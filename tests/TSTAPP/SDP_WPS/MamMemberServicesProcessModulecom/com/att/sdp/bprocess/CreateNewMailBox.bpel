<?xml version="1.0" encoding="UTF-8"?><bpws:process xmlns:bpws="http://schemas.xmlsoap.org/ws/2004/03/business-process/" xmlns:java="http://SdpCommonLibrary" xmlns:ns="http://MamMemberServicesProcessModule/com/att/sdp/bprocess/CreateNewMailBoxArtifacts" xmlns:ns0="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_Order" xmlns:ns1="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_TransactionDetail" xmlns:ns10="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_ErrorObject_Message" xmlns:ns11="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_ServiceCvoipSettings" xmlns:ns12="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_AccountMailBoxes" xmlns:ns13="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_MemberTNS" xmlns:ns14="http://SdpCommonLibrary/com/att/sdp/intf/FromSdp_ErrorLogger_Interface" xmlns:ns15="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_Account" xmlns:ns16="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_CVoipTNInfo" xmlns:ns17="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_MailBoxMembers" xmlns:ns18="http://MamMemberServicesProcessModule/com/att/sdp/intf/FromMam_DeleteMailBox_Interface" xmlns:ns19="http://MamMemberServicesProcessModule/com/att/sdp/bprocess" xmlns:ns2="http://MamMemberServicesProcessModule/com/att/sdp/intf/FromMam_CreateNewMailBox_Interface" xmlns:ns20="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_MemberProfile" xmlns:ns21="http://SdpCommonLibrary/com/att/sdp/intf/UcdclOutputServiceWrapper_Interface" xmlns:ns22="http://SdpCommonLibrary/com/att/sdp/intf/MPSCompensableService2_Interface" xmlns:ns23="http://SdpCommonLibrary/com/att/sdp/intf/UCDCLCompensableService_Interface" xmlns:ns3="http://SdpCommonLibrary/com/att/sdp/intf/ToUCDCL_ProvisioningService_Interface" xmlns:ns4="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_Person" xmlns:ns5="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_TelephoneNumber" xmlns:ns6="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_PersonName" xmlns:ns7="http://SdpCommonLibrary/com/att/sdp/intf/ToUCDCL_SubscriberService_Interface" xmlns:ns8="http://SdpCommonLibrary/com/att/sdp/intf/To_WESM" xmlns:ns9="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_Error" xmlns:wpc="http://www.ibm.com/xmlns/prod/websphere/business-process/6.0.0/" xmlns:xsd="http://www.w3.org/2001/XMLSchema" expressionLanguage="http://www.ibm.com/xmlns/prod/websphere/business-process/expression-lang/java/6.0.0/" name="CreateNewMailBox" suppressJoinFailure="yes" targetNamespace="http://MamMemberServicesProcessModule/com/att/sdp/bprocess" wpc:displayName="CreateNewMailBox" wpc:executionMode="microflow" wpc:id="1" wpc:version="8.5.0">
  <wpc:javaGlobals>
    <wpc:import packages="sbc.lightspeed.sdp.wps.SdpErrorHelper"/>
    <wpc:import packages="sbc.lightspeed.sdp.wps.SdpHelper"/>
    <wpc:import packages="sbc.lightspeed.sdp.wps.SdpLoggerHelper"/>
    <wpc:import packages="commonj.sdo.DataObject"/>
    <wpc:import packages="java.util.List"/>
    <wpc:import packages="java.util.Iterator"/>
    <wpc:import packages="com.att.sdp.utils.MamMemberServiceHelper"/>
    <wpc:import packages="att.lightspeed.sdp.helper.Product"/>
    <wpc:import packages="att.lightspeed.sdp.helper.Order"/>
    <wpc:import packages="att.lightspeed.sdp.helper.CvoipConfig"/>
    <wpc:import packages="att.lightspeed.sdp.helper.PropertyReadException"/>
    <wpc:import packages="sbc.lightspeed.sdp.wps.MpsHelper"/>
    <wpc:import packages="att.lightspeed.sdp.helper.SDO"/>
    <wpc:import packages="att.lightspeed.sdp.helper.WpsLogger"/>
    <wpc:import packages="com.att.sdp.util.StringUtil"/>
  </wpc:javaGlobals>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../../../../../MamMemberServicesProcessModule_Old/com/att/sdp/intf/FromMam_CreateNewMailBox_Interface.wsdl" namespace="http://MamMemberServicesProcessModule/com/att/sdp/intf/FromMam_CreateNewMailBox_Interface"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../../SdpCommonLibrary/SDP_Order.xsd" namespace="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_Order"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="CreateNewMailBoxArtifacts.wsdl" namespace="http://MamMemberServicesProcessModule/com/att/sdp/bprocess/CreateNewMailBoxArtifacts"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../../SdpCommonLibrary/SDP_TransactionDetail.xsd" namespace="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_TransactionDetail"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../../../../../SdpCommonLibrary/com/att/sdp/intf/SDP_Order_to_UCDCL_ProvisioningService.wsdl" namespace="http://SdpCommonLibrary/com/att/sdp/intf/ToUCDCL_ProvisioningService_Interface"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../../SdpCommonLibrary/SDP_TelephoneNumber.xsd" namespace="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_TelephoneNumber"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../../SdpCommonLibrary/SDP_Person.xsd" namespace="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_Person"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../../SdpCommonLibrary/SDP_PersonName.xsd" namespace="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_PersonName"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../../../../../SdpCommonLibrary/com/att/sdp/intf/SDP_Order_to_UCDCL_SubscriberService.wsdl" namespace="http://SdpCommonLibrary/com/att/sdp/intf/ToUCDCL_SubscriberService_Interface"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../../../../../SdpCommonLibrary/com/att/sdp/intf/To_WESM.wsdl" namespace="http://SdpCommonLibrary/com/att/sdp/intf/To_WESM"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../../SdpCommonLibrary/BPCStandardFaultType.xsd" namespace="http://www.ibm.com/xmlns/prod/websphere/business-process/6.0.0/"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../../SdpCommonLibrary/SDP_Error.xsd" namespace="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_Error"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../../SdpCommonLibrary/SDP_ErrorObject_Message.xsd" namespace="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_ErrorObject_Message"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../../SdpCommonLibrary/SDP_ServiceCvoipSettings.xsd" namespace="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_ServiceCvoipSettings"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../../SdpCommonLibrary/SDP_AccountMailBoxes.xsd" namespace="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_AccountMailBoxes"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../../SdpCommonLibrary/SDP_MemberTNS.xsd" namespace="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_MemberTNS"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../../../../../SdpCommonLibrary/com/att/sdp/intf/FromSdp_ErrorLogger_Interface.wsdl" namespace="http://SdpCommonLibrary/com/att/sdp/intf/FromSdp_ErrorLogger_Interface"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../../SdpCommonLibrary/SDP_Account.xsd" namespace="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_Account"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../../SdpCommonLibrary/SDP_CVoipTNInfo.xsd" namespace="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_CVoipTNInfo"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../../SdpCommonLibrary/SDP_MailBoxMembers.xsd" namespace="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_MailBoxMembers"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../../../../../MamMemberServicesProcessModule_Old/com/att/sdp/intf/FromMam_DeleteMailBox_Interface.wsdl" namespace="http://MamMemberServicesProcessModule/com/att/sdp/intf/FromMam_DeleteMailBox_Interface"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../../../../../MamMemberServicesProcessModuleTemp/com/att/sdp/bprocess/DeleteMailBox_CompensationArtifacts.wsdl" namespace="http://MamMemberServicesProcessModule/com/att/sdp/bprocess/CreateNewMailBoxArtifacts"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../../../../../MamMemberServicesProcessModule_Old/com/att/sdp/intf/FromMam_CreateNewMailBox_Interface.wsdl" namespace="http://MamMemberServicesProcessModule/com/att/sdp/intf/FromMam_CreateNewMailBox_Interface"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../../../../../MamMemberServicesProcessModule_Old/com/att/sdp/intf/FromMam_CreateNewMailBox_Interface.wsdl" namespace="http://MamMemberServicesProcessModule/com/att/sdp/intf/FromMam_CreateNewMailBox_Interface"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../../../../../MamMemberServicesProcessModule_Old/com/att/sdp/intf/FromMam_CreateNewMailBox_Interface.wsdl" namespace="http://MamMemberServicesProcessModule/com/att/sdp/intf/FromMam_CreateNewMailBox_Interface"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../../../../../MamMemberServicesProcessModule_Old/com/att/sdp/intf/FromMam_CreateNewMailBox_Interface.wsdl" namespace="http://MamMemberServicesProcessModule/com/att/sdp/intf/FromMam_CreateNewMailBox_Interface"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../../../../../MamMemberServicesProcessModuleTemp/com/att/sdp/intf/FromMam_CreateNewMailBox_Interface.wsdl" namespace="http://MamMemberServicesProcessModule/com/att/sdp/intf/FromMam_CreateNewMailBox_Interface"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../intf/FromMam_CreateNewMailBox_Interface.wsdl" namespace="http://MamMemberServicesProcessModule/com/att/sdp/intf/FromMam_CreateNewMailBox_Interface"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="DeleteMailBox_CompensationArtifacts.wsdl" namespace="http://MamMemberServicesProcessModule/com/att/sdp/bprocess/CreateNewMailBoxArtifacts"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../../SdpCommonLibrary/SDP_MemberProfile.xsd" namespace="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_MemberProfile"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../intf/To_WESM.wsdl" namespace="http://SdpCommonLibrary/com/att/sdp/intf/To_WESM"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../intf/SDP_Order_to_UCDCL_ProvisioningService.wsdl" namespace="http://SdpCommonLibrary/com/att/sdp/intf/ToUCDCL_ProvisioningService_Interface"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../SDP_MemberProfile.xsd" namespace="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_MemberProfile"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../SDP_TransactionDetail.xsd" namespace="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_TransactionDetail"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../SDP_MemberTNS.xsd" namespace="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_MemberTNS"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../SDP_PersonName.xsd" namespace="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_PersonName"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../SDP_AccountMailBoxes.xsd" namespace="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_AccountMailBoxes"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../intf/SDP_Order_to_UCDCL_SubscriberService.wsdl" namespace="http://SdpCommonLibrary/com/att/sdp/intf/ToUCDCL_SubscriberService_Interface"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../SDP_Order.xsd" namespace="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_Order"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../SDP_CVoipTNInfo.xsd" namespace="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_CVoipTNInfo"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../SDP_Account.xsd" namespace="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_Account"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../SDP_ServiceCvoipSettings.xsd" namespace="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_ServiceCvoipSettings"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../SDP_ErrorObject_Message.xsd" namespace="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_ErrorObject_Message"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../BPCStandardFaultType.xsd" namespace="http://www.ibm.com/xmlns/prod/websphere/business-process/6.0.0/"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../SDP_Error.xsd" namespace="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_Error"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../intf/UcdclOutputServiceWrapper_Interface.wsdl" namespace="http://SdpCommonLibrary/com/att/sdp/intf/UcdclOutputServiceWrapper_Interface"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="/resource/SdpCommonLibrary/com/att/sdp/intf/MPSCompensableService2_Interface.wsdl" namespace="http://SdpCommonLibrary/com/att/sdp/intf/MPSCompensableService2_Interface"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="/resource/SdpCommonLibrary/com/att/sdp/intf/MPSCompensableService2_Interface.wsdl" namespace="http://SdpCommonLibrary/com/att/sdp/intf/MPSCompensableService2_Interface"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../intf/MPSCompensableService2_Interface.wsdl" namespace="http://SdpCommonLibrary/com/att/sdp/intf/MPSCompensableService2_Interface"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../ServiceCallFault.xsd" namespace="http://SdpCommonLibrary"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../intf/UCDCLCompensableService_Interface.wsdl" namespace="http://SdpCommonLibrary/com/att/sdp/intf/UCDCLCompensableService_Interface"/>
  <bpws:partnerLinks>
    <bpws:partnerLink myRole="myRole" name="FromMam_CreateNewMailBox_Interface" partnerLinkType="ns:PartnerPLT4" wpc:id="1154"/>
    <bpws:partnerLink name="UCDCL_CompensableService_Interface" partnerLinkType="ns:PartnerPLT5" partnerRole="partnerRole" wpc:id="1155"/>
    <bpws:partnerLink name="MPSCompensableService2_InterfacePartner" partnerLinkType="ns:MPSCompensableService2_InterfacePLT" partnerRole="MPSCompensableService2_InterfaceRole" wpc:id="1156"/>
  </bpws:partnerLinks>
  <bpws:variables>
    <bpws:variable name="EmptyTransaction_Detail" type="ns1:SDP_TransactionDetail" wpc:id="4"/>
    <bpws:variable name="ucdclEmailOrPhone" type="xsd:string" wpc:id="9"/>
    <bpws:variable name="ucdclTelePhoneNumber" type="ns16:SDP_CVoipTNInfo" wpc:id="11"/>
    <bpws:variable name="ucdclDeviceNumber" type="xsd:string" wpc:id="21"/>
    <bpws:variable name="ucdclDeviceType" type="xsd:string" wpc:id="22"/>
    <bpws:variable name="ucdclDeviceCFN" type="xsd:string" wpc:id="23"/>
    <bpws:variable name="ucdclAuthentication" type="xsd:string" wpc:id="24"/>
    <bpws:variable name="ucdclTransportMWI" type="xsd:string" wpc:id="25"/>
    <bpws:variable name="EmptyErrorObject" type="ns9:SDP_Error" wpc:id="113"/>
    <bpws:variable name="currentMBox" type="ns12:SDP_AccountMailBoxes" wpc:id="125"/>
    <bpws:variable name="intListCounter" type="xsd:int" wpc:id="126"/>
    <bpws:variable name="intTNListCounter" type="xsd:int" wpc:id="136"/>
    <bpws:variable name="intCounterReq" type="xsd:int" wpc:id="147"/>
    <bpws:variable name="intCounterProv" type="xsd:int" wpc:id="148"/>
    <bpws:variable name="sdpOrderTrig" type="ns0:SDP_Order" wpc:id="200"/>
    <bpws:variable name="sdpOrderProc" type="ns0:SDP_Order" wpc:id="201"/>
    <bpws:variable name="provSdpOrderTrig" type="ns0:SDP_Order" wpc:id="202"/>
    <bpws:variable name="provSdpOrderProc" type="ns0:SDP_Order" wpc:id="203"/>
    <bpws:variable name="sdpOrderPort" type="ns0:SDP_Order" wpc:id="205"/>
    <bpws:variable name="sdpAccount" type="ns15:SDP_Account" wpc:id="209"/>
    <bpws:variable name="mainMailBox" type="ns12:SDP_AccountMailBoxes" wpc:id="224"/>
    <bpws:variable name="provLoopCounter" type="xsd:int" wpc:id="285"/>
    <bpws:variable name="mainMailboxInvariantId" type="xsd:string" wpc:id="288"/>
    <bpws:variable name="tmpMBox" type="ns12:SDP_AccountMailBoxes" wpc:id="307"/>
    <bpws:variable name="sdpOrderForUpdate" type="ns0:SDP_Order" wpc:id="308"/>
    <bpws:variable name="currentTN" type="ns13:SDP_MemberTNS" wpc:id="324"/>
    <bpws:variable name="firstmailboxTN" type="ns13:SDP_MemberTNS" wpc:id="343"/>
    <bpws:variable name="RollBack_SDP_ORDER" type="ns0:SDP_Order" wpc:id="410"/>
    <bpws:variable name="CNMB_state" type="xsd:int" wpc:id="413"/>
    <bpws:variable name="RollBackMailBox" type="ns12:SDP_AccountMailBoxes" wpc:id="432"/>
    <bpws:variable name="emptyMailBox" type="ns12:SDP_AccountMailBoxes" wpc:id="440"/>
    <bpws:variable name="SDP_ORDER_RequestPort" type="ns0:SDP_Order" wpc:id="464"/>
    <bpws:variable name="SDP_ORDER_ProvPort" type="ns0:SDP_Order" wpc:id="465"/>
    <bpws:variable name="transactionDetailPort" type="ns1:SDP_TransactionDetail" wpc:id="548"/>
    <bpws:variable name="PROCESS_NAME" type="xsd:string" wpc:id="569"/>
    <bpws:variable name="processID" type="xsd:string" wpc:id="570"/>
    <bpws:variable name="mainMailBoxTN" type="xsd:string" wpc:id="752"/>
    <bpws:variable name="Sdp_AccountMailBoxes_Port" type="ns12:SDP_AccountMailBoxes" wpc:id="753"/>
    <bpws:variable name="primaryMemberProfile" type="ns20:SDP_MemberProfile" wpc:id="760"/>
    <bpws:variable name="invariantId" type="xsd:string" wpc:id="888"/>
    <bpws:variable name="ADLRemovedMbox" type="ns12:SDP_AccountMailBoxes" wpc:id="1012"/>
    <bpws:variable name="provSdpOrderCopy" type="ns0:SDP_Order" wpc:id="1020"/>
    <bpws:variable name="UMSessionID" type="xsd:string" wpc:id="1021"/>
    <bpws:variable name="mailboxComponentId" type="xsd:string" wpc:id="1095"/>
    <bpws:variable name="processBO" type="ns0:SDP_Order" wpc:id="1137"/>
    <bpws:variable name="processTransDetail" type="ns1:SDP_TransactionDetail" wpc:id="1138"/>
    <bpws:variable name="emptyOrder" type="ns0:SDP_Order" wpc:id="1141"/>
    <bpws:variable name="tmpTN" type="xsd:string" wpc:id="1147"/>
    <bpws:variable name="loginId" type="xsd:string" wpc:id="1148"/>
    <bpws:variable name="UMMessageCenterIP" type="xsd:string" wpc:id="1149"/>
    <bpws:variable name="umJSessionId" type="xsd:string" wpc:id="1151"/>
  </bpws:variables>
  <bpws:faultHandlers>
    <bpws:catchAll wpc:id="1153">
      <bpws:invoke name="LogErrorToFile" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log Error To File" wpc:id="545">
        <wpc:script>
          <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage("Unknown Failure Occured in MAM.UpdateMailBoxConfig",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);
														
											
														
														
														]]></wpc:javaCode>
        </wpc:script>
      </bpws:invoke>
    </bpws:catchAll>
  </bpws:faultHandlers>
  <bpws:sequence name="HiddenSequence18" wpc:id="1073742935">
    <bpws:receive createInstance="yes" name="Receive" operation="CreateNewMailBox" partnerLink="FromMam_CreateNewMailBox_Interface" portType="ns2:FromMam_CreateNewMailBox_Interface" wpc:displayName="Receive" wpc:id="6">
      <wpc:output>
        <wpc:parameter name="SDP_ORDER_Prov" variable="provSdpOrderTrig"/>
        <wpc:parameter name="SDP_ORDER_Request" variable="sdpOrderTrig"/>
      </wpc:output>
    </bpws:receive>
    <bpws:invoke name="LogBeginProcess" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [Begin Process]" wpc:id="572">
      <wpc:script>
        <wpc:javaCode><![CDATA[processID=sdpOrderTrig.getString(SdpHelper.TEMPSTRING2_PATH.replace('.','/'));
PROCESS_NAME = "CREATE_NEW_MAILBOX";


SdpLoggerHelper.logMessage("Begin SubFlow : CreateNewMailBox",PROCESS_NAME,processID,SdpLoggerHelper.INFO);
SdpLoggerHelper.logMessage("Received the following GBO From MAM ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("sdpOrder :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(sdpOrderTrig,PROCESS_NAME,processID,SdpLoggerHelper.INFO);]]></wpc:javaCode>
      </wpc:script>
    </bpws:invoke>
    <bpws:assign name="CopyTrigtoProc" wpc:displayName="Copy Trig to Proc" wpc:id="206">
      <bpws:copy>
        <bpws:from variable="sdpOrderTrig"/>
        <bpws:to variable="sdpOrderProc"/>
      </bpws:copy>
      <bpws:copy>
        <bpws:from variable="provSdpOrderTrig"/>
        <bpws:to variable="provSdpOrderProc"/>
      </bpws:copy>
      <bpws:copy>
        <bpws:from variable="provSdpOrderTrig"/>
        <bpws:to variable="provSdpOrderCopy"/>
      </bpws:copy>
    </bpws:assign>
    <bpws:invoke name="GettheMainMailBoxandInitilazeVariables" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Get the Main MailBox and Initilaze Variables" wpc:id="223">
      <wpc:script>
        <wpc:javaCode><![CDATA[commonj.sdo.DataObject __result__2 = sbc.lightspeed.sdp.wps.SdpHelper.getPrimaryMailBox(provSdpOrderProc);
mainMailBox = __result__2;
boolean __result__4 = mainMailBox != null;
if (__result__4){
	java.lang.String __result__7 = mainMailBox.getString("mailBoxInvariantId");
	mainMailboxInvariantId = __result__7;
}
else{
}
UMMessageCenterIP = null;]]></wpc:javaCode>
      </wpc:script>
    </bpws:invoke>
    <bpws:invoke name="GetthePrimaryMemberProfile" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Get the PrimaryMemberProfile" wpc:id="758">
      <wpc:script>
        <wpc:javaCode><![CDATA[primaryMemberProfile = null;

SdpLoggerHelper.logMessage("Getting the Primary MemberProfile",PROCESS_NAME,processID,SdpLoggerHelper.INFO);
primaryMemberProfile = SdpHelper.getPrimaryMemberProfile(provSdpOrderProc);

if (primaryMemberProfile == null) 
{
	SdpLoggerHelper.logMessage("Primary MemberProfile is Not Available",PROCESS_NAME,processID,SdpLoggerHelper.INFO);
}]]></wpc:javaCode>
      </wpc:script>
    </bpws:invoke>
    <bpws:invoke name="ClearAccountMailboxesfromprovSdpOrderProc" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Clear AccountMailboxes from provSdpOrderProc" wpc:id="772">
      <wpc:script>
        <wpc:javaCode><![CDATA[//Clearing all the AccountMailboxes from provSdpOrderProc, to add the Newly created Mailbox
provSdpOrderProc.getList(SdpHelper.VOIP_ACCOUNTMAILBOXES_PATH.replace('.','/')).clear();]]></wpc:javaCode>
      </wpc:script>
    </bpws:invoke>
    <bpws:assign name="InitializeVariables" wpc:displayName="Initialize Variables" wpc:id="112">
      <bpws:copy>
        <bpws:from>0</bpws:from>
        <bpws:to variable="intListCounter"/>
      </bpws:copy>
      <bpws:copy>
        <bpws:from>
          <bpws:expression expressionLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[bo:create('http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_Error','SDP_Error')]]></bpws:expression>
        </bpws:from>
        <bpws:to variable="EmptyErrorObject"/>
      </bpws:copy>
      <bpws:copy>
        <bpws:from>0</bpws:from>
        <bpws:to variable="intCounterReq"/>
      </bpws:copy>
      <bpws:copy>
        <bpws:from>0</bpws:from>
        <bpws:to variable="intCounterProv"/>
      </bpws:copy>
      <bpws:copy>
        <bpws:from>Landline</bpws:from>
        <bpws:to variable="ucdclDeviceType"/>
      </bpws:copy>
      <bpws:copy>
        <bpws:from>SIP</bpws:from>
        <bpws:to variable="ucdclTransportMWI"/>
      </bpws:copy>
      <bpws:copy>
        <bpws:from>0</bpws:from>
        <bpws:to variable="provLoopCounter"/>
      </bpws:copy>
      <bpws:copy>
        <bpws:from variable="provSdpOrderProc"/>
        <bpws:to variable="sdpOrderForUpdate"/>
      </bpws:copy>
      <bpws:copy>
        <bpws:from>
          <bpws:expression expressionLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[bo:create('http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_TransactionDetail', 'SDP_TransactionDetail')]]></bpws:expression>
        </bpws:from>
        <bpws:to variable="EmptyTransaction_Detail"/>
      </bpws:copy>
      <bpws:copy>
        <bpws:from>false</bpws:from>
        <bpws:to variable="EmptyTransaction_Detail">
          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorIndicator]]></bpws:query>
        </bpws:to>
      </bpws:copy>
      <bpws:copy>
        <bpws:from>
          <bpws:expression expressionLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[bo:create('http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_AccountMailBoxes', 'SDP_AccountMailBoxes')]]></bpws:expression>
        </bpws:from>
        <bpws:to variable="emptyMailBox"/>
      </bpws:copy>
      <bpws:copy>
        <bpws:from variable="sdpOrderProc"/>
        <bpws:to variable="RollBack_SDP_ORDER"/>
      </bpws:copy>
      <bpws:copy>
        <bpws:from>null</bpws:from>
        <bpws:to variable="EmptyTransaction_Detail">
          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/Message/SdpCode]]></bpws:query>
        </bpws:to>
      </bpws:copy>
      <bpws:copy>
        <bpws:from variable="EmptyTransaction_Detail"/>
        <bpws:to variable="transactionDetailPort"/>
      </bpws:copy>
      <bpws:copy>
        <bpws:from variable="EmptyTransaction_Detail"/>
        <bpws:to variable="sdpOrderForUpdate">
          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail]]></bpws:query>
        </bpws:to>
      </bpws:copy>
      <bpws:copy>
        <bpws:from>
          <bpws:expression expressionLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[bo:create('http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_Order', 'SDP_Order')]]></bpws:expression>
        </bpws:from>
        <bpws:to variable="emptyOrder"/>
      </bpws:copy>
      <bpws:copy>
        <bpws:from><![CDATA[null]]></bpws:from>
        <bpws:to variable="tmpTN"/>
      </bpws:copy>
      <bpws:copy>
        <bpws:from variable="EmptyTransaction_Detail"/>
        <bpws:to variable="processBO">
          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[transactionDetail]]></bpws:query>
        </bpws:to>
      </bpws:copy>
    </bpws:assign>
    <bpws:invoke name="ClearROLLBACKORDER" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Clear ROLLBACK ORDER" wpc:id="327">
      <wpc:script>
        <wpc:javaCode><![CDATA[new Order(RollBack_SDP_ORDER).getProductList(Product.CVOIPMAILBOX).clear();]]></wpc:javaCode>
      </wpc:script>
    </bpws:invoke>
    <bpws:while name="ForeachnewMailBoxintheList" wpc:displayName="For each new MailBox in the List" wpc:id="118">
      <bpws:condition><![CDATA[boolean __result__1 = intListCounter.intValue() < sdpOrderProc.getDataObject("order").getDataObject("ReqService").getDataObject("product").getDataObject("cvoipProduct").getList("accountMailBoxes").size();
return __result__1;
]]></bpws:condition>
      <bpws:sequence name="HiddenSequence" wpc:id="1073742936">
        <bpws:invoke name="LogSDPOrderProc" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log SDP Order Proc" wpc:id="983">
          <wpc:script>
            <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage("SdpOrder Proc from which the mailbox is retireved",
	PROCESS_NAME,processID, SdpLoggerHelper.DEBUG);
	
SdpLoggerHelper.logBO(sdpOrderProc, PROCESS_NAME,processID, SdpLoggerHelper.DEBUG);

SdpLoggerHelper.logMessage("TN List Counter [" + intListCounter.intValue() + "]", 
	PROCESS_NAME,processID, SdpLoggerHelper.DEBUG);]]></wpc:javaCode>
          </wpc:script>
        </bpws:invoke>
        <bpws:invoke name="GetCurrentNewMailBoxandIntializeTNListCounter" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Get Current New MailBox and Intialize TN List Counter" wpc:id="197">
          <wpc:script>
            <wpc:javaCode><![CDATA[java.util.List __result__1 = sdpOrderProc.getDataObject("order").getDataObject("ReqService").getDataObject("product").getDataObject("cvoipProduct").getList("accountMailBoxes");
java.lang.Object __result__3;
{// get item at index
	__result__3 = __result__1.get((intListCounter.intValue()));
}
currentMBox = (commonj.sdo.DataObject)__result__3;
byte __result__5 = 0;
intTNListCounter = new java.lang.Integer(__result__5);
]]></wpc:javaCode>
          </wpc:script>
        </bpws:invoke>
        <bpws:invoke name="LogCurrentMailbox1" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log Current Mailbox" wpc:id="986">
          <wpc:script>
            <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage("currentMBox", PROCESS_NAME,processID, SdpLoggerHelper.DEBUG);
SdpLoggerHelper.logBO(currentMBox, PROCESS_NAME,processID, SdpLoggerHelper.DEBUG);]]></wpc:javaCode>
          </wpc:script>
        </bpws:invoke>
        <bpws:switch name="IfMailboxInvariantIDisnullorempty" wpc:displayName="If Mailbox Invariant ID is null or empty?" wpc:id="194">
          <bpws:case wpc:id="195">
            <bpws:condition><![CDATA[String strMailBoxInvID = currentMBox.getString("mailBoxInvariantId");

return strMailBoxInvID == null || strMailBoxInvID.trim().length() == 0; 

]]></bpws:condition>
            <bpws:sequence name="HiddenSequence10" wpc:id="1073742937">
              <bpws:assign name="Preinvokeassigns6" wpc:displayName="Preinvoke assigns" wpc:id="743">
                <bpws:copy>
                  <bpws:from variable="EmptyTransaction_Detail"/>
                  <bpws:to variable="transactionDetailPort"/>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from>UCDCL.Login.Request</bpws:from>
                  <bpws:to variable="transactionDetailPort">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/State]]></bpws:query>
                  </bpws:to>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from>UCDCL</bpws:from>
                  <bpws:to variable="transactionDetailPort">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/TargetSystem]]></bpws:query>
                  </bpws:to>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from>Login</bpws:from>
                  <bpws:to variable="transactionDetailPort">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/currentTargetOperation]]></bpws:query>
                  </bpws:to>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from>0</bpws:from>
                  <bpws:to variable="CNMB_state"/>
                </bpws:copy>
              </bpws:assign>
              <bpws:invoke name="LogUCDCLLogin1" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UCDCL.Login ]" wpc:id="719">
                <wpc:script>
                  <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage(SdpLoggerHelper.INVOKE_STR +" : UCDCL.Login",PROCESS_NAME,processID
														,SdpLoggerHelper.INFO);]]></wpc:javaCode>
                </wpc:script>
              </bpws:invoke>
              <bpws:invoke name="Login1" operation="provisioningServiceLogin" partnerLink="UCDCL_CompensableService_Interface" portType="ns23:UCDCLCompensableService_Interface" wpc:displayName="Login" wpc:id="720">
                <wpc:input>
                  <wpc:parameter name="transactionDetail" variable="processTransDetail"/>
                </wpc:input>
                <wpc:output>
                  <wpc:parameter name="transactionDetail" variable="processTransDetail"/>
                </wpc:output>
                <bpws:catch faultName="wpc:runtimeFailure" faultVariable="bpcFault" wpc:faultType="wpc:BPCStandardFaultType" wpc:id="1167" wpc:variableId="721">
                  <bpws:invoke name="HandleRuntimeFailure6" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Handle Run time Failure" wpc:id="723">
                    <wpc:script>
                      <wpc:javaCode><![CDATA[SdpErrorHelper.setErrDetInTransDet(transactionDetailPort,bpcFault,SdpErrorHelper.SEVERITY_FATAL);

SdpLoggerHelper.logMessage(SdpLoggerHelper.RUNTIME_FAILURE+"   UCDCL.Login",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);

]]></wpc:javaCode>
                    </wpc:script>
                  </bpws:invoke>
                </bpws:catch>
                <bpws:catch faultName="ns23:serviceCallFault" faultVariable="scFault" wpc:faultType="java:ServiceCallFault" wpc:id="1168" wpc:variableId="724">
                  <bpws:invoke name="SetErrorDetails10" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Set Error Details" wpc:id="726">
                    <wpc:script>
                      <wpc:javaCode><![CDATA[transactionDetailPort.setBoolean(SdpHelper.ERRORINDICATOR,true);

new att.lightspeed.sdp.helper.TransactionDetail(transactionDetailPort).setSDPErrorMessage(scFault);

transactionDetailPort.getDataObject("errorDetails").getDataObject("Error").setString("Severity",SdpErrorHelper.SEVERITY_FATAL);

 
SdpLoggerHelper.logMessage(SdpLoggerHelper.FAULT_FAILURE +"   UCDCL.Login",PROCESS_NAME,processID,SdpLoggerHelper.FATAL); 
 ]]></wpc:javaCode>
                    </wpc:script>
                  </bpws:invoke>
                </bpws:catch>
                <bpws:catchAll wpc:id="1166">
                  <bpws:invoke name="Handleotherfailures6" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="handle other failures" wpc:id="731">
                    <wpc:script>
                      <wpc:javaCode><![CDATA[SdpErrorHelper.setErrDetInTransDet(transactionDetailPort,null,SdpErrorHelper.SEVERITY_FATAL);
SdpLoggerHelper.logMessage(SdpLoggerHelper.UNKNOWN_FAILURE+"  UCDCL.Login",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);]]></wpc:javaCode>
                    </wpc:script>
                  </bpws:invoke>
                </bpws:catchAll>
              </bpws:invoke>
              <bpws:switch name="CheckLoginerror" wpc:displayName="Check Login error?" wpc:id="732">
                <bpws:case wpc:id="733">
                  <bpws:condition><![CDATA[boolean __result__1 = com.ibm.wbiservers.brules.core.codegen.NillableUtility.getBoolean(transactionDetailPort, "errorIndicator", "transactionDetailPort");
return __result__1;

//@generated:com.ibm.wbit.activity.ui
//<?xml version="1.0" encoding="UTF-8"?>
//<com.ibm.wbit.activity:CompositeActivity xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:com.ibm.wbit.activity="http:///com/ibm/wbit/activity.ecore" name="ActivityMethod">
//  <result name="Result">
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="boolean"/>
//  </result>
//  <exceptions>
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="com.ibm.bpe.api.ProcessException"/>
//  </exceptions>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="transactionDetailPort.errorIndicator" field="true">
//    <dataOutputs target="//@executableElements.1"/>
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="boolean" namespace="http://www.w3.org/2001/XMLSchema" nillable="false"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:ReturnElement" dataInputs="//@executableElements.0/@dataOutputs.0"/>
//  <executableGroups executableElements="//@executableElements.0 //@executableElements.1"/>
//</com.ibm.wbit.activity:CompositeActivity>
//@generated:end
//!SMAP!*S WBIACTDBG
//!SMAP!*L
//!SMAP!1:1,1
//!SMAP!2:2,1
//!SMAP!1000000:26,1]]></bpws:condition>
                  <bpws:sequence name="HiddenSequence19" wpc:id="1073742938">
                    <bpws:invoke name="LogUCDCLLoginError" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UCDCL.Login  - Error]" wpc:id="736">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[String strSeverity =transactionDetailPort.getString("errorDetails/Error/Severity");
int logLevel = SdpHelper.getLogLevel(strSeverity);
SdpLoggerHelper.logMessage("Returning : UCDCL.Login- "+SdpLoggerHelper.ERROR_STR+"["+strSeverity+"]",PROCESS_NAME,processID,logLevel);
														



																		]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                    <bpws:invoke name="PrepareRollBack_SDP_ORDER7" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Prepare RollBack_SDP_ORDER" wpc:id="738">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[boolean __result__1 = com.ibm.wbiservers.brules.core.codegen.NillableUtility.getList(com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(RollBack_SDP_ORDER, "order", "RollBack_SDP_ORDER"), "ReqService", "order"), "product", "ReqService"), "cvoipProduct", "product"), "accountMailBoxes", "RollBack_SDP_ORDER.order.ReqService.product.cvoipProduct").add(com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(RollBackMailBox, "RollBackMailBox"));
int __local__3 = CNMB_state.intValue();
com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(RollBack_SDP_ORDER, "transactionDetail", "RollBack_SDP_ORDER"), "tempStoreNonArray", "transactionDetail").setInt("temp11", __local__3);
int __local__5 = intTNListCounter.intValue();
com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(RollBack_SDP_ORDER, "transactionDetail", "RollBack_SDP_ORDER"), "tempStoreNonArray", "transactionDetail").setInt("temp10", __local__5);

//@generated:com.ibm.wbit.activity.ui
//<?xml version="1.0" encoding="UTF-8"?>
//<com.ibm.wbit.activity:CompositeActivity xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:com.ibm.wbit.activity="http:///com/ibm/wbit/activity.ecore" name="ActivityMethod">
//  <exceptions>
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="com.ibm.bpe.api.ProcessException"/>
//  </exceptions>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="RollBack_SDP_ORDER.order.ReqService.product.cvoipProduct.accountMailBoxes.add(RollBackMailBox)" assignable="false">
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="boolean"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="CNMB_state" variable="true">
//    <dataOutputs target="//@executableElements.2"/>
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="int" namespace="http://www.w3.org/2001/XMLSchema"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" dataInputs="//@executableElements.1/@dataOutputs.0" value="RollBack_SDP_ORDER.transactionDetail.tempStoreNonArray.temp11" field="true">
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="int" namespace="http://www.w3.org/2001/XMLSchema" nillable="false"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="intTNListCounter" variable="true">
//    <dataOutputs target="//@executableElements.4"/>
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="int" namespace="http://www.w3.org/2001/XMLSchema"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" dataInputs="//@executableElements.3/@dataOutputs.0" value="RollBack_SDP_ORDER.transactionDetail.tempStoreNonArray.temp10" field="true">
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="int" namespace="http://www.w3.org/2001/XMLSchema" nillable="false"/>
//  </executableElements>
//  <executableGroups executableElements="//@executableElements.0"/>
//  <executableGroups executableElements="//@executableElements.1 //@executableElements.2"/>
//  <executableGroups executableElements="//@executableElements.3 //@executableElements.4"/>
//</com.ibm.wbit.activity:CompositeActivity>
//@generated:end
//!SMAP!*S WBIACTDBG
//!SMAP!*L
//!SMAP!1:1,1
//!SMAP!3:2,2
//!SMAP!5:4,2
//!SMAP!1000000:41,1]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                    <bpws:reply name="ReplyUCDCLError7" operation="CreateNewMailBox" partnerLink="FromMam_CreateNewMailBox_Interface" portType="ns2:FromMam_CreateNewMailBox_Interface" wpc:displayName="Reply UCDCL Error" wpc:id="739">
                      <wpc:input>
                        <wpc:parameter name="Transaction_Detail" variable="transactionDetailPort"/>
                        <wpc:parameter name="SDP_ORDER_RequestPort" variable="RollBack_SDP_ORDER"/>
                        <wpc:parameter name="SDP_ORDER_ProvPort" variable="provSdpOrderProc"/>
                      </wpc:input>
                    </bpws:reply>
                    <bpws:terminate name="Terminate2" wpc:displayName="Terminate" wpc:id="740"/>
                  </bpws:sequence>
                </bpws:case>
              </bpws:switch>
              <bpws:invoke name="LogUCDCLLoginSuccess1" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [ UCDCL.Login -Success]" wpc:id="742">
                <wpc:script>
                  <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage("Returning : UCDCL.Login -"+SdpLoggerHelper.SUCCESS_STR,PROCESS_NAME,processID,SdpLoggerHelper.INFO);
SdpLoggerHelper.logMessage("Returning : UMSessionID -"+UMSessionID,PROCESS_NAME,processID,SdpLoggerHelper.INFO);]]></wpc:javaCode>
                </wpc:script>
              </bpws:invoke>
              <bpws:invoke name="SetUMSessionIDUMMessageCenterIP" operation="null" partnerLink="null" portType="wpc:null" wpc:continueOnError="inherit" wpc:displayName="Set UMSessionID &amp; UMMessageCenterIP" wpc:id="1136">
                <wpc:script>
                  <wpc:javaCode><![CDATA[att.lightspeed.sdp.helper.WpsLogger logger = att.lightspeed.sdp.helper.WpsLogger.getLogger(processInstance());
String UMSessionID = null;
//String UMMessageCenterIP = null;

UMSessionID = processTransDetail.getString(SdpHelper.TRANSDETAIL_UMSESSIONID);
UMMessageCenterIP = processTransDetail.getString(SdpHelper.TRANSDETAIL_UMMESSAGECENTERIP);

logger.debug("UMSessionID from the Login Response: " + UMSessionID);
logger.debug("UMMessageCenterIP from the Login Response: " + UMMessageCenterIP);

processBO.setString(SdpHelper.xPathify(SdpHelper.TRANSDETAIL_UMSESSIONID_PATH),UMSessionID);

processBO.setString(SdpHelper.xPathify(SdpHelper.TRANSDETAIL_UMMESSAGECENTERIP_PATH),UMMessageCenterIP);]]></wpc:javaCode>
                </wpc:script>
              </bpws:invoke>
              <bpws:invoke name="ClearmemberTNsinmemberProfile" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Clear memberTNs in memberProfile" wpc:id="1011">
                <wpc:script>
                  <wpc:javaCode><![CDATA[String strMemberId = null;

List lstMemberProfile = null;
Iterator itrMemberProfile = null;
DataObject memberProfile = null;
StringBuffer msg=new StringBuffer();
StringBuffer logmsg=new StringBuffer();

strMemberId = ((DataObject)currentMBox.getList("mailBoxMembers").get(0)).getString("memberId");

msg.append(" Clearing the MemberTNs from memberProfile [ ");
msg.append(strMemberId);
SdpLoggerHelper.logMessage(msg.toString(),PROCESS_NAME,processID,SdpLoggerHelper.INFO);
msg.delete(0, msg.length());

lstMemberProfile = provSdpOrderProc.getList(SdpHelper.MEMBERPROFILE_LIST_PATH.replace('.','/'));
itrMemberProfile = lstMemberProfile.iterator();

while(itrMemberProfile.hasNext())
{
	memberProfile = (DataObject) itrMemberProfile.next();
	
	if(memberProfile != null && 
		memberProfile.getString(SdpHelper.MEMBERPROFILE_MEMBERID).equalsIgnoreCase(strMemberId))
	{
		memberProfile.getList(SdpHelper.MEMBERPROFILE_MEMBER_TNS).clear();
		logmsg.append(" MemberTNs removed from memberProfile [ ");
		logmsg.append(strMemberId);
		SdpLoggerHelper.logMessage(logmsg.toString(),PROCESS_NAME,processID,SdpLoggerHelper.INFO);
		logmsg.delete(0, logmsg.length());		
	}
}
]]></wpc:javaCode>
                </wpc:script>
              </bpws:invoke>
              <bpws:invoke name="ClearRollBackMailBox" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Clear RollBackMailBox" wpc:id="412">
                <wpc:script>
                  <wpc:javaCode><![CDATA[RollBackMailBox = SdpHelper.copySpecificBO(emptyMailBox);
RollBackMailBox.getList(SdpHelper.VOIP_MAILBOXTNS).clear();]]></wpc:javaCode>
                </wpc:script>
              </bpws:invoke>
              <bpws:invoke name="SetADLRemovedMboxnull1" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Set ADLRemovedMbox = null" wpc:id="1016">
                <wpc:script>
                  <wpc:javaCode><![CDATA[ADLRemovedMbox = null;]]></wpc:javaCode>
                </wpc:script>
              </bpws:invoke>
              <bpws:while name="ForeachTNinSubMailBox" wpc:displayName="For each TN in Sub MailBox" wpc:id="134">
                <bpws:condition><![CDATA[boolean __result__1 = com.ibm.wbiservers.brules.core.codegen.NillableUtility.getInt(intTNListCounter, "intTNListCounter") < com.ibm.wbiservers.brules.core.codegen.NillableUtility.getList(currentMBox, "mailBoxTNs", "currentMBox").size();
return __result__1;

//@generated:com.ibm.wbit.activity.ui
//<?xml version="1.0" encoding="UTF-8"?>
//<com.ibm.wbit.activity:CompositeActivity xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:com.ibm.wbit.activity="http:///com/ibm/wbit/activity.ecore" name="ActivityMethod">
//  <result name="Result">
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="boolean"/>
//  </result>
//  <exceptions>
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="com.ibm.bpe.api.ProcessException"/>
//  </exceptions>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="intTNListCounter &lt; currentMBox.mailBoxTNs.size()" assignable="false">
//    <dataOutputs target="//@executableElements.1"/>
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="boolean"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:ReturnElement" dataInputs="//@executableElements.0/@dataOutputs.0"/>
//  <executableGroups executableElements="//@executableElements.0 //@executableElements.1"/>
//</com.ibm.wbit.activity:CompositeActivity>
//@generated:end
//!SMAP!*S WBIACTDBG
//!SMAP!*L
//!SMAP!1:1,1
//!SMAP!2:2,1
//!SMAP!1000000:26,1]]></bpws:condition>
                <bpws:sequence name="HiddenSequence20" wpc:id="1073742939">
                  <bpws:invoke name="GettheCurrentTNfromSubMailBox" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Get the Current TN from Sub Mail Box" wpc:id="138">
                    <wpc:script>
                      <wpc:javaCode><![CDATA[java.lang.Object __result__1 = com.ibm.wbiservers.brules.core.codegen.NillableUtility.getList(currentMBox, "mailBoxTNs", "currentMBox").get(com.ibm.wbiservers.brules.core.codegen.NillableUtility.getInt(intTNListCounter, "intTNListCounter"));
commonj.sdo.DataObject __result__2;
{// copy BO
	com.ibm.websphere.bo.BOCopy _copyService = 
	   (com.ibm.websphere.bo.BOCopy) new com.ibm.websphere.sca.ServiceManager().locateService("com/ibm/websphere/bo/BOCopy"); 
	__result__2 = _copyService.copy(((commonj.sdo.DataObject)__result__1));
}
currentTN = __result__2;

//@generated:com.ibm.wbit.activity.ui
//<?xml version="1.0" encoding="UTF-8"?>
//<com.ibm.wbit.activity:CompositeActivity xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:com.ibm.wbit.activity="http:///com/ibm/wbit/activity.ecore" name="ActivityMethod">
//  <exceptions>
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="com.ibm.bpe.api.ProcessException"/>
//  </exceptions>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="currentMBox.mailBoxTNs.get(intTNListCounter)" assignable="false">
//    <dataOutputs target="//@executableElements.1/@parameters.0"/>
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="java.lang.Object"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:LibraryActivity" name="copy BO" description="Copy a Business Object" category="SCA services" template="com.ibm.websphere.bo.BOCopy _copyService = &#xA;   (com.ibm.websphere.bo.BOCopy) new com.ibm.websphere.sca.ServiceManager().locateService(&quot;com/ibm/websphere/bo/BOCopy&quot;); &#xA;&lt;%return%> _copyService.copy(&lt;%bo%>);">
//    <parameters name="bo" dataInputs="//@executableElements.0/@dataOutputs.0" displayName="BO">
//      <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="commonj.sdo.DataObject"/>
//    </parameters>
//    <result name="copy" displayName="copy">
//      <dataOutputs target="//@executableElements.2"/>
//      <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="commonj.sdo.DataObject"/>
//    </result>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" dataInputs="//@executableElements.1/@result/@dataOutputs.0" value="currentTN" variable="true">
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="SDP_MemberTNS" namespace="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_MemberTNS"/>
//  </executableElements>
//  <executableGroups executableElements="//@executableElements.0 //@executableElements.1 //@executableElements.2"/>
//</com.ibm.wbit.activity:CompositeActivity>
//@generated:end
//!SMAP!*S WBIACTDBG
//!SMAP!*L
//!SMAP!1:1,1
//!SMAP!2:2,6
//!SMAP!3:8,1
//!SMAP!1000000:41,1]]></wpc:javaCode>
                    </wpc:script>
                  </bpws:invoke>
                  <bpws:switch name="NotPTL" wpc:displayName="Not PTL?" wpc:id="976">
                    <bpws:case wpc:id="977">
                      <bpws:condition><![CDATA[String strTN = null;
String primaryTNInd = null;
String isNLT = null;
boolean blnPTL = false;

DataObject lineSubComponent = null;

if (currentTN != null)
{
	strTN = currentTN.getString(SdpHelper.CVOIP_MAILBOX_TN);
	
	SdpLoggerHelper.logMessage("Current TN [ " + strTN + "]", PROCESS_NAME, processID, 
		SdpLoggerHelper.DEBUG);
	
	lineSubComponent = SdpHelper.getTN(provSdpOrderProc,strTN);
	
	if (lineSubComponent != null)
	{
		primaryTNInd = lineSubComponent.getString(SdpHelper.CVOIP_TN_PRIMARYIND_PATH.replace('.' , '/'));
		isNLT = lineSubComponent.getString(SdpHelper.ISNLT);
		
		SdpLoggerHelper.logMessage("Primary TN Ind[ " + primaryTNInd + "]", PROCESS_NAME, processID, 
			SdpLoggerHelper.DEBUG);
			
		SdpLoggerHelper.logMessage("NLT Ind " + isNLT + "]", PROCESS_NAME, processID, 
			SdpLoggerHelper.DEBUG);
		//Changing the logic for UBV 2 orders.	
		if ((!StringUtil.isEmpty(isNLT) && isNLT.equalsIgnoreCase(SdpHelper.YES)) || primaryTNInd.equalsIgnoreCase(SdpHelper.YES))
		/*if (primaryTNInd.equalsIgnoreCase(SdpHelper.YES))*/
		{
			blnPTL = true;
		}
	}
}

return !blnPTL;]]></bpws:condition>
                      <bpws:sequence name="HiddenSequence13" wpc:id="1073742940">
                        <bpws:invoke name="GetADLRemovedMbox" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Get ADLRemovedMbox" wpc:id="1014">
                          <wpc:script>
                            <wpc:javaCode><![CDATA[String strTN = currentTN.getString(SdpHelper.CVOIP_MAILBOX_TN);
SdpLoggerHelper.logMessage("Getting the Mailbox for the TN : " + strTN, PROCESS_NAME,processID, SdpLoggerHelper.DEBUG);
ADLRemovedMbox = SdpHelper.getMailBox(provSdpOrderCopy,strTN,SdpHelper.SEARCH_TYPE_TN); 
SdpLoggerHelper.logMessage("ADL has to be removed from the following Mailbox : ", PROCESS_NAME,processID, SdpLoggerHelper.DEBUG);
SdpLoggerHelper.logBO(ADLRemovedMbox, PROCESS_NAME,processID, SdpLoggerHelper.DEBUG);
invariantId = ADLRemovedMbox.getString(SdpHelper.CVOIP_MAILBOX_MAILBOXINVARIANTID); 
]]></wpc:javaCode>
                          </wpc:script>
                        </bpws:invoke>
                        <bpws:assign name="PreInvokeAssigns1" wpc:displayName="Pre-Invoke Assigns" wpc:id="29">
                          <bpws:copy>
                            <bpws:from variable="currentTN">
                              <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/tn]]></bpws:query>
                            </bpws:from>
                            <bpws:to variable="ucdclDeviceNumber"/>
                          </bpws:copy>
                          <bpws:copy>
                            <bpws:from>1</bpws:from>
                            <bpws:to variable="CNMB_state"/>
                          </bpws:copy>
                          <bpws:copy>
                            <bpws:from variable="EmptyTransaction_Detail"/>
                            <bpws:to variable="transactionDetailPort"/>
                          </bpws:copy>
                          <bpws:copy>
                            <bpws:from>UCDCL.DeleteDevice.request</bpws:from>
                            <bpws:to variable="transactionDetailPort">
                              <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/State]]></bpws:query>
                            </bpws:to>
                          </bpws:copy>
                          <bpws:copy>
                            <bpws:from>UCDCL</bpws:from>
                            <bpws:to variable="transactionDetailPort">
                              <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/TargetSystem]]></bpws:query>
                            </bpws:to>
                          </bpws:copy>
                          <bpws:copy>
                            <bpws:from>DeleteDevice</bpws:from>
                            <bpws:to variable="transactionDetailPort">
                              <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/currentTargetOperation]]></bpws:query>
                            </bpws:to>
                          </bpws:copy>
                          <bpws:copy>
                            <bpws:from variable="ucdclDeviceNumber"/>
                            <bpws:to variable="processBO">
                              <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[order/ReqService/product/cvoipProduct/cvoipLineSubComponent[1]/tnInfo/tn]]></bpws:query>
                            </bpws:to>
                          </bpws:copy>
                          <bpws:copy>
                            <bpws:from variable="invariantId"/>
                            <bpws:to variable="processBO">
                              <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[order/ReqService/product/cvoipProduct/accountMailBoxes[1]/mailBoxInvariantId]]></bpws:query>
                            </bpws:to>
                          </bpws:copy>
                        </bpws:assign>
                        <bpws:invoke name="TrimInputValuestoDeleteDevice" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Trim Input Values to Delete Device" wpc:id="798">
                          <wpc:script>
                            <wpc:javaCode><![CDATA[if(ucdclDeviceNumber != null)
{
	ucdclDeviceNumber = ucdclDeviceNumber.trim();
	
	SdpLoggerHelper.logMessage("ucdclDeviceNumber Trimed [" + ucdclDeviceNumber + "]",
		PROCESS_NAME, processID, SdpLoggerHelper.DEBUG);
}	

if(mainMailboxInvariantId != null)
{
	mainMailboxInvariantId = mainMailboxInvariantId.trim();
	
	SdpLoggerHelper.logMessage("mainMailboxInvariantId Trimed [" + mainMailboxInvariantId + "]",
		PROCESS_NAME, processID, SdpLoggerHelper.DEBUG);	
}	]]></wpc:javaCode>
                          </wpc:script>
                        </bpws:invoke>
                        <bpws:invoke name="LogUCDCLDeleteDevice" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UCDCL.DeleteDevice ]" wpc:id="574">
                          <wpc:script>
                            <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage(SdpLoggerHelper.INVOKE_STR +" : UCDCL.DeleteDevice",PROCESS_NAME,processID,SdpLoggerHelper.INFO);
														
SdpLoggerHelper.logMessage("Request BO[mainMailBoxInvariandId]:",PROCESS_NAME,processID,SdpLoggerHelper.INFO);
														
SdpLoggerHelper.logMessage("invariantId :"+invariantId,PROCESS_NAME,processID,SdpLoggerHelper.INFO);
SdpLoggerHelper.logMessage("ucdclDeviceNumber :"+ucdclDeviceNumber,PROCESS_NAME,processID,SdpLoggerHelper.INFO);
SdpLoggerHelper.logMessage("ucdclAuthentication :"+ucdclAuthentication,PROCESS_NAME,processID,SdpLoggerHelper.INFO);
														]]></wpc:javaCode>
                          </wpc:script>
                        </bpws:invoke>
                        <bpws:invoke name="UCDCLDeleteDevice" operation="deleteDevice" partnerLink="UCDCL_CompensableService_Interface" portType="ns23:UCDCLCompensableService_Interface" wpc:displayName="UCDCL Delete Device" wpc:id="8">
                          <wpc:input>
                            <wpc:parameter name="order" variable="processBO"/>
                          </wpc:input>
                          <wpc:output>
                            <wpc:parameter name="transactionDetail" variable="processTransDetail"/>
                          </wpc:output>
                          <bpws:catch faultName="wpc:runtimeFailure" faultVariable="bpcFault" wpc:faultType="wpc:BPCStandardFaultType" wpc:id="1194" wpc:variableId="107">
                            <bpws:invoke name="HandleRuntimeFailure" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Handle Runtime Failure" wpc:id="547">
                              <wpc:script>
                                <wpc:javaCode><![CDATA[SdpErrorHelper.setErrDetInTransDet(transactionDetailPort,bpcFault,SdpErrorHelper.SEVERITY_FATAL);
SdpLoggerHelper.logMessage(SdpLoggerHelper.RUNTIME_FAILURE+"  UCDCL.DeleteDevice",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);

 
]]></wpc:javaCode>
                              </wpc:script>
                            </bpws:invoke>
                          </bpws:catch>
                          <bpws:catch faultName="ns23:serviceCallFault" faultVariable="scFault" wpc:faultType="java:ServiceCallFault" wpc:id="1195" wpc:variableId="174">
                            <bpws:invoke name="SetErrorDetails" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Set Error Details" wpc:id="550">
                              <wpc:script>
                                <wpc:javaCode><![CDATA[transactionDetailPort.setBoolean(SdpHelper.ERRORINDICATOR,true);

new att.lightspeed.sdp.helper.TransactionDetail(transactionDetailPort).setSDPErrorMessage(scFault);

transactionDetailPort.getDataObject("errorDetails").getDataObject("Error").setString("Severity",SdpErrorHelper.SEVERITY_FATAL);

SdpLoggerHelper.logMessage(SdpLoggerHelper.FAULT_FAILURE +"  UCDCL.DeleteDevice",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);

 
]]></wpc:javaCode>
                              </wpc:script>
                            </bpws:invoke>
                          </bpws:catch>
                          <bpws:catchAll wpc:id="1193">
                            <bpws:invoke name="Handleotherfailures" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="handle other failures" wpc:id="380">
                              <wpc:script>
                                <wpc:javaCode><![CDATA[SdpErrorHelper.setErrDetInTransDet(transactionDetailPort,null,SdpErrorHelper.SEVERITY_FATAL);
SdpLoggerHelper.logMessage(SdpLoggerHelper.UNKNOWN_FAILURE+"  UCDCL.DeleteDevice",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);]]></wpc:javaCode>
                              </wpc:script>
                            </bpws:invoke>
                          </bpws:catchAll>
                        </bpws:invoke>
                        <bpws:switch name="CheckUCDCLError" wpc:displayName="Check UCDCL Error" wpc:id="57">
                          <bpws:case wpc:id="58">
                            <bpws:condition><![CDATA[boolean __result__1 = com.ibm.wbiservers.brules.core.codegen.NillableUtility.getBoolean(transactionDetailPort, "errorIndicator", "transactionDetailPort");
return __result__1;

//@generated:com.ibm.wbit.activity.ui
//<?xml version="1.0" encoding="UTF-8"?>
//<com.ibm.wbit.activity:CompositeActivity xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:com.ibm.wbit.activity="http:///com/ibm/wbit/activity.ecore" name="ActivityMethod">
//  <result name="Result">
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="boolean"/>
//  </result>
//  <exceptions>
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="com.ibm.bpe.api.ProcessException"/>
//  </exceptions>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="transactionDetailPort.errorIndicator" field="true">
//    <dataOutputs target="//@executableElements.1"/>
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="boolean" namespace="http://www.w3.org/2001/XMLSchema" nillable="false"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:ReturnElement" dataInputs="//@executableElements.0/@dataOutputs.0"/>
//  <executableGroups executableElements="//@executableElements.0 //@executableElements.1"/>
//</com.ibm.wbit.activity:CompositeActivity>
//@generated:end
//!SMAP!*S WBIACTDBG
//!SMAP!*L
//!SMAP!1:1,1
//!SMAP!2:2,1
//!SMAP!1000000:26,1]]></bpws:condition>
                            <bpws:sequence name="HiddenSequence21" wpc:id="1073742941">
                              <bpws:invoke name="LogUCDCLDeleteDeviceError" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [ UCDCL.DeleteDevice - Error]" wpc:id="603">
                                <wpc:script>
                                  <wpc:javaCode><![CDATA[String strSeverity =transactionDetailPort.getString("errorDetails/Error/Severity");
int logLevel = SdpHelper.getLogLevel(strSeverity);

SdpLoggerHelper.logMessage(" UCDCL.DeleteDevice - "+SdpLoggerHelper.ERROR_STR+"["+strSeverity+"]",PROCESS_NAME,processID,logLevel);
]]></wpc:javaCode>
                                </wpc:script>
                              </bpws:invoke>
                              <bpws:invoke name="PrepareRollBack_SDP_ORDER3" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Prepare RollBack_SDP_ORDER" wpc:id="436">
                                <wpc:script>
                                  <wpc:javaCode><![CDATA[boolean __result__1 = com.ibm.wbiservers.brules.core.codegen.NillableUtility.getList(com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(RollBack_SDP_ORDER, "order", "RollBack_SDP_ORDER"), "ReqService", "order"), "product", "ReqService"), "cvoipProduct", "product"), "accountMailBoxes", "RollBack_SDP_ORDER.order.ReqService.product.cvoipProduct").add(com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(RollBackMailBox, "RollBackMailBox"));
int __local__3 = CNMB_state.intValue();
com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(RollBack_SDP_ORDER, "transactionDetail", "RollBack_SDP_ORDER"), "tempStoreNonArray", "transactionDetail").setInt("temp11", __local__3);

//@generated:com.ibm.wbit.activity.ui
//<?xml version="1.0" encoding="UTF-8"?>
//<com.ibm.wbit.activity:CompositeActivity xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:com.ibm.wbit.activity="http:///com/ibm/wbit/activity.ecore" name="ActivityMethod">
//  <exceptions>
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="com.ibm.bpe.api.ProcessException"/>
//  </exceptions>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="RollBack_SDP_ORDER.order.ReqService.product.cvoipProduct.accountMailBoxes.add(RollBackMailBox)" assignable="false">
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="boolean"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="CNMB_state" variable="true">
//    <dataOutputs target="//@executableElements.2"/>
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="int" namespace="http://www.w3.org/2001/XMLSchema"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" dataInputs="//@executableElements.1/@dataOutputs.0" value="RollBack_SDP_ORDER.transactionDetail.tempStoreNonArray.temp11" field="true">
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="int" namespace="http://www.w3.org/2001/XMLSchema" nillable="false"/>
//  </executableElements>
//  <executableGroups executableElements="//@executableElements.0"/>
//  <executableGroups executableElements="//@executableElements.1 //@executableElements.2"/>
//</com.ibm.wbit.activity:CompositeActivity>
//@generated:end
//!SMAP!*S WBIACTDBG
//!SMAP!*L
//!SMAP!1:1,1
//!SMAP!3:2,2
//!SMAP!1000000:30,1]]></wpc:javaCode>
                                </wpc:script>
                              </bpws:invoke>
                              <bpws:reply name="ReplyUCDCLError" operation="CreateNewMailBox" partnerLink="FromMam_CreateNewMailBox_Interface" portType="ns2:FromMam_CreateNewMailBox_Interface" wpc:displayName="Reply UCDCL Error" wpc:id="62">
                                <wpc:input>
                                  <wpc:parameter name="Transaction_Detail" variable="transactionDetailPort"/>
                                  <wpc:parameter name="SDP_ORDER_RequestPort" variable="RollBack_SDP_ORDER"/>
                                  <wpc:parameter name="SDP_ORDER_ProvPort" variable="provSdpOrderProc"/>
                                </wpc:input>
                              </bpws:reply>
                              <bpws:terminate name="Terminate" wpc:displayName="Terminate" wpc:id="517"/>
                            </bpws:sequence>
                          </bpws:case>
                        </bpws:switch>
                        <bpws:invoke name="LogUCDCLDeleteDeviceSuccess" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [ UCDCL.DeleteDevice -Success]" wpc:id="596">
                          <wpc:script>
                            <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage(" UCDCL.DeleteDevice -"+SdpLoggerHelper.SUCCESS_STR,PROCESS_NAME,processID,SdpLoggerHelper.INFO);
]]></wpc:javaCode>
                          </wpc:script>
                        </bpws:invoke>
                        <bpws:invoke name="SetUMSessionIDUMMessageCenterIP1" operation="null" partnerLink="null" portType="wpc:null" wpc:continueOnError="inherit" wpc:displayName="Set UMSessionID &amp; UMMessageCenterIP" wpc:id="1140">
                          <wpc:script>
                            <wpc:javaCode><![CDATA[att.lightspeed.sdp.helper.WpsLogger logger = att.lightspeed.sdp.helper.WpsLogger.getLogger(processInstance());
String UMSessionID = null;
//String UMMessageCenterIP = null;

UMSessionID = processTransDetail.getString(SdpHelper.TRANSDETAIL_UMSESSIONID);
UMMessageCenterIP = processTransDetail.getString(SdpHelper.TRANSDETAIL_UMMESSAGECENTERIP);

logger.debug("UMSessionID from the DeleteDevice Response: " + UMSessionID);
logger.debug("UMMessageCenterIP from the DeleteDevice Response: " + UMMessageCenterIP);

processBO.setString(SdpHelper.xPathify(SdpHelper.TRANSDETAIL_UMSESSIONID_PATH),UMSessionID);

processBO.setString(SdpHelper.xPathify(SdpHelper.TRANSDETAIL_UMMESSAGECENTERIP_PATH),UMMessageCenterIP);]]></wpc:javaCode>
                          </wpc:script>
                        </bpws:invoke>
                        <bpws:invoke name="UpdateRollBackMailBox" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Update RollBackMailBox" wpc:id="434">
                          <wpc:script>
                            <wpc:javaCode><![CDATA[RollBackMailBox.getList(SdpHelper.VOIP_MAILBOXTNS).add(currentTN);
RollBackMailBox.setString(SdpHelper.CVOIP_MAILBOX_MAINMAILBOXIND,SdpHelper.NO);]]></wpc:javaCode>
                          </wpc:script>
                        </bpws:invoke>
                        <bpws:invoke name="DeleteTNfromADLRemovedMbox1" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Delete TN from ADLRemovedMbox" wpc:id="409">
                          <wpc:script>
                            <wpc:javaCode><![CDATA[java.lang.String __result__2 = currentTN.getString("tn");
commonj.sdo.DataObject __result__3 = sbc.lightspeed.sdp.wps.SdpHelper.removeTNFromMailBox(ADLRemovedMbox, __result__2);
ADLRemovedMbox = __result__3;
]]></wpc:javaCode>
                          </wpc:script>
                        </bpws:invoke>
                        <bpws:invoke name="DeleteTNfromADLRemovedMboxmembers" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Delete TN from ADLRemovedMbox member[s]" wpc:id="762">
                          <wpc:script>
                            <wpc:javaCode><![CDATA[List lstMboxMembers = null;
Iterator itrMboxMembers = null;

DataObject mboxMember = null;

Object strTn = null;

String strMemberId = null;
String keySelector = MamMemberServiceHelper.TN_KEY_SELECTOR;
String operationSelector = MamMemberServiceHelper.DELETE_OPERATION_SELECTOR;
String objectSelector = MamMemberServiceHelper.MEMBERPROFILE_OBJECT_SELECTOR;
StringBuffer logMsg=new StringBuffer();

lstMboxMembers = ADLRemovedMbox.getList(SdpHelper.VOIP_MAILBOX_MEMBERS);
itrMboxMembers = lstMboxMembers.iterator();

while(itrMboxMembers.hasNext())
{
	mboxMember = (DataObject)itrMboxMembers.next();
	
	if (mboxMember != null)
	{
		strMemberId = mboxMember.getString(SdpHelper.CVOIP_MAILBOX_MEMBERID);
		
		strTn = new String(currentTN.getString(SdpHelper.CVOIP_MAILBOX_TN));
		logMsg.append("Deleting the TN [");
		logMsg.append(strTn);
		logMsg.append("] from the PrimaryMemberProfile of MemberId[");
		logMsg.append(strMemberId);
		logMsg.append("]");
		SdpLoggerHelper.logMessage(logMsg.toString(),PROCESS_NAME,processID,SdpLoggerHelper.INFO);
		logMsg.delete(0, logMsg.length());
		MamMemberServiceHelper.modifyMemberProfileOrMailbox(provSdpOrderProc,
			strMemberId,keySelector,operationSelector,strTn,objectSelector);
	}
}]]></wpc:javaCode>
                          </wpc:script>
                        </bpws:invoke>
                      </bpws:sequence>
                    </bpws:case>
                  </bpws:switch>
                  <bpws:invoke name="IncrementTNListCounter" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Increment TN List Counter" wpc:id="141">
                    <wpc:script>
                      <wpc:javaCode><![CDATA[java.lang.Integer __result__1 = new java.lang.Integer(com.ibm.wbiservers.brules.core.codegen.NillableUtility.getInt(intTNListCounter, "intTNListCounter") + 1);
intTNListCounter = __result__1;

//@generated:com.ibm.wbit.activity.ui
//<?xml version="1.0" encoding="UTF-8"?>
//<com.ibm.wbit.activity:CompositeActivity xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:com.ibm.wbit.activity="http:///com/ibm/wbit/activity.ecore" name="ActivityMethod">
//  <exceptions>
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="com.ibm.bpe.api.ProcessException"/>
//  </exceptions>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="intTNListCounter +1" assignable="false">
//    <dataOutputs target="//@executableElements.1"/>
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="int" namespace="http://www.w3.org/2001/XMLSchema"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" dataInputs="//@executableElements.0/@dataOutputs.0" value="intTNListCounter" variable="true">
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="int" namespace="http://www.w3.org/2001/XMLSchema"/>
//  </executableElements>
//  <executableGroups executableElements="//@executableElements.0 //@executableElements.1"/>
//</com.ibm.wbit.activity:CompositeActivity>
//@generated:end
//!SMAP!*S WBIACTDBG
//!SMAP!*L
//!SMAP!1:1,1
//!SMAP!2:2,1
//!SMAP!1000000:25,1]]></wpc:javaCode>
                    </wpc:script>
                  </bpws:invoke>
                </bpws:sequence>
              </bpws:while>
              <bpws:invoke name="GetfirsttnfromCurrentMBox" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Get first tn from Current MBox" wpc:id="342">
                <wpc:script>
                  <wpc:javaCode><![CDATA[commonj.sdo.DataObject __result__1 = (commonj.sdo.DataObject)currentMBox.getList("mailBoxTNs").get(0);
commonj.sdo.DataObject __result__2;
{// copy BO
	com.ibm.websphere.bo.BOCopy _copyService = 
	   (com.ibm.websphere.bo.BOCopy) new com.ibm.websphere.sca.ServiceManager().locateService("com/ibm/websphere/bo/BOCopy"); 
	__result__2 = _copyService.copy(__result__1);
}
firstmailboxTN = __result__2;
]]></wpc:javaCode>
                </wpc:script>
              </bpws:invoke>
              <bpws:invoke name="AssigningsdpAccount" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Assigning sdpAccount" wpc:id="619">
                <wpc:script>
                  <wpc:javaCode><![CDATA[Iterator iterMemberProfiles = null;
DataObject memberProfile = null;
DataObject memberProfileTmp = null;
DataObject memberProfileOut = null;
List memberProfiles = null;
DataObject sdpAccountTmp = null;
String strMemberIDTmp = null;
StringBuffer logMsg=new StringBuffer();
StringBuffer loggerMsg=new StringBuffer();

boolean blnFound = false; 

String memberId = ((DataObject)currentMBox.getList("mailBoxMembers").get(0)).getString("memberId");

SdpLoggerHelper.logMessage("Sub memberId : "+ memberId,PROCESS_NAME, processID, SdpLoggerHelper.DEBUG);

memberProfiles = provSdpOrderProc.getList(SdpHelper.MEMBERPROFILE_LIST_PATH.replace('.','/'));

iterMemberProfiles = memberProfiles.iterator();

SdpLoggerHelper.logMessage("Got the Iterator", PROCESS_NAME, processID, SdpLoggerHelper.DEBUG);

if(memberId == null)
	memberId = "";
	
while(iterMemberProfiles.hasNext()){

	SdpLoggerHelper.logMessage("Looping through the Iterator", 
		PROCESS_NAME, processID, SdpLoggerHelper.DEBUG);
		
	memberProfileTmp = (DataObject)	iterMemberProfiles.next();

	memberProfile = SdpHelper.copySpecificBO(memberProfileTmp);
	
	SdpLoggerHelper.logMessage("Got the Member Profile", PROCESS_NAME, processID, SdpLoggerHelper.DEBUG);

	strMemberIDTmp = memberProfile.getString(SdpHelper.MEMBERID);
	logMsg.append("Comparing Member Profile :");
	logMsg.append(strMemberIDTmp);
	SdpLoggerHelper.logMessage(logMsg.toString(), PROCESS_NAME, processID, SdpLoggerHelper.DEBUG);
	logMsg.delete(0, logMsg.length());
	
	if(strMemberIDTmp == null){
	        SdpLoggerHelper.logMessage("Inside if(strMemberIDTmp == null) : " , PROCESS_NAME, 
			processID, SdpLoggerHelper.DEBUG);
		strMemberIDTmp = "";
		
	}
	if(strMemberIDTmp.equalsIgnoreCase(memberId)){
	
		memberProfileOut =  SdpHelper.copySpecificBO(memberProfile);
		loggerMsg.append(" Returning Member Profile :  ");
		loggerMsg.append(strMemberIDTmp);
		SdpLoggerHelper.logMessage(loggerMsg.toString(),PROCESS_NAME,processID,SdpLoggerHelper.DEBUG);
		loggerMsg.delete(0, loggerMsg.length());	
		break;
	}
	SdpLoggerHelper.logMessage("after if(strMemberIDTmp.equalsIgnoreCase(memberId)) : " , PROCESS_NAME, 
			processID, SdpLoggerHelper.DEBUG);
}

sdpAccountTmp = (DataObject)provSdpOrderProc.getDataObject("order/ReqService/Account");
sdpAccount = SdpHelper.copySpecificBO(sdpAccountTmp);
sdpAccount.getList("Customer/Person/memberProfile").clear();
sdpAccount.getList("Customer/Person/memberProfile").add(memberProfileOut);

mainMailBoxTN = ((DataObject)mainMailBox.getList("mailBoxTNs").get(0)).getString("tn"); 
]]></wpc:javaCode>
                </wpc:script>
              </bpws:invoke>
              <bpws:invoke name="TrimthefirstMailBoxTN1" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Trim the first MailBox TN" wpc:id="803">
                <wpc:script>
                  <wpc:javaCode><![CDATA[if( firstmailboxTN != null)
{
	String strTN = firstmailboxTN.getString("tn");
	
	if(strTN != null)
	{
		strTN = strTN.trim();
		firstmailboxTN.setString("tn", strTN);
	}	
}]]></wpc:javaCode>
                </wpc:script>
              </bpws:invoke>
              <bpws:assign name="PreInvokeAssigns" wpc:displayName="Pre-Invoke Assigns" wpc:id="13">
                <bpws:copy>
                  <bpws:from variable="mainMailboxInvariantId"/>
                  <bpws:to variable="ucdclEmailOrPhone"/>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from>2</bpws:from>
                  <bpws:to variable="CNMB_state"/>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from variable="EmptyTransaction_Detail"/>
                  <bpws:to variable="transactionDetailPort"/>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from>UCDCL.CREATESECONDARYMAILBOX.request</bpws:from>
                  <bpws:to variable="transactionDetailPort">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/State]]></bpws:query>
                  </bpws:to>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from>UCDCL</bpws:from>
                  <bpws:to variable="transactionDetailPort">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/TargetSystem]]></bpws:query>
                  </bpws:to>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from>Create Secondary MailBox</bpws:from>
                  <bpws:to variable="transactionDetailPort">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/currentTargetOperation]]></bpws:query>
                  </bpws:to>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from variable="firstmailboxTN">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/tn]]></bpws:query>
                  </bpws:from>
                  <bpws:to variable="ucdclTelePhoneNumber">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/tn]]></bpws:query>
                  </bpws:to>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from>null</bpws:from>
                  <bpws:to variable="sdpAccount">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/Customer/Person/TelephoneNumber/Usages]]></bpws:query>
                  </bpws:to>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from>null</bpws:from>
                  <bpws:to variable="Sdp_AccountMailBoxes_Port">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/Status/Message/SdpCode]]></bpws:query>
                  </bpws:to>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from variable="currentMBox">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/PIN]]></bpws:query>
                  </bpws:from>
                  <bpws:to variable="ucdclTelePhoneNumber">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/@locale]]></bpws:query>
                  </bpws:to>
                </bpws:copy>
              </bpws:assign>
              <bpws:invoke name="PreparingucdclTelePhoneNumberAddingRandomNumberintoTN" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Preparing ucdclTelePhoneNumber[Adding Random Number into TN]" wpc:id="1009">
                <wpc:script>
                  <wpc:javaCode><![CDATA[String tmpTN = null;
String newTNWithRandomNo = null;

tmpTN = ucdclTelePhoneNumber.getString("tn");

SdpLoggerHelper.logMessage("Before adding the Random No. TN in ucdclTelePhoneNumber: " + tmpTN,
	PROCESS_NAME,processID,SdpLoggerHelper.INFO);

newTNWithRandomNo = MamMemberServiceHelper.getEmailAddress(tmpTN);

ucdclTelePhoneNumber.setString("tn",newTNWithRandomNo);

tmpTN = ucdclTelePhoneNumber.getString("tn");

SdpLoggerHelper.logMessage("After adding the Random No. TN in ucdclTelePhoneNumber: " + tmpTN,
	PROCESS_NAME,processID,SdpLoggerHelper.INFO);]]></wpc:javaCode>
                </wpc:script>
              </bpws:invoke>
              <bpws:assign name="BuildGBO" wpc:displayName="Build GBO" wpc:id="1139">
                <bpws:copy>
                  <bpws:from variable="sdpAccount"/>
                  <bpws:to variable="processBO">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[order/ReqService/Account]]></bpws:query>
                  </bpws:to>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from variable="ucdclTelePhoneNumber"/>
                  <bpws:to variable="processBO">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[order/ReqService/product/cvoipProduct/cvoipLineSubComponent[1]/tnInfo]]></bpws:query>
                  </bpws:to>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from variable="ucdclEmailOrPhone"/>
                  <bpws:to variable="processBO">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[order/ReqService/product/cvoipProduct/accountMailBoxes[1]/mailBoxInvariantId]]></bpws:query>
                  </bpws:to>
                </bpws:copy>
              </bpws:assign>
              <bpws:invoke name="LogUCDCLCreateSecondaryMailBox" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UCDCL.CreateSecondaryMailBox ]" wpc:id="577">
                <wpc:script>
                  <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage(SdpLoggerHelper.INVOKE_STR +" : UCDCL.CreateSecondaryMailBox",PROCESS_NAME,processID,SdpLoggerHelper.INFO);
														
SdpLoggerHelper.logMessage("Request BO:[ucdclEmailOrPhone]",PROCESS_NAME,processID,SdpLoggerHelper.INFO);
														
SdpLoggerHelper.logMessage("ucdclEmailOrPhone :"+ucdclEmailOrPhone,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("sdpAccount :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(sdpAccount,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("ucdclTelePhoneNumber :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(ucdclTelePhoneNumber,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

														]]></wpc:javaCode>
                </wpc:script>
              </bpws:invoke>
              <bpws:invoke name="UCDCLCreateSecondaryMailBox" operation="createSecondaryMailbox" partnerLink="UCDCL_CompensableService_Interface" portType="ns23:UCDCLCompensableService_Interface" wpc:displayName="UCDCL Create Secondary MailBox" wpc:id="12">
                <wpc:input>
                  <wpc:parameter name="order" variable="processBO"/>
                </wpc:input>
                <wpc:output>
                  <wpc:parameter name="returnOrder" variable="processBO"/>
                </wpc:output>
                <bpws:catch faultName="wpc:runtimeFailure" faultVariable="bpcFault" wpc:faultType="wpc:BPCStandardFaultType" wpc:id="1158" wpc:variableId="102">
                  <bpws:invoke name="Handleruntimefailure2" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="handle runtime failure" wpc:id="383">
                    <wpc:script>
                      <wpc:javaCode><![CDATA[SdpErrorHelper.setErrDetInTransDet(transactionDetailPort,bpcFault,SdpErrorHelper.SEVERITY_FATAL);
SdpLoggerHelper.logMessage(SdpLoggerHelper.RUNTIME_FAILURE+" UCDCL.CreateSecondaryMailBox",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);
]]></wpc:javaCode>
                    </wpc:script>
                  </bpws:invoke>
                </bpws:catch>
                <bpws:catch faultName="ns23:serviceCallFault" faultVariable="scFault" wpc:faultType="java:ServiceCallFault" wpc:id="1159" wpc:variableId="178">
                  <bpws:invoke name="SetErrorDetails2" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Set Error Details" wpc:id="556">
                    <wpc:script>
                      <wpc:javaCode><![CDATA[transactionDetailPort.setBoolean(SdpHelper.ERRORINDICATOR,true);

new att.lightspeed.sdp.helper.TransactionDetail(transactionDetailPort).setSDPErrorMessage(scFault);

transactionDetailPort.getDataObject("errorDetails").getDataObject("Error").setString("Severity",SdpErrorHelper.SEVERITY_FATAL);

SdpLoggerHelper.logMessage(SdpLoggerHelper.FAULT_FAILURE +" UCDCL.CreateSecondaryMailBox",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);

 
]]></wpc:javaCode>
                    </wpc:script>
                  </bpws:invoke>
                </bpws:catch>
                <bpws:catchAll wpc:id="1157">
                  <bpws:invoke name="Handleotherfailures1" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="handle other failures" wpc:id="386">
                    <wpc:script>
                      <wpc:javaCode><![CDATA[SdpErrorHelper.setErrDetInTransDet(transactionDetailPort,null,SdpErrorHelper.SEVERITY_FATAL);
SdpLoggerHelper.logMessage(SdpLoggerHelper.UNKNOWN_FAILURE+" UCDCL.CreateSecondaryMailBox",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);]]></wpc:javaCode>
                    </wpc:script>
                  </bpws:invoke>
                </bpws:catchAll>
              </bpws:invoke>
              <bpws:switch name="CheckUCDCLError1" wpc:displayName="Check UCDCL Error" wpc:id="65">
                <bpws:case wpc:id="66">
                  <bpws:condition><![CDATA[boolean __result__1 = com.ibm.wbiservers.brules.core.codegen.NillableUtility.getBoolean(transactionDetailPort, "errorIndicator", "transactionDetailPort");
return __result__1;

//@generated:com.ibm.wbit.activity.ui
//<?xml version="1.0" encoding="UTF-8"?>
//<com.ibm.wbit.activity:CompositeActivity xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:com.ibm.wbit.activity="http:///com/ibm/wbit/activity.ecore" name="ActivityMethod">
//  <result name="Result">
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="boolean"/>
//  </result>
//  <exceptions>
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="com.ibm.bpe.api.ProcessException"/>
//  </exceptions>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="transactionDetailPort.errorIndicator" field="true">
//    <dataOutputs target="//@executableElements.1"/>
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="boolean" namespace="http://www.w3.org/2001/XMLSchema" nillable="false"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:ReturnElement" dataInputs="//@executableElements.0/@dataOutputs.0"/>
//  <executableGroups executableElements="//@executableElements.0 //@executableElements.1"/>
//</com.ibm.wbit.activity:CompositeActivity>
//@generated:end
//!SMAP!*S WBIACTDBG
//!SMAP!*L
//!SMAP!1:1,1
//!SMAP!2:2,1
//!SMAP!1000000:26,1]]></bpws:condition>
                  <bpws:sequence name="HiddenSequence23" wpc:id="1073742947">
                    <bpws:invoke name="LogUCDCLCreateSecondaryMailBoxError" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UCDCL.CreateSecondaryMailBox  - Error]" wpc:id="598">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[String strSeverity =transactionDetailPort.getString("errorDetails/Error/Severity");
int logLevel = SdpHelper.getLogLevel(strSeverity);
SdpLoggerHelper.logMessage(" UCDCL.CreateSecondaryMailBox - "+SdpLoggerHelper.ERROR_STR+"["+strSeverity+"]",PROCESS_NAME,processID,logLevel);]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                    <bpws:invoke name="PrepareRollBack_SDP_ORDER2" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Prepare RollBack_SDP_ORDER" wpc:id="442">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[boolean __result__1 = com.ibm.wbiservers.brules.core.codegen.NillableUtility.getList(com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(RollBack_SDP_ORDER, "order", "RollBack_SDP_ORDER"), "ReqService", "order"), "product", "ReqService"), "cvoipProduct", "product"), "accountMailBoxes", "RollBack_SDP_ORDER.order.ReqService.product.cvoipProduct").add(com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(RollBackMailBox, "RollBackMailBox"));
int __local__3 = CNMB_state.intValue();
com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(RollBack_SDP_ORDER, "transactionDetail", "RollBack_SDP_ORDER"), "tempStoreNonArray", "transactionDetail").setInt("temp11", __local__3);

//@generated:com.ibm.wbit.activity.ui
//<?xml version="1.0" encoding="UTF-8"?>
//<com.ibm.wbit.activity:CompositeActivity xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:com.ibm.wbit.activity="http:///com/ibm/wbit/activity.ecore" name="ActivityMethod">
//  <exceptions>
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="com.ibm.bpe.api.ProcessException"/>
//  </exceptions>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="RollBack_SDP_ORDER.order.ReqService.product.cvoipProduct.accountMailBoxes.add(RollBackMailBox)" assignable="false">
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="boolean"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="CNMB_state" variable="true">
//    <dataOutputs target="//@executableElements.2"/>
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="int" namespace="http://www.w3.org/2001/XMLSchema"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" dataInputs="//@executableElements.1/@dataOutputs.0" value="RollBack_SDP_ORDER.transactionDetail.tempStoreNonArray.temp11" field="true">
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="int" namespace="http://www.w3.org/2001/XMLSchema" nillable="false"/>
//  </executableElements>
//  <executableGroups executableElements="//@executableElements.0"/>
//  <executableGroups executableElements="//@executableElements.1 //@executableElements.2"/>
//</com.ibm.wbit.activity:CompositeActivity>
//@generated:end
//!SMAP!*S WBIACTDBG
//!SMAP!*L
//!SMAP!1:1,1
//!SMAP!3:2,2
//!SMAP!1000000:30,1]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                    <bpws:reply name="ReplyUCDCLError1" operation="CreateNewMailBox" partnerLink="FromMam_CreateNewMailBox_Interface" portType="ns2:FromMam_CreateNewMailBox_Interface" wpc:displayName="Reply UCDCL Error" wpc:id="70">
                      <wpc:input>
                        <wpc:parameter name="Transaction_Detail" variable="transactionDetailPort"/>
                        <wpc:parameter name="SDP_ORDER_RequestPort" variable="RollBack_SDP_ORDER"/>
                        <wpc:parameter name="SDP_ORDER_ProvPort" variable="provSdpOrderProc"/>
                      </wpc:input>
                    </bpws:reply>
                    <bpws:terminate name="Terminate1" wpc:displayName="Terminate" wpc:id="518"/>
                  </bpws:sequence>
                </bpws:case>
              </bpws:switch>
              <bpws:invoke name="LogUCDCLCreateSecondaryMailBoxSuccess" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [ UCDCL.CreateSecondaryMailBox -Success]" wpc:id="606">
                <wpc:script>
                  <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage(" UCDCL.CreateSecondaryMailBox -"+SdpLoggerHelper.SUCCESS_STR,PROCESS_NAME,processID,SdpLoggerHelper.INFO);]]></wpc:javaCode>
                </wpc:script>
              </bpws:invoke>
              <bpws:invoke name="UpdateRollBack_MailBox" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Update RollBack_MailBox" wpc:id="444">
                <wpc:script>
                  <wpc:javaCode><![CDATA[String strInvariantID = null;
strInvariantID = Sdp_AccountMailBoxes_Port.getString(SdpHelper.CVOIP_MAILBOX_MAILBOXINVARIANTID);
currentMBox.setString(SdpHelper.CVOIP_MAILBOX_MAILBOXINVARIANTID,strInvariantID);

RollBack_SDP_ORDER.getDataObject("order").getDataObject("ReqService").set("Account", sdpAccount);]]></wpc:javaCode>
                </wpc:script>
              </bpws:invoke>
              <bpws:assign name="Preinvokeassigns8" wpc:displayName="Preinvoke assigns" wpc:id="926">
                <bpws:copy>
                  <bpws:from variable="EmptyTransaction_Detail"/>
                  <bpws:to variable="transactionDetailPort"/>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from>UCDCL.Logout.Request</bpws:from>
                  <bpws:to variable="transactionDetailPort">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/State]]></bpws:query>
                  </bpws:to>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from>UCDCL</bpws:from>
                  <bpws:to variable="transactionDetailPort">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/TargetSystem]]></bpws:query>
                  </bpws:to>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from>Logout</bpws:from>
                  <bpws:to variable="transactionDetailPort">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/currentTargetOperation]]></bpws:query>
                  </bpws:to>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from variable="processBO">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[transactionDetail/UMSessionID]]></bpws:query>
                  </bpws:from>
                  <bpws:to variable="processTransDetail">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[UMSessionID]]></bpws:query>
                  </bpws:to>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from variable="processBO">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[transactionDetail/UMMessageCenterIP]]></bpws:query>
                  </bpws:from>
                  <bpws:to variable="processTransDetail">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[UMMessageCenterIP]]></bpws:query>
                  </bpws:to>
                </bpws:copy>
              </bpws:assign>
              <bpws:invoke name="LogUCDCLLogout1" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UCDCL.Logout]" wpc:id="908">
                <wpc:script>
                  <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage(SdpLoggerHelper.INVOKE_STR +" : UCDCL.Logout",PROCESS_NAME,processID
														,SdpLoggerHelper.INFO);
]]></wpc:javaCode>
                </wpc:script>
              </bpws:invoke>
              <bpws:invoke name="InvokeUCDCLLogout1" operation="provisioningServiceLogout" partnerLink="UCDCL_CompensableService_Interface" portType="ns23:UCDCLCompensableService_Interface" wpc:displayName="Invoke - UCDCL.Logout" wpc:id="909">
                <wpc:input>
                  <wpc:parameter name="transactionDetail" variable="processTransDetail"/>
                </wpc:input>
                <wpc:output/>
                <bpws:catch faultName="wpc:runtimeFailure" faultVariable="bpcFault" wpc:faultType="wpc:BPCStandardFaultType" wpc:id="1161" wpc:variableId="910">
                  <bpws:invoke name="HandleRuntimeFailure4" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Handle Run time Failure" wpc:id="912">
                    <wpc:script>
                      <wpc:javaCode><![CDATA[SdpErrorHelper.setErrDetInTransDet(transactionDetailPort,bpcFault,SdpErrorHelper.SEVERITY_FATAL);

SdpLoggerHelper.logMessage(SdpLoggerHelper.RUNTIME_FAILURE+" UCDCL.Logout",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);

]]></wpc:javaCode>
                    </wpc:script>
                  </bpws:invoke>
                </bpws:catch>
                <bpws:catch faultName="ns23:serviceCallFault" faultVariable="scFault" wpc:faultType="java:ServiceCallFault" wpc:id="1162" wpc:variableId="913">
                  <bpws:invoke name="SetErrorDetails4" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Set Error Details" wpc:id="915">
                    <wpc:script>
                      <wpc:javaCode><![CDATA[transactionDetailPort.setBoolean(SdpHelper.ERRORINDICATOR,true);

new att.lightspeed.sdp.helper.TransactionDetail(transactionDetailPort).setSDPErrorMessage(scFault);

transactionDetailPort.getDataObject("errorDetails").getDataObject("Error").setString("Severity",SdpErrorHelper.SEVERITY_FATAL);

 
SdpLoggerHelper.logMessage(SdpLoggerHelper.FAULT_FAILURE +"   UCDCL.Logout",PROCESS_NAME,processID,SdpLoggerHelper.FATAL); 
 ]]></wpc:javaCode>
                    </wpc:script>
                  </bpws:invoke>
                </bpws:catch>
                <bpws:catchAll wpc:id="1160">
                  <bpws:invoke name="Handleotherfailures2" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="handle other failures" wpc:id="917">
                    <wpc:script>
                      <wpc:javaCode><![CDATA[SdpErrorHelper.setErrDetInTransDet(transactionDetailPort,null,SdpErrorHelper.SEVERITY_FATAL);
SdpLoggerHelper.logMessage(SdpLoggerHelper.UNKNOWN_FAILURE+" UCDCL.Logout",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);]]></wpc:javaCode>
                    </wpc:script>
                  </bpws:invoke>
                </bpws:catchAll>
              </bpws:invoke>
              <bpws:switch name="ErrorinLogout1" wpc:displayName="Error in Logout?" wpc:id="918">
                <bpws:case wpc:id="919">
                  <bpws:condition><![CDATA[return transactionDetailPort.getBoolean(SdpHelper.ERRORINDICATOR);]]></bpws:condition>
                  <bpws:invoke name="LogUCDCLLogoutError" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UCDCL.Logout - Error]" wpc:id="921">
                    <wpc:script>
                      <wpc:javaCode><![CDATA[String strSeverity =transactionDetailPort.getString("errorDetails/Error/Severity");
int logLevel = SdpHelper.getLogLevel(strSeverity);
SdpLoggerHelper.logMessage("Returning : UCDCL.Logout - "+SdpLoggerHelper.ERROR_STR+"["+strSeverity+"]",PROCESS_NAME,processID,logLevel);]]></wpc:javaCode>
                    </wpc:script>
                  </bpws:invoke>
                </bpws:case>
                <bpws:otherwise wpc:id="1177">
                  <bpws:invoke name="LogUCDCLLogoutSuccess" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UCDCL.Logout - Success]" wpc:id="923">
                    <wpc:script>
                      <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage("Returning : UCDCL.Logout -"+SdpLoggerHelper.SUCCESS_STR,PROCESS_NAME,processID
														,SdpLoggerHelper.INFO);																		]]></wpc:javaCode>
                    </wpc:script>
                  </bpws:invoke>
                </bpws:otherwise>
              </bpws:switch>
              <bpws:invoke name="CreateLoginId1" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Create LoginId" wpc:id="716">
                <wpc:script>
                  <wpc:javaCode><![CDATA[if (ucdclTelePhoneNumber != null)
{
	tmpTN = ucdclTelePhoneNumber.getString("tn");
	try {
		loginId = tmpTN + "@" + CvoipConfig.instance().getEmailAddressDomain();
	}catch (PropertyReadException prEX)
	{
		SdpLoggerHelper.logMessage("Exception occured while Constructing LoginId : " + prEX.getMessage(), 
			PROCESS_NAME, processID, SdpLoggerHelper.ERROR);
	}
	SdpLoggerHelper.logMessage("Constructed LoginId : " + loginId, PROCESS_NAME, processID, SdpLoggerHelper.INFO); 
}
else
{
	SdpLoggerHelper.logMessage("Failed While Creating LoginId ", PROCESS_NAME, processID, SdpLoggerHelper.INFO);
}

/*String tn = null;
DataObject mailboxTN= null;
try
{ 
	if(firstmailboxTN != null )
	{
		mailboxTN = SdpHelper.copySpecificBO(firstmailboxTN);
		tn = mailboxTN.getString("tn");
		loginId = tn+"@uvm.dayatt.com";
		SdpLoggerHelper.logMessage("Constructed LoginId : " + loginId, PROCESS_NAME, processID, SdpLoggerHelper.INFO);
	}
		
}
catch(Exception ex)
{
	SdpLoggerHelper.logMessage("Exception Occured While Creating LoginId " + ex, PROCESS_NAME, processID, SdpLoggerHelper.INFO);
}*/


/*String tn = mainMailBoxTN;

try
{ 
	if(tn != null )
	{
		loginId = tn+"@uvm.dayatt.com";
		// using ucdclEmailOrPhone instead of loginId - defect 57855
		SdpLoggerHelper.logMessage("ProvisionEmailAddress : " + ucdclEmailOrPhone, PROCESS_NAME, processID, SdpLoggerHelper.INFO);
	}
		
}
catch(Exception ex)
{
	SdpLoggerHelper.logMessage("Exception Occured: " + ex, PROCESS_NAME, processID, SdpLoggerHelper.INFO);
}*/]]></wpc:javaCode>
                </wpc:script>
              </bpws:invoke>
              <bpws:assign name="PreInvokeAssigns2" wpc:displayName="Pre-Invoke Assigns" wpc:id="823">
                <bpws:copy>
                  <bpws:from variable="EmptyTransaction_Detail"/>
                  <bpws:to variable="transactionDetailPort"/>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from>UCDCL.DelegatedLogin.Request</bpws:from>
                  <bpws:to variable="transactionDetailPort">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/State]]></bpws:query>
                  </bpws:to>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from>UCDCL</bpws:from>
                  <bpws:to variable="transactionDetailPort">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/TargetSystem]]></bpws:query>
                  </bpws:to>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from>DelegatedLogin</bpws:from>
                  <bpws:to variable="transactionDetailPort">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/currentTargetOperation]]></bpws:query>
                  </bpws:to>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from>DelegatedLogin</bpws:from>
                  <bpws:to variable="transactionDetailPort">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/CurrentTargetOperation]]></bpws:query>
                  </bpws:to>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from>3</bpws:from>
                  <bpws:to variable="CNMB_state"/>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from variable="emptyOrder"/>
                  <bpws:to variable="processBO"/>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from variable="tmpTN"/>
                  <bpws:to variable="processBO">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[order/ReqService/product/cvoipProduct/cvoipLineSubComponent[1]/tnInfo/tn]]></bpws:query>
                  </bpws:to>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from variable="processTransDetail">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[UMSessionID]]></bpws:query>
                  </bpws:from>
                  <bpws:to variable="processBO">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[transactionDetail/UMSessionID]]></bpws:query>
                  </bpws:to>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from variable="processTransDetail">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[UMMessageCenterIP]]></bpws:query>
                  </bpws:from>
                  <bpws:to variable="processBO">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[transactionDetail/UMMessageCenterIP]]></bpws:query>
                  </bpws:to>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from variable="processTransDetail">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[UMMessageCenterIP]]></bpws:query>
                  </bpws:from>
                  <bpws:to variable="UMMessageCenterIP"/>
                </bpws:copy>
              </bpws:assign>
              <bpws:invoke name="LogUCDCLdelegatedLogin" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [ UCDCL.delegatedLogin]" wpc:id="1053">
                <wpc:script>
                  <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage("UCDCL.delegatedLogin -"+SdpLoggerHelper.INVOKE_STR,PROCESS_NAME,processID,SdpLoggerHelper.INFO);
SdpLoggerHelper.logMessage("UMSessionID : "+UMSessionID,PROCESS_NAME,processID,SdpLoggerHelper.INFO);
SdpLoggerHelper.logMessage("UMMessageCenterIP : "+UMMessageCenterIP,PROCESS_NAME,processID,SdpLoggerHelper.INFO);]]></wpc:javaCode>
                </wpc:script>
              </bpws:invoke>
              <bpws:invoke name="InvokeUCDCLdelegatedLogin" operation="delegatedLogin" partnerLink="UCDCL_CompensableService_Interface" portType="ns23:UCDCLCompensableService_Interface" wpc:displayName="Invoke - [UCDCL.delegatedLogin]" wpc:id="832">
                <wpc:input>
                  <wpc:parameter name="order" variable="processBO"/>
                </wpc:input>
                <wpc:output>
                  <wpc:parameter name="transactionDetail" variable="processTransDetail"/>
                </wpc:output>
                <bpws:catch faultName="wpc:runtimeFailure" faultVariable="bpcFault" wpc:faultType="wpc:BPCStandardFaultType" wpc:id="1164" wpc:variableId="833">
                  <bpws:invoke name="HandleRuntimeFailure6" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Handle Run time Failure" wpc:id="835">
                    <wpc:script>
                      <wpc:javaCode><![CDATA[SdpErrorHelper.setErrDetInTransDet(transactionDetailPort,bpcFault,SdpErrorHelper.SEVERITY_FATAL);

SdpLoggerHelper.logMessage(SdpLoggerHelper.RUNTIME_FAILURE+"   UCDCL.DelegatedLogin",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);

]]></wpc:javaCode>
                    </wpc:script>
                  </bpws:invoke>
                </bpws:catch>
                <bpws:catch faultName="ns23:serviceCallFault" faultVariable="scFault" wpc:faultType="java:ServiceCallFault" wpc:id="1165" wpc:variableId="836">
                  <bpws:invoke name="SetErrorDetails10" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Set Error Details" wpc:id="838">
                    <wpc:script>
                      <wpc:javaCode><![CDATA[transactionDetailPort.setBoolean(SdpHelper.ERRORINDICATOR,true);

new att.lightspeed.sdp.helper.TransactionDetail(transactionDetailPort).setSDPErrorMessage(scFault);

transactionDetailPort.getDataObject("errorDetails").getDataObject("Error").setString("Severity",SdpErrorHelper.SEVERITY_FATAL);

 
SdpLoggerHelper.logMessage(SdpLoggerHelper.FAULT_FAILURE +"   UCDCL.DelegatedLogin",PROCESS_NAME,processID,SdpLoggerHelper.FATAL); 
 ]]></wpc:javaCode>
                    </wpc:script>
                  </bpws:invoke>
                </bpws:catch>
                <bpws:catchAll wpc:id="1163">
                  <bpws:invoke name="Handleotherfailures6" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="handle other failures" wpc:id="843">
                    <wpc:script>
                      <wpc:javaCode><![CDATA[SdpErrorHelper.setErrDetInTransDet(transactionDetailPort,null,SdpErrorHelper.SEVERITY_FATAL);
SdpLoggerHelper.logMessage(SdpLoggerHelper.UNKNOWN_FAILURE+"  UCDCL.DelegatedLogin",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);]]></wpc:javaCode>
                    </wpc:script>
                  </bpws:invoke>
                </bpws:catchAll>
              </bpws:invoke>
              <bpws:switch name="ErrorinUCDCLDelegatedLogin" wpc:displayName="Error in UCDCL.DelegatedLogin?" wpc:id="851">
                <bpws:case wpc:id="852">
                  <bpws:condition><![CDATA[boolean __result__1 = com.ibm.wbiservers.brules.core.codegen.NillableUtility.getBoolean(transactionDetailPort, "errorIndicator", "transactionDetailPort");
return __result__1;

//@generated:com.ibm.wbit.activity.ui
//<?xml version="1.0" encoding="UTF-8"?>
//<com.ibm.wbit.activity:CompositeActivity xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:com.ibm.wbit.activity="http:///com/ibm/wbit/activity.ecore" name="ActivityMethod">
//  <result name="Result">
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="boolean"/>
//  </result>
//  <exceptions>
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="com.ibm.bpe.api.ProcessException"/>
//  </exceptions>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="transactionDetailPort.errorIndicator" field="true">
//    <dataOutputs target="//@executableElements.1"/>
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="boolean" namespace="http://www.w3.org/2001/XMLSchema" nillable="false"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:ReturnElement" dataInputs="//@executableElements.0/@dataOutputs.0"/>
//  <executableGroups executableElements="//@executableElements.0 //@executableElements.1"/>
//</com.ibm.wbit.activity:CompositeActivity>
//@generated:end
//!SMAP!*S WBIACTDBG
//!SMAP!*L
//!SMAP!1:1,1
//!SMAP!2:2,1
//!SMAP!1000000:26,1]]></bpws:condition>
                  <bpws:sequence name="HiddenSequence4" wpc:id="1073742942">
                    <bpws:invoke name="LogUCDCLDelegatedLoginError" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UCDCL.DelegatedLogin - Error]" wpc:id="855">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[String strSeverity =transactionDetailPort.getString("errorDetails/Error/Severity");
int logLevel = SdpHelper.getLogLevel(strSeverity);
SdpLoggerHelper.logMessage("UCDCL.DelegatedLogin - "+SdpLoggerHelper.ERROR_STR+"["+strSeverity+"]",PROCESS_NAME,processID,logLevel);
														



																		]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                    <bpws:invoke name="PrepareRollBack_SDP_ORDER4" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Prepare RollBack_SDP_ORDER" wpc:id="857">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[boolean __result__1 = com.ibm.wbiservers.brules.core.codegen.NillableUtility.getList(com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(RollBack_SDP_ORDER, "order", "RollBack_SDP_ORDER"), "ReqService", "order"), "product", "ReqService"), "cvoipProduct", "product"), "accountMailBoxes", "RollBack_SDP_ORDER.order.ReqService.product.cvoipProduct").add(com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(RollBackMailBox, "RollBackMailBox"));
int __local__3 = CNMB_state.intValue();
com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(RollBack_SDP_ORDER, "transactionDetail", "RollBack_SDP_ORDER"), "tempStoreNonArray", "transactionDetail").setInt("temp11", __local__3);
int __local__5 = intTNListCounter.intValue();
com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(RollBack_SDP_ORDER, "transactionDetail", "RollBack_SDP_ORDER"), "tempStoreNonArray", "transactionDetail").setInt("temp10", __local__5);

//@generated:com.ibm.wbit.activity.ui
//<?xml version="1.0" encoding="UTF-8"?>
//<com.ibm.wbit.activity:CompositeActivity xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:com.ibm.wbit.activity="http:///com/ibm/wbit/activity.ecore" name="ActivityMethod">
//  <exceptions>
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="com.ibm.bpe.api.ProcessException"/>
//  </exceptions>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="RollBack_SDP_ORDER.order.ReqService.product.cvoipProduct.accountMailBoxes.add(RollBackMailBox)" assignable="false">
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="boolean"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="CNMB_state" variable="true">
//    <dataOutputs target="//@executableElements.2"/>
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="int" namespace="http://www.w3.org/2001/XMLSchema"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" dataInputs="//@executableElements.1/@dataOutputs.0" value="RollBack_SDP_ORDER.transactionDetail.tempStoreNonArray.temp11" field="true">
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="int" namespace="http://www.w3.org/2001/XMLSchema" nillable="false"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="intTNListCounter" variable="true">
//    <dataOutputs target="//@executableElements.4"/>
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="int" namespace="http://www.w3.org/2001/XMLSchema"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" dataInputs="//@executableElements.3/@dataOutputs.0" value="RollBack_SDP_ORDER.transactionDetail.tempStoreNonArray.temp10" field="true">
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="int" namespace="http://www.w3.org/2001/XMLSchema" nillable="false"/>
//  </executableElements>
//  <executableGroups executableElements="//@executableElements.0"/>
//  <executableGroups executableElements="//@executableElements.1 //@executableElements.2"/>
//  <executableGroups executableElements="//@executableElements.3 //@executableElements.4"/>
//</com.ibm.wbit.activity:CompositeActivity>
//@generated:end
//!SMAP!*S WBIACTDBG
//!SMAP!*L
//!SMAP!1:1,1
//!SMAP!3:2,2
//!SMAP!5:4,2
//!SMAP!1000000:41,1]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                    <bpws:reply name="ReplyUCDCLError7" operation="CreateNewMailBox" partnerLink="FromMam_CreateNewMailBox_Interface" portType="ns2:FromMam_CreateNewMailBox_Interface" wpc:displayName="Reply UCDCL Error" wpc:id="858">
                      <wpc:input>
                        <wpc:parameter name="Transaction_Detail" variable="transactionDetailPort"/>
                        <wpc:parameter name="SDP_ORDER_RequestPort" variable="RollBack_SDP_ORDER"/>
                        <wpc:parameter name="SDP_ORDER_ProvPort" variable="provSdpOrderProc"/>
                      </wpc:input>
                    </bpws:reply>
                    <bpws:terminate name="Terminate2" wpc:displayName="Terminate" wpc:id="859"/>
                  </bpws:sequence>
                </bpws:case>
                <bpws:otherwise wpc:id="1178">
                  <bpws:sequence name="HiddenSequence22" wpc:id="1073742946">
                    <bpws:invoke name="LogUCDCLDelegatedLoginSuccess" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [ UCDCL.DelegatedLogin - Success]" wpc:id="887">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage("UCDCL.DelegatedLogin -"+SdpLoggerHelper.SUCCESS_STR,PROCESS_NAME,processID
														,SdpLoggerHelper.INFO);																		]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                    <bpws:invoke name="SetUMSessionIDUMMessageCenterIP2" operation="null" partnerLink="null" portType="wpc:null" wpc:continueOnError="inherit" wpc:displayName="Set UMSessionID, UMMessageCenterIP" wpc:id="1142">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[att.lightspeed.sdp.helper.WpsLogger logger = WpsLogger.getLogger(processInstance());
String UMSessionID = null;
//String UMMessageCenterIP = null;
umJSessionId = null;

UMSessionID = processTransDetail.getString(SdpHelper.TRANSDETAIL_UMSESSIONID);
umJSessionId = processTransDetail.getString(SdpHelper.TRANSDETAIL_UMSESSIONID);
UMMessageCenterIP = processTransDetail.getString(SdpHelper.TRANSDETAIL_UMMESSAGECENTERIP);

logger.debug("UMSessionID from the DelegatedLogin Response: " + UMSessionID);
logger.debug("UMMessageCenterIP from the DelegatedLogin Response: " + UMMessageCenterIP);

new Order(processBO).getTransactionDetail();

processBO.setString(SdpHelper.xPathify(SdpHelper.TRANSDETAIL_UMSESSIONID_PATH),UMSessionID);
processBO.setString(SdpHelper.xPathify(SdpHelper.TRANSDETAIL_UMMESSAGECENTERIP_PATH),UMMessageCenterIP);
]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                    <bpws:assign name="PreInvokeAssigns7" wpc:displayName="Pre-Invoke Assigns" wpc:id="861">
                      <bpws:copy>
                        <bpws:from variable="EmptyTransaction_Detail"/>
                        <bpws:to variable="transactionDetailPort"/>
                      </bpws:copy>
                      <bpws:copy>
                        <bpws:from>UCDCL.CreateInvariantId.Request</bpws:from>
                        <bpws:to variable="transactionDetailPort">
                          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/State]]></bpws:query>
                        </bpws:to>
                      </bpws:copy>
                      <bpws:copy>
                        <bpws:from>UCDCL</bpws:from>
                        <bpws:to variable="transactionDetailPort">
                          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/TargetSystem]]></bpws:query>
                        </bpws:to>
                      </bpws:copy>
                      <bpws:copy>
                        <bpws:from>CreateInvariantId</bpws:from>
                        <bpws:to variable="transactionDetailPort">
                          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/currentTargetOperation]]></bpws:query>
                        </bpws:to>
                      </bpws:copy>
                      <bpws:copy>
                        <bpws:from>CreateInvariantId</bpws:from>
                        <bpws:to variable="transactionDetailPort">
                          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/CurrentTargetOperation]]></bpws:query>
                        </bpws:to>
                      </bpws:copy>
                      <bpws:copy>
                        <bpws:from>4</bpws:from>
                        <bpws:to variable="CNMB_state"/>
                      </bpws:copy>
                      <bpws:copy>
                        <bpws:from variable="loginId"/>
                        <bpws:to variable="processBO">
                          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[order/ReqService/product/cvoipProduct/cvoipLineSubComponent[1]/tnInfo/tn]]></bpws:query>
                        </bpws:to>
                      </bpws:copy>
                    </bpws:assign>
                    <bpws:invoke name="LogUCDCLCreateInvariantId" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UCDCL.CreateInvariantId]" wpc:id="864">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage(SdpLoggerHelper.INVOKE_STR +" : UCDCL.CreateInvariantId",
	PROCESS_NAME,processID,SdpLoggerHelper.INFO);
SdpLoggerHelper.logMessage("loginID: " + tmpTN,PROCESS_NAME,processID,SdpLoggerHelper.INFO);]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                    <bpws:invoke name="InvokeUCDCLcreateInvariantID" operation="createInvariantID" partnerLink="UCDCL_CompensableService_Interface" portType="ns23:UCDCLCompensableService_Interface" wpc:displayName="Invoke - [UCDCL.createInvariantID]" wpc:id="873">
                      <wpc:input>
                        <wpc:parameter name="order" variable="processBO"/>
                      </wpc:input>
                      <wpc:output>
                        <wpc:parameter name="returnOrder" variable="processBO"/>
                      </wpc:output>
                      <bpws:catch faultName="wpc:runtimeFailure" faultVariable="bpcFault" wpc:faultType="wpc:BPCStandardFaultType" wpc:id="1180" wpc:variableId="874">
                        <bpws:invoke name="HandleRuntimeFailure6" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Handle Run time Failure" wpc:id="876">
                          <wpc:script>
                            <wpc:javaCode><![CDATA[SdpErrorHelper.setErrDetInTransDet(transactionDetailPort,bpcFault,SdpErrorHelper.SEVERITY_FATAL);

SdpLoggerHelper.logMessage(SdpLoggerHelper.RUNTIME_FAILURE+"   UCDCL.CreateInvariantId",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);

]]></wpc:javaCode>
                          </wpc:script>
                        </bpws:invoke>
                      </bpws:catch>
                      <bpws:catch faultName="ns23:serviceCallFault" faultVariable="scFault" wpc:faultType="java:ServiceCallFault" wpc:id="1181" wpc:variableId="877">
                        <bpws:invoke name="SetErrorDetails10" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Set Error Details" wpc:id="879">
                          <wpc:script>
                            <wpc:javaCode><![CDATA[transactionDetailPort.setBoolean(SdpHelper.ERRORINDICATOR,true);

new att.lightspeed.sdp.helper.TransactionDetail(transactionDetailPort).setSDPErrorMessage(scFault);

transactionDetailPort.getDataObject("errorDetails").getDataObject("Error").setString("Severity",SdpErrorHelper.SEVERITY_FATAL);

 
SdpLoggerHelper.logMessage(SdpLoggerHelper.FAULT_FAILURE +"   UCDCL.CreateInvariantId",PROCESS_NAME,processID,SdpLoggerHelper.FATAL); 
 ]]></wpc:javaCode>
                          </wpc:script>
                        </bpws:invoke>
                      </bpws:catch>
                      <bpws:catchAll wpc:id="1179">
                        <bpws:invoke name="Handleotherfailures6" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="handle other failures" wpc:id="884">
                          <wpc:script>
                            <wpc:javaCode><![CDATA[SdpErrorHelper.setErrDetInTransDet(transactionDetailPort,null,SdpErrorHelper.SEVERITY_FATAL);
SdpLoggerHelper.logMessage(SdpLoggerHelper.UNKNOWN_FAILURE+"  UCDCL.CreateInvariantId",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);]]></wpc:javaCode>
                          </wpc:script>
                        </bpws:invoke>
                      </bpws:catchAll>
                    </bpws:invoke>
                    <bpws:switch name="ErrorinUCDCLcreateInvariantId" wpc:displayName="Error in UCDCL.createInvariantId?" wpc:id="820">
                      <bpws:case wpc:id="821">
                        <bpws:condition><![CDATA[boolean __result__1 = com.ibm.wbiservers.brules.core.codegen.NillableUtility.getBoolean(transactionDetailPort, "errorIndicator", "transactionDetailPort");
return __result__1;

//@generated:com.ibm.wbit.activity.ui
//<?xml version="1.0" encoding="UTF-8"?>
//<com.ibm.wbit.activity:CompositeActivity xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:com.ibm.wbit.activity="http:///com/ibm/wbit/activity.ecore" name="ActivityMethod">
//  <result name="Result">
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="boolean"/>
//  </result>
//  <exceptions>
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="com.ibm.bpe.api.ProcessException"/>
//  </exceptions>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="transactionDetailPort.errorIndicator" field="true">
//    <dataOutputs target="//@executableElements.1"/>
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="boolean" namespace="http://www.w3.org/2001/XMLSchema" nillable="false"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:ReturnElement" dataInputs="//@executableElements.0/@dataOutputs.0"/>
//  <executableGroups executableElements="//@executableElements.0 //@executableElements.1"/>
//</com.ibm.wbit.activity:CompositeActivity>
//@generated:end
//!SMAP!*S WBIACTDBG
//!SMAP!*L
//!SMAP!1:1,1
//!SMAP!2:2,1
//!SMAP!1000000:26,1]]></bpws:condition>
                        <bpws:sequence name="HiddenSequence14" wpc:id="1073742943">
                          <bpws:invoke name="LogUCDCLcreateInvariantIDError" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UCDCL.createInvariantID - Error]" wpc:id="892">
                            <wpc:script>
                              <wpc:javaCode><![CDATA[String strSeverity =transactionDetailPort.getString("errorDetails/Error/Severity");
int logLevel = SdpHelper.getLogLevel(strSeverity);
SdpLoggerHelper.logMessage("UCDCL.createInvariantID - "+SdpLoggerHelper.ERROR_STR+"["+strSeverity+"]",PROCESS_NAME,processID,logLevel);
														



																		]]></wpc:javaCode>
                            </wpc:script>
                          </bpws:invoke>
                          <bpws:invoke name="PrepareRollBack_SDP_ORDER6" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Prepare RollBack_SDP_ORDER" wpc:id="895">
                            <wpc:script>
                              <wpc:javaCode><![CDATA[boolean __result__1 = com.ibm.wbiservers.brules.core.codegen.NillableUtility.getList(com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(RollBack_SDP_ORDER, "order", "RollBack_SDP_ORDER"), "ReqService", "order"), "product", "ReqService"), "cvoipProduct", "product"), "accountMailBoxes", "RollBack_SDP_ORDER.order.ReqService.product.cvoipProduct").add(com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(RollBackMailBox, "RollBackMailBox"));
int __local__3 = CNMB_state.intValue();
com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(RollBack_SDP_ORDER, "transactionDetail", "RollBack_SDP_ORDER"), "tempStoreNonArray", "transactionDetail").setInt("temp11", __local__3);
int __local__5 = intTNListCounter.intValue();
com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(RollBack_SDP_ORDER, "transactionDetail", "RollBack_SDP_ORDER"), "tempStoreNonArray", "transactionDetail").setInt("temp10", __local__5);

//@generated:com.ibm.wbit.activity.ui
//<?xml version="1.0" encoding="UTF-8"?>
//<com.ibm.wbit.activity:CompositeActivity xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:com.ibm.wbit.activity="http:///com/ibm/wbit/activity.ecore" name="ActivityMethod">
//  <exceptions>
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="com.ibm.bpe.api.ProcessException"/>
//  </exceptions>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="RollBack_SDP_ORDER.order.ReqService.product.cvoipProduct.accountMailBoxes.add(RollBackMailBox)" assignable="false">
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="boolean"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="CNMB_state" variable="true">
//    <dataOutputs target="//@executableElements.2"/>
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="int" namespace="http://www.w3.org/2001/XMLSchema"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" dataInputs="//@executableElements.1/@dataOutputs.0" value="RollBack_SDP_ORDER.transactionDetail.tempStoreNonArray.temp11" field="true">
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="int" namespace="http://www.w3.org/2001/XMLSchema" nillable="false"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="intTNListCounter" variable="true">
//    <dataOutputs target="//@executableElements.4"/>
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="int" namespace="http://www.w3.org/2001/XMLSchema"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" dataInputs="//@executableElements.3/@dataOutputs.0" value="RollBack_SDP_ORDER.transactionDetail.tempStoreNonArray.temp10" field="true">
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="int" namespace="http://www.w3.org/2001/XMLSchema" nillable="false"/>
//  </executableElements>
//  <executableGroups executableElements="//@executableElements.0"/>
//  <executableGroups executableElements="//@executableElements.1 //@executableElements.2"/>
//  <executableGroups executableElements="//@executableElements.3 //@executableElements.4"/>
//</com.ibm.wbit.activity:CompositeActivity>
//@generated:end
//!SMAP!*S WBIACTDBG
//!SMAP!*L
//!SMAP!1:1,1
//!SMAP!3:2,2
//!SMAP!5:4,2
//!SMAP!1000000:41,1]]></wpc:javaCode>
                            </wpc:script>
                          </bpws:invoke>
                          <bpws:reply name="ReplyUCDCLError2" operation="CreateNewMailBox" partnerLink="FromMam_CreateNewMailBox_Interface" portType="ns2:FromMam_CreateNewMailBox_Interface" wpc:displayName="Reply UCDCL Error" wpc:id="897">
                            <wpc:input>
                              <wpc:parameter name="Transaction_Detail" variable="transactionDetailPort"/>
                              <wpc:parameter name="SDP_ORDER_RequestPort" variable="RollBack_SDP_ORDER"/>
                              <wpc:parameter name="SDP_ORDER_ProvPort" variable="provSdpOrderProc"/>
                            </wpc:input>
                          </bpws:reply>
                          <bpws:terminate name="Terminate6" wpc:displayName="Terminate" wpc:id="899"/>
                        </bpws:sequence>
                      </bpws:case>
                      <bpws:otherwise wpc:id="1185">
                        <bpws:sequence name="HiddenSequence8" wpc:id="1073742944">
                          <bpws:invoke name="LogUCDCLcreateInvariantIDSuccess" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [ UCDCL.createInvariantID - Success]" wpc:id="902">
                            <wpc:script>
                              <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage("UCDCL.createInvariantID -"+SdpLoggerHelper.SUCCESS_STR,PROCESS_NAME,processID
														,SdpLoggerHelper.INFO);																		]]></wpc:javaCode>
                            </wpc:script>
                          </bpws:invoke>
                          <bpws:assign name="SetinvariantId" wpc:displayName="Set invariantId" wpc:id="1143">
                            <bpws:copy>
                              <bpws:from variable="processBO">
                                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[order/ReqService/product/cvoipProduct/accountMailBoxes[1]/mailBoxInvariantId]]></bpws:query>
                              </bpws:from>
                              <bpws:to variable="invariantId"/>
                            </bpws:copy>
                          </bpws:assign>
                          <bpws:invoke name="GenerateMailboxComponentId1" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Generate Mailbox ComponentId" wpc:id="1099">
                            <wpc:script>
                              <wpc:javaCode><![CDATA[mailboxComponentId = MpsHelper.getMailboxComponentId(new Order(sdpOrderProc), intListCounter.intValue());

]]></wpc:javaCode>
                            </wpc:script>
                          </bpws:invoke>
                          <bpws:assign name="MergecomponentIDandinvariantIdinSubandRollbackMailBox" wpc:displayName="Merge componentID and invariantId in Sub and Rollback  MailBox" wpc:id="306">
                            <bpws:copy>
                              <bpws:from variable="invariantId"/>
                              <bpws:to variable="currentMBox">
                                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/mailBoxInvariantId]]></bpws:query>
                              </bpws:to>
                            </bpws:copy>
                            <bpws:copy>
                              <bpws:from variable="invariantId"/>
                              <bpws:to variable="RollBackMailBox">
                                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/mailBoxInvariantId]]></bpws:query>
                              </bpws:to>
                            </bpws:copy>
                            <bpws:copy>
                              <bpws:from variable="mailboxComponentId"/>
                              <bpws:to variable="currentMBox">
                                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/mailboxComponentId]]></bpws:query>
                              </bpws:to>
                            </bpws:copy>
                            <bpws:copy>
                              <bpws:from variable="mailboxComponentId"/>
                              <bpws:to variable="RollBackMailBox">
                                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/mailboxComponentId]]></bpws:query>
                              </bpws:to>
                            </bpws:copy>
                          </bpws:assign>
                          <bpws:invoke name="AddcomponentIdandinvariantIdtosecondaryMemberProfile" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Add componentId and invariantId to secondary MemberProfile" wpc:id="764">
                            <wpc:script>
                              <wpc:javaCode><![CDATA[DataObject memberProfile = null;
DataObject mailboxMember = null;

List lstMemberProfile = null;
Iterator iterMemProfile = null;

List lstMailboxMembers = null;
Iterator iterMailboxMember = null;
StringBuffer logMsg=new StringBuffer();
StringBuffer loggerMsg=new StringBuffer();
StringBuffer loggerMessage=new StringBuffer();
StringBuffer logMessage=new StringBuffer();
StringBuffer msgLog=new StringBuffer();

String strMemberId = null;
String tmpMemberId = null;
String keySelector = MamMemberServiceHelper.MAILBOXINVARIANTID_KEY_SELECTOR;
String operationSelector = MamMemberServiceHelper.ADD_OPERATION_SELECTOR;
String objectSelector = MamMemberServiceHelper.MEMBERPROFILE_OBJECT_SELECTOR;
logMsg.append(" Adding the MailboxInvariantId [ ");
logMsg.append(invariantId);
logMsg.append("] to the MemberProfile");
SdpLoggerHelper.logMessage(logMsg.toString(),PROCESS_NAME,processID,SdpLoggerHelper.INFO);
logMsg.delete(0, logMsg.length());

loggerMsg.append(" Setting Secondary MemberProfile [");
loggerMsg.append(strMemberId);
loggerMsg.append(" mainMailboxInd to NO ");

SdpLoggerHelper.logMessage(loggerMsg.toString(),PROCESS_NAME,processID,SdpLoggerHelper.INFO);
loggerMsg.delete(0, loggerMsg.length());

lstMemberProfile = provSdpOrderProc.getList(SdpHelper.MEMBERPROFILE_LIST_PATH.replace('.', '/'));

lstMailboxMembers = currentMBox.getList(SdpHelper.VOIP_MAILBOX_MEMBERS);
iterMailboxMember = lstMailboxMembers.iterator();

while(iterMailboxMember.hasNext())
{

mailboxMember = SdpHelper.copySpecificBO((DataObject) iterMailboxMember.next());
strMemberId = mailboxMember.getString(SdpHelper.CVOIP_MAILBOX_MEMBERID);
loggerMessage.append("Secondary MemberProfile MemberId:");
loggerMessage.append(strMemberId);

SdpLoggerHelper.logMessage(loggerMessage.toString(), PROCESS_NAME, processID, SdpLoggerHelper.INFO);
loggerMessage.delete(0, loggerMessage.length());
MamMemberServiceHelper.modifyMemberProfileOrMailbox(provSdpOrderProc,strMemberId,
	keySelector, operationSelector,invariantId, objectSelector);

	if(lstMemberProfile.size() > 0  && strMemberId != null)
	{	
		iterMemProfile = lstMemberProfile.iterator();
	
		SdpLoggerHelper.logMessage("Getting MemberProfile",PROCESS_NAME,processID,SdpLoggerHelper.INFO);
		//Loop through for each member profile
	
		while (iterMemProfile.hasNext()) {
	
			memberProfile = (DataObject) iterMemProfile.next();
			
			if (memberProfile != null)
			{
				tmpMemberId = memberProfile.getString(SdpHelper.MEMBERPROFILE_MEMBERID);
				logMessage.append(" Comparing MemberProfile [ ");
				logMessage.append(strMemberId);
				logMessage.append(" ] with MemberProfile[ ");
				logMessage.append(tmpMemberId);
				logMessage.append(" ]");
				SdpLoggerHelper.logMessage(logMessage.toString(),PROCESS_NAME,processID,SdpLoggerHelper.INFO);
		       	logMessage.delete(0, logMessage.length());
				if (tmpMemberId != null && tmpMemberId.equalsIgnoreCase(strMemberId)) {	
					memberProfile.setString(SdpHelper.MEMBERPROFILE_MAINMAILBOXIND,SdpHelper.NO);
					
					memberProfile.setString(SdpHelper.MEMBERPROFILE_MAILBOXCOMPONENTID, mailboxComponentId);
					msgLog.append(" Setting the mainMailboxInd to NO for MemberProfile[ ");
					msgLog.append(strMemberId);
					msgLog.append(" ]");
					SdpLoggerHelper.logMessage(msgLog.toString(),PROCESS_NAME,processID,SdpLoggerHelper.INFO);
					msgLog.delete(0, msgLog.length());
					
					break;
				}
			}
		}
	}
}]]></wpc:javaCode>
                            </wpc:script>
                          </bpws:invoke>
                        </bpws:sequence>
                      </bpws:otherwise>
                    </bpws:switch>
                    <bpws:assign name="Preinvokeassigns11" wpc:displayName="Preinvoke assigns" wpc:id="990">
                      <bpws:copy>
                        <bpws:from variable="EmptyTransaction_Detail"/>
                        <bpws:to variable="transactionDetailPort"/>
                      </bpws:copy>
                      <bpws:copy>
                        <bpws:from>UCDCL.Logout.Request</bpws:from>
                        <bpws:to variable="transactionDetailPort">
                          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/State]]></bpws:query>
                        </bpws:to>
                      </bpws:copy>
                      <bpws:copy>
                        <bpws:from>UCDCL</bpws:from>
                        <bpws:to variable="transactionDetailPort">
                          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/TargetSystem]]></bpws:query>
                        </bpws:to>
                      </bpws:copy>
                      <bpws:copy>
                        <bpws:from>Logout</bpws:from>
                        <bpws:to variable="transactionDetailPort">
                          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/currentTargetOperation]]></bpws:query>
                        </bpws:to>
                      </bpws:copy>
                    </bpws:assign>
                    <bpws:invoke name="LogUCDCLLogout2" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UCDCL.Logout]" wpc:id="992">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage(SdpLoggerHelper.INVOKE_STR +" : UCDCL.Logout",PROCESS_NAME,processID
														,SdpLoggerHelper.INFO);]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                    <bpws:invoke name="InvokeUCDCLLogout2" operation="subscriberServiceLogout" partnerLink="UCDCL_CompensableService_Interface" portType="ns23:UCDCLCompensableService_Interface" wpc:displayName="Invoke - UCDCL.Logout" wpc:id="993">
                      <wpc:input>
                        <wpc:parameter name="transactionDetail" variable="processTransDetail"/>
                      </wpc:input>
                      <wpc:output/>
                      <bpws:catch faultName="wpc:runtimeFailure" faultVariable="bpcFault" wpc:faultType="wpc:BPCStandardFaultType" wpc:id="1183" wpc:variableId="994">
                        <bpws:invoke name="HandleRuntimeFailure4" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Handle Run time Failure" wpc:id="996">
                          <wpc:script>
                            <wpc:javaCode><![CDATA[SdpErrorHelper.setErrDetInTransDet(transactionDetailPort,bpcFault,SdpErrorHelper.SEVERITY_FATAL);

SdpLoggerHelper.logMessage(SdpLoggerHelper.RUNTIME_FAILURE+" UCDCL.Logout",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);

]]></wpc:javaCode>
                          </wpc:script>
                        </bpws:invoke>
                      </bpws:catch>
                      <bpws:catch faultName="ns23:serviceCallFault" faultVariable="scFault" wpc:faultType="java:ServiceCallFault" wpc:id="1184" wpc:variableId="997">
                        <bpws:invoke name="SetErrorDetails4" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Set Error Details" wpc:id="999">
                          <wpc:script>
                            <wpc:javaCode><![CDATA[transactionDetailPort.setBoolean(SdpHelper.ERRORINDICATOR,true);

new att.lightspeed.sdp.helper.TransactionDetail(transactionDetailPort).setSDPErrorMessage(scFault);

transactionDetailPort.getDataObject("errorDetails").getDataObject("Error").setString("Severity",SdpErrorHelper.SEVERITY_FATAL);

 
SdpLoggerHelper.logMessage(SdpLoggerHelper.FAULT_FAILURE +"   UCDCL.Logout",PROCESS_NAME,processID,SdpLoggerHelper.FATAL); 
 
]]></wpc:javaCode>
                          </wpc:script>
                        </bpws:invoke>
                      </bpws:catch>
                      <bpws:catchAll wpc:id="1182">
                        <bpws:invoke name="Handleotherfailures2" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="handle other failures" wpc:id="1001">
                          <wpc:script>
                            <wpc:javaCode><![CDATA[SdpErrorHelper.setErrDetInTransDet(transactionDetailPort,null,SdpErrorHelper.SEVERITY_FATAL);
SdpLoggerHelper.logMessage(SdpLoggerHelper.UNKNOWN_FAILURE+" UCDCL.Logout",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);]]></wpc:javaCode>
                          </wpc:script>
                        </bpws:invoke>
                      </bpws:catchAll>
                    </bpws:invoke>
                    <bpws:switch name="ErrorinLogout2" wpc:displayName="Error in Logout?" wpc:id="1002">
                      <bpws:case wpc:id="1003">
                        <bpws:condition><![CDATA[return transactionDetailPort.getBoolean(SdpHelper.ERRORINDICATOR);]]></bpws:condition>
                        <bpws:sequence name="HiddenSequence11" wpc:id="1073742945">
                          <bpws:invoke name="LogUCDCLLogoutError" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UCDCL.Logout - Error]" wpc:id="1006">
                            <wpc:script>
                              <wpc:javaCode><![CDATA[String strSeverity =transactionDetailPort.getString("errorDetails/Error/Severity");
int logLevel = SdpHelper.getLogLevel(strSeverity);
SdpLoggerHelper.logMessage("Returning : UCDCL.Logout - "+SdpLoggerHelper.ERROR_STR+"["+strSeverity+"]",PROCESS_NAME,processID,logLevel);]]></wpc:javaCode>
                            </wpc:script>
                          </bpws:invoke>
                        </bpws:sequence>
                      </bpws:case>
                      <bpws:otherwise wpc:id="1186">
                        <bpws:invoke name="LogUCDCLLogoutSuccess" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UCDCL.Logout - Success]" wpc:id="1008">
                          <wpc:script>
                            <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage("Returning : UCDCL.Logout -"+SdpLoggerHelper.SUCCESS_STR,PROCESS_NAME,processID
														,SdpLoggerHelper.INFO);																		]]></wpc:javaCode>
                          </wpc:script>
                        </bpws:invoke>
                      </bpws:otherwise>
                    </bpws:switch>
                  </bpws:sequence>
                </bpws:otherwise>
              </bpws:switch>
              <bpws:assign name="Preinvokeassigns10" wpc:displayName="Preinvoke assigns" wpc:id="932">
                <bpws:copy>
                  <bpws:from variable="EmptyTransaction_Detail"/>
                  <bpws:to variable="transactionDetailPort"/>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from>UCDCL.Login.Request</bpws:from>
                  <bpws:to variable="transactionDetailPort">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/State]]></bpws:query>
                  </bpws:to>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from>UCDCL</bpws:from>
                  <bpws:to variable="transactionDetailPort">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/TargetSystem]]></bpws:query>
                  </bpws:to>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from>Login</bpws:from>
                  <bpws:to variable="transactionDetailPort">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/currentTargetOperation]]></bpws:query>
                  </bpws:to>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from>5</bpws:from>
                  <bpws:to variable="CNMB_state"/>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from variable="emptyOrder"/>
                  <bpws:to variable="processBO"/>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from variable="EmptyTransaction_Detail"/>
                  <bpws:to variable="processTransDetail"/>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from variable="UMMessageCenterIP"/>
                  <bpws:to variable="processTransDetail">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[UMMessageCenterIP]]></bpws:query>
                  </bpws:to>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from variable="umJSessionId"/>
                  <bpws:to variable="processTransDetail">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[UMSessionID]]></bpws:query>
                  </bpws:to>
                </bpws:copy>
              </bpws:assign>
              <bpws:invoke name="LogUCDCLLogin2" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UCDCL.Login ]" wpc:id="935">
                <wpc:script>
                  <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage(SdpLoggerHelper.INVOKE_STR +" : UCDCL.Login",PROCESS_NAME,processID
														,SdpLoggerHelper.INFO);
														



																		]]></wpc:javaCode>
                </wpc:script>
              </bpws:invoke>
              <bpws:invoke name="Login2" operation="provisioningServiceLogin" partnerLink="UCDCL_CompensableService_Interface" portType="ns23:UCDCLCompensableService_Interface" wpc:displayName="Login" wpc:id="944">
                <wpc:input>
                  <wpc:parameter name="transactionDetail" variable="processTransDetail"/>
                </wpc:input>
                <wpc:output>
                  <wpc:parameter name="transactionDetail" variable="processTransDetail"/>
                </wpc:output>
                <bpws:catch faultName="wpc:runtimeFailure" faultVariable="bpcFault" wpc:faultType="wpc:BPCStandardFaultType" wpc:id="1170" wpc:variableId="945">
                  <bpws:invoke name="HandleRuntimeFailure6" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Handle Run time Failure" wpc:id="947">
                    <wpc:script>
                      <wpc:javaCode><![CDATA[SdpErrorHelper.setErrDetInTransDet(transactionDetailPort,bpcFault,SdpErrorHelper.SEVERITY_FATAL);

SdpLoggerHelper.logMessage(SdpLoggerHelper.RUNTIME_FAILURE+"   UCDCL.Login",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);

]]></wpc:javaCode>
                    </wpc:script>
                  </bpws:invoke>
                </bpws:catch>
                <bpws:catch faultName="ns23:serviceCallFault" faultVariable="scFault" wpc:faultType="java:ServiceCallFault" wpc:id="1171" wpc:variableId="948">
                  <bpws:invoke name="SetErrorDetails10" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Set Error Details" wpc:id="950">
                    <wpc:script>
                      <wpc:javaCode><![CDATA[transactionDetailPort.setBoolean(SdpHelper.ERRORINDICATOR,true);

new att.lightspeed.sdp.helper.TransactionDetail(transactionDetailPort).setSDPErrorMessage(scFault);

transactionDetailPort.getDataObject("errorDetails").getDataObject("Error").setString("Severity",SdpErrorHelper.SEVERITY_FATAL);

 
SdpLoggerHelper.logMessage(SdpLoggerHelper.FAULT_FAILURE +"   UCDCL.Login",PROCESS_NAME,processID,SdpLoggerHelper.FATAL); 
 ]]></wpc:javaCode>
                    </wpc:script>
                  </bpws:invoke>
                </bpws:catch>
                <bpws:catchAll wpc:id="1169">
                  <bpws:invoke name="Handleotherfailures6" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="handle other failures" wpc:id="955">
                    <wpc:script>
                      <wpc:javaCode><![CDATA[SdpErrorHelper.setErrDetInTransDet(transactionDetailPort,null,SdpErrorHelper.SEVERITY_FATAL);
SdpLoggerHelper.logMessage(SdpLoggerHelper.UNKNOWN_FAILURE+"  UCDCL.Login",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);]]></wpc:javaCode>
                    </wpc:script>
                  </bpws:invoke>
                </bpws:catchAll>
              </bpws:invoke>
              <bpws:switch name="CheckLoginerror1" wpc:displayName="Check Login error?" wpc:id="963">
                <bpws:case wpc:id="964">
                  <bpws:condition><![CDATA[boolean __result__1 = com.ibm.wbiservers.brules.core.codegen.NillableUtility.getBoolean(transactionDetailPort, "errorIndicator", "transactionDetailPort");
return __result__1;

//@generated:com.ibm.wbit.activity.ui
//<?xml version="1.0" encoding="UTF-8"?>
//<com.ibm.wbit.activity:CompositeActivity xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:com.ibm.wbit.activity="http:///com/ibm/wbit/activity.ecore" name="ActivityMethod">
//  <result name="Result">
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="boolean"/>
//  </result>
//  <exceptions>
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="com.ibm.bpe.api.ProcessException"/>
//  </exceptions>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="transactionDetailPort.errorIndicator" field="true">
//    <dataOutputs target="//@executableElements.1"/>
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="boolean" namespace="http://www.w3.org/2001/XMLSchema" nillable="false"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:ReturnElement" dataInputs="//@executableElements.0/@dataOutputs.0"/>
//  <executableGroups executableElements="//@executableElements.0 //@executableElements.1"/>
//</com.ibm.wbit.activity:CompositeActivity>
//@generated:end
//!SMAP!*S WBIACTDBG
//!SMAP!*L
//!SMAP!1:1,1
//!SMAP!2:2,1
//!SMAP!1000000:26,1]]></bpws:condition>
                  <bpws:sequence name="HiddenSequence5" wpc:id="1073742948">
                    <bpws:invoke name="LogUCDCLLoginError" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UCDCL.Login  - Error]" wpc:id="967">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[String strSeverity =transactionDetailPort.getString("errorDetails/Error/Severity");
int logLevel = SdpHelper.getLogLevel(strSeverity);
SdpLoggerHelper.logMessage("Returning : UCDCL.Login- "+SdpLoggerHelper.ERROR_STR+"["+strSeverity+"]",PROCESS_NAME,processID,logLevel);
														



																		]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                    <bpws:invoke name="PrepareRollBack_SDP_ORDER8" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Prepare RollBack_SDP_ORDER" wpc:id="969">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[boolean __result__1 = com.ibm.wbiservers.brules.core.codegen.NillableUtility.getList(com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(RollBack_SDP_ORDER, "order", "RollBack_SDP_ORDER"), "ReqService", "order"), "product", "ReqService"), "cvoipProduct", "product"), "accountMailBoxes", "RollBack_SDP_ORDER.order.ReqService.product.cvoipProduct").add(com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(RollBackMailBox, "RollBackMailBox"));
int __local__3 = CNMB_state.intValue();
com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(RollBack_SDP_ORDER, "transactionDetail", "RollBack_SDP_ORDER"), "tempStoreNonArray", "transactionDetail").setInt("temp11", __local__3);
int __local__5 = intTNListCounter.intValue();
com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(RollBack_SDP_ORDER, "transactionDetail", "RollBack_SDP_ORDER"), "tempStoreNonArray", "transactionDetail").setInt("temp10", __local__5);

//@generated:com.ibm.wbit.activity.ui
//<?xml version="1.0" encoding="UTF-8"?>
//<com.ibm.wbit.activity:CompositeActivity xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:com.ibm.wbit.activity="http:///com/ibm/wbit/activity.ecore" name="ActivityMethod">
//  <exceptions>
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="com.ibm.bpe.api.ProcessException"/>
//  </exceptions>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="RollBack_SDP_ORDER.order.ReqService.product.cvoipProduct.accountMailBoxes.add(RollBackMailBox)" assignable="false">
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="boolean"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="CNMB_state" variable="true">
//    <dataOutputs target="//@executableElements.2"/>
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="int" namespace="http://www.w3.org/2001/XMLSchema"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" dataInputs="//@executableElements.1/@dataOutputs.0" value="RollBack_SDP_ORDER.transactionDetail.tempStoreNonArray.temp11" field="true">
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="int" namespace="http://www.w3.org/2001/XMLSchema" nillable="false"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="intTNListCounter" variable="true">
//    <dataOutputs target="//@executableElements.4"/>
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="int" namespace="http://www.w3.org/2001/XMLSchema"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" dataInputs="//@executableElements.3/@dataOutputs.0" value="RollBack_SDP_ORDER.transactionDetail.tempStoreNonArray.temp10" field="true">
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="int" namespace="http://www.w3.org/2001/XMLSchema" nillable="false"/>
//  </executableElements>
//  <executableGroups executableElements="//@executableElements.0"/>
//  <executableGroups executableElements="//@executableElements.1 //@executableElements.2"/>
//  <executableGroups executableElements="//@executableElements.3 //@executableElements.4"/>
//</com.ibm.wbit.activity:CompositeActivity>
//@generated:end
//!SMAP!*S WBIACTDBG
//!SMAP!*L
//!SMAP!1:1,1
//!SMAP!3:2,2
//!SMAP!5:4,2
//!SMAP!1000000:41,1]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                    <bpws:reply name="ReplyUCDCLError7" operation="CreateNewMailBox" partnerLink="FromMam_CreateNewMailBox_Interface" portType="ns2:FromMam_CreateNewMailBox_Interface" wpc:displayName="Reply UCDCL Error" wpc:id="970">
                      <wpc:input>
                        <wpc:parameter name="Transaction_Detail" variable="transactionDetailPort"/>
                        <wpc:parameter name="SDP_ORDER_RequestPort" variable="RollBack_SDP_ORDER"/>
                        <wpc:parameter name="SDP_ORDER_ProvPort" variable="provSdpOrderProc"/>
                      </wpc:input>
                    </bpws:reply>
                    <bpws:terminate name="Terminate2" wpc:displayName="Terminate" wpc:id="971"/>
                  </bpws:sequence>
                </bpws:case>
                <bpws:otherwise wpc:id="1187">
                  <bpws:sequence name="HiddenSequence12" wpc:id="1073742968">
                    <bpws:invoke name="LogUCDCLLoginSuccess2" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [ UCDCL.Login -Success]" wpc:id="975">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage("Returning : UCDCL.Login -"+SdpLoggerHelper.SUCCESS_STR,PROCESS_NAME,processID
														,SdpLoggerHelper.INFO);																		]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                    <bpws:invoke name="SetUMSessionIDUMMessageCenterIP3" operation="null" partnerLink="null" portType="wpc:null" wpc:continueOnError="inherit" wpc:displayName="Set UMSessionID &amp; UMMessageCenterIP" wpc:id="1145">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[WpsLogger logger = WpsLogger.getLogger(processInstance());
String UMSessionID = null;
//String UMMessageCenterIP = null;

UMSessionID = processTransDetail.getString(SdpHelper.TRANSDETAIL_UMSESSIONID);
UMMessageCenterIP = processTransDetail.getString(SdpHelper.TRANSDETAIL_UMMESSAGECENTERIP);

logger.debug("UMSessionID from the Login Response: " + UMSessionID);
logger.debug("UMMessageCenterIP from the Login Response: " + UMMessageCenterIP);

new Order(processBO).getTransactionDetail();

processBO.setString(SdpHelper.xPathify(SdpHelper.TRANSDETAIL_UMSESSIONID_PATH),UMSessionID);
processBO.setString(SdpHelper.xPathify(SdpHelper.TRANSDETAIL_UMMESSAGECENTERIP_PATH),UMMessageCenterIP);
]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                  </bpws:sequence>
                </bpws:otherwise>
              </bpws:switch>
              <bpws:assign name="ReInitializeTnCounter" wpc:displayName="Re-Initialize Tn Counter" wpc:id="149">
                <bpws:copy>
                  <bpws:from>0</bpws:from>
                  <bpws:to variable="intTNListCounter"/>
                </bpws:copy>
              </bpws:assign>
              <bpws:while name="ForeachTNintheSubMailBox" wpc:displayName="For each TN in the Sub MailBox" wpc:id="19">
                <bpws:condition><![CDATA[int __result__2 = com.ibm.wbiservers.brules.core.codegen.NillableUtility.getList(currentMBox, "mailBoxTNs", "currentMBox").size();
boolean __result__3;
{// less than
	__result__3 = (intTNListCounter.intValue()) < __result__2;
}
return __result__3;

//@generated:com.ibm.wbit.activity.ui
//<?xml version="1.0" encoding="UTF-8"?>
//<com.ibm.wbit.activity:CompositeActivity xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:com.ibm.wbit.activity="http:///com/ibm/wbit/activity.ecore" name="ActivityMethod">
//  <result name="Result">
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="boolean"/>
//  </result>
//  <exceptions>
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="com.ibm.bpe.api.ProcessException"/>
//  </exceptions>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="intTNListCounter" variable="true">
//    <dataOutputs target="//@executableElements.2/@parameters.0"/>
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="int" namespace="http://www.w3.org/2001/XMLSchema"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="currentMBox.mailBoxTNs.size()" assignable="false">
//    <dataOutputs target="//@executableElements.2/@parameters.1"/>
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="int"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:LibraryActivity" name="less than" description="True if the value of the first input is less than the value of the second input" category="math" template="&lt;%return%> &lt;%input1%> &lt; &lt;%input2%>;">
//    <parameters name="input1" dataInputs="//@executableElements.0/@dataOutputs.0" displayName="input1">
//      <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="double"/>
//    </parameters>
//    <parameters name="input2" dataInputs="//@executableElements.1/@dataOutputs.0" displayName="input2">
//      <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="double"/>
//    </parameters>
//    <result name="result" displayName="result">
//      <dataOutputs target="//@executableElements.3"/>
//      <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="boolean"/>
//    </result>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:ReturnElement" dataInputs="//@executableElements.2/@result/@dataOutputs.0"/>
//  <executableGroups executableElements="//@executableElements.0 //@executableElements.1 //@executableElements.2 //@executableElements.3"/>
//</com.ibm.wbit.activity:CompositeActivity>
//@generated:end
//!SMAP!*S WBIACTDBG
//!SMAP!*L
//!SMAP!2:1,1
//!SMAP!3:2,4
//!SMAP!4:6,1
//!SMAP!1000000:47,1]]></bpws:condition>
                <bpws:sequence name="HiddenSequence6" wpc:id="1073742949">
                  <bpws:invoke name="GetCurrentTN1" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Get Current TN" wpc:id="227">
                    <wpc:script>
                      <wpc:javaCode><![CDATA[commonj.sdo.DataObject __result__2;
{// copy BO
	com.ibm.websphere.bo.BOCopy _copyService = 
	   (com.ibm.websphere.bo.BOCopy) new com.ibm.websphere.sca.ServiceManager().locateService("com/ibm/websphere/bo/BOCopy"); 
	__result__2 = _copyService.copy(currentMBox);
}
tmpMBox = __result__2;
java.util.List __result__4 = com.ibm.wbiservers.brules.core.codegen.NillableUtility.getList(tmpMBox, "mailBoxTNs", "tmpMBox");
java.lang.Object __result__6;
{// get item at index
	__result__6 = __result__4.get((intTNListCounter.intValue()));
}
currentTN = (commonj.sdo.DataObject)__result__6;

//@generated:com.ibm.wbit.activity.ui
//<?xml version="1.0" encoding="UTF-8"?>
//<com.ibm.wbit.activity:CompositeActivity xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:com.ibm.wbit.activity="http:///com/ibm/wbit/activity.ecore" name="ActivityMethod">
//  <exceptions>
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="com.ibm.bpe.api.ProcessException"/>
//  </exceptions>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="currentMBox" variable="true">
//    <dataOutputs target="//@executableElements.1/@parameters.0"/>
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="SDP_AccountMailBoxes" namespace="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_AccountMailBoxes"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:LibraryActivity" name="copy BO" description="Copy a Business Object" category="SCA services" template="com.ibm.websphere.bo.BOCopy _copyService = &#xA;   (com.ibm.websphere.bo.BOCopy) new com.ibm.websphere.sca.ServiceManager().locateService(&quot;com/ibm/websphere/bo/BOCopy&quot;); &#xA;&lt;%return%> _copyService.copy(&lt;%bo%>);">
//    <parameters name="bo" dataInputs="//@executableElements.0/@dataOutputs.0" displayName="BO">
//      <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="commonj.sdo.DataObject"/>
//    </parameters>
//    <result name="copy" displayName="copy">
//      <dataOutputs target="//@executableElements.2"/>
//      <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="commonj.sdo.DataObject"/>
//    </result>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" dataInputs="//@executableElements.1/@result/@dataOutputs.0" value="tmpMBox" variable="true">
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="SDP_AccountMailBoxes" namespace="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_AccountMailBoxes"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="tmpMBox.mailBoxTNs" field="true">
//    <dataOutputs target="//@executableElements.5/@parameters.0"/>
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="java.util.List"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="intTNListCounter" variable="true">
//    <dataOutputs target="//@executableElements.5/@parameters.1"/>
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="int" namespace="http://www.w3.org/2001/XMLSchema"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:LibraryActivity" name="get item at index" description="Get the item at the given index in the list" category="list" template="&lt;%return%> &lt;%list%>.get(&lt;%index%>);">
//    <parameters name="list" dataInputs="//@executableElements.3/@dataOutputs.0" displayName="list">
//      <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="java.util.List"/>
//    </parameters>
//    <parameters name="index" dataInputs="//@executableElements.4/@dataOutputs.0" displayName="index">
//      <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="int"/>
//    </parameters>
//    <result name="element" displayName="element">
//      <dataOutputs target="//@executableElements.6"/>
//      <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="java.lang.Object"/>
//    </result>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" dataInputs="//@executableElements.5/@result/@dataOutputs.0" value="currentTN" variable="true">
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="SDP_MemberTNS" namespace="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_MemberTNS"/>
//  </executableElements>
//  <executableGroups executableElements="//@executableElements.0 //@executableElements.1 //@executableElements.2"/>
//  <executableGroups executableElements="//@executableElements.3 //@executableElements.4 //@executableElements.5 //@executableElements.6"/>
//</com.ibm.wbit.activity:CompositeActivity>
//@generated:end
//!SMAP!*S WBIACTDBG
//!SMAP!*L
//!SMAP!2:1,6
//!SMAP!3:7,1
//!SMAP!4:8,1
//!SMAP!6:9,4
//!SMAP!7:13,1
//!SMAP!1000000:72,1]]></wpc:javaCode>
                    </wpc:script>
                  </bpws:invoke>
                  <bpws:switch name="IfPTL" wpc:displayName="If PTL?" wpc:id="979">
                    <bpws:case wpc:id="980">
                      <bpws:condition expressionLanguage="http://www.ibm.com/xmlns/prod/websphere/business-process/expression-lang/java/6.0.0/"><![CDATA[String strTN = null;
String primaryTNInd = null;
String isNLT = null;
boolean blnPTL = false;

DataObject lineSubComponent = null;

if (currentTN != null)
{
	strTN = currentTN.getString(SdpHelper.CVOIP_MAILBOX_TN);
	
	SdpLoggerHelper.logMessage("Current TN [ " + strTN + "]", PROCESS_NAME, processID, 
		SdpLoggerHelper.DEBUG);
	
	lineSubComponent = SdpHelper.getTN(provSdpOrderProc,strTN);
	
	if (lineSubComponent != null)
	{
		primaryTNInd = lineSubComponent.getString(SdpHelper.CVOIP_TN_PRIMARYIND_PATH.replace('.' , '/'));
		isNLT = lineSubComponent.getString(SdpHelper.ISNLT);
		
		SdpLoggerHelper.logMessage("Primary TN Ind[ " + primaryTNInd + "]", PROCESS_NAME, processID, 
			SdpLoggerHelper.DEBUG);
			
		SdpLoggerHelper.logMessage("NLT Ind " + isNLT + "]", PROCESS_NAME, processID, 
			SdpLoggerHelper.DEBUG);
		//Changing the logic for UBV 2 orders.	
		if ((!StringUtil.isEmpty(isNLT) && isNLT.equalsIgnoreCase(SdpHelper.YES)) || primaryTNInd.equalsIgnoreCase(SdpHelper.YES))
		/*if (primaryTNInd.equalsIgnoreCase(SdpHelper.YES))*/
		{
			blnPTL = true;
		}
	}
}

return !blnPTL;]]></bpws:condition>
                      <bpws:sequence name="HiddenSequence1" wpc:id="1073742950">
                        <bpws:assign name="PreInvokeAssigns3" wpc:displayName="Pre-Invoke Assigns" wpc:id="33">
                          <bpws:copy>
                            <bpws:from variable="currentMBox">
                              <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/mailBoxInvariantId]]></bpws:query>
                            </bpws:from>
                            <bpws:to variable="ucdclEmailOrPhone"/>
                          </bpws:copy>
                          <bpws:copy>
                            <bpws:from variable="currentTN">
                              <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/tn]]></bpws:query>
                            </bpws:from>
                            <bpws:to variable="ucdclDeviceNumber"/>
                          </bpws:copy>
                          <bpws:copy>
                            <bpws:from>6</bpws:from>
                            <bpws:to variable="CNMB_state"/>
                          </bpws:copy>
                          <bpws:copy>
                            <bpws:from variable="EmptyTransaction_Detail"/>
                            <bpws:to variable="transactionDetailPort"/>
                          </bpws:copy>
                          <bpws:copy>
                            <bpws:from>UCDCL.AddDevice.request</bpws:from>
                            <bpws:to variable="transactionDetailPort">
                              <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/State]]></bpws:query>
                            </bpws:to>
                          </bpws:copy>
                          <bpws:copy>
                            <bpws:from>UCDCL</bpws:from>
                            <bpws:to variable="transactionDetailPort">
                              <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/TargetSystem]]></bpws:query>
                            </bpws:to>
                          </bpws:copy>
                          <bpws:copy>
                            <bpws:from>Add Deivce</bpws:from>
                            <bpws:to variable="transactionDetailPort">
                              <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/currentTargetOperation]]></bpws:query>
                            </bpws:to>
                          </bpws:copy>
                          <bpws:copy>
                            <bpws:from variable="provSdpOrderProc">
                              <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/order/ReqService/product/cvoipProduct/cfn]]></bpws:query>
                            </bpws:from>
                            <bpws:to variable="ucdclDeviceCFN"/>
                          </bpws:copy>
                          <bpws:copy>
                            <bpws:from>0000</bpws:from>
                            <bpws:to variable="ucdclAuthentication"/>
                          </bpws:copy>
                          <bpws:copy>
                            <bpws:from>SIP</bpws:from>
                            <bpws:to variable="ucdclTransportMWI"/>
                          </bpws:copy>
                        </bpws:assign>
                        <bpws:invoke name="TrimInputValuestoAddDevice" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Trim Input Values to Add Device" wpc:id="805">
                          <wpc:script>
                            <wpc:javaCode><![CDATA[if(ucdclEmailOrPhone != null)
{
	ucdclEmailOrPhone = ucdclEmailOrPhone.trim();
	
	SdpLoggerHelper.logMessage("ucdclEmailOrPhone Trimed [" + ucdclEmailOrPhone + "]",
		PROCESS_NAME, processID, SdpLoggerHelper.DEBUG);
}	

if(ucdclDeviceNumber != null)
{
	ucdclDeviceNumber = ucdclDeviceNumber.trim();
	
	SdpLoggerHelper.logMessage("ucdclDeviceNumber Trimed [" + ucdclDeviceNumber + "]",
		PROCESS_NAME, processID, SdpLoggerHelper.DEBUG);	
}]]></wpc:javaCode>
                          </wpc:script>
                        </bpws:invoke>
                        <bpws:assign name="BuildGBO1" wpc:displayName="Build GBO" wpc:id="1146">
                          <bpws:copy>
                            <bpws:from variable="ucdclEmailOrPhone"/>
                            <bpws:to variable="processBO">
                              <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[order/ReqService/product/cvoipProduct/accountMailBoxes[1]/mailBoxInvariantId]]></bpws:query>
                            </bpws:to>
                          </bpws:copy>
                          <bpws:copy>
                            <bpws:from variable="ucdclDeviceNumber"/>
                            <bpws:to variable="processBO">
                              <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[order/ReqService/product/cvoipProduct/cvoipLineSubComponent[1]/tnInfo/tn]]></bpws:query>
                            </bpws:to>
                          </bpws:copy>
                          <bpws:copy>
                            <bpws:from variable="ucdclDeviceCFN"/>
                            <bpws:to variable="processBO">
                              <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[order/ReqService/product/cvoipProduct/cfn]]></bpws:query>
                            </bpws:to>
                          </bpws:copy>
                        </bpws:assign>
                        <bpws:invoke name="LogUCDCLAddDevice" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [ UCDCL.AddDevice]" wpc:id="584">
                          <wpc:script>
                            <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage(SdpLoggerHelper.INVOKE_STR +" : UCDCL.AddDevice",PROCESS_NAME,processID,SdpLoggerHelper.INFO);
SdpLoggerHelper.logMessage("Request BO:[ucdclEmailOrPhone]",PROCESS_NAME,processID,SdpLoggerHelper.INFO);
SdpLoggerHelper.logMessage("ucdclEmailOrPhone:"+ucdclEmailOrPhone,PROCESS_NAME,processID,SdpLoggerHelper.INFO);
SdpLoggerHelper.logMessage("ucdclDeviceNumber:"+ucdclDeviceNumber,PROCESS_NAME,processID,SdpLoggerHelper.INFO);
SdpLoggerHelper.logMessage("ucdclDeviceType:"+ucdclDeviceType,PROCESS_NAME,processID,SdpLoggerHelper.INFO);
SdpLoggerHelper.logMessage("ucdclDeviceCFN:"+ucdclDeviceCFN,PROCESS_NAME,processID,SdpLoggerHelper.INFO);
SdpLoggerHelper.logMessage("ucdclAuthentication:"+ucdclAuthentication,PROCESS_NAME,processID,SdpLoggerHelper.INFO);
SdpLoggerHelper.logMessage("ucdclTransportMWI:"+ucdclTransportMWI,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

																															]]></wpc:javaCode>
                          </wpc:script>
                        </bpws:invoke>
                        <bpws:invoke name="UCDCLAddDevice" operation="addDevice" partnerLink="UCDCL_CompensableService_Interface" portType="ns23:UCDCLCompensableService_Interface" wpc:displayName="UCDCL Add Device" wpc:id="20">
                          <wpc:input>
                            <wpc:parameter name="order" variable="processBO"/>
                          </wpc:input>
                          <wpc:output>
                            <wpc:parameter name="transactionDetail" variable="processTransDetail"/>
                          </wpc:output>
                          <bpws:catch faultName="wpc:runtimeFailure" faultVariable="bpcFault" wpc:faultType="wpc:BPCStandardFaultType" wpc:id="1191" wpc:variableId="91">
                            <bpws:invoke name="Handleruntimefailure3" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="handle runtime failure" wpc:id="398">
                              <wpc:script>
                                <wpc:javaCode><![CDATA[SdpErrorHelper.setErrDetInTransDet(transactionDetailPort,bpcFault,SdpErrorHelper.SEVERITY_FATAL);
SdpLoggerHelper.logMessage(SdpLoggerHelper.RUNTIME_FAILURE+"  UCDCL.AddDevice",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);]]></wpc:javaCode>
                              </wpc:script>
                            </bpws:invoke>
                          </bpws:catch>
                          <bpws:catch faultName="ns23:serviceCallFault" faultVariable="scFault" wpc:faultType="java:ServiceCallFault" wpc:id="1192" wpc:variableId="186">
                            <bpws:invoke name="SetErrorDetails5" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Set Error Details" wpc:id="565">
                              <wpc:script>
                                <wpc:javaCode><![CDATA[transactionDetailPort.setBoolean(SdpHelper.ERRORINDICATOR,true);

new att.lightspeed.sdp.helper.TransactionDetail(transactionDetailPort).setSDPErrorMessage(scFault);

transactionDetailPort.getDataObject("errorDetails").getDataObject("Error").setString("Severity",SdpErrorHelper.SEVERITY_FATAL);

 
SdpLoggerHelper.logMessage(SdpLoggerHelper.FAULT_FAILURE +"  UCDCL.AddDevice",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);]]></wpc:javaCode>
                              </wpc:script>
                            </bpws:invoke>
                          </bpws:catch>
                          <bpws:catchAll wpc:id="1190">
                            <bpws:invoke name="Handleotherfailures3" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="handle other failures" wpc:id="395">
                              <wpc:script>
                                <wpc:javaCode><![CDATA[SdpErrorHelper.setErrDetInTransDet(transactionDetailPort,null,SdpErrorHelper.SEVERITY_FATAL);
SdpLoggerHelper.logMessage(SdpLoggerHelper.FAULT_FAILURE +"  UCDCL.AddDevice",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);]]></wpc:javaCode>
                              </wpc:script>
                            </bpws:invoke>
                          </bpws:catchAll>
                        </bpws:invoke>
                        <bpws:switch name="CheckUCDCLError3" wpc:displayName="Check UCDCL Error" wpc:id="79">
                          <bpws:case wpc:id="80">
                            <bpws:condition><![CDATA[boolean __result__1 = com.ibm.wbiservers.brules.core.codegen.NillableUtility.getBoolean(transactionDetailPort, "errorIndicator", "transactionDetailPort");
return __result__1;

//@generated:com.ibm.wbit.activity.ui
//<?xml version="1.0" encoding="UTF-8"?>
//<com.ibm.wbit.activity:CompositeActivity xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:com.ibm.wbit.activity="http:///com/ibm/wbit/activity.ecore" name="ActivityMethod">
//  <result name="Result">
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="boolean"/>
//  </result>
//  <exceptions>
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="com.ibm.bpe.api.ProcessException"/>
//  </exceptions>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="transactionDetailPort.errorIndicator" field="true">
//    <dataOutputs target="//@executableElements.1"/>
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="boolean" namespace="http://www.w3.org/2001/XMLSchema" nillable="false"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:ReturnElement" dataInputs="//@executableElements.0/@dataOutputs.0"/>
//  <executableGroups executableElements="//@executableElements.0 //@executableElements.1"/>
//</com.ibm.wbit.activity:CompositeActivity>
//@generated:end
//!SMAP!*S WBIACTDBG
//!SMAP!*L
//!SMAP!1:1,1
//!SMAP!2:2,1
//!SMAP!1000000:26,1]]></bpws:condition>
                            <bpws:sequence name="HiddenSequence9" wpc:id="1073742951">
                              <bpws:invoke name="LogUCDCLAddDeviceError" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [ UCDCL.AddDevice  - Error]" wpc:id="611">
                                <wpc:script>
                                  <wpc:javaCode><![CDATA[String strSeverity =transactionDetailPort.getString("errorDetails/Error/Severity");
int logLevel = SdpHelper.getLogLevel(strSeverity);
SdpLoggerHelper.logMessage(" UCDCL.AddDevice - "+SdpLoggerHelper.ERROR_STR+"["+strSeverity+"]",PROCESS_NAME,processID,logLevel);]]></wpc:javaCode>
                                </wpc:script>
                              </bpws:invoke>
                              <bpws:invoke name="PrepareRollBack_SDP_ORDER5" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Prepare RollBack_SDP_ORDER" wpc:id="475">
                                <wpc:script>
                                  <wpc:javaCode><![CDATA[boolean __result__1 = com.ibm.wbiservers.brules.core.codegen.NillableUtility.getList(com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(RollBack_SDP_ORDER, "order", "RollBack_SDP_ORDER"), "ReqService", "order"), "product", "ReqService"), "cvoipProduct", "product"), "accountMailBoxes", "RollBack_SDP_ORDER.order.ReqService.product.cvoipProduct").add(com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(RollBackMailBox, "RollBackMailBox"));
int __local__3 = CNMB_state.intValue();
com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(RollBack_SDP_ORDER, "transactionDetail", "RollBack_SDP_ORDER"), "tempStoreNonArray", "transactionDetail").setInt("temp11", __local__3);
int __local__5 = intTNListCounter.intValue();
com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(RollBack_SDP_ORDER, "transactionDetail", "RollBack_SDP_ORDER"), "tempStoreNonArray", "transactionDetail").setInt("temp10", __local__5);

//@generated:com.ibm.wbit.activity.ui
//<?xml version="1.0" encoding="UTF-8"?>
//<com.ibm.wbit.activity:CompositeActivity xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:com.ibm.wbit.activity="http:///com/ibm/wbit/activity.ecore" name="ActivityMethod">
//  <exceptions>
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="com.ibm.bpe.api.ProcessException"/>
//  </exceptions>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="RollBack_SDP_ORDER.order.ReqService.product.cvoipProduct.accountMailBoxes.add(RollBackMailBox)" assignable="false">
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="boolean"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="CNMB_state" variable="true">
//    <dataOutputs target="//@executableElements.2"/>
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="int" namespace="http://www.w3.org/2001/XMLSchema"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" dataInputs="//@executableElements.1/@dataOutputs.0" value="RollBack_SDP_ORDER.transactionDetail.tempStoreNonArray.temp11" field="true">
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="int" namespace="http://www.w3.org/2001/XMLSchema" nillable="false"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="intTNListCounter" variable="true">
//    <dataOutputs target="//@executableElements.4"/>
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="int" namespace="http://www.w3.org/2001/XMLSchema"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" dataInputs="//@executableElements.3/@dataOutputs.0" value="RollBack_SDP_ORDER.transactionDetail.tempStoreNonArray.temp10" field="true">
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="int" namespace="http://www.w3.org/2001/XMLSchema" nillable="false"/>
//  </executableElements>
//  <executableGroups executableElements="//@executableElements.0"/>
//  <executableGroups executableElements="//@executableElements.1 //@executableElements.2"/>
//  <executableGroups executableElements="//@executableElements.3 //@executableElements.4"/>
//</com.ibm.wbit.activity:CompositeActivity>
//@generated:end
//!SMAP!*S WBIACTDBG
//!SMAP!*L
//!SMAP!1:1,1
//!SMAP!3:2,2
//!SMAP!5:4,2
//!SMAP!1000000:41,1]]></wpc:javaCode>
                                </wpc:script>
                              </bpws:invoke>
                              <bpws:assign name="Assign" wpc:displayName="Assign" wpc:id="1150">
                                <bpws:copy>
                                  <bpws:from variable="UMMessageCenterIP"/>
                                  <bpws:to variable="transactionDetailPort">
                                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[UMMessageCenterIP]]></bpws:query>
                                  </bpws:to>
                                </bpws:copy>
                              </bpws:assign>
                              <bpws:reply name="ReplyUCDCLError4" operation="CreateNewMailBox" partnerLink="FromMam_CreateNewMailBox_Interface" portType="ns2:FromMam_CreateNewMailBox_Interface" wpc:displayName="Reply UCDCL Error" wpc:id="366">
                                <wpc:input>
                                  <wpc:parameter name="Transaction_Detail" variable="transactionDetailPort"/>
                                  <wpc:parameter name="SDP_ORDER_RequestPort" variable="RollBack_SDP_ORDER"/>
                                  <wpc:parameter name="SDP_ORDER_ProvPort" variable="provSdpOrderProc"/>
                                </wpc:input>
                              </bpws:reply>
                              <bpws:terminate name="Terminate3" wpc:displayName="Terminate" wpc:id="520"/>
                            </bpws:sequence>
                          </bpws:case>
                        </bpws:switch>
                        <bpws:invoke name="LogUCDCLAddDeviceSuccess" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UCDCL.AddDevice -Success ]" wpc:id="600">
                          <wpc:script>
                            <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage(" UCDCL.AddDevice -"+SdpLoggerHelper.SUCCESS_STR,PROCESS_NAME,processID,SdpLoggerHelper.INFO);]]></wpc:javaCode>
                          </wpc:script>
                        </bpws:invoke>
                      </bpws:sequence>
                    </bpws:case>
                  </bpws:switch>
                  <bpws:invoke name="AddTNtosecondaryMemberProfile" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Add TN to secondary MemberProfile" wpc:id="767">
                    <wpc:script>
                      <wpc:javaCode><![CDATA[Object memberTn = null;
DataObject mailboxMember = null;
List lstMailboxMembers = null;
Iterator iterMailboxMember = null;
StringBuffer logMsg=new StringBuffer();

String strMemberId = null;
String strTn = null;
String keySelector = MamMemberServiceHelper.TN_KEY_SELECTOR;
String operationSelector = MamMemberServiceHelper.ADD_OPERATION_SELECTOR;
String objectSelector = MamMemberServiceHelper.MEMBERPROFILE_OBJECT_SELECTOR;

lstMailboxMembers = currentMBox.getList(SdpHelper.VOIP_MAILBOX_MEMBERS);
iterMailboxMember = lstMailboxMembers.iterator();

strTn = currentTN.getString(SdpHelper.CVOIP_MAILBOX_TN);

while(iterMailboxMember.hasNext())
{
	mailboxMember = SdpHelper.copySpecificBO((DataObject) iterMailboxMember.next());	
	
	if(mailboxMember != null)
	{
		memberTn = (Object) SdpHelper.copySpecificBO(currentTN);
		
		strMemberId = mailboxMember.getString(SdpHelper.CVOIP_MAILBOX_MEMBERID);
		logMsg.append("Adding the TN ");
		logMsg.append(strTn);
		logMsg.append(" to the MemberProfile[");
		logMsg.append(strMemberId);
		logMsg.append("]");
		SdpLoggerHelper.logMessage(logMsg.toString(),PROCESS_NAME, processID, SdpLoggerHelper.INFO);
		logMsg.delete(0, logMsg.length());
		
		MamMemberServiceHelper.modifyMemberProfileOrMailbox(provSdpOrderProc, strMemberId,
			keySelector, operationSelector,memberTn,objectSelector);
	}
}]]></wpc:javaCode>
                    </wpc:script>
                  </bpws:invoke>
                  <bpws:invoke name="IncrementtheTNListCounter" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Increment the TN List Counter" wpc:id="35">
                    <wpc:script>
                      <wpc:javaCode><![CDATA[java.lang.Integer __result__1 = new java.lang.Integer(com.ibm.wbiservers.brules.core.codegen.NillableUtility.getInt(intTNListCounter, "intTNListCounter") + 1);
intTNListCounter = __result__1;

//@generated:com.ibm.wbit.activity.ui
//<?xml version="1.0" encoding="UTF-8"?>
//<com.ibm.wbit.activity:CompositeActivity xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:com.ibm.wbit.activity="http:///com/ibm/wbit/activity.ecore" name="ActivityMethod">
//  <exceptions>
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="com.ibm.bpe.api.ProcessException"/>
//  </exceptions>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="intTNListCounter+1" assignable="false">
//    <dataOutputs target="//@executableElements.1"/>
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="int" namespace="http://www.w3.org/2001/XMLSchema"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" dataInputs="//@executableElements.0/@dataOutputs.0" value="intTNListCounter" variable="true">
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="int" namespace="http://www.w3.org/2001/XMLSchema"/>
//  </executableElements>
//  <executableGroups executableElements="//@executableElements.0 //@executableElements.1"/>
//</com.ibm.wbit.activity:CompositeActivity>
//@generated:end
//!SMAP!*S WBIACTDBG
//!SMAP!*L
//!SMAP!1:1,1
//!SMAP!2:2,1
//!SMAP!1000000:25,1]]></wpc:javaCode>
                    </wpc:script>
                  </bpws:invoke>
                </bpws:sequence>
              </bpws:while>
              <bpws:invoke name="PrepareSDPOrderforMPSCreateOrderSubMailBox" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Prepare SDP Order for MPS Create Order[Sub MailBox]" wpc:id="298">
                <wpc:script>
                  <wpc:javaCode><![CDATA[currentMBox.setString(SdpHelper.CVOIP_MAILBOX_MAINMAILBOXIND, SdpHelper.NO);
new Order(sdpOrderForUpdate).getProductList(Product.CVOIPMAILBOX).clear();
new Order(sdpOrderForUpdate).getProductList(Product.CVOIPMAILBOX).add(SDO.copy(currentMBox));
new Order(provSdpOrderProc).getProductList(Product.CVOIPMAILBOX).add(SDO.copy(currentMBox));
]]></wpc:javaCode>
                </wpc:script>
              </bpws:invoke>
              <bpws:invoke name="LogProvSDPOrder" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log Prov SDP Order" wpc:id="756">
                <wpc:script>
                  <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage("Prov SDP Order:",PROCESS_NAME,processID,SdpLoggerHelper.INFO);														
SdpLoggerHelper.logBO(provSdpOrderProc,PROCESS_NAME,processID,SdpLoggerHelper.INFO);
]]></wpc:javaCode>
                </wpc:script>
              </bpws:invoke>
              <bpws:assign name="PreInvokeAssigns4" wpc:displayName="Pre-Invoke Assigns" wpc:id="37">
                <bpws:copy>
                  <bpws:from>7</bpws:from>
                  <bpws:to variable="CNMB_state"/>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from variable="EmptyTransaction_Detail"/>
                  <bpws:to variable="sdpOrderPort">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail]]></bpws:query>
                  </bpws:to>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from>MPS.AddComponent.request</bpws:from>
                  <bpws:to variable="sdpOrderPort">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/State]]></bpws:query>
                  </bpws:to>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from>MPS</bpws:from>
                  <bpws:to variable="sdpOrderPort">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/errorDetails/Error/TargetSystem]]></bpws:query>
                  </bpws:to>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from>AddComponent</bpws:from>
                  <bpws:to variable="sdpOrderPort">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/currentTargetOperation]]></bpws:query>
                  </bpws:to>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from>MAILBOX</bpws:from>
                  <bpws:to variable="sdpOrderForUpdate">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/currentProduct]]></bpws:query>
                  </bpws:to>
                </bpws:copy>
              </bpws:assign>
              <bpws:invoke name="LogMPSAddComponent" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [ MPS.AddComponent]" wpc:id="586">
                <wpc:script>
                  <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage(SdpLoggerHelper.INVOKE_STR +" : MPS.AddComponent",PROCESS_NAME,processID
														,SdpLoggerHelper.INFO);
														
SdpLoggerHelper.logMessage("Request BO:[sdpOrder]",PROCESS_NAME,processID
														,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("sdpOrder:",PROCESS_NAME,processID
														,SdpLoggerHelper.INFO);
														
SdpLoggerHelper.logBO(sdpOrderForUpdate,PROCESS_NAME,processID,SdpLoggerHelper.INFO);
																		]]></wpc:javaCode>
                </wpc:script>
              </bpws:invoke>
              <bpws:invoke name="MPSCreateComponentforSubMailBox" operation="createComponent" partnerLink="MPSCompensableService2_InterfacePartner" portType="ns22:MPSCompensableService2_Interface" wpc:displayName="MPS.Create Component for Sub MailBox" wpc:id="26">
                <wpc:input>
                  <wpc:parameter name="order" variable="sdpOrderForUpdate"/>
                </wpc:input>
                <wpc:output/>
                <bpws:catch faultName="ns22:serviceCallFault" faultVariable="scFault" wpc:faultType="java:ServiceCallFault" wpc:id="1172" wpc:variableId="88">
                  <bpws:sequence name="HiddenSequence2" wpc:id="1073742912">
                    <bpws:assign name="SetErrorDetails7" wpc:displayName="Set Error Details" wpc:id="1089">
                      <bpws:copy>
                        <bpws:from><![CDATA[11016]]></bpws:from>
                        <bpws:to variable="transactionDetailPort">
                          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/Message/MessageCode]]></bpws:query>
                        </bpws:to>
                      </bpws:copy>
                      <bpws:copy>
                        <bpws:from><![CDATA[SDP_Downstream_System_Error]]></bpws:from>
                        <bpws:to variable="transactionDetailPort">
                          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/Message/MessageText]]></bpws:query>
                        </bpws:to>
                      </bpws:copy>
                      <bpws:copy>
                        <bpws:from>FATAL</bpws:from>
                        <bpws:to variable="transactionDetailPort">
                          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/Severity]]></bpws:query>
                        </bpws:to>
                      </bpws:copy>
                      <bpws:copy>
                        <bpws:from variable="scFault">
                          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[messageDetail]]></bpws:query>
                        </bpws:from>
                        <bpws:to variable="transactionDetailPort">
                          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[errorDetails/Error/Message/MessageDetail]]></bpws:query>
                        </bpws:to>
                      </bpws:copy>
                    </bpws:assign>
                    <bpws:invoke name="Handlesruntimefailures" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="handles runtime failures" wpc:id="353">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[transactionDetailPort.setBoolean("errorIndicator", true);
SdpLoggerHelper.logMessage(SdpLoggerHelper.RUNTIME_FAILURE+" MPS.CreateComponent",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);
SdpLoggerHelper.logBO(scFault,PROCESS_NAME,processID,SdpLoggerHelper.FATAL);

/*
SdpErrorHelper.setErrDetInTransDet(sdpOrderPort.getDataObject(SdpHelper.TRANSACTION_DETAIL),scFault,SdpErrorHelper.SEVERITY_FATAL);
SdpLoggerHelper.logMessage(SdpLoggerHelper.RUNTIME_FAILURE+" MPS.CreateComponent",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);

DataObject responseMessage = (DataObject)sdpOrderPort.getDataObject("transactionDetail/errorDetails/Error/Message");
responseMessage.setString(SdpHelper.ERRORDETAILS_MESSAGE_CODE,SdpErrorHelper.SDP_INTERNAL_SYSTEM_ERROR);
*/]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                    <bpws:sequence name="HiddenSequence2" wpc:id="1073741873">
                      <bpws:invoke name="PrepareRollBack_SDP_ORDER" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Prepare RollBack_SDP_ORDER" wpc:id="478">
                        <wpc:script>
                          <wpc:javaCode><![CDATA[boolean __result__1 = com.ibm.wbiservers.brules.core.codegen.NillableUtility.getList(com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(RollBack_SDP_ORDER, "order", "RollBack_SDP_ORDER"), "ReqService", "order"), "product", "ReqService"), "cvoipProduct", "product"), "accountMailBoxes", "RollBack_SDP_ORDER.order.ReqService.product.cvoipProduct").add(com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(RollBackMailBox, "RollBackMailBox"));
int __local__3 = CNMB_state.intValue();
com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(RollBack_SDP_ORDER, "transactionDetail", "RollBack_SDP_ORDER"), "tempStoreNonArray", "transactionDetail").setInt("temp11", __local__3);

//@generated:com.ibm.wbit.activity.ui
//<?xml version="1.0" encoding="UTF-8"?>
//<com.ibm.wbit.activity:CompositeActivity xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:com.ibm.wbit.activity="http:///com/ibm/wbit/activity.ecore" name="ActivityMethod">
//  <exceptions>
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="com.ibm.bpe.api.ProcessException"/>
//  </exceptions>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="RollBack_SDP_ORDER.order.ReqService.product.cvoipProduct.accountMailBoxes.add(RollBackMailBox)" assignable="false">
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="boolean"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="CNMB_state" variable="true">
//    <dataOutputs target="//@executableElements.2"/>
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="int" namespace="http://www.w3.org/2001/XMLSchema"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" dataInputs="//@executableElements.1/@dataOutputs.0" value="RollBack_SDP_ORDER.transactionDetail.tempStoreNonArray.temp11" field="true">
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="int" namespace="http://www.w3.org/2001/XMLSchema" nillable="false"/>
//  </executableElements>
//  <executableGroups executableElements="//@executableElements.0"/>
//  <executableGroups executableElements="//@executableElements.1 //@executableElements.2"/>
//</com.ibm.wbit.activity:CompositeActivity>
//@generated:end
//!SMAP!*S WBIACTDBG
//!SMAP!*L
//!SMAP!1:1,1
//!SMAP!3:2,2
//!SMAP!1000000:30,1]]></wpc:javaCode>
                        </wpc:script>
                      </bpws:invoke>
                      <bpws:reply name="ReplyUCDCLError3" operation="CreateNewMailBox" partnerLink="FromMam_CreateNewMailBox_Interface" portType="ns2:FromMam_CreateNewMailBox_Interface" wpc:displayName="Reply UCDCL Error" wpc:id="370">
                        <wpc:input>
                          <wpc:parameter name="Transaction_Detail" variable="transactionDetailPort"/>
                          <wpc:parameter name="SDP_ORDER_RequestPort" variable="RollBack_SDP_ORDER"/>
                          <wpc:parameter name="SDP_ORDER_ProvPort" variable="provSdpOrderProc"/>
                        </wpc:input>
                      </bpws:reply>
                      <bpws:terminate name="Terminate4" wpc:displayName="Terminate" wpc:id="521"/>
                    </bpws:sequence>
                  </bpws:sequence>
                </bpws:catch>
              </bpws:invoke>
              <bpws:invoke name="UpdateRollBack_MailBox2" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Update RollBack_MailBox" wpc:id="462">
                <wpc:script>
                  <wpc:javaCode><![CDATA[RollBackMailBox = SDO.copy(currentMBox);
]]></wpc:javaCode>
                </wpc:script>
              </bpws:invoke>
              <bpws:invoke name="SetCNMB_state" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Set CNMB_state" wpc:id="1133">
                <wpc:script>
                  <wpc:javaCode><![CDATA[CNMB_state = new Integer(8);]]></wpc:javaCode>
                </wpc:script>
              </bpws:invoke>
              <bpws:invoke name="InvokeMPSassociateMailboxTNsforSubMailbox" operation="associateMailboxTNs" partnerLink="MPSCompensableService2_InterfacePartner" portType="ns22:MPSCompensableService2_Interface" wpc:displayName="Invoke MPS.associateMailboxTNs for Sub Mailbox" wpc:id="1101">
                <wpc:input>
                  <wpc:parameter name="order" variable="sdpOrderForUpdate"/>
                </wpc:input>
                <wpc:output/>
                <bpws:catch faultName="ns22:serviceCallFault" faultVariable="scFault" wpc:faultType="java:ServiceCallFault" wpc:id="1173" wpc:variableId="1102">
                  <bpws:sequence name="HiddenSequence17" wpc:id="1073742928">
                    <bpws:assign name="SetErrorDetails9" wpc:displayName="Set Error Details" wpc:id="1103">
                      <bpws:copy>
                        <bpws:from><![CDATA[11016]]></bpws:from>
                        <bpws:to variable="transactionDetailPort">
                          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/Message/MessageCode]]></bpws:query>
                        </bpws:to>
                      </bpws:copy>
                      <bpws:copy>
                        <bpws:from><![CDATA[SDP_Downstream_System_Error]]></bpws:from>
                        <bpws:to variable="transactionDetailPort">
                          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/Message/MessageText]]></bpws:query>
                        </bpws:to>
                      </bpws:copy>
                      <bpws:copy>
                        <bpws:from>FATAL</bpws:from>
                        <bpws:to variable="transactionDetailPort">
                          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/Severity]]></bpws:query>
                        </bpws:to>
                      </bpws:copy>
                      <bpws:copy>
                        <bpws:from variable="scFault">
                          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[messageDetail]]></bpws:query>
                        </bpws:from>
                        <bpws:to variable="transactionDetailPort">
                          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[errorDetails/Error/Message/MessageDetail]]></bpws:query>
                        </bpws:to>
                      </bpws:copy>
                    </bpws:assign>
                    <bpws:invoke name="Handlesruntimefailures2" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="handles runtime failures" wpc:id="1106">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[transactionDetailPort.setBoolean("errorIndicator", true);
SdpLoggerHelper.logMessage(SdpLoggerHelper.RUNTIME_FAILURE+" MPS.CreateComponent",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);
SdpLoggerHelper.logBO(scFault,PROCESS_NAME,processID,SdpLoggerHelper.FATAL);

/*
SdpErrorHelper.setErrDetInTransDet(sdpOrderPort.getDataObject(SdpHelper.TRANSACTION_DETAIL),scFault,SdpErrorHelper.SEVERITY_FATAL);
SdpLoggerHelper.logMessage(SdpLoggerHelper.RUNTIME_FAILURE+" MPS.CreateComponent",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);

DataObject responseMessage = (DataObject)sdpOrderPort.getDataObject("transactionDetail/errorDetails/Error/Message");
responseMessage.setString(SdpHelper.ERRORDETAILS_MESSAGE_CODE,SdpErrorHelper.SDP_INTERNAL_SYSTEM_ERROR);
*/]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                    <bpws:invoke name="PrepareRollBack_SDP_ORDER9" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Prepare RollBack_SDP_ORDER" wpc:id="1108">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[boolean __result__1 = com.ibm.wbiservers.brules.core.codegen.NillableUtility.getList(com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(RollBack_SDP_ORDER, "order", "RollBack_SDP_ORDER"), "ReqService", "order"), "product", "ReqService"), "cvoipProduct", "product"), "accountMailBoxes", "RollBack_SDP_ORDER.order.ReqService.product.cvoipProduct").add(com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(RollBackMailBox, "RollBackMailBox"));
int __local__3 = CNMB_state.intValue();
com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(RollBack_SDP_ORDER, "transactionDetail", "RollBack_SDP_ORDER"), "tempStoreNonArray", "transactionDetail").setInt("temp11", __local__3);

//@generated:com.ibm.wbit.activity.ui
//<?xml version="1.0" encoding="UTF-8"?>
//<com.ibm.wbit.activity:CompositeActivity xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:com.ibm.wbit.activity="http:///com/ibm/wbit/activity.ecore" name="ActivityMethod">
//  <exceptions>
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="com.ibm.bpe.api.ProcessException"/>
//  </exceptions>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="RollBack_SDP_ORDER.order.ReqService.product.cvoipProduct.accountMailBoxes.add(RollBackMailBox)" assignable="false">
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="boolean"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="CNMB_state" variable="true">
//    <dataOutputs target="//@executableElements.2"/>
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="int" namespace="http://www.w3.org/2001/XMLSchema"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" dataInputs="//@executableElements.1/@dataOutputs.0" value="RollBack_SDP_ORDER.transactionDetail.tempStoreNonArray.temp11" field="true">
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="int" namespace="http://www.w3.org/2001/XMLSchema" nillable="false"/>
//  </executableElements>
//  <executableGroups executableElements="//@executableElements.0"/>
//  <executableGroups executableElements="//@executableElements.1 //@executableElements.2"/>
//</com.ibm.wbit.activity:CompositeActivity>
//@generated:end
//!SMAP!*S WBIACTDBG
//!SMAP!*L
//!SMAP!1:1,1
//!SMAP!3:2,2
//!SMAP!1000000:30,1]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                    <bpws:reply name="ReplyUCDCLError6" operation="CreateNewMailBox" partnerLink="FromMam_CreateNewMailBox_Interface" portType="ns2:FromMam_CreateNewMailBox_Interface" wpc:displayName="Reply UCDCL Error" wpc:id="1109">
                      <wpc:input>
                        <wpc:parameter name="Transaction_Detail" variable="transactionDetailPort"/>
                        <wpc:parameter name="SDP_ORDER_RequestPort" variable="RollBack_SDP_ORDER"/>
                        <wpc:parameter name="SDP_ORDER_ProvPort" variable="provSdpOrderProc"/>
                      </wpc:input>
                    </bpws:reply>
                    <bpws:terminate name="Terminate7" wpc:displayName="Terminate" wpc:id="1110"/>
                  </bpws:sequence>
                </bpws:catch>
              </bpws:invoke>
              <bpws:invoke name="LogMPSCreateComponentSuccess" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [MPS.CreateComponent -Success ]" wpc:id="588">
                <wpc:script>
                  <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage("WESM.CreateComponent : -"+SdpLoggerHelper.SUCCESS_STR,PROCESS_NAME,processID
														,SdpLoggerHelper.INFO);
SdpLoggerHelper.logMessage("Response BO [sdpOrder]",PROCESS_NAME,processID,SdpLoggerHelper.INFO);
SdpLoggerHelper.logMessage("sdpOrder:",PROCESS_NAME,processID,SdpLoggerHelper.INFO);														
SdpLoggerHelper.logBO(sdpOrderPort,PROCESS_NAME,processID,SdpLoggerHelper.INFO);
																		]]></wpc:javaCode>
                </wpc:script>
              </bpws:invoke>
              <bpws:assign name="ReInitializeCounter" wpc:displayName="Re-Initialize Counter" wpc:id="375">
                <bpws:copy>
                  <bpws:from>0</bpws:from>
                  <bpws:to variable="provLoopCounter"/>
                </bpws:copy>
              </bpws:assign>
              <bpws:switch name="NeedsupdateOrderforADLRemovedMbox" wpc:displayName="Needs updateOrder for ADLRemovedMbox?" wpc:id="1017">
                <bpws:case wpc:id="1018">
                  <bpws:condition><![CDATA[return ADLRemovedMbox != null;]]></bpws:condition>
                  <bpws:sequence name="HiddenSequence7" wpc:id="1073742952">
                    <bpws:invoke name="UpdateTNTNNameinADLRemovedMboxmboxMembers" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="update TN/TNName in ADLRemovedMbox &amp; mboxMembers" wpc:id="987">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[WpsLogger logger = WpsLogger.getLogger(processInstance());
DataObject reqADLRemovdMbox = null;
DataObject mailboxTN = null;
DataObject tmpMailboxTN = null;
DataObject memberProfile = null;
DataObject tmpMailbox = null;

String strInvariantId = null;
String strMPMboxInvariantId = null;

List lstMailboxTNs = null;
Iterator iterMailboxTNs = null;
List adlRemovedMboxTnList = null;
List lstMemberProfile = null;
Iterator itrMemberProfile = null;

List tmpLstMboxTNs = null;

com.ibm.websphere.bo.BOFactory factory = null;
commonj.sdo.DataObject memberTN = null;

String memberTNs_NameSpace = "http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_MemberTNS";
String memberTNs_Name = "SDP_MemberTNS"; 
String BOFactory = "com/ibm/websphere/bo/BOFactory"; 

strInvariantId = ADLRemovedMbox.getString(SdpHelper.CVOIP_MAILBOX_MAILBOXINVARIANTID);

reqADLRemovdMbox = SdpHelper.getMailBox(sdpOrderProc,strInvariantId);
adlRemovedMboxTnList = ADLRemovedMbox.getList(SdpHelper.VOIP_MAILBOXTNS);

if (reqADLRemovdMbox != null)
{
	//SdpLoggerHelper.logMessage("Updating the TNName in ADLRemovedMbox and mboxMembers",
	//	PROCESS_NAME,processID,SdpLoggerHelper.DEBUG);
	logger.debug("Updating the TNName in ADLRemovedMbox and mboxMembers");
	lstMailboxTNs = reqADLRemovdMbox.getList(SdpHelper.VOIP_MAILBOXTNS);
	
	if (lstMailboxTNs.size() > 0)
	{
		//iterMailboxTNs = lstMailboxTNs.iterator();
		
		//SdpLoggerHelper.logMessage("Getting the MailboxTNs from Request Mailbox",PROCESS_NAME,
		//	processID,SdpLoggerHelper.DEBUG);
		logger.debug("Getting the MailboxTNs from Request Mailbox");
		ADLRemovedMbox.setList(SdpHelper.VOIP_MAILBOXTNS,lstMailboxTNs);
		
		/*while(iterMailboxTNs.hasNext())
		{
			tmpMailboxTN = (DataObject) iterMailboxTNs.next();
			
			mailboxTN = SdpHelper.copySpecificBO(tmpMailboxTN);
			
			SdpLoggerHelper.logMessage("Calling MamMemberServiceHelper.updateMailboxTN()",
				PROCESS_NAME,processID,SdpLoggerHelper.DEBUG);
			
			MamMemberServiceHelper.updateMailboxTN(ADLRemovedMbox,mailboxTN);
						
			mailboxTN = SdpHelper.copySpecificBO(tmpMailboxTN);
			
			SdpLoggerHelper.logMessage("Calling MamMemberServiceHelper.updateMemberProfileMemberTName()",
				PROCESS_NAME,processID,SdpLoggerHelper.DEBUG);

			MamMemberServiceHelper.updateMemberProfileMemberTName(provSdpOrderProc,mailboxTN);			
		}*/ 
	}		
}
//Commenting the below code as fix for defect 163.Sending empty TN and tnName will cause issue in addCompCompAssociation API
/*else if (adlRemovedMboxTnList == null || adlRemovedMboxTnList.size() == 0)
{
	//SdpLoggerHelper.logMessage("ADLRemovedMbox TNList is empty and adding an emptyTN",
	//	PROCESS_NAME,processID,SdpLoggerHelper.DEBUG);
	logger.debug("ADLRemovedMbox TNList is empty and adding an emptyTN");
	factory = (com.ibm.websphere.bo.BOFactory)
	new com.ibm.websphere.sca.ServiceManager().locateService(BOFactory);
	
	memberTN = factory.create(memberTNs_NameSpace, memberTNs_Name);
	memberTN.setString("tn","");
	memberTN.setString("tnName","");
	ADLRemovedMbox.getList(SdpHelper.VOIP_MAILBOXTNS).add(memberTN);
}*/

lstMemberProfile = provSdpOrderProc.getList(SdpHelper.MEMBERPROFILE_LIST_PATH.replace('.','/'));
itrMemberProfile = lstMemberProfile.iterator();

while (itrMemberProfile.hasNext())
{
	memberProfile = (DataObject)itrMemberProfile.next();
	if (memberProfile != null)
	{
		strMPMboxInvariantId = memberProfile.getString(SdpHelper.MEMBERPROFILE_MAILBOXINVARIANTID);
		if (strMPMboxInvariantId != null && strMPMboxInvariantId.equalsIgnoreCase(strInvariantId))
		{
			tmpMailbox = SdpHelper.copySpecificBO(ADLRemovedMbox);
			tmpLstMboxTNs = tmpMailbox.getList(SdpHelper.VOIP_MAILBOXTNS);
			memberProfile.setList(SdpHelper.MEMBERPROFILE_MEMBER_TNS,tmpLstMboxTNs);
		}
	}
}
]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                    <bpws:invoke name="AssigntheADLRemovedMboxtosdpOrderForUpdate" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Assign the ADLRemovedMbox to sdpOrderForUpdate" wpc:id="296">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[Order order = new Order(sdpOrderForUpdate);
List lstMbox = order.getProductList(Product.CVOIPMAILBOX);
lstMbox.clear();

lstMbox.add(ADLRemovedMbox);]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                    <bpws:invoke name="AssignforMailboxTNs1" operation="null" partnerLink="null" portType="wpc:null" wpc:continueOnError="inherit" wpc:displayName="Assign for Mailbox TNs" wpc:id="1196">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[Order order = new Order(sdpOrderForUpdate);
WpsLogger logger = WpsLogger.getLogger(processInstance());
DataObject adlRemovedMBoxCopy = SDO.copy(ADLRemovedMbox);
DataObject mailboxForUpdate = order.getProduct(Product.CVOIPMAILBOX, 0);
if(mailboxForUpdate != null){
	List mailboxTnEmptyList = new java.util.ArrayList();
	mailboxForUpdate.setList(SdpHelper.VOIP_MAILBOXTNS,mailboxTnEmptyList);
	List mailboxTnList = adlRemovedMBoxCopy.getList(SdpHelper.VOIP_MAILBOXTNS);
	logger.info("mailboxTnList in adlRemovedMBox:"+mailboxTnList);
	if (mailboxTnList != null && mailboxTnList.size() > 0){
		//Changes made for 1502 Defect 29693.
		String customerSubType = order.getCustSubType();
		if (!SdpHelper.isBusinessCvoip(order)) {
			DataObject mailboxTNs = (DataObject)mailboxTnList.get(0);
			mailboxForUpdate.getList(SdpHelper.VOIP_MAILBOXTNS).add(mailboxTNs);
		}
		else {
			//for (int count=0; count<mailboxTnList.size(); count++) {
				//DataObject mailboxTNs = (DataObject)mailboxTnList.get(count);
				//mailboxForUpdate.getList(SdpHelper.VOIP_MAILBOXTNS).add(mailboxTNs);
				mailboxForUpdate.setList(SdpHelper.VOIP_MAILBOXTNS, mailboxTnList);
			//}
		}
	}
}]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                    <bpws:assign name="PreInvokeAssigns5" wpc:displayName="Pre-Invoke Assigns" wpc:id="41">
                      <bpws:copy>
                        <bpws:from variable="EmptyTransaction_Detail"/>
                        <bpws:to variable="transactionDetailPort"/>
                      </bpws:copy>
                      <bpws:copy>
                        <bpws:from>MPS.AssoicateMailboxTNs.request</bpws:from>
                        <bpws:to variable="transactionDetailPort">
                          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/State]]></bpws:query>
                        </bpws:to>
                      </bpws:copy>
                      <bpws:copy>
                        <bpws:from>MPS</bpws:from>
                        <bpws:to variable="transactionDetailPort">
                          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/TargetSystem]]></bpws:query>
                        </bpws:to>
                      </bpws:copy>
                      <bpws:copy>
                        <bpws:from>AssociateMailboxTNs</bpws:from>
                        <bpws:to variable="transactionDetailPort">
                          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/currentTargetOperation]]></bpws:query>
                        </bpws:to>
                      </bpws:copy>
                      <bpws:copy>
                        <bpws:from>MAILBOX</bpws:from>
                        <bpws:to variable="sdpOrderForUpdate">
                          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/currentProduct]]></bpws:query>
                        </bpws:to>
                      </bpws:copy>
                    </bpws:assign>
                    <bpws:invoke name="LogMPSUpdateOrder" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [MPS.UpdateOrder]" wpc:id="590">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage(SdpLoggerHelper.INVOKE_STR +" : MPS.AssociateMailboxTNs",PROCESS_NAME,processID
														,SdpLoggerHelper.INFO);
														
SdpLoggerHelper.logMessage("Request BO:[sdpOrder]",PROCESS_NAME,processID
														,SdpLoggerHelper.INFO);
SdpLoggerHelper.logMessage("sdpOrder:",PROCESS_NAME,processID
														,SdpLoggerHelper.INFO);

														
SdpLoggerHelper.logBO(sdpOrderForUpdate,PROCESS_NAME,processID,SdpLoggerHelper.INFO);
																		]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                    <bpws:invoke name="MPSAssociateMailboxTNs" operation="associateMailboxTNs" partnerLink="MPSCompensableService2_InterfacePartner" portType="ns22:MPSCompensableService2_Interface" wpc:displayName="MPS.Associate MailboxTNs" wpc:id="27">
                      <wpc:input>
                        <wpc:parameter name="order" variable="sdpOrderForUpdate"/>
                      </wpc:input>
                      <wpc:output/>
                      <bpws:catch faultName="ns22:serviceCallFault" faultVariable="scFault" wpc:faultType="java:ServiceCallFault" wpc:id="1188" wpc:variableId="85">
                        <bpws:sequence name="HiddenSequence3" wpc:id="1073742915">
                          <bpws:assign name="SetErrorDetails8" wpc:displayName="Set Error Details" wpc:id="1092">
                            <bpws:copy>
                              <bpws:from><![CDATA[11016]]></bpws:from>
                              <bpws:to variable="transactionDetailPort">
                                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/Message/MessageCode]]></bpws:query>
                              </bpws:to>
                            </bpws:copy>
                            <bpws:copy>
                              <bpws:from><![CDATA[SDP_Downstream_System_Error]]></bpws:from>
                              <bpws:to variable="transactionDetailPort">
                                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/Message/MessageText]]></bpws:query>
                              </bpws:to>
                            </bpws:copy>
                            <bpws:copy>
                              <bpws:from>FATAL</bpws:from>
                              <bpws:to variable="transactionDetailPort">
                                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/Severity]]></bpws:query>
                              </bpws:to>
                            </bpws:copy>
                            <bpws:copy>
                              <bpws:from variable="scFault">
                                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[messageDetail]]></bpws:query>
                              </bpws:from>
                              <bpws:to variable="transactionDetailPort">
                                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[errorDetails/Error/Message/MessageDetail]]></bpws:query>
                              </bpws:to>
                            </bpws:copy>
                          </bpws:assign>
                          <bpws:invoke name="Handlesruntimefailures1" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="handles runtime failures" wpc:id="404">
                            <wpc:script>
                              <wpc:javaCode><![CDATA[transactionDetailPort.setBoolean("errorIndicator", true);
SdpLoggerHelper.logMessage(SdpLoggerHelper.RUNTIME_FAILURE+" MPS.AssociateMailboxTNs",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);
SdpLoggerHelper.logBO(scFault,PROCESS_NAME,processID,SdpLoggerHelper.FATAL);

/*

SdpErrorHelper.setErrDetInTransDet(transactionDetailPort,bpcFault,SdpErrorHelper.SEVERITY_FATAL);
SdpLoggerHelper.logMessage(SdpLoggerHelper.RUNTIME_FAILURE+"  WESM.UpdateOrder",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);

DataObject responseMessage = (DataObject)transactionDetailPort.getDataObject("errorDetails/Error/Message");
responseMessage.setString(SdpHelper.ERRORDETAILS_MESSAGE_CODE,SdpErrorHelper.SDP_INTERNAL_SYSTEM_ERROR);
*/]]></wpc:javaCode>
                            </wpc:script>
                          </bpws:invoke>
                          <bpws:sequence name="HiddenSequence3" wpc:id="1073741879">
                            <bpws:invoke name="PrepareRollBack_SDP_ORDER1" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Prepare RollBack_SDP_ORDER" wpc:id="481">
                              <wpc:script>
                                <wpc:javaCode><![CDATA[boolean __result__1 = com.ibm.wbiservers.brules.core.codegen.NillableUtility.getList(com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(RollBack_SDP_ORDER, "order", "RollBack_SDP_ORDER"), "ReqService", "order"), "product", "ReqService"), "cvoipProduct", "product"), "accountMailBoxes", "RollBack_SDP_ORDER.order.ReqService.product.cvoipProduct").add(com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(RollBackMailBox, "RollBackMailBox"));
int __local__3 = CNMB_state.intValue();
com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(RollBack_SDP_ORDER, "transactionDetail", "RollBack_SDP_ORDER"), "tempStoreNonArray", "transactionDetail").setInt("temp11", __local__3);

//@generated:com.ibm.wbit.activity.ui
//<?xml version="1.0" encoding="UTF-8"?>
//<com.ibm.wbit.activity:CompositeActivity xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:com.ibm.wbit.activity="http:///com/ibm/wbit/activity.ecore" name="ActivityMethod">
//  <exceptions>
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="com.ibm.bpe.api.ProcessException"/>
//  </exceptions>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="RollBack_SDP_ORDER.order.ReqService.product.cvoipProduct.accountMailBoxes.add(RollBackMailBox)" assignable="false">
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="boolean"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="CNMB_state" variable="true">
//    <dataOutputs target="//@executableElements.2"/>
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="int" namespace="http://www.w3.org/2001/XMLSchema"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" dataInputs="//@executableElements.1/@dataOutputs.0" value="RollBack_SDP_ORDER.transactionDetail.tempStoreNonArray.temp11" field="true">
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="int" namespace="http://www.w3.org/2001/XMLSchema" nillable="false"/>
//  </executableElements>
//  <executableGroups executableElements="//@executableElements.0"/>
//  <executableGroups executableElements="//@executableElements.1 //@executableElements.2"/>
//</com.ibm.wbit.activity:CompositeActivity>
//@generated:end
//!SMAP!*S WBIACTDBG
//!SMAP!*L
//!SMAP!1:1,1
//!SMAP!3:2,2
//!SMAP!1000000:30,1]]></wpc:javaCode>
                              </wpc:script>
                            </bpws:invoke>
                            <bpws:reply name="ReplyUCDCLError5" operation="CreateNewMailBox" partnerLink="FromMam_CreateNewMailBox_Interface" portType="ns2:FromMam_CreateNewMailBox_Interface" wpc:displayName="Reply UCDCL Error" wpc:id="374">
                              <wpc:input>
                                <wpc:parameter name="Transaction_Detail" variable="transactionDetailPort"/>
                                <wpc:parameter name="SDP_ORDER_RequestPort" variable="RollBack_SDP_ORDER"/>
                                <wpc:parameter name="SDP_ORDER_ProvPort" variable="provSdpOrderProc"/>
                              </wpc:input>
                            </bpws:reply>
                            <bpws:terminate name="Terminate5" wpc:displayName="Terminate" wpc:id="522"/>
                          </bpws:sequence>
                        </bpws:sequence>
                      </bpws:catch>
                    </bpws:invoke>
                    <bpws:invoke name="LogMPSAssociateMailboxTNsSuccess" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [MPS.AssociateMailboxTNs -Success]" wpc:id="617">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage("MPS.AssociateMailboxTNs :-"+SdpLoggerHelper.SUCCESS_STR,PROCESS_NAME,processID
														,SdpLoggerHelper.INFO);
SdpLoggerHelper.logMessage("Response BO [TransactionDetailPort]",PROCESS_NAME,processID,SdpLoggerHelper.INFO);
SdpLoggerHelper.logMessage("TransactionDetailPort:",PROCESS_NAME,processID,SdpLoggerHelper.INFO);														
SdpLoggerHelper.logBO(transactionDetailPort,PROCESS_NAME,processID,SdpLoggerHelper.INFO);
																		]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                  </bpws:sequence>
                </bpws:case>
              </bpws:switch>
              <bpws:invoke name="UpdateRollBackMailBoxintoRollBack_SDP_ORDER" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Update RollBackMailBox into RollBack_SDP_ORDER" wpc:id="439">
                <wpc:script>
                  <wpc:javaCode><![CDATA[java.util.List __result__1 = com.ibm.wbiservers.brules.core.codegen.NillableUtility.getList(com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(RollBack_SDP_ORDER, "order", "RollBack_SDP_ORDER"), "ReqService", "order"), "product", "ReqService"), "cvoipProduct", "product"), "accountMailBoxes", "RollBack_SDP_ORDER.order.ReqService.product.cvoipProduct");
boolean __result__3;
{// add item to list
	__result__3 = __result__1.add(RollBackMailBox);
}

//@generated:com.ibm.wbit.activity.ui
//<?xml version="1.0" encoding="UTF-8"?>
//<com.ibm.wbit.activity:CompositeActivity xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:com.ibm.wbit.activity="http:///com/ibm/wbit/activity.ecore" name="ActivityMethod">
//  <exceptions>
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="com.ibm.bpe.api.ProcessException"/>
//  </exceptions>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="RollBack_SDP_ORDER.order.ReqService.product.cvoipProduct.accountMailBoxes" field="true">
//    <dataOutputs target="//@executableElements.2/@parameters.0"/>
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="java.util.List"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="RollBackMailBox" variable="true">
//    <dataOutputs target="//@executableElements.2/@parameters.1"/>
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="SDP_AccountMailBoxes" namespace="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_AccountMailBoxes"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:LibraryActivity" name="add item to list" description="Add the provided Object at the end of the list" category="list" template="&lt;%return%> &lt;%list%>.add(&lt;%object%>);">
//    <parameters name="list" dataInputs="//@executableElements.0/@dataOutputs.0" displayName="list">
//      <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="java.util.List"/>
//    </parameters>
//    <parameters name="object" dataInputs="//@executableElements.1/@dataOutputs.0" displayName="object">
//      <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="java.lang.Object"/>
//    </parameters>
//    <result name="added" displayName="added">
//      <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="boolean"/>
//    </result>
//  </executableElements>
//  <executableGroups executableElements="//@executableElements.0 //@executableElements.1 //@executableElements.2"/>
//</com.ibm.wbit.activity:CompositeActivity>
//@generated:end
//!SMAP!*S WBIACTDBG
//!SMAP!*L
//!SMAP!1:1,1
//!SMAP!3:2,4
//!SMAP!1000000:40,1]]></wpc:javaCode>
                </wpc:script>
              </bpws:invoke>
              <bpws:assign name="Preinvokeassigns9" wpc:displayName="Preinvoke assigns" wpc:id="928">
                <bpws:copy>
                  <bpws:from variable="EmptyTransaction_Detail"/>
                  <bpws:to variable="transactionDetailPort"/>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from>UCDCL.Logout.Request</bpws:from>
                  <bpws:to variable="transactionDetailPort">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/State]]></bpws:query>
                  </bpws:to>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from>UCDCL</bpws:from>
                  <bpws:to variable="transactionDetailPort">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/TargetSystem]]></bpws:query>
                  </bpws:to>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from>Logout</bpws:from>
                  <bpws:to variable="transactionDetailPort">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/currentTargetOperation]]></bpws:query>
                  </bpws:to>
                </bpws:copy>
              </bpws:assign>
              <bpws:invoke name="LogUCDCLLogout" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UCDCL.Logout]" wpc:id="775">
                <wpc:script>
                  <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage(SdpLoggerHelper.INVOKE_STR +" : UCDCL.Logout",PROCESS_NAME,processID
														,SdpLoggerHelper.INFO);]]></wpc:javaCode>
                </wpc:script>
              </bpws:invoke>
              <bpws:invoke name="InvokeUCDCLLogout" operation="provisioningServiceLogout" partnerLink="UCDCL_CompensableService_Interface" portType="ns23:UCDCLCompensableService_Interface" wpc:displayName="Invoke - UCDCL.Logout" wpc:id="773">
                <wpc:input>
                  <wpc:parameter name="transactionDetail" variable="processTransDetail"/>
                </wpc:input>
                <wpc:output/>
                <bpws:catch faultName="wpc:runtimeFailure" faultVariable="bpcFault" wpc:faultType="wpc:BPCStandardFaultType" wpc:id="1175" wpc:variableId="786">
                  <bpws:invoke name="HandleRuntimeFailure4" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Handle Run time Failure" wpc:id="793">
                    <wpc:script>
                      <wpc:javaCode><![CDATA[SdpErrorHelper.setErrDetInTransDet(transactionDetailPort,bpcFault,SdpErrorHelper.SEVERITY_FATAL);

SdpLoggerHelper.logMessage(SdpLoggerHelper.RUNTIME_FAILURE+" UCDCL.Logout",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);

]]></wpc:javaCode>
                    </wpc:script>
                  </bpws:invoke>
                </bpws:catch>
                <bpws:catch faultName="ns23:serviceCallFault" faultVariable="scFault" wpc:faultType="java:ServiceCallFault" wpc:id="1176" wpc:variableId="787">
                  <bpws:invoke name="SetErrorDetails4" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Set Error Details" wpc:id="790">
                    <wpc:script>
                      <wpc:javaCode><![CDATA[transactionDetailPort.setBoolean(SdpHelper.ERRORINDICATOR,true);

new att.lightspeed.sdp.helper.TransactionDetail(transactionDetailPort).setSDPErrorMessage(scFault);

transactionDetailPort.getDataObject("errorDetails").getDataObject("Error").setString("Severity",SdpErrorHelper.SEVERITY_FATAL);

 
SdpLoggerHelper.logMessage(SdpLoggerHelper.FAULT_FAILURE +"   UCDCL.Logout",PROCESS_NAME,processID,SdpLoggerHelper.FATAL); 
 ]]></wpc:javaCode>
                    </wpc:script>
                  </bpws:invoke>
                </bpws:catch>
                <bpws:catchAll wpc:id="1174">
                  <bpws:invoke name="Handleotherfailures2" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="handle other failures" wpc:id="796">
                    <wpc:script>
                      <wpc:javaCode><![CDATA[SdpErrorHelper.setErrDetInTransDet(transactionDetailPort,null,SdpErrorHelper.SEVERITY_FATAL);
SdpLoggerHelper.logMessage(SdpLoggerHelper.UNKNOWN_FAILURE+" UCDCL.Logout",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);]]></wpc:javaCode>
                    </wpc:script>
                  </bpws:invoke>
                </bpws:catchAll>
              </bpws:invoke>
              <bpws:switch name="ErrorinLogout" wpc:displayName="Error in Logout?" wpc:id="776">
                <bpws:case wpc:id="777">
                  <bpws:condition><![CDATA[return transactionDetailPort.getBoolean(SdpHelper.ERRORINDICATOR);]]></bpws:condition>
                  <bpws:sequence name="HiddenSequence15" wpc:id="1073742953">
                    <bpws:invoke name="LogUCDCLLogoutError" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UCDCL.Logout - Error]" wpc:id="779">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[String strSeverity =transactionDetailPort.getString("errorDetails/Error/Severity");
int logLevel = SdpHelper.getLogLevel(strSeverity);
SdpLoggerHelper.logMessage("Returning : UCDCL.Logout - "+SdpLoggerHelper.ERROR_STR+"["+strSeverity+"]",PROCESS_NAME,processID,logLevel);]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                    <bpws:invoke name="SeterrorIndicatorfalse" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Set errorIndicator = false" wpc:id="1135">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[transactionDetailPort.setBoolean(SdpHelper.ERRORINDICATOR,false);]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                  </bpws:sequence>
                </bpws:case>
                <bpws:otherwise wpc:id="1189">
                  <bpws:invoke name="LogUCDCLLogoutSuccess" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UCDCL.Logout - Success]" wpc:id="781">
                    <wpc:script>
                      <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage("Returning : UCDCL.Logout -"+SdpLoggerHelper.SUCCESS_STR,PROCESS_NAME,processID
														,SdpLoggerHelper.INFO);																		]]></wpc:javaCode>
                    </wpc:script>
                  </bpws:invoke>
                </bpws:otherwise>
              </bpws:switch>
            </bpws:sequence>
          </bpws:case>
        </bpws:switch>
        <bpws:invoke name="IncrementListCounter" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Increment List Counter" wpc:id="133">
          <wpc:script>
            <wpc:javaCode><![CDATA[java.lang.Integer __result__1 = new java.lang.Integer(com.ibm.wbiservers.brules.core.codegen.NillableUtility.getInt(intListCounter, "intListCounter") + 1);
intListCounter = __result__1;

//@generated:com.ibm.wbit.activity.ui
//<?xml version="1.0" encoding="UTF-8"?>
//<com.ibm.wbit.activity:CompositeActivity xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:com.ibm.wbit.activity="http:///com/ibm/wbit/activity.ecore" name="ActivityMethod">
//  <exceptions>
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="com.ibm.bpe.api.ProcessException"/>
//  </exceptions>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="intListCounter + 1" assignable="false">
//    <dataOutputs target="//@executableElements.1"/>
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="int" namespace="http://www.w3.org/2001/XMLSchema"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" dataInputs="//@executableElements.0/@dataOutputs.0" value="intListCounter" variable="true">
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="int" namespace="http://www.w3.org/2001/XMLSchema"/>
//  </executableElements>
//  <executableGroups executableElements="//@executableElements.0 //@executableElements.1"/>
//</com.ibm.wbit.activity:CompositeActivity>
//@generated:end
//!SMAP!*S WBIACTDBG
//!SMAP!*L
//!SMAP!1:1,1
//!SMAP!2:2,1
//!SMAP!1000000:25,1]]></wpc:javaCode>
          </wpc:script>
        </bpws:invoke>
      </bpws:sequence>
    </bpws:while>
    <bpws:assign name="CopyProctoTrig" wpc:displayName="Copy Proc to Trig" wpc:id="525">
      <bpws:copy>
        <bpws:from variable="RollBack_SDP_ORDER"/>
        <bpws:to variable="sdpOrderTrig"/>
      </bpws:copy>
      <bpws:copy>
        <bpws:from variable="provSdpOrderProc"/>
        <bpws:to variable="provSdpOrderTrig"/>
      </bpws:copy>
    </bpws:assign>
    <bpws:invoke name="SetUMMessageCenterIPinreturnBO" operation="null" partnerLink="null" portType="wpc:null" wpc:continueOnError="inherit" wpc:displayName="Set UMMessageCenterIP in returnBO" wpc:id="1152">
      <wpc:script>
        <wpc:javaCode><![CDATA[att.lightspeed.sdp.helper.WpsLogger logger = att.lightspeed.sdp.helper.WpsLogger.getLogger(processInstance());
logger.debug("UMMessageCenterIP from the CreateNewMailbox flow: " + UMMessageCenterIP);
sdpOrderTrig.setString(SdpHelper.xPathify(SdpHelper.TRANSDETAIL_UMMESSAGECENTERIP_PATH),UMMessageCenterIP);]]></wpc:javaCode>
      </wpc:script>
    </bpws:invoke>
    <bpws:invoke name="LogEndProcess1" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [End Process] " wpc:id="594">
      <wpc:script>
        <wpc:javaCode><![CDATA[
SdpLoggerHelper.logMessage("Returning the following GBO To MAM ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("transactionDetail : ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(transactionDetailPort,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("sdpOrder : ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(sdpOrderTrig,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("SdpOrder : ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(provSdpOrderTrig,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("End SubFlow: CreateNewMailBox",PROCESS_NAME,processID,SdpLoggerHelper.INFO);]]></wpc:javaCode>
      </wpc:script>
    </bpws:invoke>
    <bpws:reply name="Reply" operation="CreateNewMailBox" partnerLink="FromMam_CreateNewMailBox_Interface" portType="ns2:FromMam_CreateNewMailBox_Interface" wpc:displayName="Reply" wpc:id="7">
      <wpc:input>
        <wpc:parameter name="SDP_ORDER_ProvPort" variable="provSdpOrderTrig"/>
        <wpc:parameter name="Transaction_Detail" variable="transactionDetailPort"/>
        <wpc:parameter name="SDP_ORDER_RequestPort" variable="sdpOrderTrig"/>
      </wpc:input>
    </bpws:reply>
  </bpws:sequence>
</bpws:process>