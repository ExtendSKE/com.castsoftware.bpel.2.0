<?xml version="1.0" encoding="UTF-8"?><bpws:process xmlns:bpws="http://schemas.xmlsoap.org/ws/2004/03/business-process/" xmlns:java="http://SdpCommonLibrary" xmlns:ns="http://MamMemberServiceModule/com/att/sdp/bprocess/UpdateMailBoxConfigArtifacts" xmlns:ns0="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_Order" xmlns:ns1="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_TransactionDetail" xmlns:ns10="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_Error" xmlns:ns11="http://MamMemberServicesProcessModule/com/att/sdp/intf/To_WESM_Local" xmlns:ns12="http://MamMemberServicesProcessModule/com/att/sdp/intf/Local_To_WESM" xmlns:ns13="http://MamMemberServicesProcessModule/com/att/sdp/intf/FromMam_CreateNewMailBox_Interface" xmlns:ns14="http://MamMemberServicesProcessModule/com/att/sdp/intf/FromMam_DeleteMailBox_Interface" xmlns:ns15="http://MamMemberServicesProcessModule/com/att/sdp/intf/FromMam_UpdateMailBox_Interface" xmlns:ns16="http://SdpCommonLibrary/com/att/sdp/intf/ToUCDCL_SubscriberService_Interface" xmlns:ns17="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_PersonName" xmlns:ns18="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_Person" xmlns:ns19="http://SdpCommonLibrary/com/att/sdp/intf/FromSdp_ErrorLogger_Interface" xmlns:ns2="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_MemberProfile" xmlns:ns20="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_AccountMailBoxes" xmlns:ns21="http://MamMemberServiceModule/com/att/sdp/bprocess" xmlns:ns22="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_MemberTNS" xmlns:ns23="http://SdpCommonLibrary/com/att/sdp/intf/ToMps_MemberServices_Interface" xmlns:ns24="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_ServiceCvoipSettings" xmlns:ns25="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_MailBoxMembers" xmlns:ns26="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_Temp" xmlns:ns27="http://MamMemberServicesProcessModule/com/att/sdp/intf/CreateNewMailBox_Compensation_Interface" xmlns:ns28="http://MamMemberServicesProcessModule/com/att/sdp/intf/DeleteMailBox_Compensation_Interface" xmlns:ns29="http://MamMemberServicesProcessModule/com/att/sdp/intf/UpdateMailBox_Compensation_Interface" xmlns:ns3="http://SdpCommonLibrary/com/att/sdp/intf/FromMam_FeaturePermissionMailboxUpdate_Interface" xmlns:ns30="http://SdpCommonLibrary/com/att/sdp/intf/FromSdp_CommonErrorLogger_Interface" xmlns:ns31="http://MamMemberServicesProcessModule/com/att/sdp/intf/UpdateMailBoxConfig_Compensation_Interface" xmlns:ns32="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_LineSubComponent" xmlns:ns33="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_ProcessContext" xmlns:ns34="http://SdpCommonLibrary/com/att/sdp/intf/UcdclOutputServiceWrapper_Interface" xmlns:ns35="http://SdpCommonLibrary/com/att/sdp/intf/MPSCompensableService2_Interface" xmlns:ns36="http://SdpCommonLibrary/com/att/sdp/intf/ErrorLogger_Interface" xmlns:ns37="http://SdpCommonLibrary/com/att/sdp/intf/UCDCLCompensableService_Interface" xmlns:ns38="http://SdpCommonLibrary/com/att/sdp/intf/SDPOrderDBCompensableService_Interface" xmlns:ns4="http://SdpCommonLibrary/com/att/sdp/intf/To_WESM" xmlns:ns5="http://SdpCommonLibrary/com/att/sdp/intf/ToSdp_ErrorLogger_Interface" xmlns:ns6="http://SdpCommonLibrary/com/att/sdp/intf/ToUCDCL_ProvisioningService_Interface" xmlns:ns7="http://MamMembserServicesProcessModule/com/att/sdp/intf/To_WESM" xmlns:ns8="http://MamMemberServicesProcessModule/com/att/sdp/intf/To_WESM" xmlns:ns9="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_ErrorObject_Message" xmlns:wpc="http://www.ibm.com/xmlns/prod/websphere/business-process/6.0.0/" xmlns:xsd="http://www.w3.org/2001/XMLSchema" expressionLanguage="http://www.ibm.com/xmlns/prod/websphere/business-process/expression-lang/java/6.0.0/" name="UpdateMailBoxConfig" suppressJoinFailure="yes" targetNamespace="http://MamMemberServiceModule/com/att/sdp/bprocess" wpc:displayName="UpdateMailBoxConfig" wpc:executionMode="microflow" wpc:id="1" wpc:version="8.5.0">
  <wpc:javaGlobals>
    <wpc:import packages="sbc.lightspeed.sdp.wps.SdpErrorHelper"/>
    <wpc:import packages="sbc.lightspeed.sdp.wps.SdpHelper"/>
    <wpc:import packages="sbc.lightspeed.sdp.wps.SdpLoggerHelper"/>
    <wpc:import packages="commonj.sdo.DataObject"/>
    <wpc:import packages="java.util.List"/>
    <wpc:import packages="java.util.Iterator"/>
    <wpc:import packages="att.lightspeed.sdp.helper.Product"/>
    <wpc:import packages="att.lightspeed.sdp.helper.Order"/>
    <wpc:import packages="att.lightspeed.sdp.helper.CvoipConfig"/>
    <wpc:import packages="att.lightspeed.sdp.helper.SDO"/>
    <wpc:import packages="javax.xml.namespace.QName"/>
    <wpc:import packages="att.lightspeed.sdp.helper.TransactionDetail"/>
    <wpc:import packages="att.lightspeed.sdp.helper.PropertyReadException"/>
    <wpc:import packages="att.lightspeed.sdp.helper.WpsLogger"/>
    <wpc:import packages="com.att.sdp.db.SPPMailboxDBService"/>
    <wpc:import packages="java.sql.SQLException"/>
    <wpc:import packages="java.util.ArrayList"/>
    <wpc:import packages="att.lightspeed.sdp.helper.StdProcessLogger"/>
    <wpc:import packages="att.lightspeed.sdp.helper.Status"/>
  </wpc:javaGlobals>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../../../../../../../../../resource/SdpCommonLibrary/com/att/sdp/intf/FromMam_FeaturePermissionMailboxUpdate_Interface.wsdl" namespace="http://SdpCommonLibrary/com/att/sdp/intf/FromMam_FeaturePermissionMailboxUpdate_Interface"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../../SdpCommonLibrary/SDP_Order.xsd" namespace="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_Order"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../../SdpCommonLibrary/SDP_MemberProfile.xsd" namespace="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_MemberProfile"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../../SdpCommonLibrary/SDP_TransactionDetail.xsd" namespace="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_TransactionDetail"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="UpdateMailBoxConfigArtifacts.wsdl" namespace="http://MamMemberServiceModule/com/att/sdp/bprocess/UpdateMailBoxConfigArtifacts"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../../../../../SdpCommonLibrary/com/att/sdp/intf/To_WESM.wsdl" namespace="http://SdpCommonLibrary/com/att/sdp/intf/To_WESM"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../../SdpCommonLibrary/BPCStandardFaultType.xsd" namespace="http://www.ibm.com/xmlns/prod/websphere/business-process/6.0.0/"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../../../../../SdpCommonLibrary/com/att/sdp/intf/ToSdp_ErrorLogger_Interface.wsdl" namespace="http://SdpCommonLibrary/com/att/sdp/intf/ToSdp_ErrorLogger_Interface"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../../../../../SdpCommonLibrary/com/att/sdp/intf/SDP_Order_to_UCDCL_ProvisioningService.wsdl" namespace="http://SdpCommonLibrary/com/att/sdp/intf/ToUCDCL_ProvisioningService_Interface"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../../../../../MamMemberServicesProcessModule_Old/com/att/sdp/intf/To_WESM.wsdl" namespace="http://MamMembserServicesProcessModule/com/att/sdp/intf/To_WESM"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../../SdpCommonLibrary/SDP_ErrorObject_Message.xsd" namespace="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_ErrorObject_Message"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../../SdpCommonLibrary/SDP_Error.xsd" namespace="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_Error"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../../../../../MamMemberServicesProcessModule_Old/com/att/sdp/intf/To_WESM_Local.wsdl" namespace="http://MamMemberServicesProcessModule/com/att/sdp/intf/To_WESM_Local"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../../../../../MamMemberServicesProcessModule_Old/com/att/sdp/intf/Local_To_WESM.wsdl" namespace="http://MamMemberServicesProcessModule/com/att/sdp/intf/Local_To_WESM"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../../../../../MamMemberServicesProcessModule_Old/com/att/sdp/intf/FromMam_CreateNewMailBox_Interface.wsdl" namespace="http://MamMemberServicesProcessModule/com/att/sdp/intf/FromMam_CreateNewMailBox_Interface"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../../../../../MamMemberServicesProcessModule_Old/com/att/sdp/intf/FromMam_UpdateMailBox_Interface.wsdl" namespace="http://MamMemberServicesProcessModule/com/att/sdp/intf/FromMam_UpdateMailBox_Interface"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../../../../../MamMemberServicesProcessModule_Old/com/att/sdp/intf/FromMam_DeleteMailBox_Interface.wsdl" namespace="http://MamMemberServicesProcessModule/com/att/sdp/intf/FromMam_DeleteMailBox_Interface"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../../../../../SdpCommonLibrary/com/att/sdp/intf/SDP_Order_to_UCDCL_SubscriberService.wsdl" namespace="http://SdpCommonLibrary/com/att/sdp/intf/ToUCDCL_SubscriberService_Interface"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../../SdpCommonLibrary/SDP_PersonName.xsd" namespace="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_PersonName"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../../SdpCommonLibrary/SDP_Person.xsd" namespace="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_Person"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../../../../../SdpCommonLibrary/com/att/sdp/intf/FromSdp_ErrorLogger_Interface.wsdl" namespace="http://SdpCommonLibrary/com/att/sdp/intf/FromSdp_ErrorLogger_Interface"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../../SdpCommonLibrary/SDP_AccountMailBoxes.xsd" namespace="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_AccountMailBoxes"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../../../../../SdpCommonLibrary/FromMam_FeaturePermissionMailboxUpdate_Interface.wsdl" namespace="http://SdpCommonLibrary/com/att/sdp/intf/FromMam_FeaturePermissionMailboxUpdate_Interface"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../../SdpCommonLibrary/SDP_MemberTNS.xsd" namespace="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_MemberTNS"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../../../../../SdpCommonLibrary/com/att/sdp/intf/ToMps_MemberServices_Interface.wsdl" namespace="http://SdpCommonLibrary/com/att/sdp/intf/ToMps_MemberServices_Interface"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../../SdpCommonLibrary/SDP_ServiceCvoipSettings.xsd" namespace="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_ServiceCvoipSettings"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../../SdpCommonLibrary/SDP_MailBoxMembers.xsd" namespace="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_MailBoxMembers"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../../../../../SdpCommonLibrary/com/att/sdp/intf/FromMam_FeaturePermissionMailboxUpdate_Interface.wsdl" namespace="http://SdpCommonLibrary/com/att/sdp/intf/FromMam_FeaturePermissionMailboxUpdate_Interface"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../../SdpCommonLibrary/SDP_Temp.xsd" namespace="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_Temp"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../../../../../MamMemberServicesProcessModule_Old/com/att/sdp/intf/CreateNewMailBox_Compensation_Interface.wsdl" namespace="http://MamMemberServicesProcessModule/com/att/sdp/intf/CreateNewMailBox_Compensation_Interface"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../../../../../MamMemberServicesProcessModule_Old/com/att/sdp/intf/DeleteMailBox_Compensation_Interface.wsdl" namespace="http://MamMemberServicesProcessModule/com/att/sdp/intf/DeleteMailBox_Compensation_Interface"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../../../../../MamMemberServicesProcessModule_Old/com/att/sdp/intf/UpdateMailBox_Compensation_Interface.wsdl" namespace="http://MamMemberServicesProcessModule/com/att/sdp/intf/UpdateMailBox_Compensation_Interface"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../../../../../SdpCommonLibrary/FromSdp_CommonErrorLogger_Interface.wsdl" namespace="http://SdpCommonLibrary/com/att/sdp/intf/FromSdp_CommonErrorLogger_Interface"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../../../../../MamMemberServicesProcessModule_Old/com/att/sdp/intf/FromMam_CreateNewMailBox_Interface.wsdl" namespace="http://MamMemberServicesProcessModule/com/att/sdp/intf/FromMam_CreateNewMailBox_Interface"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../../../../../MamMemberServicesProcessModule_Old/com/att/sdp/intf/FromMam_DeleteMailBox_Interface.wsdl" namespace="http://MamMemberServicesProcessModule/com/att/sdp/intf/FromMam_DeleteMailBox_Interface"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../../../../../MamMemberServicesProcessModule_Old/com/att/sdp/intf/FromMam_UpdateMailBox_Interface.wsdl" namespace="http://MamMemberServicesProcessModule/com/att/sdp/intf/FromMam_UpdateMailBox_Interface"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../../../../../MamMemberServicesProcessModule_Old/com/att/sdp/intf/UpdateMailBoxConfig_Compensation_Interface.wsdl" namespace="http://MamMemberServicesProcessModule/com/att/sdp/intf/UpdateMailBoxConfig_Compensation_Interface"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../../../../../MamMemberServicesProcessModule_Old/com/att/sdp/intf/FromMam_CreateNewMailBox_Interface.wsdl" namespace="http://MamMemberServicesProcessModule/com/att/sdp/intf/FromMam_CreateNewMailBox_Interface"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../../../../../MamMemberServicesProcessModule_Old/com/att/sdp/intf/FromMam_UpdateMailBox_Interface.wsdl" namespace="http://MamMemberServicesProcessModule/com/att/sdp/intf/FromMam_UpdateMailBox_Interface"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../../../../../MamMemberServicesProcessModule_Old/com/att/sdp/intf/FromMam_DeleteMailBox_Interface.wsdl" namespace="http://MamMemberServicesProcessModule/com/att/sdp/intf/FromMam_DeleteMailBox_Interface"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../../../../../MamMemberServicesProcessModule_Old/com/att/sdp/intf/FromMam_DeleteMailBox_Interface.wsdl" namespace="http://MamMemberServicesProcessModule/com/att/sdp/intf/FromMam_DeleteMailBox_Interface"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../../../../../MamMemberServicesProcessModule_Old/com/att/sdp/intf/FromMam_UpdateMailBox_Interface.wsdl" namespace="http://MamMemberServicesProcessModule/com/att/sdp/intf/FromMam_UpdateMailBox_Interface"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../../../../../MamMemberServicesProcessModule_Old/com/att/sdp/intf/FromMam_CreateNewMailBox_Interface.wsdl" namespace="http://MamMemberServicesProcessModule/com/att/sdp/intf/FromMam_CreateNewMailBox_Interface"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../../../../../MamMemberServicesProcessModule_Old/com/att/sdp/intf/FromMam_CreateNewMailBox_Interface.wsdl" namespace="http://MamMemberServicesProcessModule/com/att/sdp/intf/FromMam_CreateNewMailBox_Interface"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../../../../../MamMemberServicesProcessModule_Old/com/att/sdp/intf/FromMam_UpdateMailBox_Interface.wsdl" namespace="http://MamMemberServicesProcessModule/com/att/sdp/intf/FromMam_UpdateMailBox_Interface"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../../../../../MamMemberServicesProcessModule_Old/com/att/sdp/intf/FromMam_DeleteMailBox_Interface.wsdl" namespace="http://MamMemberServicesProcessModule/com/att/sdp/intf/FromMam_DeleteMailBox_Interface"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../../../../../MamMemberServicesProcessModuleTemp/com/att/sdp/intf/UpdateMailBoxConfig_Compensation_Interface.wsdl" namespace="http://MamMemberServicesProcessModule/com/att/sdp/intf/UpdateMailBoxConfig_Compensation_Interface"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../../../../../MamMemberServicesProcessModuleTemp/com/att/sdp/intf/FromMam_CreateNewMailBox_Interface.wsdl" namespace="http://MamMemberServicesProcessModule/com/att/sdp/intf/FromMam_CreateNewMailBox_Interface"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../../../../../MamMemberServicesProcessModuleTemp/com/att/sdp/intf/FromMam_UpdateMailBox_Interface.wsdl" namespace="http://MamMemberServicesProcessModule/com/att/sdp/intf/FromMam_UpdateMailBox_Interface"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../../../../../MamMemberServicesProcessModuleTemp/com/att/sdp/intf/FromMam_DeleteMailBox_Interface.wsdl" namespace="http://MamMemberServicesProcessModule/com/att/sdp/intf/FromMam_DeleteMailBox_Interface"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../intf/FromMam_UpdateMailBox_Interface.wsdl" namespace="http://MamMemberServicesProcessModule/com/att/sdp/intf/FromMam_UpdateMailBox_Interface"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../intf/FromMam_CreateNewMailBox_Interface.wsdl" namespace="http://MamMemberServicesProcessModule/com/att/sdp/intf/FromMam_CreateNewMailBox_Interface"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../intf/FromMam_DeleteMailBox_Interface.wsdl" namespace="http://MamMemberServicesProcessModule/com/att/sdp/intf/FromMam_DeleteMailBox_Interface"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../intf/UpdateMailBoxConfig_Compensation_Interface.wsdl" namespace="http://MamMemberServicesProcessModule/com/att/sdp/intf/UpdateMailBoxConfig_Compensation_Interface"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../../SdpCommonLibrary/SDP_LineSubComponent.xsd" namespace="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_LineSubComponent"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../SDP_MailBoxMembers.xsd" namespace="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_MailBoxMembers"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../SDP_MemberProfile.xsd" namespace="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_MemberProfile"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../BPCStandardFaultType.xsd" namespace="http://www.ibm.com/xmlns/prod/websphere/business-process/6.0.0/"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../SDP_AccountMailBoxes.xsd" namespace="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_AccountMailBoxes"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../SDP_Person.xsd" namespace="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_Person"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../SDP_ServiceCvoipSettings.xsd" namespace="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_ServiceCvoipSettings"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../intf/FromMam_FeaturePermissionMailboxUpdate_Interface.wsdl" namespace="http://SdpCommonLibrary/com/att/sdp/intf/FromMam_FeaturePermissionMailboxUpdate_Interface"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../intf/To_WESM.wsdl" namespace="http://SdpCommonLibrary/com/att/sdp/intf/To_WESM"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../intf/SDP_Order_to_UCDCL_SubscriberService.wsdl" namespace="http://SdpCommonLibrary/com/att/sdp/intf/ToUCDCL_SubscriberService_Interface"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../SDP_Order.xsd" namespace="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_Order"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../intf/ToMps_MemberServices_Interface.wsdl" namespace="http://SdpCommonLibrary/com/att/sdp/intf/ToMps_MemberServices_Interface"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../SDP_LineSubComponent.xsd" namespace="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_LineSubComponent"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../SDP_Error.xsd" namespace="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_Error"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../SDP_ErrorObject_Message.xsd" namespace="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_ErrorObject_Message"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../SDP_Temp.xsd" namespace="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_Temp"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../SDP_MemberTNS.xsd" namespace="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_MemberTNS"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../SDP_TransactionDetail.xsd" namespace="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_TransactionDetail"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../SDP_PersonName.xsd" namespace="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_PersonName"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../../../../FromSdp_CommonErrorLogger_Interface.wsdl" namespace="http://SdpCommonLibrary/com/att/sdp/intf/FromSdp_CommonErrorLogger_Interface"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../intf/SDP_Order_to_UCDCL_ProvisioningService.wsdl" namespace="http://SdpCommonLibrary/com/att/sdp/intf/ToUCDCL_ProvisioningService_Interface"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../SDP_ProcessContext.xsd" namespace="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_ProcessContext"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../intf/UcdclOutputServiceWrapper_Interface.wsdl" namespace="http://SdpCommonLibrary/com/att/sdp/intf/UcdclOutputServiceWrapper_Interface"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="/resource/SdpCommonLibrary/com/att/sdp/intf/MPSCompensableService2_Interface.wsdl" namespace="http://SdpCommonLibrary/com/att/sdp/intf/MPSCompensableService2_Interface"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../intf/MPSCompensableService2_Interface.wsdl" namespace="http://SdpCommonLibrary/com/att/sdp/intf/MPSCompensableService2_Interface"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../ServiceCallFault.xsd" namespace="http://SdpCommonLibrary"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../intf/ErrorLogger_Interface.wsdl" namespace="http://SdpCommonLibrary/com/att/sdp/intf/ErrorLogger_Interface"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../BasicFault.xsd" namespace="http://SdpCommonLibrary"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../intf/UCDCLCompensableService_Interface.wsdl" namespace="http://SdpCommonLibrary/com/att/sdp/intf/UCDCLCompensableService_Interface"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../intf/SDPOrderDBCompensableService_Interface.wsdl" namespace="http://SdpCommonLibrary/com/att/sdp/intf/SDPOrderDBCompensableService_Interface"/>
  <bpws:partnerLinks>
    <bpws:partnerLink myRole="FromMam_FeaturePermissionMailboxUpdate_InterfaceRole" name="FromMam_FeaturePermissionMailboxUpdate_Interface" partnerLinkType="ns:FromMam_FeaturePermissionMailboxUpdate_InterfacePLT" wpc:id="2975"/>
    <bpws:partnerLink name="FromMam_DeleteMailBox_Interface" partnerLinkType="ns:FromMam_DeleteMailBox_InterfaceLT" partnerRole="FromMam_DeleteMailBox_InterfaceRole" wpc:id="2976"/>
    <bpws:partnerLink name="FromMam_CreateNewMailBox_Interface" partnerLinkType="ns:FromMam_CreateNewMailBox_InterfaceLT" partnerRole="FromMam_CreateNewMailBox_InterfaceRole" wpc:id="2977"/>
    <bpws:partnerLink name="FromMam_UpdateMailBox_Interface" partnerLinkType="ns:PartnerPLT6" partnerRole="partnerRole" wpc:id="2978"/>
    <bpws:partnerLink name="UpdateMailBoxConfig_Compensation_Interface" partnerLinkType="ns:PartnerPLT7" partnerRole="partnerRole" wpc:id="2979"/>
    <bpws:partnerLink name="UcdclCompensableService_Interface" partnerLinkType="ns:PartnerPLT9" partnerRole="partnerRole" wpc:id="2980"/>
    <bpws:partnerLink name="MPSCompensableService2_InterfacePartner" partnerLinkType="ns:MPSCompensableService2_InterfacePLT" partnerRole="MPSCompensableService2_InterfaceRole" wpc:id="2981"/>
    <bpws:partnerLink name="ErrorLogger_InterfacePartner" partnerLinkType="ns:PartnerPLT1" partnerRole="partnerRole" wpc:id="2982"/>
    <bpws:partnerLink myRole="Interface" name="SDPOrderDBCompensableService_InterfacePartner" partnerLinkType="ns:SDPPLT" wpc:id="2983"/>
    <bpws:partnerLink name="SDPOrderDBCompensableService" partnerLinkType="ns:SDPOrderDBCompensableServicePLT" partnerRole="Reference" wpc:id="2984"/>
  </bpws:partnerLinks>
  <bpws:variables>
    <bpws:variable name="MailboxConfigRequest_Trig" type="ns0:SDP_Order" wpc:id="2"/>
    <bpws:variable name="TransactionResponse" type="ns1:SDP_TransactionDetail" wpc:id="3"/>
    <bpws:variable name="MailboxConfigResponse" type="ns2:SDP_MemberProfile" wpc:id="4"/>
    <bpws:variable name="MailboxConfig_Proc" type="ns0:SDP_Order" wpc:id="8"/>
    <bpws:variable name="TrasationDetail_Port" type="ns1:SDP_TransactionDetail" wpc:id="16"/>
    <bpws:variable name="SDP_ORDER_Port" type="ns0:SDP_Order" wpc:id="187"/>
    <bpws:variable name="SDP_ORDER_Prov" type="ns0:SDP_Order" wpc:id="215"/>
    <bpws:variable name="ucdclPersonName" type="ns17:SDP_PersonName" wpc:id="225"/>
    <bpws:variable name="ucdclPerson" type="ns18:SDP_Person" wpc:id="235"/>
    <bpws:variable name="iterator" type="xsd:int" wpc:id="298"/>
    <bpws:variable name="emptyTransactionDetail" type="ns1:SDP_TransactionDetail" wpc:id="300"/>
    <bpws:variable name="emptySDPOrder" type="ns0:SDP_Order" wpc:id="301"/>
    <bpws:variable name="reqMBox" type="ns20:SDP_AccountMailBoxes" wpc:id="425"/>
    <bpws:variable name="provMBox" type="ns20:SDP_AccountMailBoxes" wpc:id="429"/>
    <bpws:variable name="SDP_ORDER_GrpMBoxInfoPort" type="ns0:SDP_Order" wpc:id="681"/>
    <bpws:variable name="SDP_ORDER_GrpMBoxInfoProc" type="ns0:SDP_Order" wpc:id="682"/>
    <bpws:variable name="intReqCounter" type="xsd:int" wpc:id="688"/>
    <bpws:variable name="intProvCounter" type="xsd:int" wpc:id="689"/>
    <bpws:variable name="intMBoxCounter" type="xsd:int" wpc:id="780"/>
    <bpws:variable name="indexChangedMBoxList" type="ns24:SDP_ServiceCvoipSettings" wpc:id="781"/>
    <bpws:variable name="bpcFault" type="wpc:BPCStandardFaultType" wpc:id="788"/>
    <bpws:variable name="tmpMemProf" type="ns2:SDP_MemberProfile" wpc:id="1032"/>
    <bpws:variable name="tmpMBox" type="ns20:SDP_AccountMailBoxes" wpc:id="1035"/>
    <bpws:variable name="tmpServiceCVoiPSettings" type="ns24:SDP_ServiceCvoipSettings" wpc:id="1041"/>
    <bpws:variable name="intCounter" type="xsd:int" wpc:id="1055"/>
    <bpws:variable name="accountMailBox" type="ns20:SDP_AccountMailBoxes" wpc:id="1068"/>
    <bpws:variable name="sdp_Temp" type="ns26:SDP_Temp" wpc:id="1099"/>
    <bpws:variable name="blnUpdateSubscriber" type="xsd:boolean" wpc:id="1124"/>
    <bpws:variable name="SDP_ORDER_ForUpdate" type="ns0:SDP_Order" wpc:id="1271"/>
    <bpws:variable name="MailboxConfig_Prov" type="ns0:SDP_Order" wpc:id="1286"/>
    <bpws:variable name="SDP_ORDER_RequestPort" type="ns0:SDP_Order" wpc:id="1289"/>
    <bpws:variable name="SDP_ORDER_ProvPort" type="ns0:SDP_Order" wpc:id="1290"/>
    <bpws:variable name="HappyPathState" type="xsd:int" wpc:id="1432"/>
    <bpws:variable name="CreateRequestState" type="ns0:SDP_Order" wpc:id="1463"/>
    <bpws:variable name="CreateProvstate" type="ns0:SDP_Order" wpc:id="1464"/>
    <bpws:variable name="DeleteRequestState" type="ns0:SDP_Order" wpc:id="1474"/>
    <bpws:variable name="DeleteProvState" type="ns0:SDP_Order" wpc:id="1475"/>
    <bpws:variable name="STATE" type="xsd:string" wpc:id="1488"/>
    <bpws:variable name="SEVERITY" type="xsd:string" wpc:id="1489"/>
    <bpws:variable name="SDP_ERROR_OBJECT_MESSAGE" type="ns9:SDP_ErrorObject_Message" wpc:id="1490"/>
    <bpws:variable name="MANUAL_INTERVENTION_FLAG" type="xsd:boolean" wpc:id="1491"/>
    <bpws:variable name="PARENT_PROCESS_NAME" type="xsd:string" wpc:id="1492"/>
    <bpws:variable name="TARGET_OPERATION_NAME" type="xsd:string" wpc:id="1493"/>
    <bpws:variable name="TARGET_SYSTEM_NAME" type="xsd:string" wpc:id="1494"/>
    <bpws:variable name="PROCESS_NAME" type="xsd:string" wpc:id="1497"/>
    <bpws:variable name="SOURCE_SYSTEM" type="xsd:string" wpc:id="1498"/>
    <bpws:variable name="UpdateRequestState" type="ns0:SDP_Order" wpc:id="1560"/>
    <bpws:variable name="UpdateProvState" type="ns0:SDP_Order" wpc:id="1561"/>
    <bpws:variable name="boolIndexChanged" type="xsd:boolean" wpc:id="1825"/>
    <bpws:variable name="boolPinChanged" type="xsd:boolean" wpc:id="1826"/>
    <bpws:variable name="IndexChangeUpdateState" type="ns0:SDP_Order" wpc:id="2107"/>
    <bpws:variable name="SetSubscriberSettingsBySub" type="ns0:SDP_Order" wpc:id="2125"/>
    <bpws:variable name="PinChangeUpdateState" type="ns0:SDP_Order" wpc:id="2128"/>
    <bpws:variable name="TnChangeUpdateState" type="ns0:SDP_Order" wpc:id="2135"/>
    <bpws:variable name="AddServiceState" type="ns0:SDP_Order" wpc:id="2143"/>
    <bpws:variable name="RemoveServiceState" type="ns0:SDP_Order" wpc:id="2144"/>
    <bpws:variable name="PinChangeCounter" type="xsd:int" wpc:id="2153"/>
    <bpws:variable name="processID" type="xsd:string" wpc:id="2355"/>
    <bpws:variable name="tmp1MBox" type="ns20:SDP_AccountMailBoxes" wpc:id="2411"/>
    <bpws:variable name="loginId" type="xsd:string" wpc:id="2504"/>
    <bpws:variable name="SDP_Order_Prov_Updated" type="ns0:SDP_Order" wpc:id="2566"/>
    <bpws:variable name="UpdateSubscriberInput" type="ns0:SDP_Order" wpc:id="2569"/>
    <bpws:variable name="secondaryMemberIdNotMatching" type="xsd:boolean" wpc:id="2601"/>
    <bpws:variable name="mailboxIndex" type="xsd:int" wpc:id="2616"/>
    <bpws:variable name="tmpSdpOrder_ForCopy" type="ns0:SDP_Order" wpc:id="2620"/>
    <bpws:variable name="lineSubComponent" type="ns32:SDP_LineSubComponent" wpc:id="2669"/>
    <bpws:variable name="sdpProcessContext" type="ns33:SDP_ProcessContext" wpc:id="2811"/>
    <bpws:variable name="UMSessionID" type="xsd:string" wpc:id="2812"/>
    <bpws:variable name="basicFault" type="java:BasicFault" wpc:id="2852"/>
    <bpws:variable name="processBO" type="ns0:SDP_Order" wpc:id="2941"/>
    <bpws:variable name="processTransDetail" type="ns1:SDP_TransactionDetail" wpc:id="2942"/>
    <bpws:variable name="UMMessageCenterIP" type="xsd:string" wpc:id="2960"/>
    <bpws:variable name="invalidRequest" type="xsd:boolean" wpc:id="2962"/>
    <bpws:variable name="ptlPresentInMainMB" type="xsd:boolean" wpc:id="2963"/>
    <bpws:variable name="serviceCallFaultVar" type="java:ServiceCallFault" wpc:id="2972"/>
    <bpws:variable name="validationErrorMessage" type="xsd:string" wpc:id="3031"/>
    <bpws:variable name="invalidInput" type="xsd:boolean" wpc:id="3033"/>
    <bpws:variable name="customerSubType" type="xsd:string" wpc:id="3037"/>
  </bpws:variables>
  <bpws:sequence name="HiddenSequence" wpc:id="1073741829">
    <bpws:pick createInstance="yes" name="ReceiveChoice" wpc:displayName="ReceiveChoice" wpc:id="188">
      <bpws:onMessage operation="UpdateAccessRights" partnerLink="FromMam_FeaturePermissionMailboxUpdate_Interface" portType="ns3:FromMam_FeaturePermissionMailboxUpdate_Interface" wpc:id="2985">
        <wpc:output>
          <wpc:parameter name="accessRightsRequest" variable="MailboxConfig_Proc"/>
        </wpc:output>
        <bpws:reply name="ReplyToMam" operation="UpdateAccessRights" partnerLink="FromMam_FeaturePermissionMailboxUpdate_Interface" portType="ns3:FromMam_FeaturePermissionMailboxUpdate_Interface" wpc:displayName="Reply To Mam" wpc:id="193">
          <wpc:input>
            <wpc:parameter name="accessRightsResponse" variable="TransactionResponse"/>
          </wpc:input>
        </bpws:reply>
      </bpws:onMessage>
      <bpws:onMessage operation="UpdateMailboxConfig" partnerLink="FromMam_FeaturePermissionMailboxUpdate_Interface" portType="ns3:FromMam_FeaturePermissionMailboxUpdate_Interface" wpc:id="2986">
        <wpc:output>
          <wpc:parameter name="mailboxConfigRequest" variable="MailboxConfigRequest_Trig"/>
        </wpc:output>
        <bpws:sequence name="HiddenSequence2" wpc:id="1073742013">
          <bpws:invoke name="LogBeginProcess" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [Begin Process]" wpc:id="2354">
            <wpc:script>
              <wpc:javaCode><![CDATA[processID = SdpLoggerHelper.getProcessID();
PROCESS_NAME = "UpdateMailBoxConfig";


SdpLoggerHelper.logMessage("Begin : UpdateMailBoxConfig",PROCESS_NAME,processID,SdpLoggerHelper.INFO);
SdpLoggerHelper.logMessage("Received the following GBO From MAM ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("MailboxConfigRequest_Trig :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(MailboxConfigRequest_Trig,PROCESS_NAME,processID,SdpLoggerHelper.INFO);
]]></wpc:javaCode>
            </wpc:script>
          </bpws:invoke>
          <bpws:scope name="Scope" wpc:displayName="Scope" wpc:id="2849">
            <bpws:faultHandlers>
              <bpws:catch faultVariable="basicFault" wpc:faultType="java:BasicFault" wpc:id="2996" wpc:variableId="2853">
                <bpws:sequence name="HiddenSequence21" wpc:id="1073744680">
                  <bpws:invoke name="SetError" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Set Error" wpc:id="2855">
                    <wpc:script>
                      <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage("EmailAddressDomain CvoipConfig info is not available",PROCESS_NAME,processID,SdpLoggerHelper.ERROR);

DataObject errorMsgObj = null;
Order order = new Order(MailboxConfigRequest_Trig);
TransactionDetail transDet = order.getTransactionDetail();

errorMsgObj = SDO.createServiceCallFault();
errorMsgObj.setString("messageType", getCurrentFaultAsException().getFaultName());
errorMsgObj.setString("targetSystem", "WPS");
errorMsgObj.setString("messageText", basicFault.getString("messageText"));
errorMsgObj.setString("messageDetail", "EmailAddressDomain CvoipConfig info is not available");
errorMsgObj.setString("sdpCode", basicFault.getString("sdpCode"));		

transDet.setSDPErrorMessage(errorMsgObj);]]></wpc:javaCode>
                    </wpc:script>
                  </bpws:invoke>
                  <bpws:reply name="Reply2" operation="UpdateMailboxConfig" partnerLink="FromMam_FeaturePermissionMailboxUpdate_Interface" portType="ns3:FromMam_FeaturePermissionMailboxUpdate_Interface" wpc:displayName="Reply" wpc:id="2862">
                    <wpc:input>
                      <wpc:parameter name="mailboxConfigResponse" variable="MailboxConfigRequest_Trig"/>
                    </wpc:input>
                  </bpws:reply>
                  <bpws:terminate name="End" wpc:displayName="End" wpc:id="2863"/>
                </bpws:sequence>
              </bpws:catch>
            </bpws:faultHandlers>
            <bpws:invoke name="CheckforCvoipConfigparam" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Check for CvoipConfig param" wpc:id="2851">
              <wpc:script>
                <wpc:javaCode><![CDATA[
try {
    CvoipConfig.instance().getEmailAddressDomain();
} catch (PropertyReadException prEx)
{
	SdpLoggerHelper.logMessage(prEx.getMessage(),PROCESS_NAME,processID,SdpLoggerHelper.ERROR);
	basicFault = SDO.createBasicFault(SdpErrorHelper.SDP_INTERNAL_SYSTEM_ERROR, "EmailAddressDomain CvoipConfig info is not available");
	raiseFault(new QName("http://SdpCommonLibrary","BasicFault"),"basicFault");
}]]></wpc:javaCode>
              </wpc:script>
            </bpws:invoke>
          </bpws:scope>
          <bpws:assign name="CopyTrigtoProc" wpc:displayName="Copy Trig to Proc" wpc:id="9">
            <bpws:copy>
              <bpws:from variable="MailboxConfigRequest_Trig"/>
              <bpws:to variable="MailboxConfig_Proc"/>
            </bpws:copy>
          </bpws:assign>
          <bpws:assign name="ASSIGNVARIABLESCONSTANTS" wpc:displayName="ASSIGN VARIABLES &amp; CONSTANTS" wpc:id="1495">
            <bpws:copy>
              <bpws:from>UpdateMailBoxConfig</bpws:from>
              <bpws:to variable="PARENT_PROCESS_NAME"/>
            </bpws:copy>
            <bpws:copy>
              <bpws:from>false</bpws:from>
              <bpws:to variable="MANUAL_INTERVENTION_FLAG"/>
            </bpws:copy>
            <bpws:copy>
              <bpws:from>MAM</bpws:from>
              <bpws:to variable="SOURCE_SYSTEM"/>
            </bpws:copy>
            <bpws:copy>
              <bpws:from>false</bpws:from>
              <bpws:to variable="boolIndexChanged"/>
            </bpws:copy>
            <bpws:copy>
              <bpws:from>false</bpws:from>
              <bpws:to variable="boolPinChanged"/>
            </bpws:copy>
            <bpws:copy>
              <bpws:from>DEFAULT</bpws:from>
              <bpws:to variable="CreateRequestState">
                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/tempStoreNonArray/temp1]]></bpws:query>
              </bpws:to>
            </bpws:copy>
            <bpws:copy>
              <bpws:from>DEFAULT</bpws:from>
              <bpws:to variable="DeleteRequestState">
                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/tempStoreNonArray/temp1]]></bpws:query>
              </bpws:to>
            </bpws:copy>
            <bpws:copy>
              <bpws:from>DEFAULT</bpws:from>
              <bpws:to variable="UpdateRequestState">
                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/tempStoreNonArray/temp1]]></bpws:query>
              </bpws:to>
            </bpws:copy>
            <bpws:copy>
              <bpws:from>DEFAULT</bpws:from>
              <bpws:to variable="SDP_ORDER_GrpMBoxInfoPort">
                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/tempStoreNonArray/temp1]]></bpws:query>
              </bpws:to>
            </bpws:copy>
            <bpws:copy>
              <bpws:from>DEFAULT</bpws:from>
              <bpws:to variable="SetSubscriberSettingsBySub">
                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/tempStoreNonArray/temp1]]></bpws:query>
              </bpws:to>
            </bpws:copy>
            <bpws:copy>
              <bpws:from>DEFAULT</bpws:from>
              <bpws:to variable="PinChangeUpdateState">
                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/tempStoreNonArray/temp1]]></bpws:query>
              </bpws:to>
            </bpws:copy>
            <bpws:copy>
              <bpws:from>DEFAULT</bpws:from>
              <bpws:to variable="TnChangeUpdateState">
                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/tempStoreNonArray/temp1]]></bpws:query>
              </bpws:to>
            </bpws:copy>
            <bpws:copy>
              <bpws:from>DEFAULT</bpws:from>
              <bpws:to variable="AddServiceState">
                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/tempStoreNonArray/temp1]]></bpws:query>
              </bpws:to>
            </bpws:copy>
            <bpws:copy>
              <bpws:from>DEFAULT</bpws:from>
              <bpws:to variable="RemoveServiceState">
                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/tempStoreNonArray/temp1]]></bpws:query>
              </bpws:to>
            </bpws:copy>
            <bpws:copy>
              <bpws:from>DEFAULT</bpws:from>
              <bpws:to variable="MailboxConfig_Proc">
                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/tempStoreNonArray/temp1]]></bpws:query>
              </bpws:to>
            </bpws:copy>
            <bpws:copy>
              <bpws:from variable="MailboxConfig_Proc"/>
              <bpws:to variable="IndexChangeUpdateState"/>
            </bpws:copy>
            <bpws:copy>
              <bpws:from variable="MailboxConfigRequest_Trig">
                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/ProcessContext]]></bpws:query>
              </bpws:from>
              <bpws:to variable="sdpProcessContext"/>
            </bpws:copy>
          </bpws:assign>
          <bpws:invoke name="ClearRollBackObject" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Clear RollBack Object" wpc:id="2187">
            <wpc:script>
              <wpc:javaCode><![CDATA[com.ibm.wbiservers.brules.core.codegen.NillableUtility.getList(com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(IndexChangeUpdateState, "order", "IndexChangeUpdateState"), "ReqService", "order"), "product", "ReqService"), "cvoipProduct", "product"), "accountMailBoxes", "IndexChangeUpdateState.order.ReqService.product.cvoipProduct").clear();

//@generated:com.ibm.wbit.activity.ui
//<?xml version="1.0" encoding="UTF-8"?>
//<com.ibm.wbit.activity:CompositeActivity xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:com.ibm.wbit.activity="http:///com/ibm/wbit/activity.ecore" name="ActivityMethod">
//  <exceptions>
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="com.ibm.bpe.api.ProcessException"/>
//  </exceptions>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="IndexChangeUpdateState.order.ReqService.product.cvoipProduct.accountMailBoxes.clear()" assignable="false">
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="void"/>
//  </executableElements>
//  <executableGroups executableElements="//@executableElements.0"/>
//</com.ibm.wbit.activity:CompositeActivity>
//@generated:end
//!SMAP!*S WBIACTDBG
//!SMAP!*L
//!SMAP!1:1,1
//!SMAP!1000000:19,1]]></wpc:javaCode>
            </wpc:script>
          </bpws:invoke>
          <bpws:assign name="SetProcessNameandSourceSystem" wpc:displayName="Set Process Name and Source System" wpc:id="202">
            <bpws:copy>
              <bpws:from variable="PROCESS_NAME"/>
              <bpws:to variable="MailboxConfig_Proc">
                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/processName]]></bpws:query>
              </bpws:to>
            </bpws:copy>
            <bpws:copy>
              <bpws:from>100</bpws:from>
              <bpws:to variable="HappyPathState"/>
            </bpws:copy>
            <bpws:copy>
              <bpws:from variable="PARENT_PROCESS_NAME"/>
              <bpws:to variable="MailboxConfig_Proc">
                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/parentProcessName]]></bpws:query>
              </bpws:to>
            </bpws:copy>
            <bpws:copy>
              <bpws:from variable="SOURCE_SYSTEM"/>
              <bpws:to variable="MailboxConfig_Proc">
                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/errorDetails/Error/SourceSystem]]></bpws:query>
              </bpws:to>
            </bpws:copy>
          </bpws:assign>
          <bpws:assign name="CreateemptyTransactionDetailandSDPOrderBO" wpc:displayName="Create empty Transaction Detail and SDP Order BO" wpc:id="208">
            <bpws:copy>
              <bpws:from>
                <bpws:expression expressionLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[bo:create('http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_TransactionDetail','SDP_TransactionDetail')]]></bpws:expression>
              </bpws:from>
              <bpws:to variable="emptyTransactionDetail"/>
            </bpws:copy>
            <bpws:copy>
              <bpws:from>
                <bpws:expression expressionLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[bo:create('http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_Order','SDP_Order')]]></bpws:expression>
              </bpws:from>
              <bpws:to variable="emptySDPOrder"/>
            </bpws:copy>
            <bpws:copy>
              <bpws:from variable="HappyPathState"/>
              <bpws:to variable="MailboxConfig_Proc">
                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/tempStoreNonArray/temp11]]></bpws:query>
              </bpws:to>
            </bpws:copy>
            <bpws:copy>
              <bpws:from>0</bpws:from>
              <bpws:to variable="MailboxConfig_Proc">
                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/tempStoreNonArray/temp10]]></bpws:query>
              </bpws:to>
            </bpws:copy>
            <bpws:copy>
              <bpws:from>null</bpws:from>
              <bpws:to variable="MailboxConfig_Proc">
                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/errorDetails/Error/Message/SdpCode]]></bpws:query>
              </bpws:to>
            </bpws:copy>
            <bpws:copy>
              <bpws:from variable="MailboxConfig_Proc">
                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail]]></bpws:query>
              </bpws:from>
              <bpws:to variable="emptyTransactionDetail"/>
            </bpws:copy>
            <bpws:copy>
              <bpws:from variable="emptyTransactionDetail"/>
              <bpws:to variable="processBO">
                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[transactionDetail]]></bpws:query>
              </bpws:to>
            </bpws:copy>
          </bpws:assign>
          <bpws:invoke name="SetupMPSValues" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Setup MPS Values" wpc:id="61">
            <wpc:script>
              <wpc:javaCode><![CDATA[
// R7 Filter Setting not required
/*
com.att.sdp.utility.ContentFilterCreator __result__1 = new com.att.sdp.utility.ContentFilterCreator();
com.att.sdp.utility.ContentFilterCreator tempContentFilter = __result__1;
java.lang.String __result__4 = sbc.lightspeed.sdp.wps.SdpHelper.CUST_MEMBERID;
java.lang.String __result__5 = sbc.lightspeed.sdp.wps.SdpHelper.CUST_MEMBERID_PATH;
tempContentFilter.addSelectFilter(__result__4, __result__5);
commonj.sdo.DataObject __result__8 = tempContentFilter.createFilters();
MailboxConfig_Proc.getDataObject("transactionDetail").set("contentFilter", __result__8);
*/

Order pOrder = new Order(MailboxConfig_Proc);
 (pOrder.getTransactionDetail()).setIteratorStep(0);

]]></wpc:javaCode>
            </wpc:script>
          </bpws:invoke>
          <bpws:assign name="PreInvokeAssigns" wpc:displayName="Pre-Invoke Assigns" wpc:id="10">
            <bpws:copy>
              <bpws:from variable="emptyTransactionDetail"/>
              <bpws:to variable="SDP_ORDER_Port">
                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail]]></bpws:query>
              </bpws:to>
            </bpws:copy>
            <bpws:copy>
              <bpws:from>MPS.RetrieveUser.request</bpws:from>
              <bpws:to variable="SDP_ORDER_Port">
                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/State]]></bpws:query>
              </bpws:to>
            </bpws:copy>
            <bpws:copy>
              <bpws:from>MPS</bpws:from>
              <bpws:to variable="SDP_ORDER_Port">
                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/errorDetails/Error/TargetSystem]]></bpws:query>
              </bpws:to>
            </bpws:copy>
            <bpws:copy>
              <bpws:from>RetrieveUser</bpws:from>
              <bpws:to variable="SDP_ORDER_Port">
                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/currentTargetOperation]]></bpws:query>
              </bpws:to>
            </bpws:copy>
          </bpws:assign>
          <bpws:invoke name="LogMPSRetrieveUser" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [ MPS.RetrieveUser]" wpc:id="2194">
            <wpc:script>
              <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage(SdpLoggerHelper.INVOKE_STR +" : MPS.RetrieveUser",PROCESS_NAME,processID
														,SdpLoggerHelper.INFO);
														
SdpLoggerHelper.logMessage("Request BO:[SDP_ORDER]",PROCESS_NAME,processID
														,SdpLoggerHelper.INFO);
SdpLoggerHelper.logMessage("MailboxConfig_Proc:",PROCESS_NAME,processID
														,SdpLoggerHelper.INFO);

														
SdpLoggerHelper.logBO(MailboxConfig_Proc,PROCESS_NAME,processID,SdpLoggerHelper.INFO);
																		]]></wpc:javaCode>
            </wpc:script>
          </bpws:invoke>
          <bpws:invoke name="RetrieveBANNumberfromMPS" operation="retrieveUser" partnerLink="MPSCompensableService2_InterfacePartner" portType="ns35:MPSCompensableService2_Interface" wpc:displayName="Retrieve BAN Number from MPS" wpc:id="15">
            <wpc:input>
              <wpc:parameter name="order" variable="MailboxConfig_Proc"/>
            </wpc:input>
            <wpc:output>
              <wpc:parameter name="returnOrder" variable="SDP_ORDER_Port"/>
            </wpc:output>
            <bpws:catch faultName="ns35:serviceCallFault" faultVariable="scFault" wpc:faultType="java:ServiceCallFault" wpc:id="2987" wpc:variableId="789">
              <bpws:sequence name="HiddenSequence1" wpc:id="1073741848">
                <bpws:assign name="MergeMPSerrortoProcobject" wpc:displayName="Merge MPS error to Proc object" wpc:id="2826">
                  <wpc:description> %wf:variable.MailboxConfig_Proc\\transactionDetail/errorDetails/Error/Message/MessageDetail% </wpc:description>
                  <bpws:copy>
                    <bpws:from>11016</bpws:from>
                    <bpws:to variable="MailboxConfig_Proc">
                      <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/errorDetails/Error/Message/MessageCode]]></bpws:query>
                    </bpws:to>
                  </bpws:copy>
                  <bpws:copy>
                    <bpws:from>SDP_Downstream_System_Error</bpws:from>
                    <bpws:to variable="MailboxConfig_Proc">
                      <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/errorDetails/Error/Message/MessageText]]></bpws:query>
                    </bpws:to>
                  </bpws:copy>
                  <bpws:copy>
                    <bpws:from>FAULT</bpws:from>
                    <bpws:to variable="MailboxConfig_Proc">
                      <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/errorDetails/Error/Severity]]></bpws:query>
                    </bpws:to>
                  </bpws:copy>
                  <bpws:copy>
                    <bpws:from variable="scFault">
                      <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[messageDetail]]></bpws:query>
                    </bpws:from>
                    <bpws:to variable="MailboxConfig_Proc">
                      <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[transactionDetail/errorDetails/Error/Message/MessageDetail]]></bpws:query>
                    </bpws:to>
                  </bpws:copy>
                </bpws:assign>
                <bpws:assign name="MergerProctoTrig" wpc:displayName="Merger Proc to Trig" wpc:id="302">
                  <bpws:copy>
                    <bpws:from variable="MailboxConfig_Proc"/>
                    <bpws:to variable="MailboxConfigRequest_Trig"/>
                  </bpws:copy>
                </bpws:assign>
                <bpws:invoke name="LogEndProcess17" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [End Process]" wpc:id="2447">
                  <wpc:script>
                    <wpc:javaCode><![CDATA[
SdpLoggerHelper.logMessage("MPS.queryUser fault:",PROCESS_NAME,processID,SdpLoggerHelper.ERROR);

SdpLoggerHelper.logBO(scFault,PROCESS_NAME,processID,SdpLoggerHelper.ERROR);

SdpLoggerHelper.logMessage("Returning the following GBO To MAM ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("Provisioned [MailboxConfigRequest_Trig ]: ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(MailboxConfigRequest_Trig,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("End - UpdateMailBoxConfig",PROCESS_NAME,processID,SdpLoggerHelper.INFO);]]></wpc:javaCode>
                  </wpc:script>
                </bpws:invoke>
                <bpws:reply name="ReplyMPSError1" operation="UpdateMailboxConfig" partnerLink="FromMam_FeaturePermissionMailboxUpdate_Interface" portType="ns3:FromMam_FeaturePermissionMailboxUpdate_Interface" wpc:displayName="Reply MPS Error" wpc:id="105">
                  <wpc:input>
                    <wpc:parameter name="mailboxConfigResponse" variable="MailboxConfigRequest_Trig"/>
                  </wpc:input>
                </bpws:reply>
                <bpws:terminate name="Terminate4" wpc:displayName="Terminate4" wpc:id="1593"/>
              </bpws:sequence>
            </bpws:catch>
          </bpws:invoke>
          <bpws:switch name="UserNotFound" wpc:displayName="User Not Found?" wpc:id="2827">
            <bpws:case wpc:id="2828">
              <bpws:condition expressionLanguage="http://www.ibm.com/xmlns/prod/websphere/business-process/expression-lang/java/6.0.0/"><![CDATA[return new Order(SDP_ORDER_Port).getTransactionDetail().isNoRecordsFound();
]]></bpws:condition>
              <bpws:sequence name="HiddenSequence9" wpc:id="1073744654">
                <bpws:assign name="MergeMPSerrortoProcobject1" wpc:displayName="Merge MPS error to Proc object" wpc:id="2829">
                  <bpws:copy>
                    <bpws:from>HSMWS0001W</bpws:from>
                    <bpws:to variable="MailboxConfig_Proc">
                      <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/errorDetails/Error/Message/MessageCode]]></bpws:query>
                    </bpws:to>
                  </bpws:copy>
                  <bpws:copy>
                    <bpws:from>Primary_MemberID_Not_Found</bpws:from>
                    <bpws:to variable="MailboxConfig_Proc">
                      <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/errorDetails/Error/Message/MessageText]]></bpws:query>
                    </bpws:to>
                  </bpws:copy>
                  <bpws:copy>
                    <bpws:from>FAULT</bpws:from>
                    <bpws:to variable="MailboxConfig_Proc">
                      <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/errorDetails/Error/Severity]]></bpws:query>
                    </bpws:to>
                  </bpws:copy>
                  <bpws:copy>
                    <bpws:from variable="SDP_ORDER_Port">
                      <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[transactionDetail/errorDetails/Error/Message/MessageDetail]]></bpws:query>
                    </bpws:from>
                    <bpws:to variable="MailboxConfig_Proc">
                      <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[transactionDetail/errorDetails/Error/Message/MessageDetail]]></bpws:query>
                    </bpws:to>
                  </bpws:copy>
                </bpws:assign>
                <bpws:assign name="MergerProctoTrig3" wpc:displayName="Merger Proc to Trig" wpc:id="2831">
                  <bpws:copy>
                    <bpws:from variable="MailboxConfig_Proc"/>
                    <bpws:to variable="MailboxConfigRequest_Trig"/>
                  </bpws:copy>
                </bpws:assign>
                <bpws:invoke name="LogEndProcess1" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [End Process]" wpc:id="2833">
                  <wpc:script>
                    <wpc:javaCode><![CDATA[
SdpLoggerHelper.logMessage("MPS.queryUser user not found:",PROCESS_NAME,processID,SdpLoggerHelper.ERROR);

SdpLoggerHelper.logMessage("Returning the following GBO To MAM ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("Provisioned [MailboxConfigRequest_Trig ]: ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(MailboxConfigRequest_Trig,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("End - UpdateMailBoxConfig",PROCESS_NAME,processID,SdpLoggerHelper.INFO);]]></wpc:javaCode>
                  </wpc:script>
                </bpws:invoke>
                <bpws:reply name="ReplyMPSError7" operation="UpdateMailboxConfig" partnerLink="FromMam_FeaturePermissionMailboxUpdate_Interface" portType="ns3:FromMam_FeaturePermissionMailboxUpdate_Interface" wpc:displayName="Reply MPS Error" wpc:id="2834">
                  <wpc:input>
                    <wpc:parameter name="mailboxConfigResponse" variable="MailboxConfigRequest_Trig"/>
                  </wpc:input>
                </bpws:reply>
                <bpws:terminate name="Terminate6" wpc:displayName="Terminate4" wpc:id="2835"/>
              </bpws:sequence>
            </bpws:case>
          </bpws:switch>
          <bpws:assign name="Postinvokeassigns3" wpc:displayName="post invoke assigns" wpc:id="1533">
            <bpws:copy>
              <bpws:from variable="SDP_ORDER_Port">
                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail]]></bpws:query>
              </bpws:from>
              <bpws:to variable="TrasationDetail_Port"/>
            </bpws:copy>
          </bpws:assign>
          <bpws:invoke name="LogMPSRetrieveUserSuccess" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [MPS.RetrieveUser -Success ]" wpc:id="2360">
            <wpc:script>
              <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage("MPS.RetrieveUser :-"+SdpLoggerHelper.SUCCESS_STR,PROCESS_NAME,processID
														,SdpLoggerHelper.INFO);
SdpLoggerHelper.logMessage("Response BO [SDP_ORDER]",PROCESS_NAME,processID,SdpLoggerHelper.INFO);
SdpLoggerHelper.logMessage("SDP_ORDER_Port:",PROCESS_NAME,processID,SdpLoggerHelper.INFO);														
SdpLoggerHelper.logBO(SDP_ORDER_Port,PROCESS_NAME,processID,SdpLoggerHelper.INFO);
																		]]></wpc:javaCode>
            </wpc:script>
          </bpws:invoke>
          <bpws:assign name="PostInvokeAssign" wpc:displayName="Post-Invoke Assign" wpc:id="303">
            <bpws:copy>
              <bpws:from variable="SDP_ORDER_Port">
                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/order/ReqService/Account/ObjectId]]></bpws:query>
              </bpws:from>
              <bpws:to variable="MailboxConfig_Proc">
                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/order/ReqService/Account/ObjectId]]></bpws:query>
              </bpws:to>
            </bpws:copy>
          </bpws:assign>
          <bpws:invoke name="SetupMPSValuesnotused" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Setup MPS Values- not used" wpc:id="113">
            <wpc:script>
              <wpc:javaCode><![CDATA[// R7 Filter Setting not required
/*


com.att.sdp.utility.ContentFilterCreator __result__1 = new com.att.sdp.utility.ContentFilterCreator();
com.att.sdp.utility.ContentFilterCreator tempContentFilter = __result__1;
java.lang.String __result__4 = sbc.lightspeed.sdp.wps.SdpHelper.ACCT_OBJID;
java.lang.String __result__5 = sbc.lightspeed.sdp.wps.SdpHelper.ACCT_OBJID_PATH;
tempContentFilter.addSelectFilter(__result__4, __result__5);
commonj.sdo.DataObject __result__8 = tempContentFilter.createFilters();
MailboxConfig_Proc.getDataObject("transactionDetail").set("contentFilter", __result__8);
*/]]></wpc:javaCode>
            </wpc:script>
          </bpws:invoke>
          <bpws:assign name="PreInvokeAssigns1" wpc:displayName="Pre-Invoke Assigns" wpc:id="1537">
            <bpws:copy>
              <bpws:from variable="emptyTransactionDetail"/>
              <bpws:to variable="SDP_ORDER_Port">
                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail]]></bpws:query>
              </bpws:to>
            </bpws:copy>
            <bpws:copy>
              <bpws:from>MPS.RetrieveAccountInfo.request</bpws:from>
              <bpws:to variable="SDP_ORDER_Port">
                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/State]]></bpws:query>
              </bpws:to>
            </bpws:copy>
            <bpws:copy>
              <bpws:from>MPS</bpws:from>
              <bpws:to variable="SDP_ORDER_Port">
                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/errorDetails/Error/TargetSystem]]></bpws:query>
              </bpws:to>
            </bpws:copy>
            <bpws:copy>
              <bpws:from>RetrieveAccountInfo</bpws:from>
              <bpws:to variable="SDP_ORDER_Port">
                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/currentTargetOperation]]></bpws:query>
              </bpws:to>
            </bpws:copy>
            <bpws:copy>
              <bpws:from>false</bpws:from>
              <bpws:to variable="secondaryMemberIdNotMatching"/>
            </bpws:copy>
          </bpws:assign>
          <bpws:invoke name="LogMPSretrieveAccountInfo" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [MPS.retrieveAccountInfo ]" wpc:id="2203">
            <wpc:script>
              <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage(SdpLoggerHelper.INVOKE_STR +" : MPS.retrieveAccountInfo",PROCESS_NAME,processID
														,SdpLoggerHelper.INFO);
														
SdpLoggerHelper.logMessage("Request BO:[SDP_ORDER]",PROCESS_NAME,processID
														,SdpLoggerHelper.INFO);
SdpLoggerHelper.logMessage("MailboxConfig_Proc:",PROCESS_NAME,processID
														,SdpLoggerHelper.INFO);

														
SdpLoggerHelper.logBO(MailboxConfig_Proc,PROCESS_NAME,processID,SdpLoggerHelper.INFO);
																		]]></wpc:javaCode>
            </wpc:script>
          </bpws:invoke>
          <bpws:invoke name="RetrieveAccountInfofromMPS" operation="retrieveAccountInfo" partnerLink="MPSCompensableService2_InterfacePartner" portType="ns35:MPSCompensableService2_Interface" wpc:displayName="Retrieve AccountInfo from MPS" wpc:id="108">
            <wpc:input>
              <wpc:parameter name="order" variable="MailboxConfig_Proc"/>
            </wpc:input>
            <wpc:output>
              <wpc:parameter name="returnOrder" variable="SDP_ORDER_Port"/>
            </wpc:output>
            <bpws:catch faultName="ns35:serviceCallFault" faultVariable="scFault" wpc:faultType="java:ServiceCallFault" wpc:id="2988" wpc:variableId="791">
              <bpws:sequence name="HiddenSequence5" wpc:id="1073744642">
                <bpws:assign name="MergeMPSerrortoProcobject7" wpc:displayName="Merge MPS error to Proc object" wpc:id="2836">
                  <bpws:copy>
                    <bpws:from>11016</bpws:from>
                    <bpws:to variable="MailboxConfig_Proc">
                      <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/errorDetails/Error/Message/MessageCode]]></bpws:query>
                    </bpws:to>
                  </bpws:copy>
                  <bpws:copy>
                    <bpws:from>SDP_Downstream_System_Error</bpws:from>
                    <bpws:to variable="MailboxConfig_Proc">
                      <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/errorDetails/Error/Message/MessageText]]></bpws:query>
                    </bpws:to>
                  </bpws:copy>
                  <bpws:copy>
                    <bpws:from>FAULT</bpws:from>
                    <bpws:to variable="MailboxConfig_Proc">
                      <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/errorDetails/Error/Severity]]></bpws:query>
                    </bpws:to>
                  </bpws:copy>
                  <bpws:copy>
                    <bpws:from variable="scFault">
                      <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[messageDetail]]></bpws:query>
                    </bpws:from>
                    <bpws:to variable="MailboxConfig_Proc">
                      <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[transactionDetail/errorDetails/Error/Message/MessageDetail]]></bpws:query>
                    </bpws:to>
                  </bpws:copy>
                </bpws:assign>
                <bpws:assign name="MergerProctoTrig1" wpc:displayName="Merger Proc to Trig" wpc:id="2837">
                  <bpws:copy>
                    <bpws:from variable="MailboxConfig_Proc"/>
                    <bpws:to variable="MailboxConfigRequest_Trig"/>
                  </bpws:copy>
                </bpws:assign>
                <bpws:invoke name="LogEndProcess2" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [End Process]" wpc:id="2839">
                  <wpc:script>
                    <wpc:javaCode><![CDATA[
SdpLoggerHelper.logMessage("MPS.queryAccount fault:",PROCESS_NAME,processID,SdpLoggerHelper.ERROR);

SdpLoggerHelper.logBO(scFault,PROCESS_NAME,processID,SdpLoggerHelper.ERROR);

SdpLoggerHelper.logMessage("Returning the following GBO To MAM ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("Provisioned [MailboxConfigRequest_Trig ]: ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(MailboxConfigRequest_Trig,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("End - UpdateMailBoxConfig",PROCESS_NAME,processID,SdpLoggerHelper.INFO);]]></wpc:javaCode>
                  </wpc:script>
                </bpws:invoke>
                <bpws:reply name="ReplyMPSError2" operation="UpdateMailboxConfig" partnerLink="FromMam_FeaturePermissionMailboxUpdate_Interface" portType="ns3:FromMam_FeaturePermissionMailboxUpdate_Interface" wpc:displayName="Reply MPS Error" wpc:id="128">
                  <wpc:input>
                    <wpc:parameter name="mailboxConfigResponse" variable="MailboxConfigRequest_Trig"/>
                  </wpc:input>
                </bpws:reply>
                <bpws:terminate name="Terminate5" wpc:displayName="Terminate5" wpc:id="1594"/>
              </bpws:sequence>
            </bpws:catch>
          </bpws:invoke>
          <bpws:switch name="AccountNotFound" wpc:displayName="Account Not Found?" wpc:id="2840">
            <bpws:case wpc:id="2841">
              <bpws:condition expressionLanguage="http://www.ibm.com/xmlns/prod/websphere/business-process/expression-lang/java/6.0.0/"><![CDATA[return new Order(SDP_ORDER_Port).getTransactionDetail().isNoRecordsFound();
]]></bpws:condition>
              <bpws:sequence name="HiddenSequence14" wpc:id="1073744667">
                <bpws:assign name="MergeMPSerrortoProcobject8" wpc:displayName="Merge MPS error to Proc object" wpc:id="2842">
                  <bpws:copy>
                    <bpws:from>HSMWS0001W</bpws:from>
                    <bpws:to variable="MailboxConfig_Proc">
                      <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/errorDetails/Error/Message/MessageCode]]></bpws:query>
                    </bpws:to>
                  </bpws:copy>
                  <bpws:copy>
                    <bpws:from>Primary_MemberID_Not_Found</bpws:from>
                    <bpws:to variable="MailboxConfig_Proc">
                      <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/errorDetails/Error/Message/MessageText]]></bpws:query>
                    </bpws:to>
                  </bpws:copy>
                  <bpws:copy>
                    <bpws:from>FAULT</bpws:from>
                    <bpws:to variable="MailboxConfig_Proc">
                      <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/errorDetails/Error/Severity]]></bpws:query>
                    </bpws:to>
                  </bpws:copy>
                  <bpws:copy>
                    <bpws:from variable="SDP_ORDER_Port">
                      <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[transactionDetail/errorDetails/Error/Message/MessageDetail]]></bpws:query>
                    </bpws:from>
                    <bpws:to variable="MailboxConfig_Proc">
                      <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[transactionDetail/errorDetails/Error/Message/MessageDetail]]></bpws:query>
                    </bpws:to>
                  </bpws:copy>
                </bpws:assign>
                <bpws:assign name="MergerProctoTrig12" wpc:displayName="Merger Proc to Trig" wpc:id="2844">
                  <bpws:copy>
                    <bpws:from variable="MailboxConfig_Proc"/>
                    <bpws:to variable="MailboxConfigRequest_Trig"/>
                  </bpws:copy>
                </bpws:assign>
                <bpws:invoke name="LogEndProcess14" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [End Process]" wpc:id="2846">
                  <wpc:script>
                    <wpc:javaCode><![CDATA[
SdpLoggerHelper.logMessage("MPS.queryUser user not found:",PROCESS_NAME,processID,SdpLoggerHelper.ERROR);

SdpLoggerHelper.logMessage("Returning the following GBO To MAM ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("Provisioned [MailboxConfigRequest_Trig ]: ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(MailboxConfigRequest_Trig,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("End - UpdateMailBoxConfig",PROCESS_NAME,processID,SdpLoggerHelper.INFO);]]></wpc:javaCode>
                  </wpc:script>
                </bpws:invoke>
                <bpws:reply name="ReplyMPSError8" operation="UpdateMailboxConfig" partnerLink="FromMam_FeaturePermissionMailboxUpdate_Interface" portType="ns3:FromMam_FeaturePermissionMailboxUpdate_Interface" wpc:displayName="Reply MPS Error" wpc:id="2847">
                  <wpc:input>
                    <wpc:parameter name="mailboxConfigResponse" variable="MailboxConfigRequest_Trig"/>
                  </wpc:input>
                </bpws:reply>
                <bpws:terminate name="Terminate7" wpc:displayName="Terminate4" wpc:id="2848"/>
              </bpws:sequence>
            </bpws:case>
          </bpws:switch>
          <bpws:assign name="Postinvokeassigns4" wpc:displayName="post invoke assigns" wpc:id="1539">
            <bpws:copy>
              <bpws:from variable="SDP_ORDER_Port">
                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail]]></bpws:query>
              </bpws:from>
              <bpws:to variable="TrasationDetail_Port"/>
            </bpws:copy>
          </bpws:assign>
          <bpws:invoke name="LogMPSRetrieveAccountInfoSuccess" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [MPS.RetrieveAccountInfo  -Success]" wpc:id="2363">
            <wpc:script>
              <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage("MPS.RetrieveAccountInfo :-"+SdpLoggerHelper.SUCCESS_STR,PROCESS_NAME,processID
														,SdpLoggerHelper.INFO);
SdpLoggerHelper.logMessage("Response BO [SDP_ORDER]",PROCESS_NAME,processID,SdpLoggerHelper.INFO);
SdpLoggerHelper.logMessage("SDP_ORDER_Port:",PROCESS_NAME,processID,SdpLoggerHelper.INFO);														
SdpLoggerHelper.logBO(SDP_ORDER_Port,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

																	]]></wpc:javaCode>
            </wpc:script>
          </bpws:invoke>
          <bpws:invoke name="Snippet2" operation="null" partnerLink="null" portType="wpc:null" wpc:continueOnError="inherit" wpc:displayName=" Set CustSubType" wpc:id="3038">
            <wpc:script>
              <wpc:javaCode><![CDATA[//Added for 268966b(R1502)
customerSubType = new Order(SDP_ORDER_Port).getCustSubType();]]></wpc:javaCode>
            </wpc:script>
          </bpws:invoke>
          <bpws:invoke name="SetcurrentProductanditeratorStep" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Set currentProduct and iteratorStep" wpc:id="2964">
            <wpc:script>
              <wpc:javaCode><![CDATA[//Set current product as line and iteratorStep as -1
Order order = new Order(SDP_ORDER_Port);
order.getTransactionDetail().setCurrentProduct(Product.CVOIPLINE, -1);
]]></wpc:javaCode>
            </wpc:script>
          </bpws:invoke>
          <bpws:invoke name="InvokeInternalDB.retrieveComponentStatus" operation="retrieveComponentStatus" partnerLink="SDPOrderDBCompensableService" portType="ns38:SDPOrderDBCompensableService_Interface" wpc:continueOnError="inherit" wpc:displayName="Invoke InternalDB.retrieveComponentStatus" wpc:id="2965">
            <wpc:input>
              <wpc:parameter name="order" variable="SDP_ORDER_Port"/>
            </wpc:input>
            <wpc:output>
              <wpc:parameter name="result" variable="SDP_ORDER_Port"/>
            </wpc:output>
            <bpws:catch faultName="ns38:serviceCallFault" faultVariable="serviceCallFaultVar" wpc:faultType="java:ServiceCallFault" wpc:id="2989" wpc:variableId="2968">
              <bpws:sequence name="HiddenSequence32" wpc:id="1073744797">
                <bpws:invoke name="LogInternalDB.retrieveComponentStatusError" operation="null" partnerLink="null" portType="wpc:null" wpc:continueOnError="inherit" wpc:displayName="Log [InternalDB.retrieveComponentStatus] Error" wpc:id="2970">
                  <wpc:script>
                    <wpc:javaCode><![CDATA[StdProcessLogger logger = new StdProcessLogger(processInstance());
logger.error("InternalDB.RetrieveComponentStatus - " + SdpLoggerHelper.ERROR_STR);
logger.error("Response BO: [serviceCallFaultVar]");
logger.error(serviceCallFaultVar);
]]></wpc:javaCode>
                  </wpc:script>
                </bpws:invoke>
                <bpws:rethrow name="Rethrow" wpc:displayName="Rethrow" wpc:id="2971"/>
              </bpws:sequence>
            </bpws:catch>
          </bpws:invoke>
          <bpws:invoke name="RemovePendingdeleteTNsfrommpsBO" operation="null" partnerLink="null" portType="wpc:null" wpc:continueOnError="inherit" wpc:displayName="Remove Pending delete TNs from mpsBO" wpc:id="2966">
            <wpc:script>
              <wpc:javaCode><![CDATA[StdProcessLogger logger = new att.lightspeed.sdp.helper.StdProcessLogger(processInstance());
logger.debug("Before setting Line status and removing PENDING_DELETE TN's from SDP_ORDER_Port BO");
logger.debug(SDP_ORDER_Port);
DataObject cvoipLineBO = null;
DataObject cvoipComponentBO = null;
List cvoipLinesALL = null;
List cvoipLinesWOPD = null;
String strStatus = null;
DataObject lineStatusBO = null;

cvoipLinesWOPD = new ArrayList();
Order order = new Order(SDP_ORDER_Port);
cvoipComponentBO = order.getProduct(Product.CVOIP);

if (cvoipComponentBO != null)
{
	cvoipLinesALL = cvoipComponentBO.getList(SdpHelper.CVOIP_LINE);
	
	if ( cvoipLinesALL != null && cvoipLinesALL.size() > 0 ) 
	{
	
		for ( int counter = 0; counter < cvoipLinesALL.size(); counter++ ) 
		{
			cvoipLineBO = (DataObject)cvoipLinesALL.get(counter);
			if (cvoipLineBO != null)
			{
				lineStatusBO = cvoipLineBO.getDataObject(SdpHelper.STATUS);
				if (lineStatusBO!=null)
					strStatus = lineStatusBO.getString(SdpHelper.STATE);
					
				logger.debug(lineStatusBO);
				
				if ( !Status.PENDINGDELETE.name().equalsIgnoreCase(strStatus) ) 
				{
					cvoipLinesWOPD.add(SDO.copy(cvoipLineBO));
				
				}
			}
		}
	}
	
	cvoipComponentBO.setList(SdpHelper.CVOIP_LINE, cvoipLinesWOPD);
}

logger.info("After setting Line status and removing PENDING_DELETE TN's from SDP_ORDER_Port BO");
logger.info(SDP_ORDER_Port);	
	]]></wpc:javaCode>
            </wpc:script>
          </bpws:invoke>
          <bpws:invoke name="UnsetcurrentProduct" operation="null" partnerLink="null" portType="wpc:null" wpc:continueOnError="inherit" wpc:displayName="Unset currentProduct" wpc:id="2967">
            <wpc:script>
              <wpc:javaCode><![CDATA[SDP_ORDER_Port.setString(SdpHelper.xPathify(SdpHelper.CURRENT_PRODUCT_PATH), null);]]></wpc:javaCode>
            </wpc:script>
          </bpws:invoke>
          <bpws:invoke name="Validatetheincomingrequest" operation="null" partnerLink="null" portType="wpc:null" wpc:continueOnError="inherit" wpc:displayName="Validate the incoming request" wpc:id="2961">
            <wpc:script>
              <wpc:javaCode><![CDATA[StdProcessLogger logger = new att.lightspeed.sdp.helper.StdProcessLogger(processInstance());

List lstReqMB;
List lstReqMBTN;
List lstProvTN;
Iterator iterReqMB;
Iterator iterReqMBTN;
Iterator iterProvTN;
DataObject reqMailBoxDO;
DataObject reqMailBoxTNDO;
DataObject provTNDO;
String strReqMBMainMailboxID;
String strReqMBTN;
String strProvTnType;
List adlProvMBTN = new ArrayList();
String ptlProvMBTN = null;
String tempProvMBTN;
String referralRemovalDate = null;
int adlAvailability = 0;
invalidRequest = new Boolean(false);
invalidInput=new Boolean(false);
ptlPresentInMainMB  = new Boolean(false);

lstReqMB = new Order(MailboxConfig_Proc).getProductList(Product.CVOIPMAILBOX);
Order provOrder = new Order(SDP_ORDER_Port);
lstProvTN = provOrder.getProductList(Product.CVOIPLINE);
iterProvTN = lstProvTN.iterator();
while(iterProvTN.hasNext()) {
	provTNDO = (DataObject) iterProvTN.next();
	tempProvMBTN = provTNDO.getString(SdpHelper.xPathify(SdpHelper.CVOIP_TN_PATH));
	strProvTnType = provTNDO.getString(SdpHelper.xPathify(SdpHelper.CVOIP_TN_PRIMARYIND_PATH));
	referralRemovalDate= provTNDO.getString(SdpHelper.xPathify(SdpHelper.CVOIP_LINE_REFERRALREMOVALDATE));
	if(SdpHelper.NO.equalsIgnoreCase(strProvTnType) && referralRemovalDate == null ){
		adlProvMBTN.add(tempProvMBTN);
	}
	else if(SdpHelper.YES.equalsIgnoreCase(strProvTnType) && referralRemovalDate == null ){
		ptlProvMBTN = tempProvMBTN;
	}
}						
if(lstReqMB != null && lstReqMB.size() > 0) {
		iterReqMB = lstReqMB.iterator();
		while(iterReqMB.hasNext()) {
			reqMailBoxDO = (DataObject)iterReqMB.next();
			strReqMBMainMailboxID = reqMailBoxDO.getString(SdpHelper.CVOIP_MAILBOX_MAINMAILBOXIND);
			
				lstReqMBTN = reqMailBoxDO.getList(SdpHelper.VOIP_MAILBOXTNS);
				iterReqMBTN = lstReqMBTN.iterator();
				while (iterReqMBTN.hasNext()) {
					reqMailBoxTNDO = (DataObject) iterReqMBTN.next();
					strReqMBTN = reqMailBoxTNDO.getString(SdpHelper.CVOIP_MAILBOX_TN);
					if(adlProvMBTN != null && adlProvMBTN.contains(strReqMBTN)) {
						adlAvailability++ ;
					}
					if(SdpHelper.YES.equalsIgnoreCase(strReqMBMainMailboxID)){
						if(ptlProvMBTN != null && ptlProvMBTN.equalsIgnoreCase(strReqMBTN)) {
						ptlPresentInMainMB = new Boolean(true);
					}					
				}
			
		}
	}
}
// D168443 - rejecting the requests in which the ADL is not associated to even one mailbox 
// if (adlAvailability >1 ||!ptlPresentInMainMB ){
//
if ((adlProvMBTN != null && adlProvMBTN.size() > 0 && adlAvailability ==0) ||!ptlPresentInMainMB ){
    SdpLoggerHelper.logMessage("The request is invalid",PROCESS_NAME,processID,SdpLoggerHelper.DEBUG);
	invalidRequest = new Boolean(true);
	logger.debug("The request is invalid, adlProvMBTN dlAvailability=" + adlAvailability+ " (should be = 1)");
	logger.debug("     OR; ptlPresentInMainMB=" + ptlPresentInMainMB+" (should be = true)");
	validationErrorMessage = "Invalid Data: The TN is not associated to even one mailbox"; 
}
]]></wpc:javaCode>
            </wpc:script>
          </bpws:invoke>
          <bpws:invoke name="SetMailBoxComponentIDinrequest" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Set MailBoxComponentID in request" wpc:id="2865">
            <wpc:script>
              <wpc:javaCode><![CDATA[List lstReqMB;
List lstReqMBTN;
List lstProvMB;
List lstProvTN;
Iterator iterReqMB;
Iterator iterReqMBTN;
Iterator iterProvMB;
Iterator iterProvTN;
DataObject reqMailBoxDO;
DataObject reqMailBoxTNDO;
DataObject provMailBoxDO;
DataObject provTNDO;
String strReqMBInvariantID;
String strReqMBTN;
String strProvMBInvariantID;
String strProvMBTN;
String strMBComponentID;
String strTNComponentID;

lstReqMB = new Order(MailboxConfig_Proc).getProductList(Product.CVOIPMAILBOX);
Order provOrder = new Order(SDP_ORDER_Port);
lstProvMB = provOrder.getProductList(Product.CVOIPMAILBOX);
lstProvTN = provOrder.getProductList(Product.CVOIPLINE);

if(lstReqMB != null && lstReqMB.size() > 0) {
	if(lstProvMB != null && lstProvMB.size() > 0) {
		iterReqMB = lstReqMB.iterator();
		while(iterReqMB.hasNext()) {
			reqMailBoxDO = (DataObject)iterReqMB.next();
			strReqMBInvariantID = reqMailBoxDO.getString(SdpHelper.CVOIP_MAILBOX_MAILBOXINVARIANTID);
			iterProvMB = lstProvMB.iterator();
			while(iterProvMB.hasNext()) {
				provMailBoxDO = (DataObject)iterProvMB.next();
				strProvMBInvariantID = provMailBoxDO.getString(SdpHelper.CVOIP_MAILBOX_MAILBOXINVARIANTID);
				if(strProvMBInvariantID != null && strProvMBInvariantID.equalsIgnoreCase(strReqMBInvariantID)) {
					strMBComponentID = provMailBoxDO.getString(SdpHelper.CVOIP_MAILBOX_COMPONENTID);
					reqMailBoxDO.setString(SdpHelper.CVOIP_MAILBOX_COMPONENTID, strMBComponentID);
					SdpLoggerHelper.logMessage("MailboxConfig_Proc after setting Component ID:",PROCESS_NAME,processID,SdpLoggerHelper.INFO);														
					SdpLoggerHelper.logBO(MailboxConfig_Proc,PROCESS_NAME,processID,SdpLoggerHelper.INFO);
					break;
				}
			}

			// Set the proper TN component ID on all incoming mailbox TNs
			lstReqMBTN = reqMailBoxDO.getList(SdpHelper.VOIP_MAILBOXTNS);
			iterReqMBTN = lstReqMBTN.iterator();
			while (iterReqMBTN.hasNext()) {
				reqMailBoxTNDO = (DataObject) iterReqMBTN.next();
				strReqMBTN = reqMailBoxTNDO.getString(SdpHelper.CVOIP_MAILBOX_TN);

				iterProvTN = lstProvTN.iterator();
				while(iterProvTN.hasNext()) {
					provTNDO = (DataObject) iterProvTN.next();

					strProvMBTN = provTNDO.getString(SdpHelper.CVOIP_LINE_TNINFO + "/" + SdpHelper.CVOIP_LINE_TN);
					if(strProvMBTN.equalsIgnoreCase(strReqMBTN)) {
						strTNComponentID = provTNDO.getString(SdpHelper.PRODUCTINFO + "/" + SdpHelper.COMPONENTID);
						reqMailBoxTNDO.setString(SdpHelper.CVOIP_MAILBOX_TNCOMPONENTID, strTNComponentID);
						break;
					}
				}
			}
		}
	}
}


//Set the mailbox in MailboxConfigRequest_Trig from MailboConfig_Proc
DataObject cvoipProduct = null;
cvoipProduct = new Order(MailboxConfig_Proc).getProduct(Product.CVOIP);
MailboxConfigRequest_Trig.setDataObject(SdpHelper.xPathify(SdpHelper.VOIP_PATH), SDO.copy(cvoipProduct));
]]></wpc:javaCode>
            </wpc:script>
          </bpws:invoke>
          <bpws:invoke name="SetMailBoxMembersinMPSprovobject" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Set MailBoxMembers in MPS prov object" wpc:id="2900">
            <wpc:script>
              <wpc:javaCode><![CDATA[List lstProvMB;
List lstProvMemProfile;
Iterator iterProvMB;
Iterator iterProvMemProfile;
DataObject reqMailBoxDO;
DataObject reqMailBoxMemberDO;
DataObject ProvMemProfileDO;
String strProvMBComponentID;
String strProvMemProfileComponentID;
String strMemProfileMemId;

//MPS order cVoip accountMailbox list
lstProvMB = new Order(SDP_ORDER_Port).getProductList(Product.CVOIPMAILBOX);

//MPS order memberProfile list
lstProvMemProfile = new Order(SDP_ORDER_Port).getMemberProfileList();

if(lstProvMB != null && lstProvMB.size() > 0) {

	if(lstProvMemProfile != null && lstProvMemProfile.size() > 0) {
	
		iterProvMB = lstProvMB.iterator();
		
		//accountMailbox loop
		while(iterProvMB.hasNext()) {
		
			reqMailBoxDO = (DataObject)iterProvMB.next();
			strProvMBComponentID = reqMailBoxDO.getString(SdpHelper.CVOIP_MAILBOX_COMPONENTID);
			iterProvMemProfile = lstProvMemProfile.iterator();
			
			//memberProfile loop
			while(iterProvMemProfile.hasNext()) {
			
				ProvMemProfileDO = (DataObject)iterProvMemProfile.next();
				strProvMemProfileComponentID = ProvMemProfileDO.getString(SdpHelper.MEMBERPROFILE_MAILBOXCOMPONENTID);
				
				//match on mailbox componentID
				if(strProvMemProfileComponentID != null && strProvMemProfileComponentID.equalsIgnoreCase(strProvMBComponentID)) {
				
					//copy memberId from memberProfile to mailboxMembers/memberId on accountMailbox
					strMemProfileMemId = ProvMemProfileDO.getString(SdpHelper.MEMBERID);
					reqMailBoxMemberDO = (DataObject)reqMailBoxDO.createDataObject(SdpHelper.VOIP_MAILBOX_MEMBERS);
					reqMailBoxMemberDO.setString(SdpHelper.MEMBERID, strMemProfileMemId);
							
					break;
				 }
			}
		}
	}
	
	SdpLoggerHelper.logMessage("MailboxConfig_Proc after setting Mailbox Members:",PROCESS_NAME,processID,SdpLoggerHelper.INFO);														
	SdpLoggerHelper.logBO(SDP_ORDER_Port,PROCESS_NAME,processID,SdpLoggerHelper.INFO);		
}]]></wpc:javaCode>
            </wpc:script>
          </bpws:invoke>
          <bpws:assign name="PostInvokeAssigns2" wpc:displayName="Post-Invoke Assigns" wpc:id="349">
            <bpws:copy>
              <bpws:from variable="SDP_ORDER_Port">
                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/order/ReqService/product/cvoipProduct]]></bpws:query>
              </bpws:from>
              <bpws:to variable="MailboxConfig_Prov">
                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/order/ReqService/product/cvoipProduct]]></bpws:query>
              </bpws:to>
            </bpws:copy>
            <bpws:copy>
              <bpws:from variable="SDP_ORDER_Port">
                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/order/ReqService/product/uVerseTechnologyProduct]]></bpws:query>
              </bpws:from>
              <bpws:to variable="MailboxConfig_Prov">
                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/order/ReqService/product/uVerseTechnologyProduct]]></bpws:query>
              </bpws:to>
            </bpws:copy>
            <bpws:copy>
              <bpws:from variable="SDP_ORDER_Port">
                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/order/ReqService/Account]]></bpws:query>
              </bpws:from>
              <bpws:to variable="MailboxConfig_Prov">
                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/order/ReqService/Account]]></bpws:query>
              </bpws:to>
            </bpws:copy>
            <bpws:copy>
              <bpws:from variable="SDP_ORDER_Port">
                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/order/transactionInfo]]></bpws:query>
              </bpws:from>
              <bpws:to variable="MailboxConfig_Prov">
                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/order/transactionInfo]]></bpws:query>
              </bpws:to>
            </bpws:copy>
          </bpws:assign>
          <bpws:invoke name="CopyMailboxConfig_ProvtoSdpOrderProvSdpOrderUpdated" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Copy MailboxConfig_Prov to SdpOrderProv, SdpOrderUpdated" wpc:id="1288">
            <wpc:script>
              <wpc:javaCode><![CDATA[SDP_ORDER_Prov = SDO.copy(MailboxConfig_Prov);
SDP_Order_Prov_Updated = SDO.copy(MailboxConfig_Prov);]]></wpc:javaCode>
            </wpc:script>
          </bpws:invoke>
          <bpws:invoke name="Snippet" operation="null" partnerLink="null" portType="wpc:null" wpc:continueOnError="inherit" wpc:displayName="Validating Input Data" wpc:id="3032">
            <wpc:script>
              <wpc:javaCode><![CDATA[List lstMailboxMembers = null;
List lstMailboxTNs = null;
List lstAccountMailboxes = null;

Iterator itrMailboxMembers = null;
Iterator itrMailboxTNs = null;
Iterator itrAccountMailboxes = null;

DataObject mailboxMember = null;
DataObject mailboxTN = null;
DataObject mailBox = null;
DataObject tmpSdpOrder = null;

String strMemberId = null;
String strTN = null;
String strInvariantId = null;

tmpSdpOrder = SDO.copy(MailboxConfig_Proc);

lstAccountMailboxes = tmpSdpOrder.getList(SdpHelper.VOIP_ACCOUNTMAILBOXES_PATH.replace('.','/'));
itrAccountMailboxes = lstAccountMailboxes.iterator();

SdpLoggerHelper.logMessage("Checking the request for Invalid Input",
	PROCESS_NAME,processID,SdpLoggerHelper.DEBUG);

while(itrAccountMailboxes.hasNext())
{
	mailBox = (DataObject)itrAccountMailboxes.next();	
	
	if (mailBox != null)
	{	
		strInvariantId = mailBox.getString(SdpHelper.CVOIP_MAILBOX_MAILBOXINVARIANTID);
		
		if(strInvariantId != null && strInvariantId.trim().length() > 0)
		{
			if(SdpHelper.getMailBox(MailboxConfig_Prov,strInvariantId) == null)
			{
				SdpLoggerHelper.logMessage("Mailbox [" + strInvariantId + "] is in Req not in MPS",
					PROCESS_NAME,processID,SdpLoggerHelper.DEBUG);
				invalidInput = true;
				validationErrorMessage = "Invalid Data: Mailbox [" + strInvariantId + "] is in Req not in MPS";
				break;
			}
		}
		
		if (!invalidInput)
		{
			lstMailboxMembers = mailBox.getList(SdpHelper.VOIP_MAILBOX_MEMBERS);
			itrMailboxMembers = lstMailboxMembers.iterator();
			
			while(itrMailboxMembers.hasNext())
			{
				mailboxMember = (DataObject) itrMailboxMembers.next();
				
				if(mailboxMember != null)
				{
					strMemberId = mailboxMember.getString(SdpHelper.CVOIP_MAILBOX_MEMBERID);
					
					if (strMemberId.trim().length() > 0 
						&& SdpHelper.getMemberProfile(MailboxConfig_Prov,strMemberId,SdpHelper.MEMBER_FILTER)
						== null)
					{
						SdpLoggerHelper.logMessage("MemberProfile[" + strMemberId + "] is in Req not in MPS",
							PROCESS_NAME,processID,SdpLoggerHelper.DEBUG);
						validationErrorMessage = "Invalid Data: MemberProfile[" + strMemberId + "] is in Req not in MPS";
						invalidInput = true;
						break;
					}
				} 
			}
		}
		if(!invalidInput)
		{
			lstMailboxTNs = mailBox.getList(SdpHelper.VOIP_MAILBOXTNS);
			itrMailboxTNs = lstMailboxTNs.iterator();
			
			while(itrMailboxTNs.hasNext())
			{
				mailboxTN = (DataObject)itrMailboxTNs.next();
				
				if(mailboxTN != null)
				{
					strTN = mailboxTN.getString(SdpHelper.CVOIP_MAILBOX_TN);
					
					if(strTN.trim().length() > 0 && SdpHelper.getTN(MailboxConfig_Prov,strTN) == null)
					{
						SdpLoggerHelper.logMessage("TN[" + strTN + "] is in Req not in MPS",
							PROCESS_NAME,processID,SdpLoggerHelper.DEBUG);
							validationErrorMessage = "Invalid Data: TN[" + strTN + "] is in Req not in MPS";
						invalidInput = true;
						break;
					}	
				}
			}
		}	
	}
}]]></wpc:javaCode>
            </wpc:script>
          </bpws:invoke>
          <bpws:switch name="Terminate16" wpc:displayName="Terminate?" wpc:id="2729">
            <bpws:case wpc:id="2730">
              <bpws:condition><![CDATA[/* Moved this Code to Validate Input data Snippet
List lstMailboxMembers = null;
List lstMailboxTNs = null;
List lstAccountMailboxes = null;

Iterator itrMailboxMembers = null;
Iterator itrMailboxTNs = null;
Iterator itrAccountMailboxes = null;

DataObject mailboxMember = null;
DataObject mailboxTN = null;
DataObject mailBox = null;
DataObject tmpSdpOrder = null;

String strMemberId = null;
String strTN = null;
String strInvariantId = null;

boolean invalidInput = false;

tmpSdpOrder = SDO.copy(MailboxConfig_Proc);

lstAccountMailboxes = tmpSdpOrder.getList(SdpHelper.VOIP_ACCOUNTMAILBOXES_PATH.replace('.','/'));
itrAccountMailboxes = lstAccountMailboxes.iterator();

SdpLoggerHelper.logMessage("Checking the request for Invalid Input",
	PROCESS_NAME,processID,SdpLoggerHelper.DEBUG);

while(itrAccountMailboxes.hasNext())
{
	mailBox = (DataObject)itrAccountMailboxes.next();	
	
	if (mailBox != null)
	{	
		strInvariantId = mailBox.getString(SdpHelper.CVOIP_MAILBOX_MAILBOXINVARIANTID);
		
		if(strInvariantId != null && strInvariantId.trim().length() > 0)
		{
			if(SdpHelper.getMailBox(MailboxConfig_Prov,strInvariantId) == null)
			{
				SdpLoggerHelper.logMessage("Mailbox [" + strInvariantId + "] is in Req not in MPS",
					PROCESS_NAME,processID,SdpLoggerHelper.DEBUG);
				invalidInput = true;
				validationErrorMessage = "Invalid Data: Mailbox [" + strInvariantId + "] is in Req not in MPS";
				break;
			}
		}
		
		if (!invalidInput)
		{
			lstMailboxMembers = mailBox.getList(SdpHelper.VOIP_MAILBOX_MEMBERS);
			itrMailboxMembers = lstMailboxMembers.iterator();
			
			while(itrMailboxMembers.hasNext())
			{
				mailboxMember = (DataObject) itrMailboxMembers.next();
				
				if(mailboxMember != null)
				{
					strMemberId = mailboxMember.getString(SdpHelper.CVOIP_MAILBOX_MEMBERID);
					
					if (strMemberId.trim().length() > 0 
						&& SdpHelper.getMemberProfile(MailboxConfig_Prov,strMemberId,SdpHelper.MEMBER_FILTER)
						== null)
					{
						SdpLoggerHelper.logMessage("MemberProfile[" + strMemberId + "] is in Req not in MPS",
							PROCESS_NAME,processID,SdpLoggerHelper.DEBUG);
						validationErrorMessage = "Invalid Data: MemberProfile[" + strMemberId + "] is in Req not in MPS";
						invalidInput = true;
						break;
					}
				} 
			}
		}
		if(!invalidInput)
		{
			lstMailboxTNs = mailBox.getList(SdpHelper.VOIP_MAILBOXTNS);
			itrMailboxTNs = lstMailboxTNs.iterator();
			
			while(itrMailboxTNs.hasNext())
			{
				mailboxTN = (DataObject)itrMailboxTNs.next();
				
				if(mailboxTN != null)
				{
					strTN = mailboxTN.getString(SdpHelper.CVOIP_MAILBOX_TN);
					
					if(strTN.trim().length() > 0 && SdpHelper.getTN(MailboxConfig_Prov,strTN) == null)
					{
						SdpLoggerHelper.logMessage("TN[" + strTN + "] is in Req not in MPS",
							PROCESS_NAME,processID,SdpLoggerHelper.DEBUG);
							validationErrorMessage = "Invalid Data: TN[" + strTN + "] is in Req not in MPS";
						invalidInput = true;
						break;
					}	
				}
			}
		}	
	}
}
*/
return invalidInput || invalidRequest;]]></bpws:condition>
              <bpws:sequence name="HiddenSequence31" wpc:id="1073744782">
                <bpws:assign name="MergeWESMerrortoProcobject2" wpc:displayName="Merge WESM error to Proc object" wpc:id="2747">
                  <bpws:copy>
                    <bpws:from><![CDATA[11030]]></bpws:from>
                    <bpws:to variable="MailboxConfig_Proc">
                      <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/errorDetails/Error/Message/MessageCode]]></bpws:query>
                    </bpws:to>
                  </bpws:copy>
                  <bpws:copy>
                    <bpws:from><![CDATA[Input_Data_Error]]></bpws:from>
                    <bpws:to variable="MailboxConfig_Proc">
                      <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/errorDetails/Error/Message/MessageText]]></bpws:query>
                    </bpws:to>
                  </bpws:copy>
                  <bpws:copy>
                    <bpws:from>FAULT</bpws:from>
                    <bpws:to variable="MailboxConfig_Proc">
                      <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/errorDetails/Error/Severity]]></bpws:query>
                    </bpws:to>
                  </bpws:copy>
                  <bpws:copy>
                    <bpws:from variable="validationErrorMessage"/>
                    <bpws:to variable="MailboxConfig_Proc">
                      <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[transactionDetail/errorDetails/Error/Message/MessageDetail]]></bpws:query>
                    </bpws:to>
                  </bpws:copy>
                </bpws:assign>
                <bpws:invoke name="LogInvalidInputError" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [ Invalid Input - Error]" wpc:id="2749">
                  <wpc:script>
                    <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage("INVALID INPUT ERROR. PLEASE CHECK THE REQUEST FOR INPUT"
	+SdpLoggerHelper.ERROR_STR,PROCESS_NAME,processID,SdpLoggerHelper.DEBUG);]]></wpc:javaCode>
                  </wpc:script>
                </bpws:invoke>
                <bpws:assign name="PreinvokesforCompensation8" wpc:displayName="Pre invokes for Compensation" wpc:id="2750">
                  <bpws:copy>
                    <bpws:from>MAM.UpdateMailboxConfig.Request</bpws:from>
                    <bpws:to variable="STATE"/>
                  </bpws:copy>
                  <bpws:copy>
                    <bpws:from>FATAL</bpws:from>
                    <bpws:to variable="SEVERITY"/>
                  </bpws:copy>
                  <bpws:copy>
                    <bpws:from>UpdateMailboxConfig</bpws:from>
                    <bpws:to variable="TARGET_OPERATION_NAME"/>
                  </bpws:copy>
                  <bpws:copy>
                    <bpws:from>WPS</bpws:from>
                    <bpws:to variable="TARGET_SYSTEM_NAME"/>
                  </bpws:copy>
                  <bpws:copy>
                    <bpws:from variable="MailboxConfig_Proc">
                      <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/errorDetails/Error/Message]]></bpws:query>
                    </bpws:from>
                    <bpws:to variable="SDP_ERROR_OBJECT_MESSAGE"/>
                  </bpws:copy>
                  <bpws:copy>
                    <bpws:from>false</bpws:from>
                    <bpws:to variable="MANUAL_INTERVENTION_FLAG"/>
                  </bpws:copy>
                  <bpws:copy>
                    <bpws:from>UpdateMailboxConfig</bpws:from>
                    <bpws:to variable="PARENT_PROCESS_NAME"/>
                  </bpws:copy>
                </bpws:assign>
                <bpws:invoke name="LogCommonErrorLogger4" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [ CommonErrorLogger]" wpc:id="2752">
                  <wpc:script>
                    <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage("Invoking CommonErrorLogger:",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

MailboxConfig_Proc.setString(SdpHelper.TEMPSTRING1_PATH.replace('.','/'),processID);
																		]]></wpc:javaCode>
                  </wpc:script>
                </bpws:invoke>
                <bpws:invoke name="LogCommonErrorLogger5" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [ CommonErrorLogger]" wpc:id="2755">
                  <wpc:script>
                    <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage(" CommonErrorLogger",PROCESS_NAME,processID,SdpLoggerHelper.INFO);]]></wpc:javaCode>
                  </wpc:script>
                </bpws:invoke>
                <bpws:assign name="MergerProctoTrig2" wpc:displayName="Merger Proc to Trig" wpc:id="2756">
                  <bpws:copy>
                    <bpws:from variable="MailboxConfig_Proc"/>
                    <bpws:to variable="MailboxConfigRequest_Trig"/>
                  </bpws:copy>
                  <bpws:copy>
                    <bpws:from variable="sdpProcessContext"/>
                    <bpws:to variable="MailboxConfigRequest_Trig">
                      <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/ProcessContext]]></bpws:query>
                    </bpws:to>
                  </bpws:copy>
                </bpws:assign>
                <bpws:invoke name="LogEndProcess15" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [End Process]" wpc:id="2758">
                  <wpc:script>
                    <wpc:javaCode><![CDATA[


SdpLoggerHelper.logMessage("Returning the following GBO To MAM ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("Provisioned [MailboxConfigRequest_Trig ]: ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(MailboxConfigRequest_Trig,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("End - UpdateMailBoxConfig",PROCESS_NAME,processID,SdpLoggerHelper.INFO);]]></wpc:javaCode>
                  </wpc:script>
                </bpws:invoke>
                <bpws:reply name="ReplyInvalidInputError" operation="UpdateMailboxConfig" partnerLink="FromMam_FeaturePermissionMailboxUpdate_Interface" portType="ns3:FromMam_FeaturePermissionMailboxUpdate_Interface" wpc:displayName="Reply Invalid Input Error" wpc:id="2759">
                  <wpc:input>
                    <wpc:parameter name="mailboxConfigResponse" variable="MailboxConfigRequest_Trig"/>
                  </wpc:input>
                </bpws:reply>
                <bpws:terminate name="Terminate18" wpc:displayName="Terminate" wpc:id="2760"/>
              </bpws:sequence>
            </bpws:case>
            <bpws:case wpc:id="2948">
              <bpws:condition><![CDATA[WpsLogger logger = WpsLogger.getLogger(processInstance());
logger.info("Check for Account locked for SPP Async Response flow to complete");

int requestCount = 0;

String BAN = null;
String rateCenter = null;

boolean locked = false;
//boolean isSoapMigrated = false;

DataObject lineComp = null;

Order order = new Order(SDP_ORDER_Port);

/*List lineLst = order.getProductList(Product.CVOIPLINE);
if(lineLst != null && lineLst.size() > 0)
{
	rateCenter = ((DataObject)lineLst.get(0)).getString(SdpHelper.CVOIP_LINE_RATECENTER);
	
	try
	{
		isSoapMigrated = SPPMailboxDBService.isSOAPMigratedRC(rateCenter);
		logger.info("SoapMigrated value successfully found.");
	}
	catch (Exception e) {
		logger.info("Exception occured while retrieving SoapMigrated value: ");
		logger.error(e.getMessage());
		locked = true;
	}
}*/

DataObject accountBO = order.getAccount();
/*if(isSoapMigrated )
{*/
	if(accountBO != null)
	{
		BAN = accountBO.getString(SdpHelper.ACCT_OBJID);
	 	
	 	if(BAN != null)
	 	{
	 		try
	 		{
	 			requestCount = SPPMailboxDBService.retrieveSppRequestCount(BAN);
				
				if(!(requestCount == 0 || requestCount == -1))
				{
					logger.info("Account locked for SPP Async Response - returns error");
					locked = true;
				}
				
			}
			catch (SQLException e) 
			{
				logger.info("Exception occured while retrieving requestCount value: ");
				logger.error(e.getMessage());
				locked = true;
			}
			
		}
	}
//}

logger.info("Account locked for SPP Async Response flow end.");
return locked;

]]></bpws:condition>
              <bpws:sequence name="HiddenSequence6" wpc:id="1073744780">
                <bpws:invoke name="MergeWESMerrortoProcObject1" operation="null" partnerLink="null" portType="wpc:null" wpc:continueOnError="inherit" wpc:displayName="Merge WESM error to Proc Object" wpc:id="2959">
                  <wpc:script>
                    <wpc:javaCode><![CDATA[WpsLogger logger = WpsLogger.getLogger(processInstance());
logger.info("Merge WESM error to Proc Object Start ");

Order mailboxConfigProc = new Order(MailboxConfig_Proc);

DataObject scFault = SDO.createServiceCallFault();
scFault.setString("messageCode", SdpErrorHelper.SDP_INPUT_DATA_ERROR_CODE);
scFault.setString("messageText", SdpErrorHelper.INPUT_DATA_ERROR_MESSAGE);
scFault.setString("messageDetail", "Invalid Data: Account locked for SPP Async Response flow to complete");

if(mailboxConfigProc.getTransactionDetail() != null )
{
	DataObject errorBO = mailboxConfigProc.getTransactionDetail().getSDPError();
	errorBO.setString("Severity","FAULT");

	mailboxConfigProc.getTransactionDetail().setSDPErrorMessage(scFault);
	
}

logger.info("Merge WESM error to Proc Object End ");]]></wpc:javaCode>
                  </wpc:script>
                </bpws:invoke>
                <bpws:invoke name="Log-Locked-Error" operation="null" partnerLink="null" portType="wpc:null" wpc:continueOnError="inherit" wpc:displayName="Log - [Locked - Error]" wpc:id="2951">
                  <wpc:script>
                    <wpc:javaCode><![CDATA[WpsLogger logger = WpsLogger.getLogger(processInstance());
logger.debug("Account locked for SPP Async Response flow to complete");]]></wpc:javaCode>
                  </wpc:script>
                </bpws:invoke>
                <bpws:invoke name="MergeProctoTrig2" operation="null" partnerLink="null" portType="wpc:null" wpc:continueOnError="inherit" wpc:displayName="Merge Proc to Trig" wpc:id="2957">
                  <wpc:script>
                    <wpc:javaCode><![CDATA[MailboxConfigRequest_Trig = MailboxConfig_Proc;

]]></wpc:javaCode>
                  </wpc:script>
                </bpws:invoke>
                <bpws:invoke name="Log-EndProcess" operation="null" partnerLink="null" portType="wpc:null" wpc:continueOnError="inherit" wpc:displayName="Log -[End Process]" wpc:id="2953">
                  <wpc:script>
                    <wpc:javaCode><![CDATA[WpsLogger logger = WpsLogger.getLogger(processInstance());
logger.info("Returning the following GBO To MAM ");
logger.info("Provisioned [MailboxConfigRequest_Trig ]: " );
logger.info(MailboxConfigRequest_Trig);
logger.info("End - UpdateMailBoxConfig ");


]]></wpc:javaCode>
                  </wpc:script>
                </bpws:invoke>
                <bpws:reply name="ReplyLockedError" operation="UpdateMailboxConfig" partnerLink="FromMam_FeaturePermissionMailboxUpdate_Interface" portType="ns3:FromMam_FeaturePermissionMailboxUpdate_Interface" wpc:displayName="Reply Locked Error" wpc:id="2954">
                  <wpc:input>
                    <wpc:parameter name="mailboxConfigResponse" variable="MailboxConfigRequest_Trig"/>
                  </wpc:input>
                </bpws:reply>
                <bpws:terminate name="Terminate15" wpc:displayName="Terminate" wpc:id="2955"/>
              </bpws:sequence>
            </bpws:case>
          </bpws:switch>
          <bpws:assign name="PreInvokeAssigns12" wpc:displayName="Pre-Invoke Assigns" wpc:id="1233">
            <bpws:copy>
              <bpws:from variable="emptySDPOrder"/>
              <bpws:to variable="SDP_ORDER_RequestPort"/>
            </bpws:copy>
            <bpws:copy>
              <bpws:from variable="emptyTransactionDetail"/>
              <bpws:to variable="TrasationDetail_Port"/>
            </bpws:copy>
            <bpws:copy>
              <bpws:from variable="emptySDPOrder"/>
              <bpws:to variable="SDP_ORDER_ProvPort"/>
            </bpws:copy>
            <bpws:copy>
              <bpws:from>MAM.CreateNewMailBox.request</bpws:from>
              <bpws:to variable="TrasationDetail_Port">
                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/State]]></bpws:query>
              </bpws:to>
            </bpws:copy>
            <bpws:copy>
              <bpws:from>MAM</bpws:from>
              <bpws:to variable="TrasationDetail_Port">
                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/TargetSystem]]></bpws:query>
              </bpws:to>
            </bpws:copy>
            <bpws:copy>
              <bpws:from>CreateNewMailBox</bpws:from>
              <bpws:to variable="TrasationDetail_Port">
                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/currentTargetOperation]]></bpws:query>
              </bpws:to>
            </bpws:copy>
          </bpws:assign>
          <bpws:invoke name="LogCreateNewMailBox" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [ CreateNewMailBox]" wpc:id="2240">
            <wpc:script>
              <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage(SdpLoggerHelper.INVOKE_STR +" SubFlow : CreateNewMailBox",PROCESS_NAME,processID
														,SdpLoggerHelper.INFO);
														
SdpLoggerHelper.logMessage("Request BO:[SDP_ORDER]",PROCESS_NAME,processID
														,SdpLoggerHelper.INFO);
SdpLoggerHelper.logMessage("MailboxConfig_Proc:",PROCESS_NAME,processID
														,SdpLoggerHelper.INFO);

														
SdpLoggerHelper.logBO(MailboxConfig_Proc,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("SDP_ORDER_Prov:",PROCESS_NAME,processID
														,SdpLoggerHelper.INFO);

														
SdpLoggerHelper.logBO(SDP_ORDER_Prov,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

MailboxConfig_Proc.setString(SdpHelper.TEMPSTRING2_PATH.replace('.','/'),processID);

]]></wpc:javaCode>
            </wpc:script>
          </bpws:invoke>
          <bpws:invoke name="InvokeCreateNewMailbox" operation="CreateNewMailBox" partnerLink="FromMam_CreateNewMailBox_Interface" portType="ns13:FromMam_CreateNewMailBox_Interface" wpc:displayName="Invoke Create New Mailbox" wpc:id="1291">
            <wpc:input>
              <wpc:parameter name="SDP_ORDER_Prov" variable="SDP_ORDER_Prov"/>
              <wpc:parameter name="SDP_ORDER_Request" variable="MailboxConfig_Proc"/>
            </wpc:input>
            <wpc:output>
              <wpc:parameter name="SDP_ORDER_ProvPort" variable="SDP_ORDER_ProvPort"/>
              <wpc:parameter name="Transaction_Detail" variable="TrasationDetail_Port"/>
              <wpc:parameter name="SDP_ORDER_RequestPort" variable="SDP_ORDER_RequestPort"/>
            </wpc:output>
            <bpws:catch faultName="wpc:runtimeFailure" faultVariable="bpcFault" wpc:faultType="wpc:BPCStandardFaultType" wpc:id="2991" wpc:variableId="1353">
              <bpws:invoke name="Handleruntimeexception" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="handle run time exception" wpc:id="1355">
                <wpc:script>
                  <wpc:javaCode><![CDATA[SdpErrorHelper.setErrDetInTransDet(TrasationDetail_Port,bpcFault,SdpErrorHelper.SEVERITY_FATAL);
SdpLoggerHelper.logMessage(SdpLoggerHelper.RUNTIME_FAILURE+"  SubFlow : CreateNewMailBox",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);]]></wpc:javaCode>
                </wpc:script>
              </bpws:invoke>
            </bpws:catch>
            <bpws:catchAll wpc:id="2990">
              <bpws:invoke name="Handleotherfailures2" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="handle other failures" wpc:id="1358">
                <wpc:script>
                  <wpc:javaCode><![CDATA[SdpErrorHelper.setErrDetInTransDet(TrasationDetail_Port,null,SdpErrorHelper.SEVERITY_FATAL);


SdpLoggerHelper.logMessage(SdpLoggerHelper.UNKNOWN_FAILURE+"  SubFlow : CreateNewMailBox",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);]]></wpc:javaCode>
                </wpc:script>
              </bpws:invoke>
            </bpws:catchAll>
          </bpws:invoke>
          <bpws:switch name="CheckMAMError" wpc:displayName="Check MAM Error" wpc:id="942">
            <bpws:case wpc:id="943">
              <bpws:condition><![CDATA[boolean __result__1 = com.ibm.wbiservers.brules.core.codegen.NillableUtility.getBoolean(TrasationDetail_Port, "errorIndicator", "TrasationDetail_Port");
return __result__1;

//@generated:com.ibm.wbit.activity.ui
//<?xml version="1.0" encoding="UTF-8"?>
//<com.ibm.wbit.activity:CompositeActivity xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:com.ibm.wbit.activity="http:///com/ibm/wbit/activity.ecore" name="ActivityMethod">
//  <result name="Result">
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="boolean"/>
//  </result>
//  <exceptions>
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="com.ibm.bpe.api.ProcessException"/>
//  </exceptions>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="TrasationDetail_Port.errorIndicator" field="true">
//    <dataOutputs target="//@executableElements.1"/>
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="boolean" namespace="http://www.w3.org/2001/XMLSchema" nillable="false"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:ReturnElement" dataInputs="//@executableElements.0/@dataOutputs.0"/>
//  <executableGroups executableElements="//@executableElements.0 //@executableElements.1"/>
//</com.ibm.wbit.activity:CompositeActivity>
//@generated:end
//!SMAP!*S WBIACTDBG
//!SMAP!*L
//!SMAP!1:1,1
//!SMAP!2:2,1
//!SMAP!1000000:26,1]]></bpws:condition>
              <bpws:sequence name="HiddenSequence13" wpc:id="1073744757">
                <bpws:invoke name="LogCreateNewMailBoxError" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [CreateNewMailBox  - Error ]" wpc:id="2242">
                  <wpc:script>
                    <wpc:javaCode><![CDATA[String strSeverity =TrasationDetail_Port.getString("errorDetails/Error/Severity");
int logLevel = SdpHelper.getLogLevel(strSeverity);
SdpLoggerHelper.logMessage("SubFlow  :CreateNewMailBox - "+SdpLoggerHelper.ERROR_STR+"["+strSeverity+"]",PROCESS_NAME,processID,logLevel);
SdpLoggerHelper.logMessage("Response BO [TrasationDetail_Port]",PROCESS_NAME,processID,logLevel);
SdpLoggerHelper.logMessage("TrasationDetail_Port:",PROCESS_NAME,processID,logLevel);														
SdpLoggerHelper.logBO(TrasationDetail_Port,PROCESS_NAME,processID,logLevel);
SdpLoggerHelper.logMessage("SDP_ORDER_RequestPort:",PROCESS_NAME,processID,logLevel);		
SdpLoggerHelper.logBO(SDP_ORDER_RequestPort,PROCESS_NAME,processID,logLevel);
SdpLoggerHelper.logMessage("SDP_ORDER_ProvPort:",PROCESS_NAME,processID,logLevel);
SdpLoggerHelper.logBO(SDP_ORDER_ProvPort,PROCESS_NAME,processID,logLevel);																]]></wpc:javaCode>
                  </wpc:script>
                </bpws:invoke>
                <bpws:assign name="CopyPorttoRollBackobject" wpc:displayName="Copy Port to RollBack object" wpc:id="1436">
                  <bpws:copy>
                    <bpws:from variable="SDP_ORDER_RequestPort"/>
                    <bpws:to variable="CreateRequestState"/>
                  </bpws:copy>
                  <bpws:copy>
                    <bpws:from variable="SDP_ORDER_Prov"/>
                    <bpws:to variable="CreateProvstate"/>
                  </bpws:copy>
                  <bpws:copy>
                    <bpws:from variable="processID"/>
                    <bpws:to variable="CreateRequestState">
                      <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/tempStoreNonArray/temp2]]></bpws:query>
                    </bpws:to>
                  </bpws:copy>
                </bpws:assign>
                <bpws:invoke name="LogUpdateMailBoxConfigCompensation" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UpdateMailBoxConfigCompensation ]" wpc:id="2235">
                  <wpc:script>
                    <wpc:javaCode><![CDATA[
SdpLoggerHelper.logMessage(SdpLoggerHelper.INVOKE_STR +" SubFlow : UpdateMailBoxConfigCompensation",PROCESS_NAME,processID,SdpLoggerHelper.INFO);
SdpLoggerHelper.logMessage("Request BOs : ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("CreateRequestState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(CreateRequestState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("CreateProvState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(CreateProvstate,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("DeleteRequestState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(DeleteRequestState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("DeleteProvState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(DeleteProvState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("UpdateRequestState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(UpdateRequestState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("UpdateProvState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(UpdateProvState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("TransactionDetailPort :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(TrasationDetail_Port,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("SDP_ORDER_GrpMBoxInfoPort :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(SDP_ORDER_GrpMBoxInfoPort,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("IndexChangeUpdateState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(IndexChangeUpdateState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("SetSubscriberSettingsBySub :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(SetSubscriberSettingsBySub,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("PinChangeUpdateState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(PinChangeUpdateState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("TnChangeUpdateState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(TnChangeUpdateState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("AddServiceState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(AddServiceState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("RemoveServiceState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(RemoveServiceState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

CreateRequestState.setString(SdpHelper.TEMPSTRING2_PATH.replace('.','/'),processID);
]]></wpc:javaCode>
                  </wpc:script>
                </bpws:invoke>
                <bpws:assign name="MergeMPSerrortoProcobject2" wpc:displayName="Merge MPS error to Proc object" wpc:id="2477">
                  <bpws:copy>
                    <bpws:from variable="TrasationDetail_Port">
                      <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/Message]]></bpws:query>
                    </bpws:from>
                    <bpws:to variable="CreateRequestState">
                      <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/errorDetails/Error/Message]]></bpws:query>
                    </bpws:to>
                  </bpws:copy>
                  <bpws:copy>
                    <bpws:from variable="TrasationDetail_Port"/>
                    <bpws:to variable="MailboxConfig_Proc">
                      <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail]]></bpws:query>
                    </bpws:to>
                  </bpws:copy>
                </bpws:assign>
                <bpws:invoke name="CallUpdateMailBoxConfigCompensate" operation="compensateUpdateMailBoxConfig" partnerLink="UpdateMailBoxConfig_Compensation_Interface" portType="ns31:UpdateMailBoxConfig_Compensation_Interface" wpc:displayName="call UpdateMailBoxConfig Compensate" wpc:id="2095">
                  <wpc:input>
                    <wpc:parameter name="CreateProvState" variable="CreateProvstate"/>
                    <wpc:parameter name="CreateRequestState" variable="CreateRequestState"/>
                    <wpc:parameter name="UpdateProvState" variable="UpdateProvState"/>
                    <wpc:parameter name="TransactionDetailPort" variable="TrasationDetail_Port"/>
                    <wpc:parameter name="DeleteProvState" variable="DeleteProvState"/>
                    <wpc:parameter name="DeleteRequestState" variable="DeleteRequestState"/>
                    <wpc:parameter name="UpdateRequestState" variable="UpdateRequestState"/>
                    <wpc:parameter name="SDP_ORDER_GrpMBoxInfoPort" variable="SDP_ORDER_GrpMBoxInfoPort"/>
                    <wpc:parameter name="IndexChangeUpdateState" variable="IndexChangeUpdateState"/>
                    <wpc:parameter name="SetSubscriberSettingsBySub" variable="SetSubscriberSettingsBySub"/>
                    <wpc:parameter name="PinChangeUpdateState" variable="PinChangeUpdateState"/>
                    <wpc:parameter name="TnChangeUpdateState" variable="TnChangeUpdateState"/>
                    <wpc:parameter name="AddServiceState" variable="AddServiceState"/>
                    <wpc:parameter name="RemoveServiceState" variable="RemoveServiceState"/>
                  </wpc:input>
                  <wpc:output>
                    <wpc:parameter name="TransactionDetailPort" variable="TrasationDetail_Port"/>
                    <wpc:parameter name="SdpOrderPort" variable="SDP_ORDER_Port"/>
                  </wpc:output>
                </bpws:invoke>
                <bpws:invoke name="LogUpdateMailBoxConfigCompensation1" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UpdateMailBoxConfigCompensation ]" wpc:id="2238">
                  <wpc:script>
                    <wpc:javaCode><![CDATA[
SdpLoggerHelper.logMessage("Received the following GBO from SubFlow : UpdateMailBoxConfigCompensation  ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("TrasationDetail_Port : ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(TrasationDetail_Port,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

]]></wpc:javaCode>
                  </wpc:script>
                </bpws:invoke>
                <bpws:assign name="MergeProctoTrig" wpc:displayName="Merge Proc to Trig" wpc:id="958">
                  <bpws:copy>
                    <bpws:from variable="MailboxConfig_Proc"/>
                    <bpws:to variable="MailboxConfigRequest_Trig"/>
                  </bpws:copy>
                  <bpws:copy>
                    <bpws:from variable="sdpProcessContext"/>
                    <bpws:to variable="MailboxConfigRequest_Trig">
                      <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/ProcessContext]]></bpws:query>
                    </bpws:to>
                  </bpws:copy>
                </bpws:assign>
                <bpws:invoke name="LogEndProcess13" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [End Process]" wpc:id="2439">
                  <wpc:script>
                    <wpc:javaCode><![CDATA[

SdpLoggerHelper.logMessage("Returning the following GBO To MAM ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("Provisioned [MailboxConfigRequest_Trig ]: ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(MailboxConfigRequest_Trig,PROCESS_NAME,processID,SdpLoggerHelper.INFO);


SdpLoggerHelper.logMessage("End - UpdateMailBoxConfig",PROCESS_NAME,processID,SdpLoggerHelper.INFO);]]></wpc:javaCode>
                  </wpc:script>
                </bpws:invoke>
                <bpws:reply name="ReplyUCDCLError3" operation="UpdateMailboxConfig" partnerLink="FromMam_FeaturePermissionMailboxUpdate_Interface" portType="ns3:FromMam_FeaturePermissionMailboxUpdate_Interface" wpc:displayName="Reply UCDCL Error" wpc:id="960">
                  <wpc:input>
                    <wpc:parameter name="mailboxConfigResponse" variable="MailboxConfigRequest_Trig"/>
                  </wpc:input>
                </bpws:reply>
                <bpws:terminate name="Terminate" wpc:displayName="Terminate" wpc:id="1443"/>
              </bpws:sequence>
            </bpws:case>
          </bpws:switch>
          <bpws:invoke name="LogCreateNewMailBoxSuccess" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [CreateNewMailBox -Success ]" wpc:id="2372">
            <wpc:script>
              <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage("SubFlow  :CreateNewMailBox -"+SdpLoggerHelper.SUCCESS_STR,PROCESS_NAME,processID
														,SdpLoggerHelper.INFO);
SdpLoggerHelper.logMessage("Response BO [TrasationDetail_Port]",PROCESS_NAME,processID,SdpLoggerHelper.INFO);
SdpLoggerHelper.logMessage("TrasationDetail_Port:",PROCESS_NAME,processID,SdpLoggerHelper.INFO);														
SdpLoggerHelper.logBO(TrasationDetail_Port,PROCESS_NAME,processID,SdpLoggerHelper.INFO);
SdpLoggerHelper.logMessage("SDP_ORDER_RequestPort:",PROCESS_NAME,processID,SdpLoggerHelper.INFO);		
SdpLoggerHelper.logBO(SDP_ORDER_RequestPort,PROCESS_NAME,processID,SdpLoggerHelper.INFO);
SdpLoggerHelper.logMessage("SDP_ORDER_ProvPort:",PROCESS_NAME,processID,SdpLoggerHelper.INFO);
SdpLoggerHelper.logBO(SDP_ORDER_ProvPort,PROCESS_NAME,processID,SdpLoggerHelper.INFO);																]]></wpc:javaCode>
            </wpc:script>
          </bpws:invoke>
          <bpws:assign name="SavingStateForRollback" wpc:displayName="Saving State For  Rollback " wpc:id="1471">
            <bpws:copy>
              <bpws:from variable="SDP_ORDER_ProvPort"/>
              <bpws:to variable="CreateRequestState"/>
            </bpws:copy>
            <bpws:copy>
              <bpws:from variable="SDP_ORDER_Prov"/>
              <bpws:to variable="CreateProvstate"/>
            </bpws:copy>
            <bpws:copy>
              <bpws:from variable="processID"/>
              <bpws:to variable="CreateRequestState">
                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/tempStoreNonArray/temp2]]></bpws:query>
              </bpws:to>
            </bpws:copy>
            <bpws:copy>
              <bpws:from>9</bpws:from>
              <bpws:to variable="CreateRequestState">
                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/tempStoreNonArray/temp11]]></bpws:query>
              </bpws:to>
            </bpws:copy>
          </bpws:assign>
          <bpws:assign name="PostInvokeAssigns" wpc:displayName="PostInvokeAssigns" wpc:id="1234">
            <bpws:copy>
              <bpws:from variable="SDP_ORDER_ProvPort"/>
              <bpws:to variable="SDP_Order_Prov_Updated"/>
            </bpws:copy>
            <bpws:copy>
              <bpws:from variable="emptyTransactionDetail"/>
              <bpws:to variable="SDP_Order_Prov_Updated">
                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail]]></bpws:query>
              </bpws:to>
            </bpws:copy>
            <bpws:copy>
              <bpws:from>null</bpws:from>
              <bpws:to variable="SDP_Order_Prov_Updated">
                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/errorDetails/Error/Message/SdpCode]]></bpws:query>
              </bpws:to>
            </bpws:copy>
            <bpws:copy>
              <bpws:from variable="SDP_ORDER_RequestPort">
                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[transactionDetail/UMMessageCenterIP]]></bpws:query>
              </bpws:from>
              <bpws:to variable="UMMessageCenterIP"/>
            </bpws:copy>
          </bpws:assign>
          <bpws:assign name="PreInvokeAssigns13" wpc:displayName="Pre-Invoke Assigns" wpc:id="1571">
            <bpws:copy>
              <bpws:from variable="emptySDPOrder"/>
              <bpws:to variable="SDP_ORDER_RequestPort"/>
            </bpws:copy>
            <bpws:copy>
              <bpws:from variable="emptyTransactionDetail"/>
              <bpws:to variable="TrasationDetail_Port"/>
            </bpws:copy>
            <bpws:copy>
              <bpws:from variable="emptySDPOrder"/>
              <bpws:to variable="SDP_ORDER_ProvPort"/>
            </bpws:copy>
            <bpws:copy>
              <bpws:from>MAM.DeleteMailBox.request</bpws:from>
              <bpws:to variable="TrasationDetail_Port">
                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/State]]></bpws:query>
              </bpws:to>
            </bpws:copy>
            <bpws:copy>
              <bpws:from>MAM</bpws:from>
              <bpws:to variable="TrasationDetail_Port">
                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/TargetSystem]]></bpws:query>
              </bpws:to>
            </bpws:copy>
            <bpws:copy>
              <bpws:from>DeleteMailBox</bpws:from>
              <bpws:to variable="TrasationDetail_Port">
                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/currentTargetOperation]]></bpws:query>
              </bpws:to>
            </bpws:copy>
            <bpws:copy>
              <bpws:from variable="emptySDPOrder"/>
              <bpws:to variable="DeleteRequestState"/>
            </bpws:copy>
            <bpws:copy>
              <bpws:from variable="UMMessageCenterIP"/>
              <bpws:to variable="MailboxConfig_Proc">
                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[transactionDetail/UMMessageCenterIP]]></bpws:query>
              </bpws:to>
            </bpws:copy>
          </bpws:assign>
          <bpws:invoke name="LogDeleteMailBox" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [DeleteMailBox ]" wpc:id="2250">
            <wpc:script>
              <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage(SdpLoggerHelper.INVOKE_STR +" SubFlow : DeleteMailBox",PROCESS_NAME,processID
														,SdpLoggerHelper.INFO);
														
SdpLoggerHelper.logMessage("Request BO:[SDP_ORDER]",PROCESS_NAME,processID
														,SdpLoggerHelper.INFO);
SdpLoggerHelper.logMessage("MailboxConfig_Proc:",PROCESS_NAME,processID
														,SdpLoggerHelper.INFO);

														
SdpLoggerHelper.logBO(MailboxConfig_Proc,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("SDP_ORDER_Prov:",PROCESS_NAME,processID
														,SdpLoggerHelper.INFO);

														
SdpLoggerHelper.logBO(SDP_ORDER_Prov,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

MailboxConfig_Proc.setString(SdpHelper.TEMPSTRING2_PATH.replace('.','/'),processID);
]]></wpc:javaCode>
            </wpc:script>
          </bpws:invoke>
          <bpws:invoke name="InvokeDeleteMailBoxFlow" operation="DeleteMailBox" partnerLink="FromMam_DeleteMailBox_Interface" portType="ns14:FromMam_DeleteMailBox_Interface" wpc:displayName="Invoke Delete MailBox Flow" wpc:id="213">
            <wpc:input>
              <wpc:parameter name="SDP_ORDER_Prov" variable="SDP_ORDER_Prov"/>
              <wpc:parameter name="SDP_ORDER_Request" variable="MailboxConfig_Proc"/>
              <wpc:parameter name="SDP_ORDER_Prov_Updated" variable="SDP_Order_Prov_Updated"/>
            </wpc:input>
            <wpc:output>
              <wpc:parameter name="SDP_ORDER_ProvPort" variable="SDP_ORDER_ProvPort"/>
              <wpc:parameter name="Transaction_Detail" variable="TrasationDetail_Port"/>
              <wpc:parameter name="SDP_ORDER_RequestPort" variable="SDP_ORDER_RequestPort"/>
              <wpc:parameter name="SDP_ORDER_Prov_Updated" variable="SDP_Order_Prov_Updated"/>
            </wpc:output>
            <bpws:catch faultName="wpc:runtimeFailure" faultVariable="bpcFault" wpc:faultType="wpc:BPCStandardFaultType" wpc:id="2993" wpc:variableId="797">
              <bpws:invoke name="Handleruntimeexception1" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="handle run time exception" wpc:id="1361">
                <wpc:script>
                  <wpc:javaCode><![CDATA[SdpErrorHelper.setErrDetInTransDet(TrasationDetail_Port,bpcFault,SdpErrorHelper.SEVERITY_FATAL);

SdpLoggerHelper.logMessage(SdpLoggerHelper.RUNTIME_FAILURE+"  SubFlow : DeleteMailBox",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);]]></wpc:javaCode>
                </wpc:script>
              </bpws:invoke>
            </bpws:catch>
            <bpws:catchAll wpc:id="2992">
              <bpws:invoke name="Handleotherfailures3" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="handle other failures" wpc:id="1364">
                <wpc:script>
                  <wpc:javaCode><![CDATA[SdpErrorHelper.setErrDetInTransDet(TrasationDetail_Port,null,SdpErrorHelper.SEVERITY_FATAL);

SdpLoggerHelper.logMessage(SdpLoggerHelper.UNKNOWN_FAILURE+"  SubFlow : DeleteMailBox",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);
]]></wpc:javaCode>
                </wpc:script>
              </bpws:invoke>
            </bpws:catchAll>
          </bpws:invoke>
          <bpws:switch name="CheckMAMError1" wpc:displayName="Check MAM Error" wpc:id="962">
            <bpws:case wpc:id="963">
              <bpws:condition><![CDATA[boolean __result__1 = com.ibm.wbiservers.brules.core.codegen.NillableUtility.getBoolean(TrasationDetail_Port, "errorIndicator", "TrasationDetail_Port");
return __result__1;

//@generated:com.ibm.wbit.activity.ui
//<?xml version="1.0" encoding="UTF-8"?>
//<com.ibm.wbit.activity:CompositeActivity xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:com.ibm.wbit.activity="http:///com/ibm/wbit/activity.ecore" name="ActivityMethod">
//  <result name="Result">
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="boolean"/>
//  </result>
//  <exceptions>
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="com.ibm.bpe.api.ProcessException"/>
//  </exceptions>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="TrasationDetail_Port.errorIndicator" field="true">
//    <dataOutputs target="//@executableElements.1"/>
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="boolean" namespace="http://www.w3.org/2001/XMLSchema" nillable="false"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:ReturnElement" dataInputs="//@executableElements.0/@dataOutputs.0"/>
//  <executableGroups executableElements="//@executableElements.0 //@executableElements.1"/>
//</com.ibm.wbit.activity:CompositeActivity>
//@generated:end
//!SMAP!*S WBIACTDBG
//!SMAP!*L
//!SMAP!1:1,1
//!SMAP!2:2,1
//!SMAP!1000000:26,1]]></bpws:condition>
              <bpws:sequence name="HiddenSequence7" wpc:id="1073742804">
                <bpws:invoke name="LogDeleteMailBoxError" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [DeleteMailBox  - Error ]" wpc:id="2252">
                  <wpc:script>
                    <wpc:javaCode><![CDATA[String strSeverity =TrasationDetail_Port.getString("errorDetails/Error/Severity");
int logLevel = SdpHelper.getLogLevel(strSeverity);
SdpLoggerHelper.logMessage("SubFlow  :DeleteMailBox - FATAL/ERROR ",PROCESS_NAME,processID,logLevel);
SdpLoggerHelper.logMessage("Response BO [TrasationDetail_Port]",PROCESS_NAME,processID,logLevel);
SdpLoggerHelper.logMessage("TrasationDetail_Port:",PROCESS_NAME,processID,logLevel);														
SdpLoggerHelper.logBO(TrasationDetail_Port,PROCESS_NAME,processID,logLevel);
SdpLoggerHelper.logMessage("SDP_ORDER_RequestPort:",PROCESS_NAME,processID,logLevel);		
SdpLoggerHelper.logBO(SDP_ORDER_RequestPort,PROCESS_NAME,processID,logLevel);
SdpLoggerHelper.logMessage("SDP_ORDER_ProvPort:",PROCESS_NAME,processID,logLevel);
SdpLoggerHelper.logBO(SDP_ORDER_ProvPort,PROCESS_NAME,processID,logLevel);																]]></wpc:javaCode>
                  </wpc:script>
                </bpws:invoke>
                <bpws:assign name="CopyPorttoRollBackobject1" wpc:displayName="Copy Port to RollBack object" wpc:id="1459">
                  <bpws:copy>
                    <bpws:from variable="SDP_ORDER_RequestPort"/>
                    <bpws:to variable="DeleteRequestState"/>
                  </bpws:copy>
                  <bpws:copy>
                    <bpws:from variable="SDP_ORDER_ProvPort"/>
                    <bpws:to variable="DeleteProvState"/>
                  </bpws:copy>
                  <bpws:copy>
                    <bpws:from>LOGERROR</bpws:from>
                    <bpws:to variable="DeleteRequestState">
                      <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/tempStoreNonArray/temp1]]></bpws:query>
                    </bpws:to>
                  </bpws:copy>
                </bpws:assign>
                <bpws:invoke name="LogUpdateMailBoxConfigCompensation2" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UpdateMailBoxConfigCompensation ]" wpc:id="2245">
                  <wpc:script>
                    <wpc:javaCode><![CDATA[
SdpLoggerHelper.logMessage(SdpLoggerHelper.INVOKE_STR +" SubFlow : UpdateMailBoxConfigCompensation",PROCESS_NAME,processID,SdpLoggerHelper.INFO);
SdpLoggerHelper.logMessage("Request BOs : ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("CreateRequestState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(CreateRequestState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("CreateProvState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(CreateProvstate,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("DeleteRequestState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(DeleteRequestState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("DeleteProvState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(DeleteProvState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("UpdateRequestState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(UpdateRequestState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("UpdateProvState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(UpdateProvState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("TransactionDetailPort :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(TrasationDetail_Port,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("SDP_ORDER_GrpMBoxInfoPort :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(SDP_ORDER_GrpMBoxInfoPort,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("IndexChangeUpdateState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(IndexChangeUpdateState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("SetSubscriberSettingsBySub :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(SetSubscriberSettingsBySub,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("PinChangeUpdateState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(PinChangeUpdateState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("TnChangeUpdateState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(TnChangeUpdateState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("AddServiceState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(AddServiceState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("RemoveServiceState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(RemoveServiceState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

CreateRequestState.setString(SdpHelper.TEMPSTRING2_PATH.replace('.','/'),processID);
]]></wpc:javaCode>
                  </wpc:script>
                </bpws:invoke>
                <bpws:assign name="MergeWESMerrortoProcobject5" wpc:displayName="Merge WESM error to Proc object" wpc:id="2479">
                  <bpws:copy>
                    <bpws:from variable="TrasationDetail_Port">
                      <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/Message]]></bpws:query>
                    </bpws:from>
                    <bpws:to variable="DeleteRequestState">
                      <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/errorDetails/Error/Message]]></bpws:query>
                    </bpws:to>
                  </bpws:copy>
                  <bpws:copy>
                    <bpws:from variable="TrasationDetail_Port"/>
                    <bpws:to variable="MailboxConfig_Proc">
                      <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail]]></bpws:query>
                    </bpws:to>
                  </bpws:copy>
                </bpws:assign>
                <bpws:invoke name="CallUpdateMailBoxConfigCompensate3" operation="compensateUpdateMailBoxConfig" partnerLink="UpdateMailBoxConfig_Compensation_Interface" portType="ns31:UpdateMailBoxConfig_Compensation_Interface" wpc:displayName="call UpdateMailBoxConfig Compensate" wpc:id="2163">
                  <wpc:input>
                    <wpc:parameter name="CreateProvState" variable="CreateProvstate"/>
                    <wpc:parameter name="CreateRequestState" variable="CreateRequestState"/>
                    <wpc:parameter name="UpdateProvState" variable="UpdateProvState"/>
                    <wpc:parameter name="TransactionDetailPort" variable="TrasationDetail_Port"/>
                    <wpc:parameter name="DeleteProvState" variable="DeleteProvState"/>
                    <wpc:parameter name="DeleteRequestState" variable="DeleteRequestState"/>
                    <wpc:parameter name="UpdateRequestState" variable="UpdateRequestState"/>
                    <wpc:parameter name="SDP_ORDER_GrpMBoxInfoPort" variable="SDP_ORDER_GrpMBoxInfoPort"/>
                    <wpc:parameter name="IndexChangeUpdateState" variable="IndexChangeUpdateState"/>
                    <wpc:parameter name="SetSubscriberSettingsBySub" variable="SetSubscriberSettingsBySub"/>
                    <wpc:parameter name="PinChangeUpdateState" variable="PinChangeUpdateState"/>
                    <wpc:parameter name="TnChangeUpdateState" variable="TnChangeUpdateState"/>
                    <wpc:parameter name="AddServiceState" variable="AddServiceState"/>
                    <wpc:parameter name="RemoveServiceState" variable="RemoveServiceState"/>
                  </wpc:input>
                  <wpc:output>
                    <wpc:parameter name="TransactionDetailPort" variable="TrasationDetail_Port"/>
                    <wpc:parameter name="SdpOrderPort" variable="SDP_ORDER_Port"/>
                  </wpc:output>
                </bpws:invoke>
                <bpws:invoke name="LogUpdateMailBoxConfigCompensation3" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [ UpdateMailBoxConfigCompensation]" wpc:id="2248">
                  <wpc:script>
                    <wpc:javaCode><![CDATA[
SdpLoggerHelper.logMessage("Received the following GBO from SubFlow : UpdateMailBoxConfigCompensation",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("TrasationDetail_Port : ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(TrasationDetail_Port,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("RollbackedMailboxes [SDP_ORDER_Port ]: ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(SDP_ORDER_Port,PROCESS_NAME,processID,SdpLoggerHelper.INFO);]]></wpc:javaCode>
                  </wpc:script>
                </bpws:invoke>
                <bpws:invoke name="MergeRollBackedMailboxesintoProc" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Merge RollBacked Mailboxes into Proc" wpc:id="2779">
                  <wpc:script>
                    <wpc:javaCode><![CDATA[DataObject tmpMailbox = null;
List lstAccountMailboxes = null;
Iterator itrAccountMailboxes = null;
List lstMailboxes = null;

SdpLoggerHelper.logMessage("Merging the RolledBack mailboxes into the response SdpOrder",
	PROCESS_NAME,processID,SdpLoggerHelper.DEBUG);

try {
	lstAccountMailboxes = 
		SDP_ORDER_Port.getList(SdpHelper.VOIP_ACCOUNTMAILBOXES_PATH.replace('.','/'));
	itrAccountMailboxes = lstAccountMailboxes.iterator();
	
	lstMailboxes = MailboxConfig_Proc.getList(SdpHelper.VOIP_ACCOUNTMAILBOXES_PATH.replace('.','/'));
	
	while(itrAccountMailboxes.hasNext())
	{		
		tmpMailbox = SDO.copy((DataObject) itrAccountMailboxes.next());
		lstMailboxes.add(tmpMailbox);
	}
}
catch(Exception ex)
{
	SdpLoggerHelper.logMessage("Failed during Merge the RolledBack mailboxes into response SdpOrder",
		PROCESS_NAME,processID,SdpLoggerHelper.DEBUG);
	SdpLoggerHelper.logMessage("Exception : " + ex,
		PROCESS_NAME,processID,SdpLoggerHelper.DEBUG);
}]]></wpc:javaCode>
                  </wpc:script>
                </bpws:invoke>
                <bpws:assign name="MergerProctoTrig8" wpc:displayName="Merger Proc to Trig" wpc:id="1461">
                  <bpws:copy>
                    <bpws:from variable="MailboxConfig_Proc"/>
                    <bpws:to variable="MailboxConfigRequest_Trig"/>
                  </bpws:copy>
                  <bpws:copy>
                    <bpws:from variable="sdpProcessContext"/>
                    <bpws:to variable="MailboxConfigRequest_Trig">
                      <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/ProcessContext]]></bpws:query>
                    </bpws:to>
                  </bpws:copy>
                </bpws:assign>
                <bpws:invoke name="LogEndProcess12" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [End Process]" wpc:id="2437">
                  <wpc:script>
                    <wpc:javaCode><![CDATA[

SdpLoggerHelper.logMessage("Returning the following GBO To MAM ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("Provisioned [MailboxConfigRequest_Trig ]: ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(MailboxConfigRequest_Trig,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("End - UpdateMailBoxConfig",PROCESS_NAME,processID,SdpLoggerHelper.INFO);]]></wpc:javaCode>
                  </wpc:script>
                </bpws:invoke>
                <bpws:reply name="ReplyUCDCLError4" operation="UpdateMailboxConfig" partnerLink="FromMam_FeaturePermissionMailboxUpdate_Interface" portType="ns3:FromMam_FeaturePermissionMailboxUpdate_Interface" wpc:displayName="Reply UCDCL Error" wpc:id="979">
                  <wpc:input>
                    <wpc:parameter name="mailboxConfigResponse" variable="MailboxConfigRequest_Trig"/>
                  </wpc:input>
                </bpws:reply>
                <bpws:terminate name="Terminate1" wpc:displayName="Terminate" wpc:id="1444"/>
              </bpws:sequence>
            </bpws:case>
          </bpws:switch>
          <bpws:invoke name="LogDeleteMailBoxSuccess" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [DeleteMailBox -Success]" wpc:id="2375">
            <wpc:script>
              <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage("SubFlow  :DeleteMailBox -"+SdpLoggerHelper.SUCCESS_STR,PROCESS_NAME,processID
														,SdpLoggerHelper.INFO);
SdpLoggerHelper.logMessage("Response BO [TrasationDetail_Port]",PROCESS_NAME,processID,SdpLoggerHelper.INFO);
SdpLoggerHelper.logMessage("TrasationDetail_Port:",PROCESS_NAME,processID,SdpLoggerHelper.INFO);														
SdpLoggerHelper.logBO(TrasationDetail_Port,PROCESS_NAME,processID,SdpLoggerHelper.INFO);
SdpLoggerHelper.logMessage("SDP_ORDER_RequestPort:",PROCESS_NAME,processID,SdpLoggerHelper.INFO);		
SdpLoggerHelper.logBO(SDP_ORDER_RequestPort,PROCESS_NAME,processID,SdpLoggerHelper.INFO);
SdpLoggerHelper.logMessage("SDP_ORDER_ProvPort:",PROCESS_NAME,processID,SdpLoggerHelper.INFO);
SdpLoggerHelper.logBO(SDP_ORDER_ProvPort,PROCESS_NAME,processID,SdpLoggerHelper.INFO);																]]></wpc:javaCode>
            </wpc:script>
          </bpws:invoke>
          <bpws:assign name="SavingStateForRollback1" wpc:displayName="Saving State For  Rollback " wpc:id="1473">
            <bpws:copy>
              <bpws:from variable="SDP_ORDER_RequestPort"/>
              <bpws:to variable="DeleteRequestState"/>
            </bpws:copy>
            <bpws:copy>
              <bpws:from variable="MailboxConfig_Prov"/>
              <bpws:to variable="DeleteProvState"/>
            </bpws:copy>
            <bpws:copy>
              <bpws:from>LOGERROR</bpws:from>
              <bpws:to variable="DeleteRequestState">
                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/tempStoreNonArray/temp1]]></bpws:query>
              </bpws:to>
            </bpws:copy>
            <bpws:copy>
              <bpws:from>5</bpws:from>
              <bpws:to variable="DeleteRequestState">
                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/tempStoreNonArray/temp11]]></bpws:query>
              </bpws:to>
            </bpws:copy>
          </bpws:assign>
          <bpws:assign name="PostInvokeAssigns1" wpc:displayName="PostInvokeAssigns" wpc:id="1238">
            <bpws:copy>
              <bpws:from variable="SDP_ORDER_ProvPort">
                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/order]]></bpws:query>
              </bpws:from>
              <bpws:to variable="SDP_ORDER_Prov">
                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/order]]></bpws:query>
              </bpws:to>
            </bpws:copy>
            <bpws:copy>
              <bpws:from variable="SDP_ORDER_RequestPort">
                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[transactionDetail/UMMessageCenterIP]]></bpws:query>
              </bpws:from>
              <bpws:to variable="UMMessageCenterIP"/>
            </bpws:copy>
          </bpws:assign>
          <bpws:assign name="PreInvokeAssigns14" wpc:displayName="Pre-Invoke Assigns" wpc:id="1573">
            <bpws:copy>
              <bpws:from variable="emptySDPOrder"/>
              <bpws:to variable="SDP_ORDER_RequestPort"/>
            </bpws:copy>
            <bpws:copy>
              <bpws:from variable="emptyTransactionDetail"/>
              <bpws:to variable="TrasationDetail_Port"/>
            </bpws:copy>
            <bpws:copy>
              <bpws:from variable="emptySDPOrder"/>
              <bpws:to variable="SDP_ORDER_ProvPort"/>
            </bpws:copy>
            <bpws:copy>
              <bpws:from>MAM.UpdateMailBox.request</bpws:from>
              <bpws:to variable="TrasationDetail_Port">
                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/State]]></bpws:query>
              </bpws:to>
            </bpws:copy>
            <bpws:copy>
              <bpws:from>MAM</bpws:from>
              <bpws:to variable="TrasationDetail_Port">
                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/TargetSystem]]></bpws:query>
              </bpws:to>
            </bpws:copy>
            <bpws:copy>
              <bpws:from>UpdateMailBox</bpws:from>
              <bpws:to variable="TrasationDetail_Port">
                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/currentTargetOperation]]></bpws:query>
              </bpws:to>
            </bpws:copy>
            <bpws:copy>
              <bpws:from variable="UMMessageCenterIP"/>
              <bpws:to variable="MailboxConfig_Proc">
                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[transactionDetail/UMMessageCenterIP]]></bpws:query>
              </bpws:to>
            </bpws:copy>
          </bpws:assign>
          <bpws:invoke name="LogUpdateMailBox" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UpdateMailBox ]" wpc:id="2260">
            <wpc:script>
              <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage(SdpLoggerHelper.INVOKE_STR +" SubFlow : UpdateMailBox",PROCESS_NAME,
	processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("Request BO:[SDP_ORDER]",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("MailboxConfig_Proc:",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(MailboxConfig_Proc,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("SDP_ORDER_Prov:",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(SDP_ORDER_Prov,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("SDP_Order_Prov_Updated:",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(SDP_Order_Prov_Updated,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

MailboxConfig_Proc.setString(SdpHelper.TEMPSTRING2_PATH.replace('.','/'),processID);]]></wpc:javaCode>
            </wpc:script>
          </bpws:invoke>
          <bpws:invoke name="InvokeUpdateMailBox" operation="UpdateMailBox" partnerLink="FromMam_UpdateMailBox_Interface" portType="ns15:FromMam_UpdateMailBox_Interface" wpc:displayName="Invoke UpdateMailBox" wpc:id="1485">
            <wpc:input>
              <wpc:parameter name="SDP_ORDER_Prov" variable="SDP_ORDER_Prov"/>
              <wpc:parameter name="SDP_ORDER_Request" variable="MailboxConfig_Proc"/>
              <wpc:parameter name="SDP_ORDER_Prov_Updated" variable="SDP_Order_Prov_Updated"/>
            </wpc:input>
            <wpc:output>
              <wpc:parameter name="SDP_ORDER_ProvPort" variable="SDP_ORDER_ProvPort"/>
              <wpc:parameter name="Transaction_Detail" variable="TrasationDetail_Port"/>
              <wpc:parameter name="SDP_ORDER_RequestPort" variable="SDP_ORDER_RequestPort"/>
              <wpc:parameter name="SDP_ORDER_Prov_Updated" variable="SDP_Order_Prov_Updated"/>
            </wpc:output>
            <bpws:catch faultName="wpc:runtimeFailure" faultVariable="bpcFault" wpc:faultType="wpc:BPCStandardFaultType" wpc:id="2995" wpc:variableId="1516">
              <bpws:invoke name="Handleruntimeexception2" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="handle run time exception" wpc:id="1519">
                <wpc:script>
                  <wpc:javaCode><![CDATA[SdpErrorHelper.setErrDetInTransDet(TrasationDetail_Port,bpcFault,SdpErrorHelper.SEVERITY_FATAL);

SdpLoggerHelper.logMessage(SdpLoggerHelper.RUNTIME_FAILURE+" SubFlow : UpdateMailBox",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);]]></wpc:javaCode>
                </wpc:script>
              </bpws:invoke>
            </bpws:catch>
            <bpws:catchAll wpc:id="2994">
              <bpws:invoke name="Handleotherfailures4" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="handle other failures" wpc:id="1522">
                <wpc:script>
                  <wpc:javaCode><![CDATA[SdpErrorHelper.setErrDetInTransDet(TrasationDetail_Port,null,SdpErrorHelper.SEVERITY_FATAL);

SdpLoggerHelper.logMessage(SdpLoggerHelper.UNKNOWN_FAILURE+"  SubFlow : UpdateMailBox",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);
]]></wpc:javaCode>
                </wpc:script>
              </bpws:invoke>
            </bpws:catchAll>
          </bpws:invoke>
          <bpws:switch name="CheckMAMError2" wpc:displayName="Check MAM Error" wpc:id="981">
            <bpws:case wpc:id="982">
              <bpws:condition><![CDATA[boolean __result__1 = com.ibm.wbiservers.brules.core.codegen.NillableUtility.getBoolean(TrasationDetail_Port, "errorIndicator", "TrasationDetail_Port");
return __result__1;

//@generated:com.ibm.wbit.activity.ui
//<?xml version="1.0" encoding="UTF-8"?>
//<com.ibm.wbit.activity:CompositeActivity xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:com.ibm.wbit.activity="http:///com/ibm/wbit/activity.ecore" name="ActivityMethod">
//  <result name="Result">
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="boolean"/>
//  </result>
//  <exceptions>
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="com.ibm.bpe.api.ProcessException"/>
//  </exceptions>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="TrasationDetail_Port.errorIndicator" field="true">
//    <dataOutputs target="//@executableElements.1"/>
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="boolean" namespace="http://www.w3.org/2001/XMLSchema" nillable="false"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:ReturnElement" dataInputs="//@executableElements.0/@dataOutputs.0"/>
//  <executableGroups executableElements="//@executableElements.0 //@executableElements.1"/>
//</com.ibm.wbit.activity:CompositeActivity>
//@generated:end
//!SMAP!*S WBIACTDBG
//!SMAP!*L
//!SMAP!1:1,1
//!SMAP!2:2,1
//!SMAP!1000000:26,1]]></bpws:condition>
              <bpws:sequence name="HiddenSequence8" wpc:id="1073742823">
                <bpws:invoke name="LogUpdateMailBoxError" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UpdateMailBox   - Error]" wpc:id="2262">
                  <wpc:script>
                    <wpc:javaCode><![CDATA[String strSeverity =TrasationDetail_Port.getString("errorDetails/Error/Severity");
int logLevel = SdpHelper.getLogLevel(strSeverity);
SdpLoggerHelper.logMessage("SubFlow  :UpdateMailBox - "+SdpLoggerHelper.ERROR_STR+"["+strSeverity+"]",PROCESS_NAME,processID,logLevel);
SdpLoggerHelper.logMessage("Response BO [TrasationDetail]",PROCESS_NAME,processID,logLevel);
SdpLoggerHelper.logMessage("TrasationDetail_Port:",PROCESS_NAME,processID,logLevel);														
SdpLoggerHelper.logBO(TrasationDetail_Port,PROCESS_NAME,processID,logLevel);
SdpLoggerHelper.logMessage("SDP_ORDER_RequestPort:",PROCESS_NAME,processID,logLevel);		
SdpLoggerHelper.logBO(SDP_ORDER_RequestPort,PROCESS_NAME,processID,logLevel);
SdpLoggerHelper.logMessage("SDP_ORDER_ProvPort:",PROCESS_NAME,processID,logLevel);
SdpLoggerHelper.logBO(SDP_ORDER_ProvPort,PROCESS_NAME,processID,logLevel);	
SdpLoggerHelper.logMessage("SDP_ORDER_Port:",PROCESS_NAME,processID,logLevel);
SdpLoggerHelper.logBO(SDP_ORDER_Port,PROCESS_NAME,processID,logLevel);																	]]></wpc:javaCode>
                  </wpc:script>
                </bpws:invoke>
                <bpws:assign name="CopyPorttoRollBackobject2" wpc:displayName="Copy Port to RollBack object" wpc:id="1441">
                  <bpws:copy>
                    <bpws:from variable="SDP_ORDER_RequestPort"/>
                    <bpws:to variable="UpdateRequestState"/>
                  </bpws:copy>
                  <bpws:copy>
                    <bpws:from variable="MailboxConfig_Prov"/>
                    <bpws:to variable="UpdateProvState"/>
                  </bpws:copy>
                  <bpws:copy>
                    <bpws:from>LOGERROR</bpws:from>
                    <bpws:to variable="UpdateRequestState">
                      <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/tempStoreNonArray/temp1]]></bpws:query>
                    </bpws:to>
                  </bpws:copy>
                </bpws:assign>
                <bpws:invoke name="LogUpdateMailBoxConfigCompensation4" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UpdateMailBoxConfigCompensation ]" wpc:id="2255">
                  <wpc:script>
                    <wpc:javaCode><![CDATA[
SdpLoggerHelper.logMessage(SdpLoggerHelper.INVOKE_STR +" SubFlow : UpdateMailBoxConfigCompensation",PROCESS_NAME,processID,SdpLoggerHelper.INFO);
SdpLoggerHelper.logMessage("Request BOs : ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("CreateRequestState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(CreateRequestState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("CreateProvState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(CreateProvstate,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("DeleteRequestState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(DeleteRequestState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("DeleteProvState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(DeleteProvState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("UpdateRequestState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(UpdateRequestState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("UpdateProvState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(UpdateProvState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("TransactionDetailPort :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(TrasationDetail_Port,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("SDP_ORDER_GrpMBoxInfoPort :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(SDP_ORDER_GrpMBoxInfoPort,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("IndexChangeUpdateState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(IndexChangeUpdateState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("SetSubscriberSettingsBySub :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(SetSubscriberSettingsBySub,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("PinChangeUpdateState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(PinChangeUpdateState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("TnChangeUpdateState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(TnChangeUpdateState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("AddServiceState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(AddServiceState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("RemoveServiceState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(RemoveServiceState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

CreateRequestState.setString(SdpHelper.TEMPSTRING2_PATH.replace('.','/'),processID);
]]></wpc:javaCode>
                  </wpc:script>
                </bpws:invoke>
                <bpws:assign name="MergeWESMerrortoProcobject6" wpc:displayName="Merge WESM error to Proc object" wpc:id="2481">
                  <bpws:copy>
                    <bpws:from variable="TrasationDetail_Port">
                      <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/Message]]></bpws:query>
                    </bpws:from>
                    <bpws:to variable="UpdateRequestState">
                      <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/errorDetails/Error/Message]]></bpws:query>
                    </bpws:to>
                  </bpws:copy>
                  <bpws:copy>
                    <bpws:from variable="TrasationDetail_Port"/>
                    <bpws:to variable="MailboxConfig_Proc">
                      <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail]]></bpws:query>
                    </bpws:to>
                  </bpws:copy>
                </bpws:assign>
                <bpws:invoke name="CallUpdateMailBoxConfigCompensate1" operation="compensateUpdateMailBoxConfig" partnerLink="UpdateMailBoxConfig_Compensation_Interface" portType="ns31:UpdateMailBoxConfig_Compensation_Interface" wpc:displayName="call UpdateMailBoxConfig Compensate" wpc:id="2165">
                  <wpc:input>
                    <wpc:parameter name="CreateProvState" variable="CreateProvstate"/>
                    <wpc:parameter name="CreateRequestState" variable="CreateRequestState"/>
                    <wpc:parameter name="UpdateProvState" variable="UpdateProvState"/>
                    <wpc:parameter name="TransactionDetailPort" variable="TrasationDetail_Port"/>
                    <wpc:parameter name="DeleteProvState" variable="DeleteProvState"/>
                    <wpc:parameter name="DeleteRequestState" variable="DeleteRequestState"/>
                    <wpc:parameter name="UpdateRequestState" variable="UpdateRequestState"/>
                    <wpc:parameter name="SDP_ORDER_GrpMBoxInfoPort" variable="SDP_ORDER_GrpMBoxInfoPort"/>
                    <wpc:parameter name="IndexChangeUpdateState" variable="IndexChangeUpdateState"/>
                    <wpc:parameter name="SetSubscriberSettingsBySub" variable="SetSubscriberSettingsBySub"/>
                    <wpc:parameter name="PinChangeUpdateState" variable="PinChangeUpdateState"/>
                    <wpc:parameter name="TnChangeUpdateState" variable="TnChangeUpdateState"/>
                    <wpc:parameter name="AddServiceState" variable="AddServiceState"/>
                    <wpc:parameter name="RemoveServiceState" variable="RemoveServiceState"/>
                  </wpc:input>
                  <wpc:output>
                    <wpc:parameter name="TransactionDetailPort" variable="TrasationDetail_Port"/>
                    <wpc:parameter name="SdpOrderPort" variable="SDP_ORDER_Port"/>
                  </wpc:output>
                </bpws:invoke>
                <bpws:invoke name="LogUpdateMailBoxConfigCompensation5" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UpdateMailBoxConfigCompensation ]" wpc:id="2258">
                  <wpc:script>
                    <wpc:javaCode><![CDATA[
SdpLoggerHelper.logMessage("Received the following GBO from SubFlow : UpdateMailBoxConfigCompensation  ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("TrasationDetail_Port : ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(TrasationDetail_Port,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

]]></wpc:javaCode>
                  </wpc:script>
                </bpws:invoke>
                <bpws:invoke name="MergeRollBackedMailboxesintoProc2" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Merge RollBacked Mailboxes into Proc" wpc:id="2784">
                  <wpc:script>
                    <wpc:javaCode><![CDATA[DataObject tmpMailbox = null;
List lstAccountMailboxes = null;
Iterator itrAccountMailboxes = null;
List lstMailboxes = null;

SdpLoggerHelper.logMessage("Merging the RolledBack mailboxes into the response SdpOrder",
	PROCESS_NAME,processID,SdpLoggerHelper.DEBUG);

try {
	lstAccountMailboxes = 
		SDP_ORDER_Port.getList(SdpHelper.VOIP_ACCOUNTMAILBOXES_PATH.replace('.','/'));
	itrAccountMailboxes = lstAccountMailboxes.iterator();
	
	lstMailboxes = MailboxConfig_Proc.getList(SdpHelper.VOIP_ACCOUNTMAILBOXES_PATH.replace('.','/'));
	
	while(itrAccountMailboxes.hasNext())
	{		
		tmpMailbox = SDO.copy((DataObject) itrAccountMailboxes.next());
		lstMailboxes.add(tmpMailbox);
	}
}
catch(Exception ex)
{
	SdpLoggerHelper.logMessage("Failed during Merge the RolledBack mailboxes into response SdpOrder",
		PROCESS_NAME,processID,SdpLoggerHelper.DEBUG);
	SdpLoggerHelper.logMessage("Exception : " + ex,
		PROCESS_NAME,processID,SdpLoggerHelper.DEBUG);
}]]></wpc:javaCode>
                  </wpc:script>
                </bpws:invoke>
                <bpws:assign name="MergerProctoTrig9" wpc:displayName="Merger Proc to Trig" wpc:id="996">
                  <bpws:copy>
                    <bpws:from variable="MailboxConfig_Proc"/>
                    <bpws:to variable="MailboxConfigRequest_Trig"/>
                  </bpws:copy>
                  <bpws:copy>
                    <bpws:from variable="sdpProcessContext"/>
                    <bpws:to variable="MailboxConfigRequest_Trig">
                      <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/ProcessContext]]></bpws:query>
                    </bpws:to>
                  </bpws:copy>
                </bpws:assign>
                <bpws:invoke name="LogEndProcess11" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [End Process]" wpc:id="2435">
                  <wpc:script>
                    <wpc:javaCode><![CDATA[

SdpLoggerHelper.logMessage("Returning the following GBO To MAM ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("Provisioned [MailboxConfigRequest_Trig ]: ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(MailboxConfigRequest_Trig,PROCESS_NAME,processID,SdpLoggerHelper.INFO);


SdpLoggerHelper.logMessage("End - UpdateMailBoxConfig",PROCESS_NAME,processID,SdpLoggerHelper.INFO);]]></wpc:javaCode>
                  </wpc:script>
                </bpws:invoke>
                <bpws:reply name="ReplyUCDCLError5" operation="UpdateMailboxConfig" partnerLink="FromMam_FeaturePermissionMailboxUpdate_Interface" portType="ns3:FromMam_FeaturePermissionMailboxUpdate_Interface" wpc:displayName="Reply UCDCL Error" wpc:id="998">
                  <wpc:input>
                    <wpc:parameter name="mailboxConfigResponse" variable="MailboxConfigRequest_Trig"/>
                  </wpc:input>
                </bpws:reply>
                <bpws:terminate name="Terminate2" wpc:displayName="Terminate2" wpc:id="1445"/>
              </bpws:sequence>
            </bpws:case>
          </bpws:switch>
          <bpws:invoke name="LogUpdateMailBoxSuccess" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UpdateMailBox -Success]" wpc:id="2378">
            <wpc:script>
              <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage("SubFlow  :UpdateMailBox -"+SdpLoggerHelper.SUCCESS_STR,PROCESS_NAME,processID
														,SdpLoggerHelper.INFO);
SdpLoggerHelper.logMessage("Response BO [TrasationDetail]",PROCESS_NAME,processID,SdpLoggerHelper.INFO);
SdpLoggerHelper.logMessage("TrasationDetail_Port:",PROCESS_NAME,processID,SdpLoggerHelper.INFO);														
SdpLoggerHelper.logBO(TrasationDetail_Port,PROCESS_NAME,processID,SdpLoggerHelper.INFO);
SdpLoggerHelper.logMessage("SDP_ORDER_RequestPort:",PROCESS_NAME,processID,SdpLoggerHelper.INFO);		
SdpLoggerHelper.logBO(SDP_ORDER_RequestPort,PROCESS_NAME,processID,SdpLoggerHelper.INFO);
SdpLoggerHelper.logMessage("SDP_ORDER_ProvPort:",PROCESS_NAME,processID,SdpLoggerHelper.INFO);
SdpLoggerHelper.logBO(SDP_ORDER_ProvPort,PROCESS_NAME,processID,SdpLoggerHelper.INFO);	
SdpLoggerHelper.logMessage("SDP_ORDER_Port:",PROCESS_NAME,processID,SdpLoggerHelper.INFO);
SdpLoggerHelper.logBO(SDP_ORDER_Port,PROCESS_NAME,processID,SdpLoggerHelper.INFO);
]]></wpc:javaCode>
            </wpc:script>
          </bpws:invoke>
          <bpws:invoke name="LogMailboxConfigProcandProv" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [Mailbox Config Proc and Prov]" wpc:id="2608">
            <wpc:script>
              <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage("Mailbox config Request", PROCESS_NAME, processID, SdpLoggerHelper.DEBUG);
SdpLoggerHelper.logBO(MailboxConfig_Proc ,PROCESS_NAME,processID,SdpLoggerHelper.DEBUG);

SdpLoggerHelper.logMessage("Mailbox Config Prov", PROCESS_NAME, processID, SdpLoggerHelper.DEBUG);
SdpLoggerHelper.logBO(SDP_ORDER_Prov, PROCESS_NAME, processID, SdpLoggerHelper.DEBUG);]]></wpc:javaCode>
            </wpc:script>
          </bpws:invoke>
          <bpws:assign name="SavingStateForRollback2" wpc:displayName="Saving State For  Rollback " wpc:id="1563">
            <bpws:copy>
              <bpws:from variable="SDP_ORDER_RequestPort"/>
              <bpws:to variable="UpdateRequestState"/>
            </bpws:copy>
            <bpws:copy>
              <bpws:from variable="MailboxConfig_Prov"/>
              <bpws:to variable="UpdateProvState"/>
            </bpws:copy>
            <bpws:copy>
              <bpws:from variable="SDP_ORDER_RequestPort">
                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[transactionDetail/UMMessageCenterIP]]></bpws:query>
              </bpws:from>
              <bpws:to variable="UMMessageCenterIP"/>
            </bpws:copy>
          </bpws:assign>
          <bpws:invoke name="FindtheListofMailboxeswhereIndexisChanged1" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Find the List of Mailboxes where Index is Changed" wpc:id="1101">
            <wpc:script>
              <wpc:javaCode><![CDATA[List reqMailboxList = null;
List provMailboxList = null;
List accountMailBoxList = null;
List tempList = null;
Iterator iterReqMailbox = null;
String reqMailBoxInvariantId = null;
Integer reqMBoxInd = null;
Integer provMBoxInd = null;
// create SDP_ServiceCvoipSettings
MailboxConfig_Proc = SDO.copy(MailboxConfigRequest_Trig);
SDP_ORDER_Prov = SDO.copy(MailboxConfig_Prov);
indexChangedMBoxList = SDO.getBOFactory().create("http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_ServiceCvoipSettings", "SDP_ServiceCvoipSettings");
tmpSdpOrder_ForCopy = SDO.copy(SDP_Order_Prov_Updated);
accountMailBoxList = new Order(tmpSdpOrder_ForCopy).getProductList(Product.CVOIPMAILBOX);
indexChangedMBoxList.set(SdpHelper.CVOIP_MAILBOX, accountMailBoxList);
reqMailboxList = new Order(MailboxConfig_Proc).getProductList(Product.CVOIPMAILBOX);

if(reqMailboxList != null && reqMailboxList.size() > 0) {
	iterReqMailbox = reqMailboxList.iterator();			
	//loop reqMailBox 
	while(iterReqMailbox.hasNext()) {	
		reqMBox = (DataObject)iterReqMailbox.next();
		reqMailBoxInvariantId = reqMBox.getString(SdpHelper.CVOIP_MAILBOX_MAILBOXINVARIANTID);
		reqMBoxInd = new Integer(reqMBox.getInt(SdpHelper.CVOIP_MAILBOX_INDEX));
		if (reqMailBoxInvariantId != null){
			provMBox = SdpHelper.getMailBox(SDP_ORDER_Prov,reqMailBoxInvariantId);
			if(provMBox != null){
				provMBoxInd = new Integer(provMBox.getInt(SdpHelper.CVOIP_MAILBOX_INDEX));			
				if(reqMBoxInd != null && ( provMBoxInd == null || provMBoxInd.intValue() != reqMBoxInd.intValue())){
					tempList = indexChangedMBoxList.getList(SdpHelper.CVOIP_MAILBOX);
					tempList.add(SDO.copy(reqMBox));
					
				}
			}
		}
	}
}]]></wpc:javaCode>
            </wpc:script>
          </bpws:invoke>
          <bpws:invoke name="LogMailboxConfigProcandProv1" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [Mailbox Config Proc and Prov]" wpc:id="2611">
            <wpc:script>
              <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage("After Checking Index", PROCESS_NAME, processID, SdpLoggerHelper.DEBUG);

SdpLoggerHelper.logMessage("Mailbox config Request", PROCESS_NAME, processID, SdpLoggerHelper.DEBUG);
SdpLoggerHelper.logBO(MailboxConfig_Proc ,PROCESS_NAME,processID,SdpLoggerHelper.DEBUG);

SdpLoggerHelper.logMessage("Mailbox Config Prov", PROCESS_NAME, processID, SdpLoggerHelper.DEBUG);
SdpLoggerHelper.logBO(SDP_ORDER_Prov, PROCESS_NAME, processID, SdpLoggerHelper.DEBUG);

SdpLoggerHelper.logMessage("indexChangedMBoxList", PROCESS_NAME, processID, SdpLoggerHelper.DEBUG);
SdpLoggerHelper.logBO(indexChangedMBoxList, PROCESS_NAME, processID, SdpLoggerHelper.DEBUG);]]></wpc:javaCode>
            </wpc:script>
          </bpws:invoke>
          <bpws:invoke name="SetIndexChangeUpdateStateRollBack" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Set IndexChangeUpdateState [RollBack]" wpc:id="2612">
            <wpc:script>
              <wpc:javaCode><![CDATA[IndexChangeUpdateState = SDO.copy(MailboxConfig_Proc);
IndexChangeUpdateState.getList(SdpHelper.VOIP_ACCOUNTMAILBOXES_PATH.replace('.','/')).clear();]]></wpc:javaCode>
            </wpc:script>
          </bpws:invoke>
          <bpws:switch name="IstheIndexofMailboxesChanged" wpc:displayName="Is the Index of Mailbox(es) Changed?" wpc:id="1087">
            <bpws:case wpc:id="1088">
              <bpws:condition><![CDATA[boolean __result__1 = com.ibm.wbiservers.brules.core.codegen.NillableUtility.getList(indexChangedMBoxList, "accountMailBoxes", "indexChangedMBoxList").size() > 0;
return __result__1;

//@generated:com.ibm.wbit.activity.ui
//<?xml version="1.0" encoding="UTF-8"?>
//<com.ibm.wbit.activity:CompositeActivity xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:com.ibm.wbit.activity="http:///com/ibm/wbit/activity.ecore" name="ActivityMethod">
//  <result name="Result">
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="boolean"/>
//  </result>
//  <exceptions>
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="com.ibm.bpe.api.ProcessException"/>
//  </exceptions>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="indexChangedMBoxList.accountMailBoxes.size() > 0" assignable="false">
//    <dataOutputs target="//@executableElements.1"/>
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="boolean"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:ReturnElement" dataInputs="//@executableElements.0/@dataOutputs.0"/>
//  <executableGroups executableElements="//@executableElements.0 //@executableElements.1"/>
//</com.ibm.wbit.activity:CompositeActivity>
//@generated:end
//!SMAP!*S WBIACTDBG
//!SMAP!*L
//!SMAP!1:1,1
//!SMAP!2:2,1
//!SMAP!1000000:26,1]]></bpws:condition>
              <bpws:sequence name="HiddenSequence22" wpc:id="1073744725">
                <bpws:assign name="PreInvokeAssigns17" wpc:displayName="Pre-Invoke Assigns " wpc:id="2522">
                  <bpws:copy>
                    <bpws:from variable="emptyTransactionDetail"/>
                    <bpws:to variable="TrasationDetail_Port"/>
                  </bpws:copy>
                  <bpws:copy>
                    <bpws:from>UCDCL.DelegatedLogin.request</bpws:from>
                    <bpws:to variable="TrasationDetail_Port">
                      <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/State]]></bpws:query>
                    </bpws:to>
                  </bpws:copy>
                  <bpws:copy>
                    <bpws:from>UCDCL</bpws:from>
                    <bpws:to variable="TrasationDetail_Port">
                      <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/TargetSystem]]></bpws:query>
                    </bpws:to>
                  </bpws:copy>
                  <bpws:copy>
                    <bpws:from>DelegatedLogin</bpws:from>
                    <bpws:to variable="TrasationDetail_Port">
                      <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/currentTargetOperation]]></bpws:query>
                    </bpws:to>
                  </bpws:copy>
                </bpws:assign>
                <bpws:invoke name="CreateloginId1" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="create loginId" wpc:id="2524">
                  <wpc:script>
                    <wpc:javaCode><![CDATA[String strTn = null;
String strPTL = null;
try{       
	DataObject primaryMBox = (DataObject)SdpHelper.getPrimaryMailBox(SDP_ORDER_Prov);
	DataObject primaryCvoipLine = SdpHelper.getPrimaryOrSecondaryTN(SDP_ORDER_Prov,SdpHelper.YES);
	strPTL = primaryCvoipLine.getString("tnInfo/tn");
	SdpLoggerHelper.logMessage("strPTL : " + strPTL, PROCESS_NAME, processID, SdpLoggerHelper.INFO);
	if (primaryMBox != null ) {
		List mailboxTnlist = primaryMBox.getList("mailBoxTNs");
		if (mailboxTnlist != null && mailboxTnlist.size() > 0) {
			for (Iterator tnItr = mailboxTnlist.iterator(); tnItr.hasNext();){
				strTn = ((DataObject)tnItr.next()).getString("tn");
				if (strPTL.equalsIgnoreCase(strTn)){
					loginId = strTn;
					break;				
				}
			}			
		}
	} 
	SdpLoggerHelper.logMessage("SubscriberID [PTL]: " + loginId, PROCESS_NAME, processID, SdpLoggerHelper.INFO);
} catch(Exception ex) {
	SdpLoggerHelper.logMessage("Exception Occured: " + ex, PROCESS_NAME, processID, SdpLoggerHelper.INFO);
}

/*DataObject primaryMBox = SdpHelper.getPrimaryMailBox(SDP_ORDER_Prov);

if (primaryMBox != null)
{
	loginId = primaryMBox.getString(SdpHelper.CVOIP_MAILBOX_MAILBOXINVARIANTID);
	SdpLoggerHelper.logMessage("Getting mailBoxInvarintId [" + loginId + "] of PrimaryMailbox for Delegated login", 
		PROCESS_NAME, processID, SdpLoggerHelper.INFO);
}*/
]]></wpc:javaCode>
                  </wpc:script>
                </bpws:invoke>
                <bpws:assign name="SetupGBOforlogin" wpc:displayName="Set up GBO for login" wpc:id="2940">
                  <bpws:copy>
                    <bpws:from variable="loginId"/>
                    <bpws:to variable="processBO">
                      <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[order/ReqService/product/cvoipProduct/accountMailBoxes[1]/mailBoxInvariantId]]></bpws:query>
                    </bpws:to>
                  </bpws:copy>
                  <bpws:copy>
                    <bpws:from variable="UMMessageCenterIP"/>
                    <bpws:to variable="processBO">
                      <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[transactionDetail/UMMessageCenterIP]]></bpws:query>
                    </bpws:to>
                  </bpws:copy>
                </bpws:assign>
                <bpws:invoke name="LogUCDCLDelegatedLogin1" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UCDCL.DelegatedLogin ]" wpc:id="2526">
                  <wpc:script>
                    <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage(SdpLoggerHelper.INVOKE_STR +" : UCDCL.DelegatedLogin",PROCESS_NAME,processID
														,SdpLoggerHelper.INFO);
														



																		]]></wpc:javaCode>
                  </wpc:script>
                </bpws:invoke>
                <bpws:invoke name="CallDelegatedLogin1" operation="delegatedLogin" partnerLink="UcdclCompensableService_Interface" portType="ns37:UCDCLCompensableService_Interface" wpc:displayName="Call Delegated Login" wpc:id="2527">
                  <wpc:input>
                    <wpc:parameter name="order" variable="processBO"/>
                  </wpc:input>
                  <wpc:output>
                    <wpc:parameter name="transactionDetail" variable="processTransDetail"/>
                  </wpc:output>
                  <bpws:catch faultName="ns37:serviceCallFault" faultVariable="scFault" wpc:faultType="java:ServiceCallFault" wpc:id="3004" wpc:variableId="2528">
                    <bpws:invoke name="SetErrorDetails6" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Set Error Details" wpc:id="2530">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[TrasationDetail_Port.setBoolean(SdpHelper.ERRORINDICATOR,true);

new att.lightspeed.sdp.helper.TransactionDetail(TrasationDetail_Port).setSDPErrorMessage(scFault);

TrasationDetail_Port.getDataObject("errorDetails").getDataObject("Error").setString("Severity",SdpErrorHelper.SEVERITY_FATAL);

 
SdpLoggerHelper.logMessage(SdpLoggerHelper.FAULT_FAILURE +"  UCDCL.DelegatedLogin",PROCESS_NAME,processID,SdpLoggerHelper.FATAL); 
 
]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                  </bpws:catch>
                  <bpws:catch faultName="wpc:runtimeFailure" faultVariable="bpcFault" wpc:faultType="wpc:BPCStandardFaultType" wpc:id="3005" wpc:variableId="2534">
                    <bpws:invoke name="HandleRuntimeFailure4" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Handle Run time Failure" wpc:id="2536">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[SdpErrorHelper.setErrDetInTransDet(TrasationDetail_Port,bpcFault,SdpErrorHelper.SEVERITY_FATAL);

SdpLoggerHelper.logMessage(SdpLoggerHelper.RUNTIME_FAILURE+"   UCDCL.DelegatedLogin",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                  </bpws:catch>
                  <bpws:catchAll wpc:id="3003">
                    <bpws:invoke name="Handleotherfailures8" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="handle other failures" wpc:id="2538">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[SdpErrorHelper.setErrDetInTransDet(TrasationDetail_Port,null,SdpErrorHelper.SEVERITY_FATAL);

SdpLoggerHelper.logMessage(SdpLoggerHelper.UNKNOWN_FAILURE+"   UCDCL.DelegatedLogin",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                  </bpws:catchAll>
                </bpws:invoke>
                <bpws:switch name="CheckUCDCLerror" wpc:displayName="Check UCDCL error" wpc:id="174">
                  <bpws:case wpc:id="175">
                    <bpws:condition><![CDATA[boolean __result__1 = com.ibm.wbiservers.brules.core.codegen.NillableUtility.getBoolean(TrasationDetail_Port, "errorIndicator", "TrasationDetail_Port");
return __result__1;

//@generated:com.ibm.wbit.activity.ui
//<?xml version="1.0" encoding="UTF-8"?>
//<com.ibm.wbit.activity:CompositeActivity xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:com.ibm.wbit.activity="http:///com/ibm/wbit/activity.ecore" name="ActivityMethod">
//  <result name="Result">
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="boolean"/>
//  </result>
//  <exceptions>
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="com.ibm.bpe.api.ProcessException"/>
//  </exceptions>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="TrasationDetail_Port.errorIndicator" field="true">
//    <dataOutputs target="//@executableElements.1"/>
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="boolean" namespace="http://www.w3.org/2001/XMLSchema" nillable="false"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:ReturnElement" dataInputs="//@executableElements.0/@dataOutputs.0"/>
//  <executableGroups executableElements="//@executableElements.0 //@executableElements.1"/>
//</com.ibm.wbit.activity:CompositeActivity>
//@generated:end
//!SMAP!*S WBIACTDBG
//!SMAP!*L
//!SMAP!1:1,1
//!SMAP!2:2,1
//!SMAP!1000000:26,1]]></bpws:condition>
                    <bpws:sequence name="HiddenSequence19" wpc:id="1073744726">
                      <bpws:invoke name="LogUCDCLDelegatedLoginError1" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UCDCL.DelegatedLogin  - Error ]" wpc:id="2540">
                        <wpc:script>
                          <wpc:javaCode><![CDATA[String strSeverity =TrasationDetail_Port.getString("errorDetails/Error/Severity");
int logLevel = SdpHelper.getLogLevel(strSeverity);
SdpLoggerHelper.logMessage("Returning : UCDCL.DelegatedLogin- "+SdpLoggerHelper.ERROR_STR+"["+strSeverity+"]",PROCESS_NAME,processID,logLevel);
														



																		]]></wpc:javaCode>
                        </wpc:script>
                      </bpws:invoke>
                      <bpws:invoke name="LogUpdateMailBoxConfigCompensation16" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UpdateMailBoxConfigCompensation ]" wpc:id="2768">
                        <wpc:script>
                          <wpc:javaCode><![CDATA[
SdpLoggerHelper.logMessage(SdpLoggerHelper.INVOKE_STR +" SubFlow : UpdateMailBoxConfigCompensation",PROCESS_NAME,processID,SdpLoggerHelper.INFO);
SdpLoggerHelper.logMessage("Request BOs : ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("CreateRequestState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(CreateRequestState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("CreateProvState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(CreateProvstate,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("DeleteRequestState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(DeleteRequestState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("DeleteProvState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(DeleteProvState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("UpdateRequestState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(UpdateRequestState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("UpdateProvState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(UpdateProvState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("TransactionDetailPort :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(TrasationDetail_Port,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("SDP_ORDER_GrpMBoxInfoPort :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(SDP_ORDER_GrpMBoxInfoPort,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("IndexChangeUpdateState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(IndexChangeUpdateState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("SetSubscriberSettingsBySub :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(SetSubscriberSettingsBySub,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("PinChangeUpdateState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(PinChangeUpdateState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("TnChangeUpdateState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(TnChangeUpdateState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("AddServiceState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(AddServiceState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("RemoveServiceState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(RemoveServiceState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

CreateRequestState.setString(SdpHelper.TEMPSTRING2_PATH.replace('.','/'),processID);]]></wpc:javaCode>
                        </wpc:script>
                      </bpws:invoke>
                      <bpws:assign name="MergeWESMerrortoProcobject16" wpc:displayName="Merge WESM error to Proc object" wpc:id="2769">
                        <bpws:copy>
                          <bpws:from variable="TrasationDetail_Port">
                            <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/Message]]></bpws:query>
                          </bpws:from>
                          <bpws:to variable="SDP_ORDER_GrpMBoxInfoPort">
                            <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/errorDetails/Error/Message]]></bpws:query>
                          </bpws:to>
                        </bpws:copy>
                        <bpws:copy>
                          <bpws:from variable="TrasationDetail_Port"/>
                          <bpws:to variable="MailboxConfig_Proc">
                            <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail]]></bpws:query>
                          </bpws:to>
                        </bpws:copy>
                      </bpws:assign>
                      <bpws:invoke name="CallUpdateMailBoxConfigCompensate8" operation="compensateUpdateMailBoxConfig" partnerLink="UpdateMailBoxConfig_Compensation_Interface" portType="ns31:UpdateMailBoxConfig_Compensation_Interface" wpc:displayName="call UpdateMailBoxConfig Compensate" wpc:id="2770">
                        <wpc:input>
                          <wpc:parameter name="CreateProvState" variable="CreateProvstate"/>
                          <wpc:parameter name="CreateRequestState" variable="CreateRequestState"/>
                          <wpc:parameter name="UpdateProvState" variable="UpdateProvState"/>
                          <wpc:parameter name="TransactionDetailPort" variable="TrasationDetail_Port"/>
                          <wpc:parameter name="DeleteProvState" variable="DeleteProvState"/>
                          <wpc:parameter name="DeleteRequestState" variable="DeleteRequestState"/>
                          <wpc:parameter name="UpdateRequestState" variable="UpdateRequestState"/>
                          <wpc:parameter name="SDP_ORDER_GrpMBoxInfoPort" variable="SDP_ORDER_GrpMBoxInfoPort"/>
                          <wpc:parameter name="IndexChangeUpdateState" variable="IndexChangeUpdateState"/>
                          <wpc:parameter name="SetSubscriberSettingsBySub" variable="SetSubscriberSettingsBySub"/>
                          <wpc:parameter name="PinChangeUpdateState" variable="PinChangeUpdateState"/>
                          <wpc:parameter name="TnChangeUpdateState" variable="TnChangeUpdateState"/>
                          <wpc:parameter name="AddServiceState" variable="AddServiceState"/>
                          <wpc:parameter name="RemoveServiceState" variable="RemoveServiceState"/>
                        </wpc:input>
                        <wpc:output>
                          <wpc:parameter name="TransactionDetailPort" variable="TrasationDetail_Port"/>
                          <wpc:parameter name="SdpOrderPort" variable="SDP_ORDER_Port"/>
                        </wpc:output>
                      </bpws:invoke>
                      <bpws:invoke name="LogUpdateMailBoxConfigCompensation17" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UpdateMailBoxConfigCompensation ]" wpc:id="2772">
                        <wpc:script>
                          <wpc:javaCode><![CDATA[
SdpLoggerHelper.logMessage("Received the following GBO from SubFlow : UpdateMailBoxConfigCompensation  ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("TrasationDetail_Port : ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(TrasationDetail_Port,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

]]></wpc:javaCode>
                        </wpc:script>
                      </bpws:invoke>
                      <bpws:invoke name="MergeRollBackedMailboxesintoProc3" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Merge RollBacked Mailboxes into Proc" wpc:id="2786">
                        <wpc:script>
                          <wpc:javaCode><![CDATA[DataObject tmpMailbox = null;
List lstAccountMailboxes = null;
Iterator itrAccountMailboxes = null;
List lstMailboxes = null;

SdpLoggerHelper.logMessage("Merging the RolledBack mailboxes into the response SdpOrder",
	PROCESS_NAME,processID,SdpLoggerHelper.DEBUG);

try {
	lstAccountMailboxes = 
		SDP_ORDER_Port.getList(SdpHelper.VOIP_ACCOUNTMAILBOXES_PATH.replace('.','/'));
	itrAccountMailboxes = lstAccountMailboxes.iterator();
	
	lstMailboxes = MailboxConfig_Proc.getList(SdpHelper.VOIP_ACCOUNTMAILBOXES_PATH.replace('.','/'));
	
	while(itrAccountMailboxes.hasNext())
	{		
		tmpMailbox = SDO.copy((DataObject) itrAccountMailboxes.next());
		lstMailboxes.add(tmpMailbox);
	}
}
catch(Exception ex)
{
	SdpLoggerHelper.logMessage("Failed during Merge the RolledBack mailboxes into response SdpOrder",
		PROCESS_NAME,processID,SdpLoggerHelper.DEBUG);
	SdpLoggerHelper.logMessage("Exception : " + ex,
		PROCESS_NAME,processID,SdpLoggerHelper.DEBUG);
}]]></wpc:javaCode>
                        </wpc:script>
                      </bpws:invoke>
                      <bpws:assign name="MergerProctoTrig7" wpc:displayName="Merger Proc to Trig" wpc:id="2773">
                        <bpws:copy>
                          <bpws:from variable="MailboxConfig_Proc"/>
                          <bpws:to variable="MailboxConfigRequest_Trig"/>
                        </bpws:copy>
                        <bpws:copy>
                          <bpws:from variable="sdpProcessContext"/>
                          <bpws:to variable="MailboxConfigRequest_Trig">
                            <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/ProcessContext]]></bpws:query>
                          </bpws:to>
                        </bpws:copy>
                      </bpws:assign>
                      <bpws:invoke name="LogEndProcess5" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [End Process]" wpc:id="2775">
                        <wpc:script>
                          <wpc:javaCode><![CDATA[


SdpLoggerHelper.logMessage("Returning the following GBO To MAM ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("Provisioned [MailboxConfigRequest_Trig ]: ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(MailboxConfigRequest_Trig,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("End - UpdateMailBoxConfig",PROCESS_NAME,processID,SdpLoggerHelper.INFO);]]></wpc:javaCode>
                        </wpc:script>
                      </bpws:invoke>
                      <bpws:reply name="ReplyUCDCLError6" operation="UpdateMailboxConfig" partnerLink="FromMam_FeaturePermissionMailboxUpdate_Interface" portType="ns3:FromMam_FeaturePermissionMailboxUpdate_Interface" wpc:displayName="Reply UCDCL Error" wpc:id="2776">
                        <wpc:input>
                          <wpc:parameter name="mailboxConfigResponse" variable="MailboxConfigRequest_Trig"/>
                        </wpc:input>
                      </bpws:reply>
                      <bpws:terminate name="Terminate19" wpc:displayName="Terminate" wpc:id="2777"/>
                    </bpws:sequence>
                  </bpws:case>
                </bpws:switch>
                <bpws:invoke name="LogUCDCLDelegatedLoginSuccess1" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UCDCL.DelegatedLogin  -Success]" wpc:id="2542">
                  <wpc:script>
                    <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage("Returning : UCDCL.DelegatedLogin -"+SdpLoggerHelper.SUCCESS_STR,PROCESS_NAME,processID
														,SdpLoggerHelper.INFO);
														



																		]]></wpc:javaCode>
                  </wpc:script>
                </bpws:invoke>
                <bpws:invoke name="SetUMSessionIDUMMessageCenterIP" operation="null" partnerLink="null" portType="wpc:null" wpc:continueOnError="inherit" wpc:displayName="Set UMSessionID &amp; UMMessageCenterIP" wpc:id="2944">
                  <wpc:script>
                    <wpc:javaCode><![CDATA[att.lightspeed.sdp.helper.WpsLogger logger = att.lightspeed.sdp.helper.WpsLogger.getLogger(processInstance());
String UMSessionID = null;
//String UMMessageCenterIP = null;

UMSessionID = processTransDetail.getString(SdpHelper.TRANSDETAIL_UMSESSIONID);
UMMessageCenterIP = processTransDetail.getString(SdpHelper.TRANSDETAIL_UMMESSAGECENTERIP);

logger.debug("UMSessionID from the DelegatedLogin Response: " + UMSessionID);
logger.debug("UMMessageCenterIP from the DelegatedLogin Response: " + UMMessageCenterIP);

processBO.setString(SdpHelper.xPathify(SdpHelper.TRANSDETAIL_UMSESSIONID_PATH),UMSessionID);

processBO.setString(SdpHelper.xPathify(SdpHelper.TRANSDETAIL_UMMESSAGECENTERIP_PATH),UMMessageCenterIP);]]></wpc:javaCode>
                  </wpc:script>
                </bpws:invoke>
                <bpws:assign name="PreInvokeAssigns10" wpc:displayName="Pre-Invoke Assigns" wpc:id="1082">
                  <bpws:copy>
                    <bpws:from>GetGroupMailboxInfo</bpws:from>
                    <bpws:to variable="MailboxConfig_Proc">
                      <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/targetHostInfo]]></bpws:query>
                    </bpws:to>
                  </bpws:copy>
                  <bpws:copy>
                    <bpws:from variable="emptyTransactionDetail"/>
                    <bpws:to variable="SDP_ORDER_GrpMBoxInfoPort">
                      <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail]]></bpws:query>
                    </bpws:to>
                  </bpws:copy>
                  <bpws:copy>
                    <bpws:from>UCDCL.getGroupMailBoxInfo.request</bpws:from>
                    <bpws:to variable="SDP_ORDER_GrpMBoxInfoPort">
                      <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/State]]></bpws:query>
                    </bpws:to>
                  </bpws:copy>
                  <bpws:copy>
                    <bpws:from>UCDCL</bpws:from>
                    <bpws:to variable="SDP_ORDER_GrpMBoxInfoPort">
                      <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/errorDetails/Error/TargetSystem]]></bpws:query>
                    </bpws:to>
                  </bpws:copy>
                  <bpws:copy>
                    <bpws:from>getGroupMailBoxInfo</bpws:from>
                    <bpws:to variable="SDP_ORDER_GrpMBoxInfoPort">
                      <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/currentTargetOperation]]></bpws:query>
                    </bpws:to>
                  </bpws:copy>
                </bpws:assign>
                <bpws:invoke name="LogUCDCLgetGroupMailBoxInfoPort" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UCDCL.getGroupMailBoxInfoPort ]" wpc:id="2270">
                  <wpc:script>
                    <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage(SdpLoggerHelper.INVOKE_STR +" : UCDCL.getGroupMailBoxInfoPort",PROCESS_NAME,processID
														,SdpLoggerHelper.INFO);
														
SdpLoggerHelper.logMessage("Request BO:[SDP_ORDER]",PROCESS_NAME,processID
														,SdpLoggerHelper.INFO);
SdpLoggerHelper.logMessage("SDP_ORDER_GrpMBoxInfoPort:",PROCESS_NAME,processID
														,SdpLoggerHelper.INFO);

													
SdpLoggerHelper.logBO(SDP_ORDER_GrpMBoxInfoPort,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

]]></wpc:javaCode>
                  </wpc:script>
                </bpws:invoke>
                <bpws:invoke name="UCDCLGetGroupMailBoxInfo" operation="getGroupMailboxInfo" partnerLink="UcdclCompensableService_Interface" portType="ns37:UCDCLCompensableService_Interface" wpc:displayName="UCDCL Get Group MailBox Info  " wpc:id="230">
                  <wpc:input>
                    <wpc:parameter name="order" variable="processBO"/>
                  </wpc:input>
                  <wpc:output>
                    <wpc:parameter name="order" variable="SDP_ORDER_GrpMBoxInfoPort"/>
                  </wpc:output>
                  <bpws:catch faultName="ns37:serviceCallFault" faultVariable="scFault" wpc:faultType="java:ServiceCallFault" wpc:id="2998" wpc:variableId="381">
                    <bpws:invoke name="SetErrorDetails2" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Set Error Details" wpc:id="1566">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[SDP_ORDER_GrpMBoxInfoPort.getDataObject(SdpHelper.TRANSACTION_DETAIL).setBoolean(SdpHelper.ERRORINDICATOR,true);

new att.lightspeed.sdp.helper.TransactionDetail(SDP_ORDER_GrpMBoxInfoPort.getDataObject(SdpHelper.TRANSACTION_DETAIL)).setSDPErrorMessage(scFault);

SDP_ORDER_GrpMBoxInfoPort.getDataObject(SdpHelper.TRANSACTION_DETAIL).getDataObject("errorDetails").getDataObject("Error").setString("Severity",SdpErrorHelper.SEVERITY_FATAL);

 
SdpLoggerHelper.logMessage(SdpLoggerHelper.FAULT_FAILURE +"  UCDCL.getGroupMailBoxInfoPort",PROCESS_NAME,processID,SdpLoggerHelper.FATAL); 
 ]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                  </bpws:catch>
                  <bpws:catch faultName="wpc:runtimeFailure" faultVariable="bpcFault" wpc:faultType="wpc:BPCStandardFaultType" wpc:id="2999" wpc:variableId="1083">
                    <bpws:invoke name="PopulatetheRuntimeErrorHandlerdetails5" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Populate the Runtime Error Handler details" wpc:id="1086">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[SdpErrorHelper.setErrDetInTransDet(SDP_ORDER_GrpMBoxInfoPort.getDataObject(SdpHelper.TRANSACTION_DETAIL),bpcFault,SdpErrorHelper.SEVERITY_FATAL);

SdpLoggerHelper.logMessage(SdpLoggerHelper.RUNTIME_FAILURE+"  UCDCL.getGroupMailBoxInfoPort",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                  </bpws:catch>
                  <bpws:catchAll wpc:id="2997">
                    <bpws:invoke name="Handleotherfailures5" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="handle other failures" wpc:id="1372">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[SdpErrorHelper.setErrDetInTransDet(SDP_ORDER_GrpMBoxInfoPort.getDataObject(SdpHelper.TRANSACTION_DETAIL),null,SdpErrorHelper.SEVERITY_FATAL);
SdpLoggerHelper.logMessage(SdpLoggerHelper.UNKNOWN_FAILURE+" UCDCL.getGroupMailBoxInfoPort",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                  </bpws:catchAll>
                </bpws:invoke>
                <bpws:assign name="PostinvokeAssign1" wpc:displayName="Post invoke Assign" wpc:id="1574">
                  <bpws:copy>
                    <bpws:from variable="SDP_ORDER_GrpMBoxInfoPort">
                      <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail]]></bpws:query>
                    </bpws:from>
                    <bpws:to variable="TrasationDetail_Port"/>
                  </bpws:copy>
                  <bpws:copy>
                    <bpws:from>DEFAULT</bpws:from>
                    <bpws:to variable="SDP_ORDER_GrpMBoxInfoPort">
                      <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/tempStoreNonArray/temp1]]></bpws:query>
                    </bpws:to>
                  </bpws:copy>
                </bpws:assign>
                <bpws:switch name="CheckUCDCLerror1" wpc:displayName="Check UCDCL error" wpc:id="369">
                  <bpws:case wpc:id="370">
                    <bpws:condition><![CDATA[boolean __result__1 = com.ibm.wbiservers.brules.core.codegen.NillableUtility.getBoolean(TrasationDetail_Port, "errorIndicator", "TrasationDetail_Port");
return __result__1;

//@generated:com.ibm.wbit.activity.ui
//<?xml version="1.0" encoding="UTF-8"?>
//<com.ibm.wbit.activity:CompositeActivity xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:com.ibm.wbit.activity="http:///com/ibm/wbit/activity.ecore" name="ActivityMethod">
//  <result name="Result">
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="boolean"/>
//  </result>
//  <exceptions>
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="com.ibm.bpe.api.ProcessException"/>
//  </exceptions>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="TrasationDetail_Port.errorIndicator" field="true">
//    <dataOutputs target="//@executableElements.1"/>
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="boolean" namespace="http://www.w3.org/2001/XMLSchema" nillable="false"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:ReturnElement" dataInputs="//@executableElements.0/@dataOutputs.0"/>
//  <executableGroups executableElements="//@executableElements.0 //@executableElements.1"/>
//</com.ibm.wbit.activity:CompositeActivity>
//@generated:end
//!SMAP!*S WBIACTDBG
//!SMAP!*L
//!SMAP!1:1,1
//!SMAP!2:2,1
//!SMAP!1000000:26,1]]></bpws:condition>
                    <bpws:sequence name="HiddenSequence33" wpc:id="1073744727">
                      <bpws:invoke name="LogUCDCLgetGroupMailBoxInfoPortError" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UCDCL.getGroupMailBoxInfoPort   - Error]" wpc:id="2272">
                        <wpc:script>
                          <wpc:javaCode><![CDATA[String strSeverity =TrasationDetail_Port.getString("errorDetails/Error/Severity");
int logLevel = SdpHelper.getLogLevel(strSeverity);
SdpLoggerHelper.logMessage(" UCDCL.getGroupMailBoxInfoPort- "+SdpLoggerHelper.ERROR_STR+"["+strSeverity+"]",PROCESS_NAME,processID,logLevel);]]></wpc:javaCode>
                        </wpc:script>
                      </bpws:invoke>
                      <bpws:invoke name="LogUpdateMailBoxConfigCompensation6" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UpdateMailBoxConfigCompensation ]" wpc:id="2265">
                        <wpc:script>
                          <wpc:javaCode><![CDATA[
SdpLoggerHelper.logMessage(SdpLoggerHelper.INVOKE_STR +" SubFlow : UpdateMailBoxConfigCompensation",PROCESS_NAME,processID,SdpLoggerHelper.INFO);
SdpLoggerHelper.logMessage("Request BOs : ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("CreateRequestState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(CreateRequestState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("CreateProvState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(CreateProvstate,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("DeleteRequestState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(DeleteRequestState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("DeleteProvState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(DeleteProvState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("UpdateRequestState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(UpdateRequestState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("UpdateProvState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(UpdateProvState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("TransactionDetailPort :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(TrasationDetail_Port,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("SDP_ORDER_GrpMBoxInfoPort :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(SDP_ORDER_GrpMBoxInfoPort,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("IndexChangeUpdateState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(IndexChangeUpdateState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("SetSubscriberSettingsBySub :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(SetSubscriberSettingsBySub,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("PinChangeUpdateState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(PinChangeUpdateState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("TnChangeUpdateState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(TnChangeUpdateState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("AddServiceState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(AddServiceState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("RemoveServiceState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(RemoveServiceState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

CreateRequestState.setString(SdpHelper.TEMPSTRING2_PATH.replace('.','/'),processID);]]></wpc:javaCode>
                        </wpc:script>
                      </bpws:invoke>
                      <bpws:assign name="MergeWESMerrortoProcobject7" wpc:displayName="Merge WESM error to Proc object" wpc:id="2483">
                        <bpws:copy>
                          <bpws:from variable="TrasationDetail_Port">
                            <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/Message]]></bpws:query>
                          </bpws:from>
                          <bpws:to variable="SDP_ORDER_GrpMBoxInfoPort">
                            <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/errorDetails/Error/Message]]></bpws:query>
                          </bpws:to>
                        </bpws:copy>
                        <bpws:copy>
                          <bpws:from variable="TrasationDetail_Port"/>
                          <bpws:to variable="MailboxConfig_Proc">
                            <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail]]></bpws:query>
                          </bpws:to>
                        </bpws:copy>
                      </bpws:assign>
                      <bpws:invoke name="CallUpdateMailBoxConfigCompensate2" operation="compensateUpdateMailBoxConfig" partnerLink="UpdateMailBoxConfig_Compensation_Interface" portType="ns31:UpdateMailBoxConfig_Compensation_Interface" wpc:displayName="call UpdateMailBoxConfig Compensate" wpc:id="2167">
                        <wpc:input>
                          <wpc:parameter name="CreateProvState" variable="CreateProvstate"/>
                          <wpc:parameter name="CreateRequestState" variable="CreateRequestState"/>
                          <wpc:parameter name="UpdateProvState" variable="UpdateProvState"/>
                          <wpc:parameter name="TransactionDetailPort" variable="TrasationDetail_Port"/>
                          <wpc:parameter name="DeleteProvState" variable="DeleteProvState"/>
                          <wpc:parameter name="DeleteRequestState" variable="DeleteRequestState"/>
                          <wpc:parameter name="UpdateRequestState" variable="UpdateRequestState"/>
                          <wpc:parameter name="SDP_ORDER_GrpMBoxInfoPort" variable="SDP_ORDER_GrpMBoxInfoPort"/>
                          <wpc:parameter name="IndexChangeUpdateState" variable="IndexChangeUpdateState"/>
                          <wpc:parameter name="SetSubscriberSettingsBySub" variable="SetSubscriberSettingsBySub"/>
                          <wpc:parameter name="PinChangeUpdateState" variable="PinChangeUpdateState"/>
                          <wpc:parameter name="TnChangeUpdateState" variable="TnChangeUpdateState"/>
                          <wpc:parameter name="AddServiceState" variable="AddServiceState"/>
                          <wpc:parameter name="RemoveServiceState" variable="RemoveServiceState"/>
                        </wpc:input>
                        <wpc:output>
                          <wpc:parameter name="TransactionDetailPort" variable="TrasationDetail_Port"/>
                          <wpc:parameter name="SdpOrderPort" variable="SDP_ORDER_Port"/>
                        </wpc:output>
                      </bpws:invoke>
                      <bpws:invoke name="LogUpdateMailBoxConfigCompensation7" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UpdateMailBoxConfigCompensation ]" wpc:id="2268">
                        <wpc:script>
                          <wpc:javaCode><![CDATA[
SdpLoggerHelper.logMessage("Received the following GBO from SubFlow : UpdateMailBoxConfigCompensation  ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("TrasationDetail_Port : ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(TrasationDetail_Port,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

]]></wpc:javaCode>
                        </wpc:script>
                      </bpws:invoke>
                      <bpws:invoke name="MergeRollBackedMailboxesintoProc4" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Merge RollBacked Mailboxes into Proc" wpc:id="2788">
                        <wpc:script>
                          <wpc:javaCode><![CDATA[DataObject tmpMailbox = null;
List lstAccountMailboxes = null;
Iterator itrAccountMailboxes = null;
List lstMailboxes = null;

SdpLoggerHelper.logMessage("Merging the RolledBack mailboxes into the response SdpOrder",
	PROCESS_NAME,processID,SdpLoggerHelper.DEBUG);

try {
	lstAccountMailboxes = 
		SDP_ORDER_Port.getList(SdpHelper.VOIP_ACCOUNTMAILBOXES_PATH.replace('.','/'));
	itrAccountMailboxes = lstAccountMailboxes.iterator();
	
	lstMailboxes = MailboxConfig_Proc.getList(SdpHelper.VOIP_ACCOUNTMAILBOXES_PATH.replace('.','/'));
	
	while(itrAccountMailboxes.hasNext())
	{		
		tmpMailbox = SDO.copy((DataObject) itrAccountMailboxes.next());
		lstMailboxes.add(tmpMailbox);
	}
}
catch(Exception ex)
{
	SdpLoggerHelper.logMessage("Failed during Merge the RolledBack mailboxes into response SdpOrder",
		PROCESS_NAME,processID,SdpLoggerHelper.DEBUG);
	SdpLoggerHelper.logMessage("Exception : " + ex,
		PROCESS_NAME,processID,SdpLoggerHelper.DEBUG);
}]]></wpc:javaCode>
                        </wpc:script>
                      </bpws:invoke>
                      <bpws:assign name="MergerProctoTrig4" wpc:displayName="Merger Proc to Trig" wpc:id="2455">
                        <bpws:copy>
                          <bpws:from variable="MailboxConfig_Proc"/>
                          <bpws:to variable="MailboxConfigRequest_Trig"/>
                        </bpws:copy>
                        <bpws:copy>
                          <bpws:from variable="sdpProcessContext"/>
                          <bpws:to variable="MailboxConfigRequest_Trig">
                            <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/ProcessContext]]></bpws:query>
                          </bpws:to>
                        </bpws:copy>
                      </bpws:assign>
                      <bpws:invoke name="LogEndProcess10" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [End Process]" wpc:id="2433">
                        <wpc:script>
                          <wpc:javaCode><![CDATA[


SdpLoggerHelper.logMessage("Returning the following GBO To MAM ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("Provisioned [MailboxConfigRequest_Trig ]: ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(MailboxConfigRequest_Trig,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("End - UpdateMailBoxConfig",PROCESS_NAME,processID,SdpLoggerHelper.INFO);]]></wpc:javaCode>
                        </wpc:script>
                      </bpws:invoke>
                      <bpws:reply name="ReplyUCDCLError" operation="UpdateMailboxConfig" partnerLink="FromMam_FeaturePermissionMailboxUpdate_Interface" portType="ns3:FromMam_FeaturePermissionMailboxUpdate_Interface" wpc:displayName="Reply UCDCL Error" wpc:id="376">
                        <wpc:input>
                          <wpc:parameter name="mailboxConfigResponse" variable="MailboxConfigRequest_Trig"/>
                        </wpc:input>
                      </bpws:reply>
                      <bpws:terminate name="Terminate3" wpc:displayName="Terminate" wpc:id="1446"/>
                    </bpws:sequence>
                  </bpws:case>
                </bpws:switch>
                <bpws:invoke name="LogUCDCLgetGroupMailBoxInfoPortSuccess" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UCDCL.getGroupMailBoxInfoPort -Success]" wpc:id="2381">
                  <wpc:script>
                    <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage(" UCDCL.getGroupMailBoxInfoPort -"+SdpLoggerHelper.SUCCESS_STR,PROCESS_NAME,processID
														,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("Response BO [SDP_ORDER_GrpMBoxInfoPort]",PROCESS_NAME,processID,SdpLoggerHelper.INFO);												

SdpLoggerHelper.logBO(SDP_ORDER_GrpMBoxInfoPort,PROCESS_NAME,processID,SdpLoggerHelper.INFO);]]></wpc:javaCode>
                  </wpc:script>
                </bpws:invoke>
                <bpws:invoke name="SetUMSessionIDUMMessageCenterIP1" operation="null" partnerLink="null" portType="wpc:null" wpc:continueOnError="inherit" wpc:displayName="Set UMSessionID &amp; UMMessageCenterIP" wpc:id="2943">
                  <wpc:script>
                    <wpc:javaCode><![CDATA[att.lightspeed.sdp.helper.WpsLogger logger = att.lightspeed.sdp.helper.WpsLogger.getLogger(processInstance());
String UMSessionID = null;
//String UMMessageCenterIP = null;

UMSessionID = TrasationDetail_Port.getString(SdpHelper.TRANSDETAIL_UMSESSIONID);
UMMessageCenterIP = TrasationDetail_Port.getString(SdpHelper.TRANSDETAIL_UMMESSAGECENTERIP);

logger.debug("UMSessionID from the GetGroupMailboxInfo Response: " + UMSessionID);
logger.debug("UMMessageCenterIP from the GetGroupMailboxInfo Response: " + UMMessageCenterIP);

processBO.setString(SdpHelper.xPathify(SdpHelper.TRANSDETAIL_UMSESSIONID_PATH),UMSessionID);
processTransDetail.setString(SdpHelper.TRANSDETAIL_UMSESSIONID, UMSessionID);

processBO.setString(SdpHelper.xPathify(SdpHelper.TRANSDETAIL_UMMESSAGECENTERIP_PATH),UMMessageCenterIP);
processTransDetail.setString(SdpHelper.TRANSDETAIL_UMMESSAGECENTERIP, UMMessageCenterIP);]]></wpc:javaCode>
                  </wpc:script>
                </bpws:invoke>
                <bpws:switch name="NeedSetGroupMailboxInfo" wpc:displayName="Need SetGroupMailboxInfo?" wpc:id="2664">
                  <bpws:case wpc:id="2665">
                    <bpws:condition><![CDATA[List lstTempStore = null;

lstTempStore = SDP_ORDER_GrpMBoxInfoPort.getList(SdpHelper.TEMP_STORE_LIST.replace('.','/'));

return lstTempStore.size() > 0;]]></bpws:condition>
                    <bpws:sequence name="HiddenSequence18" wpc:id="1073744728">
                      <bpws:sequence name="SetallIndextoNULL1" wpc:displayName="Set all Index to NULL [-1]" wpc:id="2661">
                        <bpws:assign name="CopytheGroupMailBoxInfotoProcObject1" wpc:displayName="Copy the Group Mail Box Info to Proc Object" wpc:id="2622">
                          <bpws:copy>
                            <bpws:from variable="SDP_ORDER_GrpMBoxInfoPort"/>
                            <bpws:to variable="SDP_ORDER_GrpMBoxInfoProc"/>
                          </bpws:copy>
                        </bpws:assign>
                        <bpws:invoke name="Set1toIndexChangedListIndex" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Set -1 to IndexChangedList Index" wpc:id="2626">
                          <wpc:script>
                            <wpc:javaCode><![CDATA[List lstTempStore = null;
Iterator itrTempStore = null;

DataObject tempStore = null;
DataObject tmpSdp_Order = null;
DataObject tmpAccountMailbox = null;

String strInvariantId = null;

tmpSdp_Order = SDO.copy(SDP_ORDER_Prov);
tmpSdp_Order.setDataObject("order/ReqService/product/cvoipProduct",
	SDO.copy(indexChangedMBoxList));

lstTempStore = SDP_ORDER_GrpMBoxInfoProc.getList(SdpHelper.TEMP_STORE_LIST.replace('.','/'));
itrTempStore = lstTempStore.iterator();

SdpLoggerHelper.logMessage("Checking to send index as -1 for Mailboxes to UCDCL",
	PROCESS_NAME,processID,SdpLoggerHelper.INFO);

while (itrTempStore.hasNext())
{
	tempStore = (DataObject)itrTempStore.next();
	if (tempStore != null)
	{
		strInvariantId = tempStore.getString(SdpHelper.TEMP1);
		SdpLoggerHelper.logMessage("Comparing the index of getGroupMailbox with IndexChangedList",
			PROCESS_NAME,processID,SdpLoggerHelper.INFO);
		tmpAccountMailbox = SdpHelper.getMailBox(tmpSdp_Order,strInvariantId);
		if(tempStore.getInt("temp10") == 0 || tmpAccountMailbox != null)
		{	
			tempStore.setInt("temp10",-1);
			SdpLoggerHelper.logMessage("Mailbox [" + strInvariantId + 
				"] is available in IndexChangedList and set as -1 for setGroupMailboxInfo call",
				PROCESS_NAME,processID,SdpLoggerHelper.INFO);
		}
	}
} 

// Setting index as "-1" to PrimaryMailbox
try {

	SDP_ORDER_GrpMBoxInfoProc.setInt(SdpHelper.TEMPINT2_PATH.replace('.','/'),-1);
}
catch (Exception ex)
{
	SdpLoggerHelper.logMessage("Not able to set index as -1 for Primary Mailbox",
		PROCESS_NAME,processID,SdpLoggerHelper.INFO);	
}]]></wpc:javaCode>
                          </wpc:script>
                        </bpws:invoke>
                        <bpws:assign name="PreInvokeAssigns19" wpc:displayName="Pre-Invoke Assigns" wpc:id="2627">
                          <bpws:copy>
                            <bpws:from variable="emptyTransactionDetail"/>
                            <bpws:to variable="TrasationDetail_Port"/>
                          </bpws:copy>
                          <bpws:copy>
                            <bpws:from>UCDCL.SetGroupMailBoxInfo.request</bpws:from>
                            <bpws:to variable="TrasationDetail_Port">
                              <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/State]]></bpws:query>
                            </bpws:to>
                          </bpws:copy>
                          <bpws:copy>
                            <bpws:from>UCDCL</bpws:from>
                            <bpws:to variable="TrasationDetail_Port">
                              <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/TargetSystem]]></bpws:query>
                            </bpws:to>
                          </bpws:copy>
                          <bpws:copy>
                            <bpws:from>SetGroupMailBoxInfo</bpws:from>
                            <bpws:to variable="TrasationDetail_Port">
                              <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/currentTargetOperation]]></bpws:query>
                            </bpws:to>
                          </bpws:copy>
                          <bpws:copy>
                            <bpws:from variable="emptySDPOrder"/>
                            <bpws:to variable="SDP_ORDER_Port"/>
                          </bpws:copy>
                          <bpws:copy>
                            <bpws:from>true</bpws:from>
                            <bpws:to variable="boolIndexChanged"/>
                          </bpws:copy>
                        </bpws:assign>
                        <bpws:invoke name="LogUCDCLsetGroupMailBoxInfoPort1" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UCDCL.setGroupMailBoxInfoPort ]" wpc:id="2629">
                          <wpc:script>
                            <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage(SdpLoggerHelper.INVOKE_STR +" : UCDCL.setGroupMailBoxInfo",PROCESS_NAME,processID
														,SdpLoggerHelper.INFO);
														
SdpLoggerHelper.logMessage("Request BO:[SDP_ORDER]",PROCESS_NAME,processID
														,SdpLoggerHelper.INFO);
SdpLoggerHelper.logMessage("SDP_ORDER_GrpMBoxInfoProc:",PROCESS_NAME,processID
														,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(SDP_ORDER_GrpMBoxInfoProc,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

]]></wpc:javaCode>
                          </wpc:script>
                        </bpws:invoke>
                        <bpws:invoke name="UCDCLSetGroupMailBoxInfo2" operation="setGroupMailboxInfo" partnerLink="UcdclCompensableService_Interface" portType="ns37:UCDCLCompensableService_Interface" wpc:displayName="UCDCL Set Group MailBox Info  " wpc:id="2630">
                          <wpc:input>
                            <wpc:parameter name="order" variable="SDP_ORDER_GrpMBoxInfoProc"/>
                          </wpc:input>
                          <wpc:output>
                            <wpc:parameter name="transactionDetail" variable="processTransDetail"/>
                          </wpc:output>
                          <bpws:catch faultName="ns37:serviceCallFault" faultVariable="scFault" wpc:faultType="java:ServiceCallFault" wpc:id="3010" wpc:variableId="2631">
                            <bpws:invoke name="SetErrorDetails4" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Set Error Details" wpc:id="2633">
                              <wpc:script>
                                <wpc:javaCode><![CDATA[TrasationDetail_Port.setBoolean(SdpHelper.ERRORINDICATOR,true);

new att.lightspeed.sdp.helper.TransactionDetail(TrasationDetail_Port).setSDPErrorMessage(scFault);

TrasationDetail_Port.getDataObject("errorDetails").getDataObject("Error").setString("Severity",SdpErrorHelper.SEVERITY_FATAL);

 
SdpLoggerHelper.logMessage(SdpLoggerHelper.FAULT_FAILURE +" UCDCL.setGroupMailBoxInfoPort",PROCESS_NAME,processID,SdpLoggerHelper.FATAL); 
 ]]></wpc:javaCode>
                              </wpc:script>
                            </bpws:invoke>
                          </bpws:catch>
                          <bpws:catch faultName="wpc:runtimeFailure" faultVariable="bpcFault" wpc:faultType="wpc:BPCStandardFaultType" wpc:id="3011" wpc:variableId="2637">
                            <bpws:invoke name="HandleRuntimefailure3" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="handle Runtime failure" wpc:id="2639">
                              <wpc:script>
                                <wpc:javaCode><![CDATA[SdpErrorHelper.setErrDetInTransDet(TrasationDetail_Port,bpcFault,SdpErrorHelper.SEVERITY_FATAL);

SdpLoggerHelper.logMessage(SdpLoggerHelper.RUNTIME_FAILURE+"  UCDCL.setGroupMailBoxInfoPort",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);]]></wpc:javaCode>
                              </wpc:script>
                            </bpws:invoke>
                          </bpws:catch>
                          <bpws:catchAll wpc:id="3009">
                            <bpws:invoke name="Handleotherfailures6" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="handle other failures" wpc:id="2641">
                              <wpc:script>
                                <wpc:javaCode><![CDATA[SdpErrorHelper.setErrDetInTransDet(TrasationDetail_Port,null,SdpErrorHelper.SEVERITY_FATAL);

SdpLoggerHelper.logMessage(SdpLoggerHelper.UNKNOWN_FAILURE+"  UCDCL.setGroupMailBoxInfoPort",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);]]></wpc:javaCode>
                              </wpc:script>
                            </bpws:invoke>
                          </bpws:catchAll>
                        </bpws:invoke>
                        <bpws:switch name="UCDCLerror" wpc:displayName="UCDCL error?" wpc:id="2642">
                          <bpws:case wpc:id="2643">
                            <bpws:condition><![CDATA[boolean __result__1 = com.ibm.wbiservers.brules.core.codegen.NillableUtility.getBoolean(TrasationDetail_Port, "errorIndicator", "TrasationDetail_Port");
return __result__1;

//@generated:com.ibm.wbit.activity.ui
//<?xml version="1.0" encoding="UTF-8"?>
//<com.ibm.wbit.activity:CompositeActivity xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:com.ibm.wbit.activity="http:///com/ibm/wbit/activity.ecore" name="ActivityMethod">
//  <result name="Result">
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="boolean"/>
//  </result>
//  <exceptions>
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="com.ibm.bpe.api.ProcessException"/>
//  </exceptions>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="TrasationDetail_Port.errorIndicator" field="true">
//    <dataOutputs target="//@executableElements.1"/>
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="boolean" namespace="http://www.w3.org/2001/XMLSchema" nillable="false"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:ReturnElement" dataInputs="//@executableElements.0/@dataOutputs.0"/>
//  <executableGroups executableElements="//@executableElements.0 //@executableElements.1"/>
//</com.ibm.wbit.activity:CompositeActivity>
//@generated:end
//!SMAP!*S WBIACTDBG
//!SMAP!*L
//!SMAP!1:1,1
//!SMAP!2:2,1
//!SMAP!1000000:26,1]]></bpws:condition>
                            <bpws:sequence name="HiddenSequence29" wpc:id="1073744729">
                              <bpws:invoke name="LogUCDCLsetGroupMailBoxInfoPortError" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UCDCL.setGroupMailBoxInfoPort   - Error]" wpc:id="2646">
                                <wpc:script>
                                  <wpc:javaCode><![CDATA[String strSeverity =TrasationDetail_Port.getString("errorDetails/Error/Severity");
int logLevel = SdpHelper.getLogLevel(strSeverity);
SdpLoggerHelper.logMessage(" UCDCL.setGroupMailBoxInfoPort- "+SdpLoggerHelper.ERROR_STR+"["+strSeverity+"]",PROCESS_NAME,processID,logLevel);]]></wpc:javaCode>
                                </wpc:script>
                              </bpws:invoke>
                              <bpws:invoke name="LogUpdateMailBoxConfigCompensation8" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [ UpdateMailBoxConfigCompensation]" wpc:id="2648">
                                <wpc:script>
                                  <wpc:javaCode><![CDATA[
SdpLoggerHelper.logMessage(SdpLoggerHelper.INVOKE_STR +" SubFlow : UpdateMailBoxConfigCompensation",PROCESS_NAME,processID,SdpLoggerHelper.INFO);
SdpLoggerHelper.logMessage("Request BOs : ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("CreateRequestState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(CreateRequestState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("CreateProvState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(CreateProvstate,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("DeleteRequestState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(DeleteRequestState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("DeleteProvState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(DeleteProvState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("UpdateRequestState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(UpdateRequestState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("UpdateProvState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(UpdateProvState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("TransactionDetailPort :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(TrasationDetail_Port,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("SDP_ORDER_GrpMBoxInfoPort :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(SDP_ORDER_GrpMBoxInfoPort,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("IndexChangeUpdateState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(IndexChangeUpdateState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("SetSubscriberSettingsBySub :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(SetSubscriberSettingsBySub,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("PinChangeUpdateState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(PinChangeUpdateState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("TnChangeUpdateState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(TnChangeUpdateState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("AddServiceState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(AddServiceState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("RemoveServiceState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(RemoveServiceState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

CreateRequestState.setString(SdpHelper.TEMPSTRING2_PATH.replace('.','/'),processID);
]]></wpc:javaCode>
                                </wpc:script>
                              </bpws:invoke>
                              <bpws:assign name="MergeWESMerrortoProcobject8" wpc:displayName="Merge WESM error to Proc object" wpc:id="2649">
                                <bpws:copy>
                                  <bpws:from variable="TrasationDetail_Port">
                                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/Message]]></bpws:query>
                                  </bpws:from>
                                  <bpws:to variable="IndexChangeUpdateState">
                                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/errorDetails/Error/Message]]></bpws:query>
                                  </bpws:to>
                                </bpws:copy>
                                <bpws:copy>
                                  <bpws:from variable="TrasationDetail_Port"/>
                                  <bpws:to variable="MailboxConfig_Proc">
                                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail]]></bpws:query>
                                  </bpws:to>
                                </bpws:copy>
                              </bpws:assign>
                              <bpws:invoke name="CallUpdateMailBoxConfigCompensate4" operation="compensateUpdateMailBoxConfig" partnerLink="UpdateMailBoxConfig_Compensation_Interface" portType="ns31:UpdateMailBoxConfig_Compensation_Interface" wpc:displayName="call UpdateMailBoxConfig Compensate" wpc:id="2650">
                                <wpc:input>
                                  <wpc:parameter name="CreateProvState" variable="CreateProvstate"/>
                                  <wpc:parameter name="CreateRequestState" variable="CreateRequestState"/>
                                  <wpc:parameter name="UpdateProvState" variable="UpdateProvState"/>
                                  <wpc:parameter name="TransactionDetailPort" variable="TrasationDetail_Port"/>
                                  <wpc:parameter name="DeleteProvState" variable="DeleteProvState"/>
                                  <wpc:parameter name="DeleteRequestState" variable="DeleteRequestState"/>
                                  <wpc:parameter name="UpdateRequestState" variable="UpdateRequestState"/>
                                  <wpc:parameter name="SDP_ORDER_GrpMBoxInfoPort" variable="SDP_ORDER_GrpMBoxInfoPort"/>
                                  <wpc:parameter name="IndexChangeUpdateState" variable="IndexChangeUpdateState"/>
                                  <wpc:parameter name="SetSubscriberSettingsBySub" variable="SetSubscriberSettingsBySub"/>
                                  <wpc:parameter name="PinChangeUpdateState" variable="PinChangeUpdateState"/>
                                  <wpc:parameter name="TnChangeUpdateState" variable="TnChangeUpdateState"/>
                                  <wpc:parameter name="AddServiceState" variable="AddServiceState"/>
                                  <wpc:parameter name="RemoveServiceState" variable="RemoveServiceState"/>
                                </wpc:input>
                                <wpc:output>
                                  <wpc:parameter name="TransactionDetailPort" variable="TrasationDetail_Port"/>
                                  <wpc:parameter name="SdpOrderPort" variable="SDP_ORDER_Port"/>
                                </wpc:output>
                              </bpws:invoke>
                              <bpws:invoke name="LogUpdateMailBoxConfigCompensation9" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UpdateMailBoxConfigCompensation ]" wpc:id="2652">
                                <wpc:script>
                                  <wpc:javaCode><![CDATA[
SdpLoggerHelper.logMessage("Received the following GBO from SubFlow : UpdateMailBoxConfigCompensation  ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("TrasationDetail_Port : ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(TrasationDetail_Port,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

]]></wpc:javaCode>
                                </wpc:script>
                              </bpws:invoke>
                              <bpws:invoke name="MergeRollBackedMailboxesintoProc5" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Merge RollBacked Mailboxes into Proc" wpc:id="2790">
                                <wpc:script>
                                  <wpc:javaCode><![CDATA[DataObject tmpMailbox = null;
List lstAccountMailboxes = null;
Iterator itrAccountMailboxes = null;
List lstMailboxes = null;

SdpLoggerHelper.logMessage("Merging the RolledBack mailboxes into the response SdpOrder",
	PROCESS_NAME,processID,SdpLoggerHelper.DEBUG);

try {
	lstAccountMailboxes = 
		SDP_ORDER_Port.getList(SdpHelper.VOIP_ACCOUNTMAILBOXES_PATH.replace('.','/'));
	itrAccountMailboxes = lstAccountMailboxes.iterator();
	
	lstMailboxes = MailboxConfig_Proc.getList(SdpHelper.VOIP_ACCOUNTMAILBOXES_PATH.replace('.','/'));
	
	while(itrAccountMailboxes.hasNext())
	{		
		tmpMailbox = SDO.copy((DataObject) itrAccountMailboxes.next());
		lstMailboxes.add(tmpMailbox);
	}
}
catch(Exception ex)
{
	SdpLoggerHelper.logMessage("Failed during Merge the RolledBack mailboxes into response SdpOrder",
		PROCESS_NAME,processID,SdpLoggerHelper.DEBUG);
	SdpLoggerHelper.logMessage("Exception : " + ex,
		PROCESS_NAME,processID,SdpLoggerHelper.DEBUG);
}]]></wpc:javaCode>
                                </wpc:script>
                              </bpws:invoke>
                              <bpws:assign name="MergerProctoTrig5" wpc:displayName="Merger Proc to Trig" wpc:id="2653">
                                <bpws:copy>
                                  <bpws:from variable="MailboxConfig_Proc"/>
                                  <bpws:to variable="MailboxConfigRequest_Trig"/>
                                </bpws:copy>
                                <bpws:copy>
                                  <bpws:from variable="sdpProcessContext"/>
                                  <bpws:to variable="MailboxConfigRequest_Trig">
                                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/ProcessContext]]></bpws:query>
                                  </bpws:to>
                                </bpws:copy>
                              </bpws:assign>
                              <bpws:invoke name="LogEndProcess9" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [End Process]" wpc:id="2655">
                                <wpc:script>
                                  <wpc:javaCode><![CDATA[

SdpLoggerHelper.logMessage("Returning the following GBO To MAM ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("Provisioned [MailboxConfigRequest_Trig ]: ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(MailboxConfigRequest_Trig,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("End - UpdateMailBoxConfig",PROCESS_NAME,processID,SdpLoggerHelper.INFO);]]></wpc:javaCode>
                                </wpc:script>
                              </bpws:invoke>
                              <bpws:reply name="ReplyUCDCLError" operation="UpdateMailboxConfig" partnerLink="FromMam_FeaturePermissionMailboxUpdate_Interface" portType="ns3:FromMam_FeaturePermissionMailboxUpdate_Interface" wpc:displayName="Reply UCDCL Error" wpc:id="2656">
                                <wpc:input>
                                  <wpc:parameter name="mailboxConfigResponse" variable="MailboxConfigRequest_Trig"/>
                                </wpc:input>
                              </bpws:reply>
                              <bpws:terminate name="Terminate14" wpc:displayName="Terminate" wpc:id="2657"/>
                            </bpws:sequence>
                          </bpws:case>
                        </bpws:switch>
                        <bpws:invoke name="LogUCDCLsetGroupMailBoxInfoPortSuccess1" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UCDCL.setGroupMailBoxInfoPort -Success ]" wpc:id="2659">
                          <wpc:script>
                            <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage(" UCDCL.setGroupMailBoxInfo -"+SdpLoggerHelper.SUCCESS_STR,PROCESS_NAME,processID
														,SdpLoggerHelper.INFO);]]></wpc:javaCode>
                          </wpc:script>
                        </bpws:invoke>
                        <bpws:invoke name="SetUMMessageCenterIPUMSessionID" operation="null" partnerLink="null" portType="wpc:null" wpc:continueOnError="inherit" wpc:displayName="Set UMMessageCenterIP &amp; UMSessionID" wpc:id="2945">
                          <wpc:script>
                            <wpc:javaCode><![CDATA[att.lightspeed.sdp.helper.WpsLogger logger = att.lightspeed.sdp.helper.WpsLogger.getLogger(processInstance());
String UMSessionID = null;
//String UMMessageCenterIP = null;

UMSessionID = processTransDetail.getString(SdpHelper.TRANSDETAIL_UMSESSIONID);
UMMessageCenterIP = processTransDetail.getString(SdpHelper.TRANSDETAIL_UMMESSAGECENTERIP);

logger.debug("UMSessionID from the SetGroupMailboxInfo Response: " + UMSessionID);
logger.debug("UMMessageCenterIP from the SetGroupMailbox Response: " + UMMessageCenterIP);

processBO.setString(SdpHelper.xPathify(SdpHelper.TRANSDETAIL_UMSESSIONID_PATH),UMSessionID);

processBO.setString(SdpHelper.xPathify(SdpHelper.TRANSDETAIL_UMMESSAGECENTERIP_PATH),UMMessageCenterIP);]]></wpc:javaCode>
                          </wpc:script>
                        </bpws:invoke>
                      </bpws:sequence>
                      <bpws:assign name="AddgetGroupMailboxInfoforRollback" wpc:displayName="Add getGroupMailboxInfo for Rollback" wpc:id="2932">
                        <bpws:copy>
                          <bpws:from variable="SDP_ORDER_GrpMBoxInfoPort">
                            <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail]]></bpws:query>
                          </bpws:from>
                          <bpws:to variable="IndexChangeUpdateState">
                            <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail]]></bpws:query>
                          </bpws:to>
                        </bpws:copy>
                      </bpws:assign>
                      <bpws:assign name="CopytheGroupMailBoxInfotoProcObject" wpc:displayName="Copy the Group Mail Box Info to Proc Object" wpc:id="387">
                        <bpws:copy>
                          <bpws:from variable="SDP_ORDER_GrpMBoxInfoPort"/>
                          <bpws:to variable="SDP_ORDER_GrpMBoxInfoProc"/>
                        </bpws:copy>
                      </bpws:assign>
                      <bpws:invoke name="UpdatetheChangedMBoxIndexesintheresponsefromUCDCL" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Update the Changed MBox Indexes in the response from UCDCL " wpc:id="1096">
                        <wpc:script>
                          <wpc:javaCode><![CDATA[Iterator iterIndexChangedMBoxList = null;
Iterator iterTempStoreList = null;
List accountMailBoxList = null;
List tempStoreList = null;
String mailBoxInvariantId = null;
String temp1 = null;
Integer mBoxInd = null;

accountMailBoxList = indexChangedMBoxList.getList(SdpHelper.CVOIP_MAILBOX);
tempStoreList = SDP_ORDER_GrpMBoxInfoProc.getList(SdpHelper.xPathify(SdpHelper.TEMP_STORE_LIST));
//iterTempStoreList = tempStoreList.iterator();
if(accountMailBoxList != null && accountMailBoxList.size()> 0 ){
	iterIndexChangedMBoxList = accountMailBoxList.iterator();
		while(iterIndexChangedMBoxList.hasNext()){
			tmpMBox = (DataObject)iterIndexChangedMBoxList.next();
			mailBoxInvariantId = tmpMBox.getString(SdpHelper.CVOIP_MAILBOX_MAILBOXINVARIANTID);
			iterTempStoreList = tempStoreList.iterator();
			while(iterTempStoreList.hasNext()){
				sdp_Temp = (DataObject)iterTempStoreList.next();
				temp1 = sdp_Temp.getString(SdpHelper.TEMP1);
				mBoxInd = new Integer(tmpMBox.getInt(SdpHelper.CVOIP_MAILBOX_INDEX));
				if(mailBoxInvariantId.equalsIgnoreCase(temp1)){
					if(mBoxInd.intValue() == 0)
						sdp_Temp.setInt("temp10", -1);
					else
						sdp_Temp.setInt("temp10", mBoxInd.intValue());
				}
			}
	   }
}]]></wpc:javaCode>
                        </wpc:script>
                      </bpws:invoke>
                      <bpws:invoke name="ChecktoUpdateprimaryMailBoxIndexEnabled" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Check to Update primaryMailBox Index/Enabled" wpc:id="2619">
                        <wpc:script>
                          <wpc:javaCode><![CDATA[// Setting Enabled to TRUE/FALSE for Primary Mailbox

List lstTempStore = null;
Iterator itrTempStore = null;

DataObject tempStore = null;

lstTempStore = SDP_ORDER_GrpMBoxInfoProc.getList(SdpHelper.TEMP_STORE_LIST.replace('.','/'));
itrTempStore = lstTempStore.iterator();

SDP_ORDER_GrpMBoxInfoProc.setBoolean(SdpHelper.TEMPBOOL1_PATH.replace('.','/'), false);

while (itrTempStore.hasNext())
{
	tempStore = (DataObject)itrTempStore.next();
	if (tempStore != null)
	{
		SdpLoggerHelper.logMessage("Checking to set PrimaryMailbox Enabled as TRUE",
			PROCESS_NAME,processID,SdpLoggerHelper.INFO);
		
		if(tempStore.getInt("temp10") == 0)
		{
			tempStore.setInt("temp10", -1);
		}
			
		if(tempStore.getInt("temp10") != -1)
		{	
			SDP_ORDER_GrpMBoxInfoProc.setBoolean(SdpHelper.TEMPBOOL1_PATH.replace('.','/'), true);
			SdpLoggerHelper.logMessage("PrimaryMailbox Enabled is set as TRUE",
				PROCESS_NAME,processID,SdpLoggerHelper.INFO);
			break;
		}
	}
}

//Setting the index[assignedKey] for PrimaryMailbox

int reqprimaryIndex = ((DataObject)SdpHelper.getPrimaryMailBox(MailboxConfig_Proc)).getInt("index");
int provprimaryIndex = ((DataObject)SdpHelper.getPrimaryMailBox(SDP_ORDER_Prov)).getInt("index");

SdpLoggerHelper.logMessage("Checking to update the PrimaryMailbox index",
	PROCESS_NAME,processID,SdpLoggerHelper.INFO);

if( reqprimaryIndex != 0 &&  
	SDP_ORDER_GrpMBoxInfoProc.getBoolean(SdpHelper.TEMPBOOL1_PATH.replace('.','/')) )
{
	SDP_ORDER_GrpMBoxInfoProc.setInt(SdpHelper.TEMPINT2_PATH.replace('.','/'),reqprimaryIndex);
	SdpLoggerHelper.logMessage("PrimaryMailbox index is updated to : " + reqprimaryIndex,
		PROCESS_NAME,processID,SdpLoggerHelper.INFO); 
}
else
{
	SDP_ORDER_GrpMBoxInfoProc.setInt(SdpHelper.TEMPINT2_PATH.replace('.','/'),-1);
	SdpLoggerHelper.logMessage("PrimaryMailbox index is updated to : -1",
		PROCESS_NAME,processID,SdpLoggerHelper.INFO);
}]]></wpc:javaCode>
                        </wpc:script>
                      </bpws:invoke>
                      <bpws:assign name="PreInvokeAssigns16" wpc:displayName="Pre-Invoke Assigns" wpc:id="1598">
                        <bpws:copy>
                          <bpws:from variable="emptyTransactionDetail"/>
                          <bpws:to variable="TrasationDetail_Port"/>
                        </bpws:copy>
                        <bpws:copy>
                          <bpws:from>UCDCL.SetGroupMailBoxInfo.request</bpws:from>
                          <bpws:to variable="TrasationDetail_Port">
                            <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/State]]></bpws:query>
                          </bpws:to>
                        </bpws:copy>
                        <bpws:copy>
                          <bpws:from>UCDCL</bpws:from>
                          <bpws:to variable="TrasationDetail_Port">
                            <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/TargetSystem]]></bpws:query>
                          </bpws:to>
                        </bpws:copy>
                        <bpws:copy>
                          <bpws:from>SetGroupMailBoxInfo</bpws:from>
                          <bpws:to variable="TrasationDetail_Port">
                            <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/currentTargetOperation]]></bpws:query>
                          </bpws:to>
                        </bpws:copy>
                        <bpws:copy>
                          <bpws:from variable="emptySDPOrder"/>
                          <bpws:to variable="SDP_ORDER_Port"/>
                        </bpws:copy>
                        <bpws:copy>
                          <bpws:from>true</bpws:from>
                          <bpws:to variable="boolIndexChanged"/>
                        </bpws:copy>
                        <bpws:copy>
                          <bpws:from variable="processTransDetail">
                            <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[UMSessionID]]></bpws:query>
                          </bpws:from>
                          <bpws:to variable="SDP_ORDER_GrpMBoxInfoProc">
                            <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[transactionDetail/UMSessionID]]></bpws:query>
                          </bpws:to>
                        </bpws:copy>
                        <bpws:copy>
                          <bpws:from variable="processTransDetail">
                            <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[UMMessageCenterIP]]></bpws:query>
                          </bpws:from>
                          <bpws:to variable="SDP_ORDER_GrpMBoxInfoProc">
                            <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[transactionDetail/UMMessageCenterIP]]></bpws:query>
                          </bpws:to>
                        </bpws:copy>
                      </bpws:assign>
                      <bpws:invoke name="LogUCDCLsetGroupMailBoxInfoPort" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UCDCL.setGroupMailBoxInfoPort ]" wpc:id="2280">
                        <wpc:script>
                          <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage(SdpLoggerHelper.INVOKE_STR +" : UCDCL.setGroupMailBoxInfo",PROCESS_NAME,processID
														,SdpLoggerHelper.INFO);
														
SdpLoggerHelper.logMessage("Request BO:[SDP_ORDER]",PROCESS_NAME,processID
														,SdpLoggerHelper.INFO);
SdpLoggerHelper.logMessage("SDP_ORDER_GrpMBoxInfoProc:",PROCESS_NAME,processID
														,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(SDP_ORDER_GrpMBoxInfoProc,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

]]></wpc:javaCode>
                        </wpc:script>
                      </bpws:invoke>
                      <bpws:invoke name="UCDCLSetGroupMailBoxInfo1" operation="setGroupMailboxInfo" partnerLink="UcdclCompensableService_Interface" portType="ns37:UCDCLCompensableService_Interface" wpc:displayName="UCDCL Set Group MailBox Info  " wpc:id="397">
                        <wpc:input>
                          <wpc:parameter name="order" variable="SDP_ORDER_GrpMBoxInfoProc"/>
                        </wpc:input>
                        <wpc:output>
                          <wpc:parameter name="transactionDetail" variable="processTransDetail"/>
                        </wpc:output>
                        <bpws:catch faultName="ns37:serviceCallFault" faultVariable="scFault" wpc:faultType="java:ServiceCallFault" wpc:id="3007" wpc:variableId="401">
                          <bpws:invoke name="SetErrorDetails4" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Set Error Details" wpc:id="1601">
                            <wpc:script>
                              <wpc:javaCode><![CDATA[TrasationDetail_Port.setBoolean(SdpHelper.ERRORINDICATOR,true);

new att.lightspeed.sdp.helper.TransactionDetail(TrasationDetail_Port).setSDPErrorMessage(scFault);

TrasationDetail_Port.getDataObject("errorDetails").getDataObject("Error").setString("Severity",SdpErrorHelper.SEVERITY_FATAL);

 
SdpLoggerHelper.logMessage(SdpLoggerHelper.FAULT_FAILURE +" UCDCL.setGroupMailBoxInfoPort",PROCESS_NAME,processID,SdpLoggerHelper.FATAL); 
 
]]></wpc:javaCode>
                            </wpc:script>
                          </bpws:invoke>
                        </bpws:catch>
                        <bpws:catch faultName="wpc:runtimeFailure" faultVariable="bpcFault" wpc:faultType="wpc:BPCStandardFaultType" wpc:id="3008" wpc:variableId="1091">
                          <bpws:invoke name="HandleRuntimefailure3" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="handle Runtime failure" wpc:id="1375">
                            <wpc:script>
                              <wpc:javaCode><![CDATA[SdpErrorHelper.setErrDetInTransDet(TrasationDetail_Port,bpcFault,SdpErrorHelper.SEVERITY_FATAL);

SdpLoggerHelper.logMessage(SdpLoggerHelper.RUNTIME_FAILURE+"  UCDCL.setGroupMailBoxInfoPort",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);]]></wpc:javaCode>
                            </wpc:script>
                          </bpws:invoke>
                        </bpws:catch>
                        <bpws:catchAll wpc:id="3006">
                          <bpws:invoke name="Handleotherfailures6" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="handle other failures" wpc:id="1378">
                            <wpc:script>
                              <wpc:javaCode><![CDATA[SdpErrorHelper.setErrDetInTransDet(TrasationDetail_Port,null,SdpErrorHelper.SEVERITY_FATAL);

SdpLoggerHelper.logMessage(SdpLoggerHelper.UNKNOWN_FAILURE+"  UCDCL.setGroupMailBoxInfoPort",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);]]></wpc:javaCode>
                            </wpc:script>
                          </bpws:invoke>
                        </bpws:catchAll>
                      </bpws:invoke>
                      <bpws:switch name="UCDCLError1" wpc:displayName="UCDCL Error?" wpc:id="412">
                        <bpws:case wpc:id="413">
                          <bpws:condition><![CDATA[boolean __result__1 = com.ibm.wbiservers.brules.core.codegen.NillableUtility.getBoolean(TrasationDetail_Port, "errorIndicator", "TrasationDetail_Port");
return __result__1;

//@generated:com.ibm.wbit.activity.ui
//<?xml version="1.0" encoding="UTF-8"?>
//<com.ibm.wbit.activity:CompositeActivity xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:com.ibm.wbit.activity="http:///com/ibm/wbit/activity.ecore" name="ActivityMethod">
//  <result name="Result">
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="boolean"/>
//  </result>
//  <exceptions>
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="com.ibm.bpe.api.ProcessException"/>
//  </exceptions>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="TrasationDetail_Port.errorIndicator" field="true">
//    <dataOutputs target="//@executableElements.1"/>
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="boolean" namespace="http://www.w3.org/2001/XMLSchema" nillable="false"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:ReturnElement" dataInputs="//@executableElements.0/@dataOutputs.0"/>
//  <executableGroups executableElements="//@executableElements.0 //@executableElements.1"/>
//</com.ibm.wbit.activity:CompositeActivity>
//@generated:end
//!SMAP!*S WBIACTDBG
//!SMAP!*L
//!SMAP!1:1,1
//!SMAP!2:2,1
//!SMAP!1000000:26,1]]></bpws:condition>
                          <bpws:sequence name="HiddenSequence27" wpc:id="1073744730">
                            <bpws:invoke name="LogUCDCLsetGroupMailBoxInfoPortError" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UCDCL.setGroupMailBoxInfoPort   - Error]" wpc:id="2282">
                              <wpc:script>
                                <wpc:javaCode><![CDATA[String strSeverity =TrasationDetail_Port.getString("errorDetails/Error/Severity");
int logLevel = SdpHelper.getLogLevel(strSeverity);
SdpLoggerHelper.logMessage(" UCDCL.setGroupMailBoxInfoPort- "+SdpLoggerHelper.ERROR_STR+"["+strSeverity+"]",PROCESS_NAME,processID,logLevel);]]></wpc:javaCode>
                              </wpc:script>
                            </bpws:invoke>
                            <bpws:invoke name="LogUpdateMailBoxConfigCompensation8" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [ UpdateMailBoxConfigCompensation]" wpc:id="2275">
                              <wpc:script>
                                <wpc:javaCode><![CDATA[
SdpLoggerHelper.logMessage(SdpLoggerHelper.INVOKE_STR +" SubFlow : UpdateMailBoxConfigCompensation",PROCESS_NAME,processID,SdpLoggerHelper.INFO);
SdpLoggerHelper.logMessage("Request BOs : ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("CreateRequestState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(CreateRequestState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("CreateProvState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(CreateProvstate,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("DeleteRequestState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(DeleteRequestState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("DeleteProvState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(DeleteProvState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("UpdateRequestState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(UpdateRequestState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("UpdateProvState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(UpdateProvState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("TransactionDetailPort :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(TrasationDetail_Port,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("SDP_ORDER_GrpMBoxInfoPort :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(SDP_ORDER_GrpMBoxInfoPort,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("IndexChangeUpdateState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(IndexChangeUpdateState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("SetSubscriberSettingsBySub :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(SetSubscriberSettingsBySub,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("PinChangeUpdateState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(PinChangeUpdateState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("TnChangeUpdateState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(TnChangeUpdateState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("AddServiceState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(AddServiceState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("RemoveServiceState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(RemoveServiceState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

CreateRequestState.setString(SdpHelper.TEMPSTRING2_PATH.replace('.','/'),processID);
]]></wpc:javaCode>
                              </wpc:script>
                            </bpws:invoke>
                            <bpws:assign name="MergeWESMerrortoProcobject8" wpc:displayName="Merge WESM error to Proc object" wpc:id="2485">
                              <bpws:copy>
                                <bpws:from variable="TrasationDetail_Port">
                                  <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/Message]]></bpws:query>
                                </bpws:from>
                                <bpws:to variable="IndexChangeUpdateState">
                                  <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/errorDetails/Error/Message]]></bpws:query>
                                </bpws:to>
                              </bpws:copy>
                              <bpws:copy>
                                <bpws:from variable="TrasationDetail_Port"/>
                                <bpws:to variable="MailboxConfig_Proc">
                                  <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail]]></bpws:query>
                                </bpws:to>
                              </bpws:copy>
                            </bpws:assign>
                            <bpws:invoke name="CallUpdateMailBoxConfigCompensate4" operation="compensateUpdateMailBoxConfig" partnerLink="UpdateMailBoxConfig_Compensation_Interface" portType="ns31:UpdateMailBoxConfig_Compensation_Interface" wpc:displayName="call UpdateMailBoxConfig Compensate" wpc:id="2169">
                              <wpc:input>
                                <wpc:parameter name="CreateProvState" variable="CreateProvstate"/>
                                <wpc:parameter name="CreateRequestState" variable="CreateRequestState"/>
                                <wpc:parameter name="UpdateProvState" variable="UpdateProvState"/>
                                <wpc:parameter name="TransactionDetailPort" variable="TrasationDetail_Port"/>
                                <wpc:parameter name="DeleteProvState" variable="DeleteProvState"/>
                                <wpc:parameter name="DeleteRequestState" variable="DeleteRequestState"/>
                                <wpc:parameter name="UpdateRequestState" variable="UpdateRequestState"/>
                                <wpc:parameter name="SDP_ORDER_GrpMBoxInfoPort" variable="SDP_ORDER_GrpMBoxInfoPort"/>
                                <wpc:parameter name="IndexChangeUpdateState" variable="IndexChangeUpdateState"/>
                                <wpc:parameter name="SetSubscriberSettingsBySub" variable="SetSubscriberSettingsBySub"/>
                                <wpc:parameter name="PinChangeUpdateState" variable="PinChangeUpdateState"/>
                                <wpc:parameter name="TnChangeUpdateState" variable="TnChangeUpdateState"/>
                                <wpc:parameter name="AddServiceState" variable="AddServiceState"/>
                                <wpc:parameter name="RemoveServiceState" variable="RemoveServiceState"/>
                              </wpc:input>
                              <wpc:output>
                                <wpc:parameter name="TransactionDetailPort" variable="TrasationDetail_Port"/>
                                <wpc:parameter name="SdpOrderPort" variable="SDP_ORDER_Port"/>
                              </wpc:output>
                            </bpws:invoke>
                            <bpws:invoke name="LogUpdateMailBoxConfigCompensation9" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UpdateMailBoxConfigCompensation ]" wpc:id="2278">
                              <wpc:script>
                                <wpc:javaCode><![CDATA[
SdpLoggerHelper.logMessage("Received the following GBO from SubFlow : UpdateMailBoxConfigCompensation  ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("TrasationDetail_Port : ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(TrasationDetail_Port,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

]]></wpc:javaCode>
                              </wpc:script>
                            </bpws:invoke>
                            <bpws:invoke name="MergeRollBackedMailboxesintoProc6" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Merge RollBacked Mailboxes into Proc" wpc:id="2792">
                              <wpc:script>
                                <wpc:javaCode><![CDATA[DataObject tmpMailbox = null;
List lstAccountMailboxes = null;
Iterator itrAccountMailboxes = null;
List lstMailboxes = null;

SdpLoggerHelper.logMessage("Merging the RolledBack mailboxes into the response SdpOrder",
	PROCESS_NAME,processID,SdpLoggerHelper.DEBUG);

try {
	lstAccountMailboxes = 
		SDP_ORDER_Port.getList(SdpHelper.VOIP_ACCOUNTMAILBOXES_PATH.replace('.','/'));
	itrAccountMailboxes = lstAccountMailboxes.iterator();
	
	lstMailboxes = MailboxConfig_Proc.getList(SdpHelper.VOIP_ACCOUNTMAILBOXES_PATH.replace('.','/'));
	
	while(itrAccountMailboxes.hasNext())
	{		
		tmpMailbox = SDO.copy((DataObject) itrAccountMailboxes.next());
		lstMailboxes.add(tmpMailbox);
	}
}
catch(Exception ex)
{
	SdpLoggerHelper.logMessage("Failed during Merge the RolledBack mailboxes into response SdpOrder",
		PROCESS_NAME,processID,SdpLoggerHelper.DEBUG);
	SdpLoggerHelper.logMessage("Exception : " + ex,
		PROCESS_NAME,processID,SdpLoggerHelper.DEBUG);
}]]></wpc:javaCode>
                              </wpc:script>
                            </bpws:invoke>
                            <bpws:assign name="MergerProctoTrig5" wpc:displayName="Merger Proc to Trig" wpc:id="2457">
                              <bpws:copy>
                                <bpws:from variable="MailboxConfig_Proc"/>
                                <bpws:to variable="MailboxConfigRequest_Trig"/>
                              </bpws:copy>
                              <bpws:copy>
                                <bpws:from variable="sdpProcessContext"/>
                                <bpws:to variable="MailboxConfigRequest_Trig">
                                  <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/ProcessContext]]></bpws:query>
                                </bpws:to>
                              </bpws:copy>
                            </bpws:assign>
                            <bpws:invoke name="LogEndProcess9" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [End Process]" wpc:id="2431">
                              <wpc:script>
                                <wpc:javaCode><![CDATA[

SdpLoggerHelper.logMessage("Returning the following GBO To MAM ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("Provisioned [MailboxConfigRequest_Trig ]: ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(MailboxConfigRequest_Trig,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("End - UpdateMailBoxConfig",PROCESS_NAME,processID,SdpLoggerHelper.INFO);]]></wpc:javaCode>
                              </wpc:script>
                            </bpws:invoke>
                            <bpws:reply name="ReplyUCDCLError" operation="UpdateMailboxConfig" partnerLink="FromMam_FeaturePermissionMailboxUpdate_Interface" portType="ns3:FromMam_FeaturePermissionMailboxUpdate_Interface" wpc:displayName="Reply UCDCL Error" wpc:id="419">
                              <wpc:input>
                                <wpc:parameter name="mailboxConfigResponse" variable="MailboxConfigRequest_Trig"/>
                              </wpc:input>
                            </bpws:reply>
                            <bpws:terminate name="Terminate8" wpc:displayName="Terminate" wpc:id="1816"/>
                          </bpws:sequence>
                        </bpws:case>
                      </bpws:switch>
                      <bpws:invoke name="LogUCDCLsetGroupMailBoxInfoPortSuccess" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UCDCL.setGroupMailBoxInfoPort -Success ]" wpc:id="2384">
                        <wpc:script>
                          <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage(" UCDCL.setGroupMailBoxInfo -"+SdpLoggerHelper.SUCCESS_STR,PROCESS_NAME,processID
														,SdpLoggerHelper.INFO);]]></wpc:javaCode>
                        </wpc:script>
                      </bpws:invoke>
                      <bpws:invoke name="SetUMSessionIDUMMessageCenterIP2" operation="null" partnerLink="null" portType="wpc:null" wpc:continueOnError="inherit" wpc:displayName="Set UMSessionID &amp; UMMessageCenterIP" wpc:id="2946">
                        <wpc:script>
                          <wpc:javaCode><![CDATA[att.lightspeed.sdp.helper.WpsLogger logger = att.lightspeed.sdp.helper.WpsLogger.getLogger(processInstance());
String UMSessionID = null;
//String UMMessageCenterIP = null;

UMSessionID = processTransDetail.getString(SdpHelper.TRANSDETAIL_UMSESSIONID);
UMMessageCenterIP = processTransDetail.getString(SdpHelper.TRANSDETAIL_UMMESSAGECENTERIP);

logger.debug("UMSessionID from the SetGroupMailboxInfo Response: " + UMSessionID);
logger.debug("UMMessageCenterIP from the SetGroupMailbox Response: " + UMMessageCenterIP);

processBO.setString(SdpHelper.xPathify(SdpHelper.TRANSDETAIL_UMSESSIONID_PATH),UMSessionID);

processBO.setString(SdpHelper.xPathify(SdpHelper.TRANSDETAIL_UMMESSAGECENTERIP_PATH),UMMessageCenterIP);]]></wpc:javaCode>
                        </wpc:script>
                      </bpws:invoke>
                      <bpws:assign name="SetSDP_ORDER_GrpMBoxInfoPortRollBack1" wpc:displayName="Set SDP_ORDER_GrpMBoxInfoPort [RollBack]" wpc:id="2106">
                        <bpws:copy>
                          <bpws:from variable="MailboxConfig_Prov">
                            <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/order/ReqService/product/cvoipProduct/accountMailBoxes]]></bpws:query>
                          </bpws:from>
                          <bpws:to variable="SDP_ORDER_GrpMBoxInfoPort">
                            <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/order/ReqService/product/cvoipProduct/accountMailBoxes]]></bpws:query>
                          </bpws:to>
                        </bpws:copy>
                      </bpws:assign>
                    </bpws:sequence>
                  </bpws:case>
                </bpws:switch>
                <bpws:assign name="Preinvokeassigns3" wpc:displayName="pre-invoke assigns" wpc:id="2543">
                  <bpws:copy>
                    <bpws:from variable="emptyTransactionDetail"/>
                    <bpws:to variable="TrasationDetail_Port"/>
                  </bpws:copy>
                  <bpws:copy>
                    <bpws:from>UCDCL.Logout.request</bpws:from>
                    <bpws:to variable="TrasationDetail_Port">
                      <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/State]]></bpws:query>
                    </bpws:to>
                  </bpws:copy>
                  <bpws:copy>
                    <bpws:from>UCDCL</bpws:from>
                    <bpws:to variable="MailboxConfig_Proc">
                      <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/errorDetails/Error/TargetSystem]]></bpws:query>
                    </bpws:to>
                  </bpws:copy>
                  <bpws:copy>
                    <bpws:from>Logout</bpws:from>
                    <bpws:to variable="TrasationDetail_Port">
                      <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/currentTargetOperation]]></bpws:query>
                    </bpws:to>
                  </bpws:copy>
                </bpws:assign>
                <bpws:invoke name="LogUCDCLLogout1" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UCDCL.Logout ]" wpc:id="2545">
                  <wpc:script>
                    <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage(SdpLoggerHelper.INVOKE_STR +" : UCDCL.Logout",PROCESS_NAME,processID
														,SdpLoggerHelper.INFO);
														



																		]]></wpc:javaCode>
                  </wpc:script>
                </bpws:invoke>
                <bpws:invoke name="UCDCLLogout1" operation="subscriberServiceLogout" partnerLink="UcdclCompensableService_Interface" portType="ns37:UCDCLCompensableService_Interface" wpc:displayName=" UCDCL Logout" wpc:id="2546">
                  <wpc:input>
                    <wpc:parameter name="transactionDetail" variable="processTransDetail"/>
                  </wpc:input>
                  <wpc:output/>
                  <bpws:catch faultName="wpc:runtimeFailure" faultVariable="bpcFault" wpc:faultType="wpc:BPCStandardFaultType" wpc:id="3001" wpc:variableId="2547">
                    <bpws:invoke name="HandleRuntimeFailure6" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Handle Run time Failure" wpc:id="2549">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[SdpErrorHelper.setErrDetInTransDet(TrasationDetail_Port,bpcFault,SdpErrorHelper.SEVERITY_FATAL);

SdpLoggerHelper.logMessage(SdpLoggerHelper.RUNTIME_FAILURE+"  UCDCL.Logout",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                  </bpws:catch>
                  <bpws:catch faultName="ns37:serviceCallFault" faultVariable="scFault" wpc:faultType="java:ServiceCallFault" wpc:id="3002" wpc:variableId="2550">
                    <bpws:invoke name="SetErrorDetails9" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Set Error Details" wpc:id="2552">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[TrasationDetail_Port.setBoolean(SdpHelper.ERRORINDICATOR,true);

new att.lightspeed.sdp.helper.TransactionDetail(TrasationDetail_Port).setSDPErrorMessage(scFault);

TrasationDetail_Port.getDataObject("errorDetails").getDataObject("Error").setString("Severity",SdpErrorHelper.SEVERITY_FATAL);

 
SdpLoggerHelper.logMessage(SdpLoggerHelper.FAULT_FAILURE +"  UCDCL.Logout",PROCESS_NAME,processID,SdpLoggerHelper.FATAL); 
 ]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                  </bpws:catch>
                  <bpws:catchAll wpc:id="3000">
                    <bpws:invoke name="Handleotherfailures10" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="handle other failures" wpc:id="2554">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[SdpErrorHelper.setErrDetInTransDet(TrasationDetail_Port,null,SdpErrorHelper.SEVERITY_FATAL);

SdpLoggerHelper.logMessage(SdpLoggerHelper.UNKNOWN_FAILURE+"  UCDCL.Logout",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                  </bpws:catchAll>
                </bpws:invoke>
                <bpws:switch name="CheckUCDCLerror5" wpc:displayName="Check UCDCL error" wpc:id="2555">
                  <bpws:case wpc:id="2556">
                    <bpws:condition><![CDATA[boolean __result__1 = com.ibm.wbiservers.brules.core.codegen.NillableUtility.getBoolean(TrasationDetail_Port, "errorIndicator", "TrasationDetail_Port");
return __result__1;

//@generated:com.ibm.wbit.activity.ui
//<?xml version="1.0" encoding="UTF-8"?>
//<com.ibm.wbit.activity:CompositeActivity xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:com.ibm.wbit.activity="http:///com/ibm/wbit/activity.ecore" name="ActivityMethod">
//  <result name="Result">
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="boolean"/>
//  </result>
//  <exceptions>
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="com.ibm.bpe.api.ProcessException"/>
//  </exceptions>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="TrasationDetail_Port.errorIndicator" field="true">
//    <dataOutputs target="//@executableElements.1"/>
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="boolean" namespace="http://www.w3.org/2001/XMLSchema" nillable="false"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:ReturnElement" dataInputs="//@executableElements.0/@dataOutputs.0"/>
//  <executableGroups executableElements="//@executableElements.0 //@executableElements.1"/>
//</com.ibm.wbit.activity:CompositeActivity>
//@generated:end
//!SMAP!*S WBIACTDBG
//!SMAP!*L
//!SMAP!1:1,1
//!SMAP!2:2,1
//!SMAP!1000000:26,1]]></bpws:condition>
                    <bpws:sequence name="HiddenSequence10" wpc:id="1073744731">
                      <bpws:invoke name="LogUCDCLLogoutError" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UCDCL.Logout   - Error]" wpc:id="2559">
                        <wpc:script>
                          <wpc:javaCode><![CDATA[String strSeverity =TrasationDetail_Port.getString("errorDetails/Error/Severity");
int logLevel = SdpHelper.getLogLevel(strSeverity);
SdpLoggerHelper.logMessage("Returning : UCDCL.LogOut- "+SdpLoggerHelper.ERROR_STR+"["+strSeverity+"]",PROCESS_NAME,processID,logLevel);
														



																		]]></wpc:javaCode>
                        </wpc:script>
                      </bpws:invoke>
                    </bpws:sequence>
                  </bpws:case>
                  <bpws:otherwise wpc:id="3012">
                    <bpws:invoke name="LogUCDCLLogoutSuccess" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UCDCL.Logout -Success ]" wpc:id="2561">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage("Returning : UCDCL.LogOut -"+SdpLoggerHelper.SUCCESS_STR,PROCESS_NAME,processID
														,SdpLoggerHelper.INFO);
														



																		]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                  </bpws:otherwise>
                </bpws:switch>
                <bpws:assign name="Initializecounter1" wpc:displayName="initialize counter" wpc:id="1244">
                  <bpws:copy>
                    <bpws:from>0</bpws:from>
                    <bpws:to variable="intCounter"/>
                  </bpws:copy>
                </bpws:assign>
                <bpws:while name="ForeachIndexchangedMBox" wpc:displayName="For each Index changed MBox" wpc:id="1243">
                  <bpws:condition><![CDATA[boolean __result__1 = intCounter.intValue() < indexChangedMBoxList.getList("accountMailBoxes").size();
return __result__1;
]]></bpws:condition>
                  <bpws:sequence name="HiddenSequence28" wpc:id="1073744732">
                    <bpws:assign name="PreInvokeAssigns9" wpc:displayName="Pre-Invoke Assigns" wpc:id="1624">
                      <bpws:copy>
                        <bpws:from variable="emptyTransactionDetail"/>
                        <bpws:to variable="TrasationDetail_Port"/>
                      </bpws:copy>
                      <bpws:copy>
                        <bpws:from>MPS.UpdateComponent.request</bpws:from>
                        <bpws:to variable="TrasationDetail_Port">
                          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/State]]></bpws:query>
                        </bpws:to>
                      </bpws:copy>
                      <bpws:copy>
                        <bpws:from>MPS</bpws:from>
                        <bpws:to variable="TrasationDetail_Port">
                          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/TargetSystem]]></bpws:query>
                        </bpws:to>
                      </bpws:copy>
                      <bpws:copy>
                        <bpws:from>UpdateComponent</bpws:from>
                        <bpws:to variable="TrasationDetail_Port">
                          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/currentTargetOperation]]></bpws:query>
                        </bpws:to>
                      </bpws:copy>
                      <bpws:copy>
                        <bpws:from variable="MailboxConfig_Prov"/>
                        <bpws:to variable="SDP_ORDER_ForUpdate"/>
                      </bpws:copy>
                      <bpws:copy>
                        <bpws:from>MAILBOX</bpws:from>
                        <bpws:to variable="TrasationDetail_Port">
                          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/currentProduct]]></bpws:query>
                        </bpws:to>
                      </bpws:copy>
                      <bpws:copy>
                        <bpws:from variable="TrasationDetail_Port"/>
                        <bpws:to variable="SDP_ORDER_ForUpdate">
                          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail]]></bpws:query>
                        </bpws:to>
                      </bpws:copy>
                    </bpws:assign>
                    <bpws:invoke name="PrepareforMPSUpdate" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Prepare for MPS Update" wpc:id="1250">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[List accountMailBoxList = null;
List tmpMBoxList = null;
tmpMBoxList = indexChangedMBoxList.getList("accountMailBoxes");
if(tmpMBoxList != null){
	tmpMBox = (DataObject)tmpMBoxList.get(intCounter.intValue());
	new Order(SDP_ORDER_ForUpdate).getProductList(Product.CVOIPMAILBOX).clear();
	accountMailBoxList = new Order(SDP_ORDER_ForUpdate).getProductList(Product.CVOIPMAILBOX);
	if (accountMailBoxList != null)
		accountMailBoxList.add(SDO.copy(tmpMBox));
}]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                    <bpws:invoke name="SetMPSvalues" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="set MPS values" wpc:id="1246">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage("Setting up the Values for MPS.updateComponent[MailBox_Index]", PROCESS_NAME, processID,
	SdpLoggerHelper.DEBUG);
//R7 Filter settings not required
/*
//Create WESM Content Filter 
ContentFilterCreator filterCreator = new ContentFilterCreator();

filterCreator.addSelectFilter(SdpHelper.PRODUCTTYPE, SdpHelper.CURRENT_PRODUCT_PATH);

filterCreator.addSelectFilter(SdpHelper.ACCT_OBJID, SdpHelper.ACCT_OBJID_PATH);

filterCreator.addSelectFilter(SdpHelper.CVOIP_MAILBOX_MAILBOXINVARIANTID, 
	SdpHelper.CVOIP_MAILBOX_MAILBOXINVARIANTID_PATH);

filterCreator.addUpdateFilter(SdpHelper.CVOIP_MAILBOX_INDEX, SdpHelper.CVOIP_MAILBOX_INDEX_PATH);
		
//Set the Content filter to the transaction detail object. 
SDP_ORDER_ForUpdate.getDataObject("transactionDetail").setDataObject( "contentFilter", filterCreator.createFilters() );

*/


 
	]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                    <bpws:invoke name="LogMPSUpdateComponent" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [ MPS.UpdateComponent]" wpc:id="2290">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage(SdpLoggerHelper.INVOKE_STR +" : MPS.UpdateComponent",PROCESS_NAME,processID
														,SdpLoggerHelper.INFO);
														
SdpLoggerHelper.logMessage("Request BO:[SDP_ORDER]",PROCESS_NAME,processID
														,SdpLoggerHelper.INFO);
SdpLoggerHelper.logMessage("SDP_ORDER_ForUpdate:",PROCESS_NAME,processID
														,SdpLoggerHelper.INFO);

														
SdpLoggerHelper.logBO(SDP_ORDER_ForUpdate,PROCESS_NAME,processID,SdpLoggerHelper.INFO);
																		]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                    <bpws:invoke name="MPSUpdateComponent" operation="updateComponent" partnerLink="MPSCompensableService2_InterfacePartner" portType="ns35:MPSCompensableService2_Interface" wpc:displayName="MPS Update Component" wpc:id="1251">
                      <wpc:input>
                        <wpc:parameter name="order" variable="SDP_ORDER_ForUpdate"/>
                      </wpc:input>
                      <wpc:output/>
                      <bpws:catch faultName="ns35:serviceCallFault" faultVariable="scFault" wpc:faultType="java:ServiceCallFault" wpc:id="3013" wpc:variableId="1382">
                        <bpws:sequence name="HiddenSequence17" wpc:id="1073744645">
                          <bpws:assign name="SetErrorDetails" wpc:displayName="Set Error Details" wpc:id="2866">
                            <bpws:copy>
                              <bpws:from><![CDATA[11016]]></bpws:from>
                              <bpws:to variable="TrasationDetail_Port">
                                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/Message/MessageCode]]></bpws:query>
                              </bpws:to>
                            </bpws:copy>
                            <bpws:copy>
                              <bpws:from><![CDATA[SDP_Downstream_System_Error]]></bpws:from>
                              <bpws:to variable="TrasationDetail_Port">
                                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/Message/MessageText]]></bpws:query>
                              </bpws:to>
                            </bpws:copy>
                            <bpws:copy>
                              <bpws:from>FATAL</bpws:from>
                              <bpws:to variable="TrasationDetail_Port">
                                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/Severity]]></bpws:query>
                              </bpws:to>
                            </bpws:copy>
                            <bpws:copy>
                              <bpws:from variable="scFault">
                                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[messageDetail]]></bpws:query>
                              </bpws:from>
                              <bpws:to variable="TrasationDetail_Port">
                                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[errorDetails/Error/Message/MessageDetail]]></bpws:query>
                              </bpws:to>
                            </bpws:copy>
                          </bpws:assign>
                          <bpws:invoke name="Handleruntimefailures1" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="handle runtime failures" wpc:id="1381">
                            <wpc:script>
                              <wpc:javaCode><![CDATA[TrasationDetail_Port.setBoolean("errorIndicator", true);
SdpLoggerHelper.logMessage(SdpLoggerHelper.RUNTIME_FAILURE+" MPS.updateComponent",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);
SdpLoggerHelper.logBO(scFault,PROCESS_NAME,processID,SdpLoggerHelper.FATAL);
/*

SdpErrorHelper.setErrDetInTransDet(TrasationDetail_Port,bpcFault,SdpErrorHelper.SEVERITY_FATAL);

SdpLoggerHelper.logMessage(SdpLoggerHelper.RUNTIME_FAILURE+"   MPS.UpdateComponent",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);

DataObject responseMessage = (DataObject)TrasationDetail_Port.getDataObject("errorDetails/Error/Message");
responseMessage.setString(SdpHelper.ERRORDETAILS_MESSAGE_CODE,SdpErrorHelper.SDP_INTERNAL_SYSTEM_ERROR);
*/]]></wpc:javaCode>
                            </wpc:script>
                          </bpws:invoke>
                          <bpws:sequence name="HiddenSequence24" wpc:id="1073743094">
                            <bpws:assign name="PreinvokeforRollBack" wpc:displayName="preinvoke for RollBack" wpc:id="2150">
                              <bpws:copy>
                                <bpws:from>LOGERROR</bpws:from>
                                <bpws:to variable="IndexChangeUpdateState">
                                  <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/tempStoreNonArray/temp1]]></bpws:query>
                                </bpws:to>
                              </bpws:copy>
                              <bpws:copy>
                                <bpws:from variable="intCounter"/>
                                <bpws:to variable="IndexChangeUpdateState">
                                  <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/tempStoreNonArray/temp10]]></bpws:query>
                                </bpws:to>
                              </bpws:copy>
                            </bpws:assign>
                            <bpws:invoke name="LogUpdateMailBoxConfigCompensation10" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UpdateMailBoxConfigCompensation ]" wpc:id="2285">
                              <wpc:script>
                                <wpc:javaCode><![CDATA[
SdpLoggerHelper.logMessage(SdpLoggerHelper.INVOKE_STR +" SubFlow : UpdateMailBoxConfigCompensation",PROCESS_NAME,processID,SdpLoggerHelper.INFO);
SdpLoggerHelper.logMessage("Request BOs : ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("CreateRequestState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(CreateRequestState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("CreateProvState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(CreateProvstate,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("DeleteRequestState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(DeleteRequestState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("DeleteProvState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(DeleteProvState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("UpdateRequestState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(UpdateRequestState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("UpdateProvState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(UpdateProvState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("TransactionDetailPort :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(TrasationDetail_Port,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("SDP_ORDER_GrpMBoxInfoPort :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(SDP_ORDER_GrpMBoxInfoPort,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("IndexChangeUpdateState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(IndexChangeUpdateState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("SetSubscriberSettingsBySub :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(SetSubscriberSettingsBySub,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("PinChangeUpdateState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(PinChangeUpdateState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("TnChangeUpdateState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(TnChangeUpdateState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("AddServiceState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(AddServiceState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("RemoveServiceState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(RemoveServiceState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

CreateRequestState.setString(SdpHelper.TEMPSTRING2_PATH.replace('.','/'),processID);
]]></wpc:javaCode>
                              </wpc:script>
                            </bpws:invoke>
                            <bpws:assign name="MergeMPSerrortoProcobject3" wpc:displayName="Merge MPS error to Proc object" wpc:id="2487">
                              <bpws:copy>
                                <bpws:from variable="TrasationDetail_Port"/>
                                <bpws:to variable="MailboxConfig_Proc">
                                  <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail]]></bpws:query>
                                </bpws:to>
                              </bpws:copy>
                            </bpws:assign>
                            <bpws:invoke name="CallUpdateMailBoxConfigCompensate5" operation="compensateUpdateMailBoxConfig" partnerLink="UpdateMailBoxConfig_Compensation_Interface" portType="ns31:UpdateMailBoxConfig_Compensation_Interface" wpc:displayName="call UpdateMailBoxConfig Compensate" wpc:id="2171">
                              <wpc:input>
                                <wpc:parameter name="CreateProvState" variable="CreateProvstate"/>
                                <wpc:parameter name="CreateRequestState" variable="CreateRequestState"/>
                                <wpc:parameter name="UpdateProvState" variable="UpdateProvState"/>
                                <wpc:parameter name="TransactionDetailPort" variable="TrasationDetail_Port"/>
                                <wpc:parameter name="DeleteProvState" variable="DeleteProvState"/>
                                <wpc:parameter name="DeleteRequestState" variable="DeleteRequestState"/>
                                <wpc:parameter name="UpdateRequestState" variable="UpdateRequestState"/>
                                <wpc:parameter name="SDP_ORDER_GrpMBoxInfoPort" variable="SDP_ORDER_GrpMBoxInfoPort"/>
                                <wpc:parameter name="IndexChangeUpdateState" variable="IndexChangeUpdateState"/>
                                <wpc:parameter name="SetSubscriberSettingsBySub" variable="SetSubscriberSettingsBySub"/>
                                <wpc:parameter name="PinChangeUpdateState" variable="PinChangeUpdateState"/>
                                <wpc:parameter name="TnChangeUpdateState" variable="TnChangeUpdateState"/>
                                <wpc:parameter name="AddServiceState" variable="AddServiceState"/>
                                <wpc:parameter name="RemoveServiceState" variable="RemoveServiceState"/>
                              </wpc:input>
                              <wpc:output>
                                <wpc:parameter name="TransactionDetailPort" variable="TrasationDetail_Port"/>
                                <wpc:parameter name="SdpOrderPort" variable="SDP_ORDER_Port"/>
                              </wpc:output>
                            </bpws:invoke>
                            <bpws:invoke name="LogUpdateMailBoxConfigCompensation11" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UpdateMailBoxConfigCompensation ]" wpc:id="2288">
                              <wpc:script>
                                <wpc:javaCode><![CDATA[
SdpLoggerHelper.logMessage("Received the following GBO from SubFlow : UpdateMailBoxConfigCompensation  ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("TrasationDetail_Port : ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(TrasationDetail_Port,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

]]></wpc:javaCode>
                              </wpc:script>
                            </bpws:invoke>
                            <bpws:invoke name="MergeRollBackedMailboxesintoProc7" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Merge RollBacked Mailboxes into Proc" wpc:id="2794">
                              <wpc:script>
                                <wpc:javaCode><![CDATA[DataObject tmpMailbox = null;
List lstAccountMailboxes = null;
Iterator itrAccountMailboxes = null;
List lstMailboxes = null;

SdpLoggerHelper.logMessage("Merging the RolledBack mailboxes into the response SdpOrder",
	PROCESS_NAME,processID,SdpLoggerHelper.DEBUG);

try {
	lstAccountMailboxes = 
		SDP_ORDER_Port.getList(SdpHelper.VOIP_ACCOUNTMAILBOXES_PATH.replace('.','/'));
	itrAccountMailboxes = lstAccountMailboxes.iterator();
	
	lstMailboxes = MailboxConfig_Proc.getList(SdpHelper.VOIP_ACCOUNTMAILBOXES_PATH.replace('.','/'));
	
	while(itrAccountMailboxes.hasNext())
	{		
		tmpMailbox = SDO.copy((DataObject) itrAccountMailboxes.next());
		lstMailboxes.add(tmpMailbox);
	}
}
catch(Exception ex)
{
	SdpLoggerHelper.logMessage("Failed during Merge the RolledBack mailboxes into response SdpOrder",
		PROCESS_NAME,processID,SdpLoggerHelper.DEBUG);
	SdpLoggerHelper.logMessage("Exception : " + ex,
		PROCESS_NAME,processID,SdpLoggerHelper.DEBUG);
}]]></wpc:javaCode>
                              </wpc:script>
                            </bpws:invoke>
                            <bpws:assign name="MergerProctoTrig6" wpc:displayName="Merger Proc to Trig" wpc:id="2459">
                              <bpws:copy>
                                <bpws:from variable="MailboxConfig_Proc"/>
                                <bpws:to variable="MailboxConfigRequest_Trig"/>
                              </bpws:copy>
                              <bpws:copy>
                                <bpws:from variable="sdpProcessContext"/>
                                <bpws:to variable="MailboxConfigRequest_Trig">
                                  <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/ProcessContext]]></bpws:query>
                                </bpws:to>
                              </bpws:copy>
                            </bpws:assign>
                            <bpws:invoke name="LogEndProcess8" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [End Process]" wpc:id="2429">
                              <wpc:script>
                                <wpc:javaCode><![CDATA[
SdpLoggerHelper.logMessage("Returning the following GBO To MAM ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("Provisioned [MailboxConfigRequest_Trig ]: ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(MailboxConfigRequest_Trig,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("End - UpdateMailBoxConfig",PROCESS_NAME,processID,SdpLoggerHelper.INFO);]]></wpc:javaCode>
                              </wpc:script>
                            </bpws:invoke>
                            <bpws:reply name="ReplyMPSError3" operation="UpdateMailboxConfig" partnerLink="FromMam_FeaturePermissionMailboxUpdate_Interface" portType="ns3:FromMam_FeaturePermissionMailboxUpdate_Interface" wpc:displayName="Reply MPS Error" wpc:id="1268">
                              <wpc:input>
                                <wpc:parameter name="mailboxConfigResponse" variable="MailboxConfigRequest_Trig"/>
                              </wpc:input>
                            </bpws:reply>
                            <bpws:terminate name="Terminate9" wpc:displayName="Terminate" wpc:id="1817"/>
                          </bpws:sequence>
                        </bpws:sequence>
                      </bpws:catch>
                    </bpws:invoke>
                    <bpws:invoke name="LogMPSUpdateComponentrSuccess" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [MPS.UpdateComponentr -Success ]" wpc:id="2387">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage("WESM.UpdateOrder :-"+SdpLoggerHelper.SUCCESS_STR,PROCESS_NAME,processID
														,SdpLoggerHelper.INFO);
SdpLoggerHelper.logMessage("Response BO [TrasationDetail]",PROCESS_NAME,processID,SdpLoggerHelper.INFO);	
SdpLoggerHelper.logMessage("TrasationDetail_Port:",PROCESS_NAME,processID,SdpLoggerHelper.INFO);													
SdpLoggerHelper.logBO(TrasationDetail_Port,PROCESS_NAME,processID,SdpLoggerHelper.INFO);
																		]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                    <bpws:invoke name="UpdateIndexChangeUpdateStateRollBack1" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Update IndexChangeUpdateState [RollBack]" wpc:id="2149">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[DataObject tmpMailbox = null;
DataObject mailbox = null;

tmpMailbox = (DataObject)indexChangedMBoxList.getList("accountMailBoxes").get(intCounter.intValue());
mailbox =  SDO.copy(tmpMailbox);

IndexChangeUpdateState.getList(SdpHelper.VOIP_ACCOUNTMAILBOXES_PATH.replace('.','/')).add(mailbox);]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                    <bpws:invoke name="Incrementer" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="incrementer" wpc:id="1273">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[java.lang.Integer __result__1 = new java.lang.Integer(com.ibm.wbiservers.brules.core.codegen.NillableUtility.getInt(intCounter, "intCounter") + 1);
intCounter = __result__1;

//@generated:com.ibm.wbit.activity.ui
//<?xml version="1.0" encoding="UTF-8"?>
//<com.ibm.wbit.activity:CompositeActivity xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:com.ibm.wbit.activity="http:///com/ibm/wbit/activity.ecore" name="ActivityMethod">
//  <exceptions>
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="com.ibm.bpe.api.ProcessException"/>
//  </exceptions>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="intCounter+1" assignable="false">
//    <dataOutputs target="//@executableElements.1"/>
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="int" namespace="http://www.w3.org/2001/XMLSchema"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" dataInputs="//@executableElements.0/@dataOutputs.0" value="intCounter" variable="true">
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="int" namespace="http://www.w3.org/2001/XMLSchema"/>
//  </executableElements>
//  <executableGroups executableElements="//@executableElements.0 //@executableElements.1"/>
//</com.ibm.wbit.activity:CompositeActivity>
//@generated:end
//!SMAP!*S WBIACTDBG
//!SMAP!*L
//!SMAP!1:1,1
//!SMAP!2:2,1
//!SMAP!1000000:25,1]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                  </bpws:sequence>
                </bpws:while>
              </bpws:sequence>
            </bpws:case>
            <bpws:otherwise wpc:id="3014">
              <bpws:empty name="GroupMailBoxInfonotchanged" wpc:displayName="Group MailBox Info not changed " wpc:id="1337"/>
            </bpws:otherwise>
          </bpws:switch>
          <bpws:invoke name="SetPinChangeUpdateStateSetSubscriberSettingsBySubRollBack" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Set PinChangeUpdateState,SetSubscriberSettingsBySub [RollBack]" wpc:id="2130">
            <wpc:script>
              <wpc:javaCode><![CDATA[PinChangeUpdateState = SDO.copy(MailboxConfig_Proc);
PinChangeUpdateState.getList(SdpHelper.VOIP_ACCOUNTMAILBOXES_PATH.replace('.','/')).clear();

SetSubscriberSettingsBySub = SDO.copy(MailboxConfig_Proc);
SetSubscriberSettingsBySub.getList(SdpHelper.VOIP_ACCOUNTMAILBOXES_PATH.replace('.','/')).clear();]]></wpc:javaCode>
            </wpc:script>
          </bpws:invoke>
          <bpws:assign name="InitializeCounters" wpc:displayName="Initialize Counters" wpc:id="432">
            <bpws:copy>
              <bpws:from>0</bpws:from>
              <bpws:to variable="intProvCounter"/>
            </bpws:copy>
            <bpws:copy>
              <bpws:from>0</bpws:from>
              <bpws:to variable="intReqCounter"/>
            </bpws:copy>
            <bpws:copy>
              <bpws:from>0</bpws:from>
              <bpws:to variable="PinChangeCounter"/>
            </bpws:copy>
          </bpws:assign>
          <bpws:while name="ForeachMailBoxinRequest" wpc:displayName="For each MailBox in Request" wpc:id="1010">
            <bpws:condition><![CDATA[boolean __result__1 = com.ibm.wbiservers.brules.core.codegen.NillableUtility.getInt(intReqCounter, "intReqCounter") < com.ibm.wbiservers.brules.core.codegen.NillableUtility.getList(com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(com.ibm.wbiservers.brules.core.codegen.NillableUtility.getDataObject(MailboxConfig_Proc, "order", "MailboxConfig_Proc"), "ReqService", "order"), "product", "ReqService"), "cvoipProduct", "product"), "accountMailBoxes", "MailboxConfig_Proc.order.ReqService.product.cvoipProduct").size();
return __result__1;

//@generated:com.ibm.wbit.activity.ui
//<?xml version="1.0" encoding="UTF-8"?>
//<com.ibm.wbit.activity:CompositeActivity xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:com.ibm.wbit.activity="http:///com/ibm/wbit/activity.ecore" name="ActivityMethod">
//  <result name="Result">
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="boolean"/>
//  </result>
//  <exceptions>
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="com.ibm.bpe.api.ProcessException"/>
//  </exceptions>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="intReqCounter &lt; MailboxConfig_Proc.order.ReqService.product.cvoipProduct.accountMailBoxes.size()" assignable="false">
//    <dataOutputs target="//@executableElements.1"/>
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="boolean"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:ReturnElement" dataInputs="//@executableElements.0/@dataOutputs.0"/>
//  <executableGroups executableElements="//@executableElements.0 //@executableElements.1"/>
//</com.ibm.wbit.activity:CompositeActivity>
//@generated:end
//!SMAP!*S WBIACTDBG
//!SMAP!*L
//!SMAP!1:1,1
//!SMAP!2:2,1
//!SMAP!1000000:26,1]]></bpws:condition>
            <bpws:sequence name="HiddenSequence23" wpc:id="1073744733">
              <bpws:invoke name="GetRequestProvisionedMailbox" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Get Request/Provisioned Mailbox" wpc:id="2914">
                <wpc:script>
                  <wpc:javaCode><![CDATA[String strInvId = null;
Order orderBO = new Order(MailboxConfig_Proc);

reqMBox = orderBO.getProduct(Product.CVOIPMAILBOX,intReqCounter.intValue());

if (reqMBox != null)
{
	strInvId = reqMBox.getString(SdpHelper.CVOIP_MAILBOX_MAILBOXINVARIANTID);
	provMBox = SdpHelper.getMailBox(SDP_ORDER_Prov,strInvId);
}]]></wpc:javaCode>
                </wpc:script>
              </bpws:invoke>
              <bpws:switch name="IfPinnumbernotequal" wpc:displayName="If Pin number not equal" wpc:id="1007">
                <bpws:case wpc:id="1008">
                  <bpws:condition><![CDATA[boolean proceed = false;
String reqMboxPin = null;
String provMboxPin = null;

if (reqMBox != null && provMBox !=  null)
{
	reqMboxPin = reqMBox.getString("PIN");
	provMboxPin = provMBox.getString("PIN");
	
	if (reqMboxPin != null && 
		 ( provMboxPin == null || (!reqMboxPin.equalsIgnoreCase(provMboxPin)) ))
	{
		proceed = true;
	}
}

return proceed;]]></bpws:condition>
                  <bpws:sequence name="HiddenSequence11" wpc:id="1073744739">
                    <bpws:invoke name="GetSDP_PersonName" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="get SDP_PersonName" wpc:id="2511">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[ucdclPersonName = SDO.copy(new Order(MailboxConfig_Prov).getPerson().getDataObject("customerName"));
new Order(PinChangeUpdateState).getPerson().set("customerName", SDO.copy(ucdclPersonName));
]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                    <bpws:invoke name="CreateloginId" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="create loginId" wpc:id="2503">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[/*
String tn = null;
try
{       
		DataObject primaryMBox = (DataObject)SdpHelper.getPrimaryMailBox(SDP_ORDER_Prov);
		tn = ((DataObject)primaryMBox.getList("mailBoxTNs").get(0)).getString("tn");
		loginId = tn+"@uvm.dayatt.com";
		SdpLoggerHelper.logMessage("ProvisionEmailAddress : " + loginId, PROCESS_NAME, processID, SdpLoggerHelper.INFO);
	
}
catch(Exception ex)
{
	SdpLoggerHelper.logMessage("Exception Occured: " + ex, PROCESS_NAME, processID, SdpLoggerHelper.INFO);
}

*/


/*String tn = null;
try
{ 
		tn = ((DataObject)reqMBox.getList("mailBoxTNs").get(0)).getString("tn");
		loginId = tn+"@uvm.dayatt.com";
		SdpLoggerHelper.logMessage("ProvisionEmailAddress : " + loginId, PROCESS_NAME, processID, SdpLoggerHelper.INFO);
	
}
catch(Exception ex)
{
	SdpLoggerHelper.logMessage("Exception Occured: " + ex, PROCESS_NAME, processID, SdpLoggerHelper.INFO);
}*/

loginId = reqMBox.getString(SdpHelper.CVOIP_MAILBOX_MAILBOXINVARIANTID);

SdpLoggerHelper.logMessage("Getting mailBoxInvarintId [" + loginId + "] for Delegated login", 
	PROCESS_NAME, processID, SdpLoggerHelper.INFO);]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                    <bpws:invoke name="IncrementPINcounter" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="increment PIN counter" wpc:id="2155">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[java.lang.Integer __result__1 = new java.lang.Integer(com.ibm.wbiservers.brules.core.codegen.NillableUtility.getInt(PinChangeCounter, "PinChangeCounter") + 1);
PinChangeCounter = __result__1;

//@generated:com.ibm.wbit.activity.ui
//<?xml version="1.0" encoding="UTF-8"?>
//<com.ibm.wbit.activity:CompositeActivity xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:com.ibm.wbit.activity="http:///com/ibm/wbit/activity.ecore" name="ActivityMethod">
//  <exceptions>
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="com.ibm.bpe.api.ProcessException"/>
//  </exceptions>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="PinChangeCounter+1" assignable="false">
//    <dataOutputs target="//@executableElements.1"/>
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="int" namespace="http://www.w3.org/2001/XMLSchema"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" dataInputs="//@executableElements.0/@dataOutputs.0" value="PinChangeCounter" variable="true">
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="int" namespace="http://www.w3.org/2001/XMLSchema"/>
//  </executableElements>
//  <executableGroups executableElements="//@executableElements.0 //@executableElements.1"/>
//</com.ibm.wbit.activity:CompositeActivity>
//@generated:end
//!SMAP!*S WBIACTDBG
//!SMAP!*L
//!SMAP!1:1,1
//!SMAP!2:2,1
//!SMAP!1000000:25,1]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                    <bpws:assign name="PreInvokeAssigns15" wpc:displayName="Pre-Invoke Assigns " wpc:id="459">
                      <bpws:copy>
                        <bpws:from variable="emptySDPOrder"/>
                        <bpws:to variable="SDP_ORDER_Port"/>
                      </bpws:copy>
                      <bpws:copy>
                        <bpws:from>true</bpws:from>
                        <bpws:to variable="boolPinChanged"/>
                      </bpws:copy>
                      <bpws:copy>
                        <bpws:from variable="emptyTransactionDetail"/>
                        <bpws:to variable="TrasationDetail_Port"/>
                      </bpws:copy>
                      <bpws:copy>
                        <bpws:from>UCDCL.DelegatedLogin.request</bpws:from>
                        <bpws:to variable="TrasationDetail_Port">
                          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/State]]></bpws:query>
                        </bpws:to>
                      </bpws:copy>
                      <bpws:copy>
                        <bpws:from>UCDCL</bpws:from>
                        <bpws:to variable="TrasationDetail_Port">
                          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/TargetSystem]]></bpws:query>
                        </bpws:to>
                      </bpws:copy>
                      <bpws:copy>
                        <bpws:from>DelegatedLogin</bpws:from>
                        <bpws:to variable="TrasationDetail_Port">
                          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/currentTargetOperation]]></bpws:query>
                        </bpws:to>
                      </bpws:copy>
                      <bpws:copy>
                        <bpws:from variable="loginId"/>
                        <bpws:to variable="processBO">
                          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[order/ReqService/product/cvoipProduct/accountMailBoxes[1]/mailBoxInvariantId]]></bpws:query>
                        </bpws:to>
                      </bpws:copy>
                      <bpws:copy>
                        <bpws:from variable="emptyTransactionDetail"/>
                        <bpws:to variable="processBO">
                          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[transactionDetail]]></bpws:query>
                        </bpws:to>
                      </bpws:copy>
                    </bpws:assign>
                    <bpws:invoke name="LogUCDCLDelegatedLogin" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UCDCL.DelegatedLogin ]" wpc:id="2300">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage(SdpLoggerHelper.INVOKE_STR +" : UCDCL.DelegatedLogin",PROCESS_NAME,processID
														,SdpLoggerHelper.INFO);
														



																		]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                    <bpws:invoke name="CallDelegatedLogin" operation="delegatedLogin" partnerLink="UcdclCompensableService_Interface" portType="ns37:UCDCLCompensableService_Interface" wpc:displayName="Call Delegated Login" wpc:id="679">
                      <wpc:input>
                        <wpc:parameter name="order" variable="processBO"/>
                      </wpc:input>
                      <wpc:output>
                        <wpc:parameter name="transactionDetail" variable="processTransDetail"/>
                      </wpc:output>
                      <bpws:catch faultName="ns37:serviceCallFault" faultVariable="scFault" wpc:faultType="java:ServiceCallFault" wpc:id="3023" wpc:variableId="699">
                        <bpws:invoke name="SetErrorDetails6" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Set Error Details" wpc:id="2009">
                          <wpc:script>
                            <wpc:javaCode><![CDATA[TrasationDetail_Port.setBoolean(SdpHelper.ERRORINDICATOR,true);

new att.lightspeed.sdp.helper.TransactionDetail(TrasationDetail_Port).setSDPErrorMessage(scFault);

TrasationDetail_Port.getDataObject("errorDetails").getDataObject("Error").setString("Severity",SdpErrorHelper.SEVERITY_FATAL);

 
SdpLoggerHelper.logMessage(SdpLoggerHelper.FAULT_FAILURE +"  UCDCL.DelegatedLogin",PROCESS_NAME,processID,SdpLoggerHelper.FATAL); 
 ]]></wpc:javaCode>
                          </wpc:script>
                        </bpws:invoke>
                      </bpws:catch>
                      <bpws:catch faultName="wpc:runtimeFailure" faultVariable="bpcFault" wpc:faultType="wpc:BPCStandardFaultType" wpc:id="3024" wpc:variableId="1386">
                        <bpws:invoke name="HandleRuntimeFailure4" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Handle Run time Failure" wpc:id="1389">
                          <wpc:script>
                            <wpc:javaCode><![CDATA[SdpErrorHelper.setErrDetInTransDet(TrasationDetail_Port,bpcFault,SdpErrorHelper.SEVERITY_FATAL);

SdpLoggerHelper.logMessage(SdpLoggerHelper.RUNTIME_FAILURE+"   UCDCL.DelegatedLogin",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);]]></wpc:javaCode>
                          </wpc:script>
                        </bpws:invoke>
                      </bpws:catch>
                      <bpws:catchAll wpc:id="3022">
                        <bpws:invoke name="Handleotherfailures8" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="handle other failures" wpc:id="1392">
                          <wpc:script>
                            <wpc:javaCode><![CDATA[SdpErrorHelper.setErrDetInTransDet(TrasationDetail_Port,null,SdpErrorHelper.SEVERITY_FATAL);

SdpLoggerHelper.logMessage(SdpLoggerHelper.UNKNOWN_FAILURE+"   UCDCL.DelegatedLogin",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);]]></wpc:javaCode>
                          </wpc:script>
                        </bpws:invoke>
                      </bpws:catchAll>
                    </bpws:invoke>
                    <bpws:switch name="CheckUCDCLError4" wpc:displayName="Check UCDCL Error" wpc:id="901">
                      <bpws:case wpc:id="902">
                        <bpws:condition><![CDATA[boolean __result__1 = com.ibm.wbiservers.brules.core.codegen.NillableUtility.getBoolean(TrasationDetail_Port, "errorIndicator", "TrasationDetail_Port");
return __result__1;

//@generated:com.ibm.wbit.activity.ui
//<?xml version="1.0" encoding="UTF-8"?>
//<com.ibm.wbit.activity:CompositeActivity xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:com.ibm.wbit.activity="http:///com/ibm/wbit/activity.ecore" name="ActivityMethod">
//  <result name="Result">
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="boolean"/>
//  </result>
//  <exceptions>
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="com.ibm.bpe.api.ProcessException"/>
//  </exceptions>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="TrasationDetail_Port.errorIndicator" field="true">
//    <dataOutputs target="//@executableElements.1"/>
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="boolean" namespace="http://www.w3.org/2001/XMLSchema" nillable="false"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:ReturnElement" dataInputs="//@executableElements.0/@dataOutputs.0"/>
//  <executableGroups executableElements="//@executableElements.0 //@executableElements.1"/>
//</com.ibm.wbit.activity:CompositeActivity>
//@generated:end
//!SMAP!*S WBIACTDBG
//!SMAP!*L
//!SMAP!1:1,1
//!SMAP!2:2,1
//!SMAP!1000000:26,1]]></bpws:condition>
                        <bpws:sequence name="HiddenSequence12" wpc:id="1073744740">
                          <bpws:invoke name="LogUCDCLDelegatedLoginError" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UCDCL.DelegatedLogin  - Error ]" wpc:id="2302">
                            <wpc:script>
                              <wpc:javaCode><![CDATA[String strSeverity =TrasationDetail_Port.getString("errorDetails/Error/Severity");
int logLevel = SdpHelper.getLogLevel(strSeverity);
SdpLoggerHelper.logMessage("Returning : UCDCL.DelegatedLogin- "+SdpLoggerHelper.ERROR_STR+"["+strSeverity+"]",PROCESS_NAME,processID,logLevel);
														



																		]]></wpc:javaCode>
                            </wpc:script>
                          </bpws:invoke>
                          <bpws:invoke name="LogUpdateMailBoxConfigCompensation12" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UpdateMailBoxConfigCompensation ]" wpc:id="2295">
                            <wpc:script>
                              <wpc:javaCode><![CDATA[
SdpLoggerHelper.logMessage(SdpLoggerHelper.INVOKE_STR +" SubFlow : UpdateMailBoxConfigCompensation",PROCESS_NAME,processID,SdpLoggerHelper.INFO);
SdpLoggerHelper.logMessage("Request BOs : ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("CreateRequestState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(CreateRequestState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("CreateProvState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(CreateProvstate,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("DeleteRequestState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(DeleteRequestState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("DeleteProvState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(DeleteProvState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("UpdateRequestState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(UpdateRequestState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("UpdateProvState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(UpdateProvState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("TransactionDetailPort :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(TrasationDetail_Port,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("SDP_ORDER_GrpMBoxInfoPort :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(SDP_ORDER_GrpMBoxInfoPort,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("IndexChangeUpdateState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(IndexChangeUpdateState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("SetSubscriberSettingsBySub :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(SetSubscriberSettingsBySub,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("PinChangeUpdateState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(PinChangeUpdateState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("TnChangeUpdateState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(TnChangeUpdateState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("AddServiceState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(AddServiceState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("RemoveServiceState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(RemoveServiceState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

CreateRequestState.setString(SdpHelper.TEMPSTRING2_PATH.replace('.','/'),processID);]]></wpc:javaCode>
                            </wpc:script>
                          </bpws:invoke>
                          <bpws:assign name="MergeWESMerrortoProcobject10" wpc:displayName="Merge WESM error to Proc object" wpc:id="2489">
                            <bpws:copy>
                              <bpws:from variable="TrasationDetail_Port">
                                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/Message]]></bpws:query>
                              </bpws:from>
                              <bpws:to variable="PinChangeUpdateState">
                                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/errorDetails/Error/Message]]></bpws:query>
                              </bpws:to>
                            </bpws:copy>
                            <bpws:copy>
                              <bpws:from variable="TrasationDetail_Port"/>
                              <bpws:to variable="MailboxConfig_Proc">
                                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail]]></bpws:query>
                              </bpws:to>
                            </bpws:copy>
                          </bpws:assign>
                          <bpws:invoke name="CallUpdateMailBoxConfigCompensate6" operation="compensateUpdateMailBoxConfig" partnerLink="UpdateMailBoxConfig_Compensation_Interface" portType="ns31:UpdateMailBoxConfig_Compensation_Interface" wpc:displayName="call UpdateMailBoxConfig Compensate" wpc:id="2173">
                            <wpc:input>
                              <wpc:parameter name="CreateProvState" variable="CreateProvstate"/>
                              <wpc:parameter name="CreateRequestState" variable="CreateRequestState"/>
                              <wpc:parameter name="UpdateProvState" variable="UpdateProvState"/>
                              <wpc:parameter name="TransactionDetailPort" variable="TrasationDetail_Port"/>
                              <wpc:parameter name="DeleteProvState" variable="DeleteProvState"/>
                              <wpc:parameter name="DeleteRequestState" variable="DeleteRequestState"/>
                              <wpc:parameter name="UpdateRequestState" variable="UpdateRequestState"/>
                              <wpc:parameter name="SDP_ORDER_GrpMBoxInfoPort" variable="SDP_ORDER_GrpMBoxInfoPort"/>
                              <wpc:parameter name="IndexChangeUpdateState" variable="IndexChangeUpdateState"/>
                              <wpc:parameter name="SetSubscriberSettingsBySub" variable="SetSubscriberSettingsBySub"/>
                              <wpc:parameter name="PinChangeUpdateState" variable="PinChangeUpdateState"/>
                              <wpc:parameter name="TnChangeUpdateState" variable="TnChangeUpdateState"/>
                              <wpc:parameter name="AddServiceState" variable="AddServiceState"/>
                              <wpc:parameter name="RemoveServiceState" variable="RemoveServiceState"/>
                            </wpc:input>
                            <wpc:output>
                              <wpc:parameter name="TransactionDetailPort" variable="TrasationDetail_Port"/>
                              <wpc:parameter name="SdpOrderPort" variable="SDP_ORDER_Port"/>
                            </wpc:output>
                          </bpws:invoke>
                          <bpws:invoke name="LogUpdateMailBoxConfigCompensation13" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UpdateMailBoxConfigCompensation ]" wpc:id="2298">
                            <wpc:script>
                              <wpc:javaCode><![CDATA[
SdpLoggerHelper.logMessage("Received the following GBO from SubFlow : UpdateMailBoxConfigCompensation  ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("TrasationDetail_Port : ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(TrasationDetail_Port,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

]]></wpc:javaCode>
                            </wpc:script>
                          </bpws:invoke>
                          <bpws:invoke name="MergeRollBackedMailboxesintoProc8" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Merge RollBacked Mailboxes into Proc" wpc:id="2796">
                            <wpc:script>
                              <wpc:javaCode><![CDATA[DataObject tmpMailbox = null;
List lstAccountMailboxes = null;
Iterator itrAccountMailboxes = null;
List lstMailboxes = null;

SdpLoggerHelper.logMessage("Merging the RolledBack mailboxes into the response SdpOrder",
	PROCESS_NAME,processID,SdpLoggerHelper.DEBUG);

try {
	lstAccountMailboxes = 
		SDP_ORDER_Port.getList(SdpHelper.VOIP_ACCOUNTMAILBOXES_PATH.replace('.','/'));
	itrAccountMailboxes = lstAccountMailboxes.iterator();
	
	lstMailboxes = MailboxConfig_Proc.getList(SdpHelper.VOIP_ACCOUNTMAILBOXES_PATH.replace('.','/'));
	
	while(itrAccountMailboxes.hasNext())
	{		
		tmpMailbox = SDO.copy((DataObject) itrAccountMailboxes.next());
		lstMailboxes.add(tmpMailbox);
	}
}
catch(Exception ex)
{
	SdpLoggerHelper.logMessage("Failed during Merge the RolledBack mailboxes into response SdpOrder",
		PROCESS_NAME,processID,SdpLoggerHelper.DEBUG);
	SdpLoggerHelper.logMessage("Exception : " + ex,
		PROCESS_NAME,processID,SdpLoggerHelper.DEBUG);
}]]></wpc:javaCode>
                            </wpc:script>
                          </bpws:invoke>
                          <bpws:assign name="MergerProctoTrig10" wpc:displayName="Merger Proc to Trig" wpc:id="2461">
                            <bpws:copy>
                              <bpws:from variable="MailboxConfig_Proc"/>
                              <bpws:to variable="MailboxConfigRequest_Trig"/>
                            </bpws:copy>
                            <bpws:copy>
                              <bpws:from variable="sdpProcessContext"/>
                              <bpws:to variable="MailboxConfigRequest_Trig">
                                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/ProcessContext]]></bpws:query>
                              </bpws:to>
                            </bpws:copy>
                          </bpws:assign>
                          <bpws:invoke name="LogEndProcess7" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [End Process]" wpc:id="2427">
                            <wpc:script>
                              <wpc:javaCode><![CDATA[
SdpLoggerHelper.logMessage("Returning the following GBO To MAM ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("Provisioned [MailboxConfigRequest_Trig ]: ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(MailboxConfigRequest_Trig,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("End - UpdateMailBoxConfig",PROCESS_NAME,processID,SdpLoggerHelper.INFO);]]></wpc:javaCode>
                            </wpc:script>
                          </bpws:invoke>
                          <bpws:reply name="ReplyUCDCLError1" operation="UpdateMailboxConfig" partnerLink="FromMam_FeaturePermissionMailboxUpdate_Interface" portType="ns3:FromMam_FeaturePermissionMailboxUpdate_Interface" wpc:displayName="Reply UCDCL Error" wpc:id="911">
                            <wpc:input>
                              <wpc:parameter name="mailboxConfigResponse" variable="MailboxConfigRequest_Trig"/>
                            </wpc:input>
                          </bpws:reply>
                          <bpws:terminate name="Terminate10" wpc:displayName="Terminate10" wpc:id="1818"/>
                        </bpws:sequence>
                      </bpws:case>
                    </bpws:switch>
                    <bpws:invoke name="LogUCDCLDelegatedLoginSuccess" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UCDCL.DelegatedLogin  -Success]" wpc:id="2390">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage("Returning : UCDCL.DelegatedLogin -"+SdpLoggerHelper.SUCCESS_STR,PROCESS_NAME,processID
														,SdpLoggerHelper.INFO);
														



																		]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                    <bpws:assign name="Preinvokeassigns4" wpc:displayName="pre-invoke assigns" wpc:id="1000">
                      <bpws:copy>
                        <bpws:from variable="emptyTransactionDetail"/>
                        <bpws:to variable="TrasationDetail_Port"/>
                      </bpws:copy>
                      <bpws:copy>
                        <bpws:from>UCDCL.setSubscriberSettingsBySub.request</bpws:from>
                        <bpws:to variable="TrasationDetail_Port">
                          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/State]]></bpws:query>
                        </bpws:to>
                      </bpws:copy>
                      <bpws:copy>
                        <bpws:from>UCDCL</bpws:from>
                        <bpws:to variable="TrasationDetail_Port">
                          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/TargetSystem]]></bpws:query>
                        </bpws:to>
                      </bpws:copy>
                      <bpws:copy>
                        <bpws:from>setSubscriberSettingsBySub</bpws:from>
                        <bpws:to variable="TrasationDetail_Port">
                          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/currentTargetOperation]]></bpws:query>
                        </bpws:to>
                      </bpws:copy>
                      <bpws:copy>
                        <bpws:from variable="ucdclPersonName"/>
                        <bpws:to variable="processBO">
                          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[order/ReqService/Account/Customer/Person/customerName]]></bpws:query>
                        </bpws:to>
                      </bpws:copy>
                      <bpws:copy>
                        <bpws:from variable="reqMBox"/>
                        <bpws:to variable="processBO">
                          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[order/ReqService/product/cvoipProduct/accountMailBoxes[1]]]></bpws:query>
                        </bpws:to>
                      </bpws:copy>
                    </bpws:assign>
                    <bpws:invoke name="GetSetSESSIONID" operation="null" partnerLink="null" portType="wpc:null" wpc:continueOnError="inherit" wpc:displayName="Get &amp; Set SESSIONID" wpc:id="2947">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[String UMSessionID = processTransDetail.getString(SdpHelper.TRANSDETAIL_UMSESSIONID);
UMMessageCenterIP = processTransDetail.getString(SdpHelper.TRANSDETAIL_UMMESSAGECENTERIP);

WpsLogger logger = WpsLogger.getLogger(processInstance());
logger.debug("UMSessionID from delegatedLogin Response: " + UMSessionID);
logger.debug("UMMessageCenterIP from the delegatedLogin Response: " + UMMessageCenterIP);

TransactionDetail transDetail = new Order(processBO).getTransactionDetail();

processBO.setString(SdpHelper.xPathify(SdpHelper.TRANSDETAIL_UMSESSIONID_PATH),UMSessionID);
processBO.setString(SdpHelper.xPathify(SdpHelper.TRANSDETAIL_UMMESSAGECENTERIP_PATH),UMMessageCenterIP);
]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                    <bpws:invoke name="Snippet1" operation="null" partnerLink="null" portType="wpc:null" wpc:continueOnError="inherit" wpc:displayName="Set custSubType" wpc:id="3036">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[//Added for 268966b
new Order(processBO).getCustomer().setString(SdpHelper.CUST_SUBTYPE,customerSubType);]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                    <bpws:invoke name="LogUCDCLsetSubscriberSettingsBySub" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UCDCL.setSubscriberSettingsBySub ]" wpc:id="2310">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage(SdpLoggerHelper.INVOKE_STR +" : UCDCL.setSubscriberSettingsBySub",PROCESS_NAME,processID
														,SdpLoggerHelper.INFO);
														
SdpLoggerHelper.logMessage("Request BO:[ucdclPersonName]",PROCESS_NAME,processID
														,SdpLoggerHelper.INFO);
SdpLoggerHelper.logMessage("ucdclPersonName:",PROCESS_NAME,processID
														,SdpLoggerHelper.INFO);

														
SdpLoggerHelper.logBO(ucdclPersonName,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("reqMBox:",PROCESS_NAME,processID
														,SdpLoggerHelper.INFO);

														
SdpLoggerHelper.logBO(reqMBox,PROCESS_NAME,processID,SdpLoggerHelper.INFO);
																		]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                    <bpws:invoke name="UCDCLSetSubscriberSettingsBySub" operation="setSubscriberSettingsBySub" partnerLink="UcdclCompensableService_Interface" portType="ns37:UCDCLCompensableService_Interface" wpc:displayName="UCDCL Set Subscriber Settings By Sub" wpc:id="450">
                      <wpc:input>
                        <wpc:parameter name="order" variable="processBO"/>
                      </wpc:input>
                      <wpc:output/>
                      <bpws:catch faultName="ns37:serviceCallFault" faultVariable="scFault" wpc:faultType="java:ServiceCallFault" wpc:id="3016" wpc:variableId="454">
                        <bpws:invoke name="SetErrorDetails8" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Set Error Details" wpc:id="2015">
                          <wpc:script>
                            <wpc:javaCode><![CDATA[TrasationDetail_Port.setBoolean(SdpHelper.ERRORINDICATOR,true);

new att.lightspeed.sdp.helper.TransactionDetail(TrasationDetail_Port).setSDPErrorMessage(scFault);

TrasationDetail_Port.getDataObject("errorDetails").getDataObject("Error").setString("Severity",SdpErrorHelper.SEVERITY_FATAL);

 
SdpLoggerHelper.logMessage(SdpLoggerHelper.FAULT_FAILURE +"  UCDCL.setSubscriberSettingsBySub",PROCESS_NAME,processID,SdpLoggerHelper.FATAL); 
 ]]></wpc:javaCode>
                          </wpc:script>
                        </bpws:invoke>
                      </bpws:catch>
                      <bpws:catch faultName="wpc:runtimeFailure" faultVariable="ucdclFault" wpc:faultType="ns9:SDP_ErrorObject_Message" wpc:id="3017" wpc:variableId="704">
                        <bpws:invoke name="HandleRuntimeFailure5" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Handle Run time Failure" wpc:id="1395">
                          <wpc:script>
                            <wpc:javaCode><![CDATA[SdpErrorHelper.setErrDetInTransDet(TrasationDetail_Port,bpcFault,SdpErrorHelper.SEVERITY_FATAL);

SdpLoggerHelper.logMessage(SdpLoggerHelper.RUNTIME_FAILURE+"  UCDCL.setSubscriberSettingsBySub",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);]]></wpc:javaCode>
                          </wpc:script>
                        </bpws:invoke>
                      </bpws:catch>
                      <bpws:catchAll wpc:id="3015">
                        <bpws:invoke name="Handleotherfailures9" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="handle other failures" wpc:id="1398">
                          <wpc:script>
                            <wpc:javaCode><![CDATA[SdpErrorHelper.setErrDetInTransDet(TrasationDetail_Port,null,SdpErrorHelper.SEVERITY_FATAL);

SdpLoggerHelper.logMessage(SdpLoggerHelper.UNKNOWN_FAILURE+"  UCDCL.setSubscriberSettingsBySub",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);]]></wpc:javaCode>
                          </wpc:script>
                        </bpws:invoke>
                      </bpws:catchAll>
                    </bpws:invoke>
                    <bpws:switch name="CheckUCDCLError2" wpc:displayName="Check UCDCL Error" wpc:id="912">
                      <bpws:case wpc:id="913">
                        <bpws:condition><![CDATA[boolean __result__1 = com.ibm.wbiservers.brules.core.codegen.NillableUtility.getBoolean(TrasationDetail_Port, "errorIndicator", "TrasationDetail_Port");
return __result__1;

//@generated:com.ibm.wbit.activity.ui
//<?xml version="1.0" encoding="UTF-8"?>
//<com.ibm.wbit.activity:CompositeActivity xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:com.ibm.wbit.activity="http:///com/ibm/wbit/activity.ecore" name="ActivityMethod">
//  <result name="Result">
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="boolean"/>
//  </result>
//  <exceptions>
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="com.ibm.bpe.api.ProcessException"/>
//  </exceptions>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="TrasationDetail_Port.errorIndicator" field="true">
//    <dataOutputs target="//@executableElements.1"/>
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="boolean" namespace="http://www.w3.org/2001/XMLSchema" nillable="false"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:ReturnElement" dataInputs="//@executableElements.0/@dataOutputs.0"/>
//  <executableGroups executableElements="//@executableElements.0 //@executableElements.1"/>
//</com.ibm.wbit.activity:CompositeActivity>
//@generated:end
//!SMAP!*S WBIACTDBG
//!SMAP!*L
//!SMAP!1:1,1
//!SMAP!2:2,1
//!SMAP!1000000:26,1]]></bpws:condition>
                        <bpws:sequence name="HiddenSequence25" wpc:id="1073744741">
                          <bpws:invoke name="LogUCDCLsetSubscriberSettingsBySubError" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [ UCDCL.setSubscriberSettingsBySub  - Error]" wpc:id="2312">
                            <wpc:script>
                              <wpc:javaCode><![CDATA[String strSeverity =TrasationDetail_Port.getString("errorDetails/Error/Severity");
int logLevel = SdpHelper.getLogLevel(strSeverity);
SdpLoggerHelper.logMessage(" UCDCL.setSubscriberSettingsBySub- "+SdpLoggerHelper.ERROR_STR+"["+strSeverity+"]",PROCESS_NAME,processID,logLevel);
														]]></wpc:javaCode>
                            </wpc:script>
                          </bpws:invoke>
                          <bpws:invoke name="LogUpdateMailBoxConfigCompensation14" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UpdateMailBoxConfigCompensation ]" wpc:id="2305">
                            <wpc:script>
                              <wpc:javaCode><![CDATA[
SdpLoggerHelper.logMessage(SdpLoggerHelper.INVOKE_STR +" SubFlow : UpdateMailBoxConfigCompensation",PROCESS_NAME,processID,SdpLoggerHelper.INFO);
SdpLoggerHelper.logMessage("Request BOs : ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("CreateRequestState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(CreateRequestState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("CreateProvState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(CreateProvstate,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("DeleteRequestState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(DeleteRequestState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("DeleteProvState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(DeleteProvState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("UpdateRequestState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(UpdateRequestState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("UpdateProvState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(UpdateProvState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("TransactionDetailPort :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(TrasationDetail_Port,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("SDP_ORDER_GrpMBoxInfoPort :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(SDP_ORDER_GrpMBoxInfoPort,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("IndexChangeUpdateState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(IndexChangeUpdateState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("SetSubscriberSettingsBySub :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(SetSubscriberSettingsBySub,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("PinChangeUpdateState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(PinChangeUpdateState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("TnChangeUpdateState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(TnChangeUpdateState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("AddServiceState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(AddServiceState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("RemoveServiceState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(RemoveServiceState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

CreateRequestState.setString(SdpHelper.TEMPSTRING2_PATH.replace('.','/'),processID);
]]></wpc:javaCode>
                            </wpc:script>
                          </bpws:invoke>
                          <bpws:assign name="MergeWESMerrortoProcobject11" wpc:displayName="Merge WESM error to Proc object" wpc:id="2491">
                            <bpws:copy>
                              <bpws:from variable="TrasationDetail_Port">
                                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/Message]]></bpws:query>
                              </bpws:from>
                              <bpws:to variable="PinChangeUpdateState">
                                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/errorDetails/Error/Message]]></bpws:query>
                              </bpws:to>
                            </bpws:copy>
                            <bpws:copy>
                              <bpws:from variable="TrasationDetail_Port"/>
                              <bpws:to variable="MailboxConfig_Proc">
                                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail]]></bpws:query>
                              </bpws:to>
                            </bpws:copy>
                          </bpws:assign>
                          <bpws:invoke name="CallUpdateMailBoxConfigCompensate7" operation="compensateUpdateMailBoxConfig" partnerLink="UpdateMailBoxConfig_Compensation_Interface" portType="ns31:UpdateMailBoxConfig_Compensation_Interface" wpc:displayName="call UpdateMailBoxConfig Compensate" wpc:id="2175">
                            <wpc:input>
                              <wpc:parameter name="CreateProvState" variable="CreateProvstate"/>
                              <wpc:parameter name="CreateRequestState" variable="CreateRequestState"/>
                              <wpc:parameter name="UpdateProvState" variable="UpdateProvState"/>
                              <wpc:parameter name="TransactionDetailPort" variable="TrasationDetail_Port"/>
                              <wpc:parameter name="DeleteProvState" variable="DeleteProvState"/>
                              <wpc:parameter name="DeleteRequestState" variable="DeleteRequestState"/>
                              <wpc:parameter name="UpdateRequestState" variable="UpdateRequestState"/>
                              <wpc:parameter name="SDP_ORDER_GrpMBoxInfoPort" variable="SDP_ORDER_GrpMBoxInfoPort"/>
                              <wpc:parameter name="IndexChangeUpdateState" variable="IndexChangeUpdateState"/>
                              <wpc:parameter name="SetSubscriberSettingsBySub" variable="SetSubscriberSettingsBySub"/>
                              <wpc:parameter name="PinChangeUpdateState" variable="PinChangeUpdateState"/>
                              <wpc:parameter name="TnChangeUpdateState" variable="TnChangeUpdateState"/>
                              <wpc:parameter name="AddServiceState" variable="AddServiceState"/>
                              <wpc:parameter name="RemoveServiceState" variable="RemoveServiceState"/>
                            </wpc:input>
                            <wpc:output>
                              <wpc:parameter name="TransactionDetailPort" variable="TrasationDetail_Port"/>
                              <wpc:parameter name="SdpOrderPort" variable="SDP_ORDER_Port"/>
                            </wpc:output>
                          </bpws:invoke>
                          <bpws:invoke name="LogUpdateMailBoxConfigCompensation15" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [ UpdateMailBoxConfigCompensation]" wpc:id="2308">
                            <wpc:script>
                              <wpc:javaCode><![CDATA[
SdpLoggerHelper.logMessage("Received the following GBO from SubFlow : UpdateMailBoxConfigCompensation  ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("TrasationDetail_Port : ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(TrasationDetail_Port,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

]]></wpc:javaCode>
                            </wpc:script>
                          </bpws:invoke>
                          <bpws:invoke name="MergeRollBackedMailboxesintoProc9" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Merge RollBacked Mailboxes into Proc" wpc:id="2798">
                            <wpc:script>
                              <wpc:javaCode><![CDATA[DataObject tmpMailbox = null;
List lstAccountMailboxes = null;
Iterator itrAccountMailboxes = null;
List lstMailboxes = null;

SdpLoggerHelper.logMessage("Merging the RolledBack mailboxes into the response SdpOrder",
	PROCESS_NAME,processID,SdpLoggerHelper.DEBUG);

try {
	lstAccountMailboxes = 
		SDP_ORDER_Port.getList(SdpHelper.VOIP_ACCOUNTMAILBOXES_PATH.replace('.','/'));
	itrAccountMailboxes = lstAccountMailboxes.iterator();
	
	lstMailboxes = MailboxConfig_Proc.getList(SdpHelper.VOIP_ACCOUNTMAILBOXES_PATH.replace('.','/'));
	
	while(itrAccountMailboxes.hasNext())
	{		
		tmpMailbox = SDO.copy((DataObject) itrAccountMailboxes.next());
		lstMailboxes.add(tmpMailbox);
	}
}
catch(Exception ex)
{
	SdpLoggerHelper.logMessage("Failed during Merge the RolledBack mailboxes into response SdpOrder",
		PROCESS_NAME,processID,SdpLoggerHelper.DEBUG);
	SdpLoggerHelper.logMessage("Exception : " + ex,
		PROCESS_NAME,processID,SdpLoggerHelper.DEBUG);
}]]></wpc:javaCode>
                            </wpc:script>
                          </bpws:invoke>
                          <bpws:assign name="MergerProctoTrig11" wpc:displayName="Merger Proc to Trig" wpc:id="2463">
                            <bpws:copy>
                              <bpws:from variable="MailboxConfig_Proc"/>
                              <bpws:to variable="MailboxConfigRequest_Trig"/>
                            </bpws:copy>
                            <bpws:copy>
                              <bpws:from variable="sdpProcessContext"/>
                              <bpws:to variable="MailboxConfigRequest_Trig">
                                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/ProcessContext]]></bpws:query>
                              </bpws:to>
                            </bpws:copy>
                          </bpws:assign>
                          <bpws:invoke name="LogEndProcess6" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [End Process]" wpc:id="2425">
                            <wpc:script>
                              <wpc:javaCode><![CDATA[
SdpLoggerHelper.logMessage("Returning the following GBO To MAM ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("Provisioned [MailboxConfigRequest_Trig ]: ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(MailboxConfigRequest_Trig,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("End - UpdateMailBoxConfig",PROCESS_NAME,processID,SdpLoggerHelper.INFO);]]></wpc:javaCode>
                            </wpc:script>
                          </bpws:invoke>
                          <bpws:reply name="ReplyUCDCLError2" operation="UpdateMailboxConfig" partnerLink="FromMam_FeaturePermissionMailboxUpdate_Interface" portType="ns3:FromMam_FeaturePermissionMailboxUpdate_Interface" wpc:displayName="Reply UCDCL Error" wpc:id="922">
                            <wpc:input>
                              <wpc:parameter name="mailboxConfigResponse" variable="MailboxConfigRequest_Trig"/>
                            </wpc:input>
                          </bpws:reply>
                          <bpws:terminate name="Terminate11" wpc:displayName="Terminate" wpc:id="1819"/>
                        </bpws:sequence>
                      </bpws:case>
                    </bpws:switch>
                    <bpws:invoke name="LogUCDCLsetSubscriberSettingsBySubSuccess" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UCDCL.setSubscriberSettingsBySub -Success ]" wpc:id="2393">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage(" UCDCL.setSubscriberSettingsBySub -"+SdpLoggerHelper.SUCCESS_STR,PROCESS_NAME,processID
														,SdpLoggerHelper.INFO);
														]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                    <bpws:invoke name="UpdateSetSubscriberSettingsBySubRollBack" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Update SetSubscriberSettingsBySub [RollBack]" wpc:id="2762">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[DataObject mailbox = null;

mailbox =  SDO.copy(reqMBox);
SetSubscriberSettingsBySub.getList(SdpHelper.VOIP_ACCOUNTMAILBOXES_PATH.replace('.','/')).add(mailbox);]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                    <bpws:assign name="Preinvokeassigns5" wpc:displayName="pre-invoke assigns" wpc:id="1001">
                      <bpws:copy>
                        <bpws:from variable="emptyTransactionDetail"/>
                        <bpws:to variable="TrasationDetail_Port"/>
                      </bpws:copy>
                      <bpws:copy>
                        <bpws:from>UCDCL.Logout.request</bpws:from>
                        <bpws:to variable="TrasationDetail_Port">
                          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/State]]></bpws:query>
                        </bpws:to>
                      </bpws:copy>
                      <bpws:copy>
                        <bpws:from>UCDCL</bpws:from>
                        <bpws:to variable="MailboxConfig_Proc">
                          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/errorDetails/Error/TargetSystem]]></bpws:query>
                        </bpws:to>
                      </bpws:copy>
                      <bpws:copy>
                        <bpws:from>Logout</bpws:from>
                        <bpws:to variable="TrasationDetail_Port">
                          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/currentTargetOperation]]></bpws:query>
                        </bpws:to>
                      </bpws:copy>
                    </bpws:assign>
                    <bpws:invoke name="LogUCDCLLogout" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UCDCL.Logout ]" wpc:id="2318">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage(SdpLoggerHelper.INVOKE_STR +" : UCDCL.Logout",PROCESS_NAME,processID
														,SdpLoggerHelper.INFO);
														



																		]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                    <bpws:invoke name="UCDCLLogout" operation="subscriberServiceLogout" partnerLink="UcdclCompensableService_Interface" portType="ns37:UCDCLCompensableService_Interface" wpc:displayName=" UCDCL Logout" wpc:id="900">
                      <wpc:input>
                        <wpc:parameter name="transactionDetail" variable="processTransDetail"/>
                      </wpc:input>
                      <wpc:output/>
                      <bpws:catch faultName="wpc:runtimeFailure" faultVariable="bpcFault" wpc:faultType="wpc:BPCStandardFaultType" wpc:id="3019" wpc:variableId="1228">
                        <bpws:invoke name="HandleRuntimeFailure6" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Handle Run time Failure" wpc:id="1401">
                          <wpc:script>
                            <wpc:javaCode><![CDATA[SdpErrorHelper.setErrDetInTransDet(TrasationDetail_Port,bpcFault,SdpErrorHelper.SEVERITY_FATAL);

SdpLoggerHelper.logMessage(SdpLoggerHelper.RUNTIME_FAILURE+"  UCDCL.Logout",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);]]></wpc:javaCode>
                          </wpc:script>
                        </bpws:invoke>
                      </bpws:catch>
                      <bpws:catch faultName="ns37:serviceCallFault" faultVariable="scFault" wpc:faultType="java:ServiceCallFault" wpc:id="3020" wpc:variableId="1404">
                        <bpws:invoke name="SetErrorDetails9" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Set Error Details" wpc:id="2018">
                          <wpc:script>
                            <wpc:javaCode><![CDATA[TrasationDetail_Port.setBoolean(SdpHelper.ERRORINDICATOR,true);

new att.lightspeed.sdp.helper.TransactionDetail(TrasationDetail_Port).setSDPErrorMessage(scFault);

TrasationDetail_Port.getDataObject("errorDetails").getDataObject("Error").setString("Severity",SdpErrorHelper.SEVERITY_FATAL);

 
SdpLoggerHelper.logMessage(SdpLoggerHelper.FAULT_FAILURE +"  UCDCL.Logout",PROCESS_NAME,processID,SdpLoggerHelper.FATAL); 
 ]]></wpc:javaCode>
                          </wpc:script>
                        </bpws:invoke>
                      </bpws:catch>
                      <bpws:catchAll wpc:id="3018">
                        <bpws:invoke name="Handleotherfailures10" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="handle other failures" wpc:id="1407">
                          <wpc:script>
                            <wpc:javaCode><![CDATA[SdpErrorHelper.setErrDetInTransDet(TrasationDetail_Port,null,SdpErrorHelper.SEVERITY_FATAL);

SdpLoggerHelper.logMessage(SdpLoggerHelper.UNKNOWN_FAILURE+"  UCDCL.Logout",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);]]></wpc:javaCode>
                          </wpc:script>
                        </bpws:invoke>
                      </bpws:catchAll>
                    </bpws:invoke>
                    <bpws:switch name="CheckUCDCLerror3" wpc:displayName="Check UCDCL error" wpc:id="467">
                      <bpws:case wpc:id="468">
                        <bpws:condition><![CDATA[boolean __result__1 = com.ibm.wbiservers.brules.core.codegen.NillableUtility.getBoolean(TrasationDetail_Port, "errorIndicator", "TrasationDetail_Port");
return __result__1;

//@generated:com.ibm.wbit.activity.ui
//<?xml version="1.0" encoding="UTF-8"?>
//<com.ibm.wbit.activity:CompositeActivity xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:com.ibm.wbit.activity="http:///com/ibm/wbit/activity.ecore" name="ActivityMethod">
//  <result name="Result">
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="boolean"/>
//  </result>
//  <exceptions>
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="com.ibm.bpe.api.ProcessException"/>
//  </exceptions>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="TrasationDetail_Port.errorIndicator" field="true">
//    <dataOutputs target="//@executableElements.1"/>
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="boolean" namespace="http://www.w3.org/2001/XMLSchema" nillable="false"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:ReturnElement" dataInputs="//@executableElements.0/@dataOutputs.0"/>
//  <executableGroups executableElements="//@executableElements.0 //@executableElements.1"/>
//</com.ibm.wbit.activity:CompositeActivity>
//@generated:end
//!SMAP!*S WBIACTDBG
//!SMAP!*L
//!SMAP!1:1,1
//!SMAP!2:2,1
//!SMAP!1000000:26,1]]></bpws:condition>
                        <bpws:sequence name="HiddenSequence3" wpc:id="1073744742">
                          <bpws:invoke name="LogUCDCLLogoutError" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UCDCL.Logout   - Error]" wpc:id="2320">
                            <wpc:script>
                              <wpc:javaCode><![CDATA[String strSeverity =TrasationDetail_Port.getString("errorDetails/Error/Severity");
int logLevel = SdpHelper.getLogLevel(strSeverity);
SdpLoggerHelper.logMessage("Returning : UCDCL.LogOut- "+SdpLoggerHelper.ERROR_STR+"["+strSeverity+"]",PROCESS_NAME,processID,logLevel);
														



																		]]></wpc:javaCode>
                            </wpc:script>
                          </bpws:invoke>
                        </bpws:sequence>
                      </bpws:case>
                      <bpws:otherwise wpc:id="3025">
                        <bpws:invoke name="LogUCDCLLogoutSuccess" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UCDCL.Logout -Success ]" wpc:id="2396">
                          <wpc:script>
                            <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage("Returning : UCDCL.LogOut -"+SdpLoggerHelper.SUCCESS_STR,PROCESS_NAME,processID
														,SdpLoggerHelper.INFO);
														



																		]]></wpc:javaCode>
                          </wpc:script>
                        </bpws:invoke>
                      </bpws:otherwise>
                    </bpws:switch>
                    <bpws:invoke name="SetSDP_ORDER_ForUpdateforUpdateOrder" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Set SDP_ORDER_ForUpdate for UpdateOrder" wpc:id="2594">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage("MailboxConfig_Proc: ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(MailboxConfig_Proc,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SDP_ORDER_ForUpdate = SDO.copy(MailboxConfig_Prov);

SDP_ORDER_ForUpdate.getList(SdpHelper.VOIP_ACCOUNTMAILBOXES_PATH.replace('.','/')).clear();

SDP_ORDER_ForUpdate.getList(SdpHelper.VOIP_ACCOUNTMAILBOXES_PATH.replace('.','/')).add(SDO.copy(reqMBox));]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                    <bpws:assign name="Preinvokeassigns6" wpc:displayName="Pre-invoke assigns" wpc:id="1002">
                      <bpws:copy>
                        <bpws:from variable="emptyTransactionDetail"/>
                        <bpws:to variable="TrasationDetail_Port"/>
                      </bpws:copy>
                      <bpws:copy>
                        <bpws:from>MPS.UpdateComponent.request</bpws:from>
                        <bpws:to variable="TrasationDetail_Port">
                          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/State]]></bpws:query>
                        </bpws:to>
                      </bpws:copy>
                      <bpws:copy>
                        <bpws:from>MPS</bpws:from>
                        <bpws:to variable="TrasationDetail_Port">
                          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/TargetSystem]]></bpws:query>
                        </bpws:to>
                      </bpws:copy>
                      <bpws:copy>
                        <bpws:from>MAILBOX</bpws:from>
                        <bpws:to variable="SDP_ORDER_ForUpdate">
                          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/currentProduct]]></bpws:query>
                        </bpws:to>
                      </bpws:copy>
                      <bpws:copy>
                        <bpws:from>UpdateComponent</bpws:from>
                        <bpws:to variable="TrasationDetail_Port">
                          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/currentTargetOperation]]></bpws:query>
                        </bpws:to>
                      </bpws:copy>
                    </bpws:assign>
                    <bpws:invoke name="SetMPSValues1" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="set MPS Values" wpc:id="1275">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[/*
SdpLoggerHelper.logMessage("Setting up the Values for MPS.updateComponent[MailBox]", PROCESS_NAME, processID,
	SdpLoggerHelper.DEBUG);
// R7 Filter Settings not required
//Create WESM Content Filter 
ContentFilterCreator filterCreator = new ContentFilterCreator();

filterCreator.addSelectFilter(SdpHelper.PRODUCTTYPE, SdpHelper.CURRENT_PRODUCT_PATH);

filterCreator.addSelectFilter(SdpHelper.ACCT_OBJID, SdpHelper.ACCT_OBJID_PATH);

filterCreator.addSelectFilter(SdpHelper.CVOIP_MAILBOX_MAILBOXINVARIANTID, 
	SdpHelper.CVOIP_MAILBOX_MAILBOXINVARIANTID_PATH);

filterCreator.addUpdateFilter(SdpHelper.CVOIP_MAILBOX_PIN, SdpHelper.CVOIP_MAILBOX_PIN_PATH);
		
//Set the Content filter to the transaction detail object. 
SDP_ORDER_ForUpdate.getDataObject("transactionDetail").setDataObject( "contentFilter", filterCreator.createFilters() );

*/
]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                    <bpws:invoke name="LogMPSUpdateComponent1" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [ MPS.UpdateComponent]" wpc:id="2322">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage(SdpLoggerHelper.INVOKE_STR +" : MPS.UpdateComponent",PROCESS_NAME,processID
														,SdpLoggerHelper.INFO);
														
SdpLoggerHelper.logMessage("Request BO:[SDP_ORDER]",PROCESS_NAME,processID
														,SdpLoggerHelper.INFO);
SdpLoggerHelper.logMessage("SDP_ORDER_ForUpdate:",PROCESS_NAME,processID
														,SdpLoggerHelper.INFO);

														
SdpLoggerHelper.logBO(SDP_ORDER_ForUpdate,PROCESS_NAME,processID,SdpLoggerHelper.INFO);
																		]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                    <bpws:invoke name="MPSUpdateComponentMailbox" operation="updateComponent" partnerLink="MPSCompensableService2_InterfacePartner" portType="ns35:MPSCompensableService2_Interface" wpc:displayName="MPS Update Component - Mailbox" wpc:id="227">
                      <wpc:input>
                        <wpc:parameter name="order" variable="SDP_ORDER_ForUpdate"/>
                      </wpc:input>
                      <wpc:output/>
                      <bpws:catch faultName="ns35:serviceCallFault" faultVariable="scFault" wpc:faultType="java:ServiceCallFault" wpc:id="3021" wpc:variableId="803">
                        <bpws:sequence name="HiddenSequence4" wpc:id="1073744743">
                          <bpws:assign name="SetErrorDetails1" wpc:displayName="Set Error Details" wpc:id="2868">
                            <bpws:copy>
                              <bpws:from><![CDATA[11016]]></bpws:from>
                              <bpws:to variable="TrasationDetail_Port">
                                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/Message/MessageCode]]></bpws:query>
                              </bpws:to>
                            </bpws:copy>
                            <bpws:copy>
                              <bpws:from><![CDATA[SDP_Downstream_System_Error]]></bpws:from>
                              <bpws:to variable="TrasationDetail_Port">
                                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/Message/MessageText]]></bpws:query>
                              </bpws:to>
                            </bpws:copy>
                            <bpws:copy>
                              <bpws:from>FATAL</bpws:from>
                              <bpws:to variable="TrasationDetail_Port">
                                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/Severity]]></bpws:query>
                              </bpws:to>
                            </bpws:copy>
                            <bpws:copy>
                              <bpws:from variable="scFault">
                                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[messageDetail]]></bpws:query>
                              </bpws:from>
                              <bpws:to variable="TrasationDetail_Port">
                                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[errorDetails/Error/Message/MessageDetail]]></bpws:query>
                              </bpws:to>
                            </bpws:copy>
                          </bpws:assign>
                          <bpws:invoke name="HandleRuntimefailure7" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Handle Run time failure" wpc:id="1410">
                            <wpc:script>
                              <wpc:javaCode><![CDATA[TrasationDetail_Port.setBoolean("errorIndicator", true);
SdpLoggerHelper.logMessage(SdpLoggerHelper.RUNTIME_FAILURE+" MPS.updateComponent",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);
SdpLoggerHelper.logBO(scFault,PROCESS_NAME,processID,SdpLoggerHelper.FATAL);
/*

SdpErrorHelper.setErrDetInTransDet(TrasationDetail_Port,scFault,SdpErrorHelper.SEVERITY_FATAL);

SdpLoggerHelper.logMessage(SdpLoggerHelper.RUNTIME_FAILURE+"  MPS.UpdateComponent",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);

DataObject responseMessage = (DataObject)TrasationDetail_Port.getDataObject("errorDetails/Error/Message");
responseMessage.setString(SdpHelper.ERRORDETAILS_MESSAGE_CODE,SdpErrorHelper.SDP_INTERNAL_SYSTEM_ERROR);
*/]]></wpc:javaCode>
                            </wpc:script>
                          </bpws:invoke>
                          <bpws:invoke name="LogUpdateMailBoxConfigCompensation18" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UpdateMailBoxConfigCompensation ]" wpc:id="2326">
                            <wpc:script>
                              <wpc:javaCode><![CDATA[
SdpLoggerHelper.logMessage(SdpLoggerHelper.INVOKE_STR +" SubFlow : UpdateMailBoxConfigCompensation",PROCESS_NAME,processID,SdpLoggerHelper.INFO);
SdpLoggerHelper.logMessage("Request BOs : ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("CreateRequestState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(CreateRequestState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("CreateProvState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(CreateProvstate,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("DeleteRequestState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(DeleteRequestState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("DeleteProvState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(DeleteProvState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("UpdateRequestState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(UpdateRequestState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("UpdateProvState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(UpdateProvState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("TransactionDetailPort :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(TrasationDetail_Port,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("SDP_ORDER_GrpMBoxInfoPort :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(SDP_ORDER_GrpMBoxInfoPort,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("IndexChangeUpdateState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(IndexChangeUpdateState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("SetSubscriberSettingsBySub :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(SetSubscriberSettingsBySub,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("PinChangeUpdateState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(PinChangeUpdateState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("TnChangeUpdateState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(TnChangeUpdateState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("AddServiceState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(AddServiceState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("RemoveServiceState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(RemoveServiceState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

CreateRequestState.setString(SdpHelper.TEMPSTRING2_PATH.replace('.','/'),processID);
]]></wpc:javaCode>
                            </wpc:script>
                          </bpws:invoke>
                          <bpws:assign name="MergeMPSerrortoProcobject4" wpc:displayName="Merge MPS error to Proc object" wpc:id="2495">
                            <bpws:copy>
                              <bpws:from variable="TrasationDetail_Port"/>
                              <bpws:to variable="MailboxConfig_Proc">
                                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail]]></bpws:query>
                              </bpws:to>
                            </bpws:copy>
                          </bpws:assign>
                          <bpws:invoke name="CallUpdateMailBoxConfigCompensate9" operation="compensateUpdateMailBoxConfig" partnerLink="UpdateMailBoxConfig_Compensation_Interface" portType="ns31:UpdateMailBoxConfig_Compensation_Interface" wpc:displayName="call UpdateMailBoxConfig Compensate" wpc:id="2179">
                            <wpc:input>
                              <wpc:parameter name="CreateProvState" variable="CreateProvstate"/>
                              <wpc:parameter name="CreateRequestState" variable="CreateRequestState"/>
                              <wpc:parameter name="UpdateProvState" variable="UpdateProvState"/>
                              <wpc:parameter name="TransactionDetailPort" variable="TrasationDetail_Port"/>
                              <wpc:parameter name="DeleteProvState" variable="DeleteProvState"/>
                              <wpc:parameter name="DeleteRequestState" variable="DeleteRequestState"/>
                              <wpc:parameter name="UpdateRequestState" variable="UpdateRequestState"/>
                              <wpc:parameter name="SDP_ORDER_GrpMBoxInfoPort" variable="SDP_ORDER_GrpMBoxInfoPort"/>
                              <wpc:parameter name="IndexChangeUpdateState" variable="IndexChangeUpdateState"/>
                              <wpc:parameter name="SetSubscriberSettingsBySub" variable="SetSubscriberSettingsBySub"/>
                              <wpc:parameter name="PinChangeUpdateState" variable="PinChangeUpdateState"/>
                              <wpc:parameter name="TnChangeUpdateState" variable="TnChangeUpdateState"/>
                              <wpc:parameter name="AddServiceState" variable="AddServiceState"/>
                              <wpc:parameter name="RemoveServiceState" variable="RemoveServiceState"/>
                            </wpc:input>
                            <wpc:output>
                              <wpc:parameter name="TransactionDetailPort" variable="TrasationDetail_Port"/>
                              <wpc:parameter name="SdpOrderPort" variable="SDP_ORDER_Port"/>
                            </wpc:output>
                          </bpws:invoke>
                          <bpws:invoke name="LogUpdateMailBoxConfigCompensation19" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [ UpdateMailBoxConfigCompensation]" wpc:id="2328">
                            <wpc:script>
                              <wpc:javaCode><![CDATA[
SdpLoggerHelper.logMessage("Received the following GBO from SubFlow : UpdateMailBoxConfigCompensation  ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("TrasationDetail_Port : ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(TrasationDetail_Port,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

]]></wpc:javaCode>
                            </wpc:script>
                          </bpws:invoke>
                          <bpws:invoke name="MergeRollBackedMailboxesintoProc10" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Merge RollBacked Mailboxes into Proc" wpc:id="2800">
                            <wpc:script>
                              <wpc:javaCode><![CDATA[DataObject tmpMailbox = null;
List lstAccountMailboxes = null;
Iterator itrAccountMailboxes = null;
List lstMailboxes = null;

SdpLoggerHelper.logMessage("Merging the RolledBack mailboxes into the response SdpOrder",
	PROCESS_NAME,processID,SdpLoggerHelper.DEBUG);

try {
	lstAccountMailboxes = 
		SDP_ORDER_Port.getList(SdpHelper.VOIP_ACCOUNTMAILBOXES_PATH.replace('.','/'));
	itrAccountMailboxes = lstAccountMailboxes.iterator();
	
	lstMailboxes = MailboxConfig_Proc.getList(SdpHelper.VOIP_ACCOUNTMAILBOXES_PATH.replace('.','/'));
	
	while(itrAccountMailboxes.hasNext())
	{		
		tmpMailbox = SDO.copy((DataObject) itrAccountMailboxes.next());
		lstMailboxes.add(tmpMailbox);
	}
}
catch(Exception ex)
{
	SdpLoggerHelper.logMessage("Failed during Merge the RolledBack mailboxes into response SdpOrder",
		PROCESS_NAME,processID,SdpLoggerHelper.DEBUG);
	SdpLoggerHelper.logMessage("Exception : " + ex,
		PROCESS_NAME,processID,SdpLoggerHelper.DEBUG);
}]]></wpc:javaCode>
                            </wpc:script>
                          </bpws:invoke>
                          <bpws:assign name="MergerProctoTrig13" wpc:displayName="Merger Proc to Trig" wpc:id="2467">
                            <bpws:copy>
                              <bpws:from variable="MailboxConfig_Proc"/>
                              <bpws:to variable="MailboxConfigRequest_Trig"/>
                            </bpws:copy>
                            <bpws:copy>
                              <bpws:from variable="sdpProcessContext"/>
                              <bpws:to variable="MailboxConfigRequest_Trig">
                                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/ProcessContext]]></bpws:query>
                              </bpws:to>
                            </bpws:copy>
                          </bpws:assign>
                          <bpws:invoke name="LogEndProcess4" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [End Process]" wpc:id="2421">
                            <wpc:script>
                              <wpc:javaCode><![CDATA[
SdpLoggerHelper.logMessage("Returning the following GBO To MAM ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("Provisioned [MailboxConfigRequest_Trig ]: ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(MailboxConfigRequest_Trig,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("End - UpdateMailBoxConfig",PROCESS_NAME,processID,SdpLoggerHelper.INFO);]]></wpc:javaCode>
                            </wpc:script>
                          </bpws:invoke>
                          <bpws:reply name="ReplyMPSError4" operation="UpdateMailboxConfig" partnerLink="FromMam_FeaturePermissionMailboxUpdate_Interface" portType="ns3:FromMam_FeaturePermissionMailboxUpdate_Interface" wpc:displayName="Reply MPS Error" wpc:id="941">
                            <wpc:input>
                              <wpc:parameter name="mailboxConfigResponse" variable="MailboxConfigRequest_Trig"/>
                            </wpc:input>
                          </bpws:reply>
                          <bpws:terminate name="Terminate13" wpc:displayName="Terminate13" wpc:id="1821"/>
                        </bpws:sequence>
                      </bpws:catch>
                    </bpws:invoke>
                    <bpws:invoke name="LogMPSUpdateComponentSuccess" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [MPS.UpdateComponent -Success ]" wpc:id="2399">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage("MPS.UpdateComponent :-"+SdpLoggerHelper.SUCCESS_STR,PROCESS_NAME,processID
														,SdpLoggerHelper.INFO);
SdpLoggerHelper.logMessage("Response BO [TrasationDetail]",PROCESS_NAME,processID,SdpLoggerHelper.INFO);
SdpLoggerHelper.logMessage("TrasationDetail_Port:",PROCESS_NAME,processID,SdpLoggerHelper.INFO);														
SdpLoggerHelper.logBO(TrasationDetail_Port,PROCESS_NAME,processID,SdpLoggerHelper.INFO);
																		]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                    <bpws:invoke name="UpdatePinChangeUpdateStateRollBack" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Update PinChangeUpdateState [RollBack]" wpc:id="2127">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[DataObject mailbox = null;

mailbox =  SDO.copy(reqMBox);
PinChangeUpdateState.getList(SdpHelper.VOIP_ACCOUNTMAILBOXES_PATH.replace('.','/')).add(mailbox);]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                  </bpws:sequence>
                </bpws:case>
                <bpws:otherwise wpc:id="3026">
                  <bpws:empty name="Subscribersettingsnotchanged" wpc:displayName="Subscriber settings not changed" wpc:id="1338"/>
                </bpws:otherwise>
              </bpws:switch>
              <bpws:invoke name="IntReqCounter1" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="intReqCounter ++" wpc:id="1015">
                <wpc:script>
                  <wpc:javaCode><![CDATA[intReqCounter = new Integer(intReqCounter.intValue() + 1);]]></wpc:javaCode>
                </wpc:script>
              </bpws:invoke>
            </bpws:sequence>
          </bpws:while>
          <bpws:invoke name="InitialiseRollBackOrderforupdateComponentupdateUser" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Initialise RollBack Order for updateComponent, updateUser" wpc:id="2926">
            <wpc:script>
              <wpc:javaCode><![CDATA[TnChangeUpdateState = SDO.copy(MailboxConfig_Proc);

Order orderBO = new Order(TnChangeUpdateState);

orderBO.getProductList(Product.CVOIPLINE).clear();

orderBO.getMemberProfileList().clear(); ]]></wpc:javaCode>
            </wpc:script>
          </bpws:invoke>
          <bpws:assign name="IntCounter0" wpc:displayName="intCounter = 0" wpc:id="2668">
            <bpws:copy>
              <bpws:from>0</bpws:from>
              <bpws:to variable="intCounter"/>
            </bpws:copy>
          </bpws:assign>
          <bpws:while name="LoopeachLineSubComponentforChktoUpdateTNName" wpc:displayName="Loop each LineSubComponent for Chk to Update TNName" wpc:id="2667">
            <bpws:condition><![CDATA[return intCounter.intValue() < SDP_ORDER_Prov.getList(SdpHelper.CVOIP_LINE_PATH.replace('.','/')).size();]]></bpws:condition>
            <bpws:sequence name="HiddenSequence15" wpc:id="1073744744">
              <bpws:invoke name="GetLineSubComponent" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Get LineSubComponent" wpc:id="2671">
                <wpc:script>
                  <wpc:javaCode><![CDATA[DataObject tmpLineSubComponent = null;
tmpLineSubComponent = (DataObject) SDP_ORDER_Prov.getList(SdpHelper.CVOIP_LINE_PATH.replace('.','/')).get(intCounter.intValue());
lineSubComponent = SDO.copy(tmpLineSubComponent);

SdpLoggerHelper.logMessage("Getting the LineSubComponent",PROCESS_NAME,
	processID,SdpLoggerHelper.DEBUG);]]></wpc:javaCode>
                </wpc:script>
              </bpws:invoke>
              <bpws:assign name="InitializingSDP_ORDER_ForUpdate" wpc:displayName="Initializing SDP_ORDER_ForUpdate" wpc:id="2727">
                <bpws:copy>
                  <bpws:from variable="MailboxConfig_Prov"/>
                  <bpws:to variable="SDP_ORDER_ForUpdate"/>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from>null</bpws:from>
                  <bpws:to variable="SDP_ORDER_ForUpdate">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/tempStoreNonArray/temp1]]></bpws:query>
                  </bpws:to>
                </bpws:copy>
              </bpws:assign>
              <bpws:invoke name="ChecktoupdateTNName" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Check to update TNName" wpc:id="2922">
                <wpc:script>
                  <wpc:javaCode><![CDATA[String strTN = null;
String strReqTNName = null;
String strProvTNName = null;

DataObject reqAccountMailbox = null;

DataObject reqTN = null;

SdpLoggerHelper.logMessage("Checking to update the TNName in LineSubComponent level",PROCESS_NAME,
	processID,SdpLoggerHelper.DEBUG);

SDP_ORDER_ForUpdate.getList(SdpHelper.CVOIP_LINE_PATH.replace('.','/')).clear();

if (lineSubComponent != null)
{
	strTN = lineSubComponent.getString(SdpHelper.CVOIP_TN_PATH.replace('.','/'));
	try {
	strProvTNName = lineSubComponent.getString(SdpHelper.CVOIP_LINE_TNINFO + "/" + SdpHelper.CVOIP_LINE_TNNAME);} catch(Exception e){}
		
	SdpLoggerHelper.logMessage("LineSubComponent is avaiable wiht TN[" + strTN + "]",PROCESS_NAME,
		processID,SdpLoggerHelper.DEBUG);
	
	reqAccountMailbox = SdpHelper.getMailBox(MailboxConfig_Proc,strTN,SdpHelper.SEARCH_TYPE_TN);
	
	if (reqAccountMailbox != null)
	{
		SdpLoggerHelper.logMessage("Request, Provisioned Mailboxes avaiable with TN[" + strTN + "]",
			PROCESS_NAME,processID,SdpLoggerHelper.DEBUG);
		
		reqTN = SdpHelper.getTNFromMailBox(reqAccountMailbox,strTN);
		strReqTNName = reqTN.getString(SdpHelper.CVOIP_MAILBOX_TNNAME);

		
		if (strReqTNName != null && 
			 ( strProvTNName == null || (!strReqTNName.equalsIgnoreCase(strProvTNName)) ))
		{
			lineSubComponent.setString(SdpHelper.CVOIP_LINE_TNINFO + "/" + SdpHelper.CVOIP_LINE_TNNAME, strReqTNName);
			SDP_ORDER_ForUpdate.getList(SdpHelper.CVOIP_LINE_PATH.replace('.','/')).add(lineSubComponent);
			SdpLoggerHelper.logMessage("TNName added to update the same in line level for TN[" + 
				strTN + "]",PROCESS_NAME,processID,SdpLoggerHelper.DEBUG);
		}
	}
}]]></wpc:javaCode>
                </wpc:script>
              </bpws:invoke>
              <bpws:invoke name="ChecktheTNNameisupdated" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Check the TNName is updated" wpc:id="2674">
                <wpc:script>
                  <wpc:javaCode><![CDATA[//Commented the code, since the MailboxTNs at AccountMailbox level are not used in R7.
/*String strTN = null;
String strReqTNName = null;
String strProvTNName = null;

DataObject reqAccountMailbox = null;
DataObject provAccountMailbox = null;

DataObject reqTN = null;
DataObject provTN = null;

SdpLoggerHelper.logMessage("Checking to update the TNName in LineSubComponent level",PROCESS_NAME,
	processID,SdpLoggerHelper.DEBUG);

SDP_ORDER_ForUpdate.getList(SdpHelper.CVOIP_LINE_PATH.replace('.','/')).clear();

if (lineSubComponent != null)
{
	strTN = lineSubComponent.getString(SdpHelper.CVOIP_TN_PATH.replace('.','/'));
	
	SdpLoggerHelper.logMessage("LineSubComponent is avaiable wiht TN[" + strTN + "]",PROCESS_NAME,
		processID,SdpLoggerHelper.DEBUG);
	
	reqAccountMailbox = SdpHelper.getMailBox(MailboxConfig_Proc,strTN,SdpHelper.SEARCH_TYPE_TN);
	provAccountMailbox = SdpHelper.getMailBox(MailboxConfig_Prov,strTN,SdpHelper.SEARCH_TYPE_TN);
	
	if (reqAccountMailbox != null && provAccountMailbox != null)
	{
		SdpLoggerHelper.logMessage("Request, Provisioned Mailboxes avaiable with TN[" + strTN + "]",
			PROCESS_NAME,processID,SdpLoggerHelper.DEBUG);
		
		reqTN = SdpHelper.getTNFromMailBox(reqAccountMailbox,strTN);
		provTN = SdpHelper.getTNFromMailBox(provAccountMailbox,strTN);
		
		strReqTNName = reqTN.getString(SdpHelper.CVOIP_MAILBOX_TNNAME);
		strProvTNName = provTN.getString(SdpHelper.CVOIP_MAILBOX_TNNAME);
		
		if (strReqTNName != null && 
			 ( strProvTNName == null || (!strReqTNName.equalsIgnoreCase(strProvTNName)) ))
		{
			lineSubComponent.setString(SdpHelper.CVOIP_LINE_TNINFO + "/" + SdpHelper.CVOIP_LINE_TNNAME, strReqTNName);
			SDP_ORDER_ForUpdate.getList(SdpHelper.CVOIP_LINE_PATH.replace('.','/')).add(lineSubComponent);
//			SDP_ORDER_ForUpdate.setString(SdpHelper.TEMPSTRING1_PATH.replace('.','/'),strReqTNName);
			SdpLoggerHelper.logMessage("TNName added to update the same in line level for TN[" + 
				strTN + "]",PROCESS_NAME,processID,SdpLoggerHelper.DEBUG);
		}
	}
}*/]]></wpc:javaCode>
                </wpc:script>
              </bpws:invoke>
              <bpws:switch name="NeedttoUpdateTNNameforCvoipLine" wpc:displayName="Needt to Update TNName for CvoipLine?" wpc:id="2675">
                <bpws:case wpc:id="2676">
                  <bpws:condition><![CDATA[return SDP_ORDER_ForUpdate.getList(SdpHelper.CVOIP_LINE_PATH.replace('.','/')).size() > 0;]]></bpws:condition>
                  <bpws:sequence name="HiddenSequence26" wpc:id="1073744747">
                    <bpws:assign name="Preinvokeassigns20" wpc:displayName="Pre-invoke assigns" wpc:id="2678">
                      <bpws:copy>
                        <bpws:from variable="emptyTransactionDetail"/>
                        <bpws:to variable="TrasationDetail_Port"/>
                      </bpws:copy>
                      <bpws:copy>
                        <bpws:from>MPS.UpdateComponent.request</bpws:from>
                        <bpws:to variable="TrasationDetail_Port">
                          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/State]]></bpws:query>
                        </bpws:to>
                      </bpws:copy>
                      <bpws:copy>
                        <bpws:from>MPS</bpws:from>
                        <bpws:to variable="TrasationDetail_Port">
                          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/TargetSystem]]></bpws:query>
                        </bpws:to>
                      </bpws:copy>
                      <bpws:copy>
                        <bpws:from>LINE</bpws:from>
                        <bpws:to variable="SDP_ORDER_ForUpdate">
                          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/currentProduct]]></bpws:query>
                        </bpws:to>
                      </bpws:copy>
                      <bpws:copy>
                        <bpws:from>UpdateComponent</bpws:from>
                        <bpws:to variable="TrasationDetail_Port">
                          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/currentTargetOperation]]></bpws:query>
                        </bpws:to>
                      </bpws:copy>
                    </bpws:assign>
                    <bpws:invoke name="SetMPSValues2" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="set MPS Values" wpc:id="2681">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[/*
SdpLoggerHelper.logMessage("Setting up the Values for MPS.updateComponent[LINE-TNName]",
	PROCESS_NAME,processID,SdpLoggerHelper.DEBUG);
// R7 Filter Setting not required
//Create WESM Content Filter 
ContentFilterCreator filterCreator = new ContentFilterCreator();

filterCreator.addSelectFilter(SdpHelper.PRODUCTTYPE, SdpHelper.CURRENT_PRODUCT_PATH);

filterCreator.addSelectFilter(SdpHelper.ACCT_OBJID, SdpHelper.ACCT_OBJID_PATH);

filterCreator.addSelectFilter(SdpHelper.CVOIP_LINE_TN, SdpHelper.CVOIP_LINE_TN_PATH);

filterCreator.addUpdateFilter(SdpHelper.CVOIP_MAILBOX_TNNAME, SdpHelper.TEMPSTRING1_PATH);
		
//Set the Content filter to the transaction detail object. 
SDP_ORDER_ForUpdate.getDataObject("transactionDetail").setDataObject( "contentFilter", filterCreator.createFilters() );

*/
]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                    <bpws:invoke name="LogMPSUpdateComponent2" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [ MPS.UpdateComponent]" wpc:id="2684">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage(SdpLoggerHelper.INVOKE_STR +" : MPS.UpdateComponent[LineSubComponent-TNName]",
	PROCESS_NAME,processID,SdpLoggerHelper.INFO);
														
SdpLoggerHelper.logMessage("Request BO [SDP_ORDER_ForUpdate]:",PROCESS_NAME,
	processID,SdpLoggerHelper.INFO);
														
SdpLoggerHelper.logBO(SDP_ORDER_ForUpdate,PROCESS_NAME,processID,SdpLoggerHelper.INFO);
																		]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                    <bpws:invoke name="MPSupdateComponentLineTNName" operation="updateComponent" partnerLink="MPSCompensableService2_InterfacePartner" portType="ns35:MPSCompensableService2_Interface" wpc:displayName="MPS.updateComponent - Line [TNName]" wpc:id="2689">
                      <wpc:input>
                        <wpc:parameter name="order" variable="SDP_ORDER_ForUpdate"/>
                      </wpc:input>
                      <wpc:output/>
                      <bpws:catch faultName="ns35:serviceCallFault" faultVariable="scFault" wpc:faultType="java:ServiceCallFault" wpc:id="3027" wpc:variableId="2690">
                        <bpws:sequence name="HiddenSequence30" wpc:id="1073744748">
                          <bpws:assign name="SetErrorDetails10" wpc:displayName="Set Error Details" wpc:id="2870">
                            <bpws:copy>
                              <bpws:from><![CDATA[11016]]></bpws:from>
                              <bpws:to variable="TrasationDetail_Port">
                                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/Message/MessageCode]]></bpws:query>
                              </bpws:to>
                            </bpws:copy>
                            <bpws:copy>
                              <bpws:from><![CDATA[SDP_Downstream_System_Error]]></bpws:from>
                              <bpws:to variable="TrasationDetail_Port">
                                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/Message/MessageText]]></bpws:query>
                              </bpws:to>
                            </bpws:copy>
                            <bpws:copy>
                              <bpws:from>FATAL</bpws:from>
                              <bpws:to variable="TrasationDetail_Port">
                                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/Severity]]></bpws:query>
                              </bpws:to>
                            </bpws:copy>
                            <bpws:copy>
                              <bpws:from variable="scFault">
                                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[messageDetail]]></bpws:query>
                              </bpws:from>
                              <bpws:to variable="TrasationDetail_Port">
                                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[errorDetails/Error/Message/MessageDetail]]></bpws:query>
                              </bpws:to>
                            </bpws:copy>
                          </bpws:assign>
                          <bpws:invoke name="HandleRuntimefailure7" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Handle Run time failure" wpc:id="2692">
                            <wpc:script>
                              <wpc:javaCode><![CDATA[TrasationDetail_Port.setBoolean("errorIndicator", true);
SdpLoggerHelper.logMessage(SdpLoggerHelper.RUNTIME_FAILURE+" MPS.updateComponent",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);
SdpLoggerHelper.logBO(scFault,PROCESS_NAME,processID,SdpLoggerHelper.FATAL);
/*

SdpErrorHelper.setErrDetInTransDet(TrasationDetail_Port,scFault,SdpErrorHelper.SEVERITY_FATAL);

SdpLoggerHelper.logMessage(SdpLoggerHelper.RUNTIME_FAILURE+"  MPS.UpdateComponent",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);

DataObject responseMessage = (DataObject)TrasationDetail_Port.getDataObject("errorDetails/Error/Message");
responseMessage.setString(SdpHelper.ERRORDETAILS_MESSAGE_CODE,SdpErrorHelper.SDP_INTERNAL_SYSTEM_ERROR);
*/]]></wpc:javaCode>
                            </wpc:script>
                          </bpws:invoke>
                          <bpws:invoke name="LogUpdateMailBoxConfigCompensation18" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UpdateMailBoxConfigCompensation ]" wpc:id="2713">
                            <wpc:script>
                              <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage(SdpLoggerHelper.INVOKE_STR +" SubFlow : UpdateMailBoxConfigCompensation",
	PROCESS_NAME,processID,SdpLoggerHelper.INFO);
]]></wpc:javaCode>
                            </wpc:script>
                          </bpws:invoke>
                          <bpws:assign name="MergeMPSerrortoProcobject5" wpc:displayName="Merge MPS error to Proc object" wpc:id="2714">
                            <bpws:copy>
                              <bpws:from variable="TrasationDetail_Port"/>
                              <bpws:to variable="MailboxConfig_Proc">
                                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail]]></bpws:query>
                              </bpws:to>
                            </bpws:copy>
                          </bpws:assign>
                          <bpws:invoke name="CallUpdateMailBoxConfigCompensate9" operation="compensateUpdateMailBoxConfig" partnerLink="UpdateMailBoxConfig_Compensation_Interface" portType="ns31:UpdateMailBoxConfig_Compensation_Interface" wpc:displayName="call UpdateMailBoxConfig Compensate" wpc:id="2715">
                            <wpc:input>
                              <wpc:parameter name="CreateProvState" variable="CreateProvstate"/>
                              <wpc:parameter name="CreateRequestState" variable="CreateRequestState"/>
                              <wpc:parameter name="UpdateProvState" variable="UpdateProvState"/>
                              <wpc:parameter name="TransactionDetailPort" variable="TrasationDetail_Port"/>
                              <wpc:parameter name="DeleteProvState" variable="DeleteProvState"/>
                              <wpc:parameter name="DeleteRequestState" variable="DeleteRequestState"/>
                              <wpc:parameter name="UpdateRequestState" variable="UpdateRequestState"/>
                              <wpc:parameter name="SDP_ORDER_GrpMBoxInfoPort" variable="SDP_ORDER_GrpMBoxInfoPort"/>
                              <wpc:parameter name="IndexChangeUpdateState" variable="IndexChangeUpdateState"/>
                              <wpc:parameter name="SetSubscriberSettingsBySub" variable="SetSubscriberSettingsBySub"/>
                              <wpc:parameter name="PinChangeUpdateState" variable="PinChangeUpdateState"/>
                              <wpc:parameter name="TnChangeUpdateState" variable="TnChangeUpdateState"/>
                              <wpc:parameter name="AddServiceState" variable="AddServiceState"/>
                              <wpc:parameter name="RemoveServiceState" variable="RemoveServiceState"/>
                            </wpc:input>
                            <wpc:output>
                              <wpc:parameter name="TransactionDetailPort" variable="TrasationDetail_Port"/>
                              <wpc:parameter name="SdpOrderPort" variable="SDP_ORDER_Port"/>
                            </wpc:output>
                          </bpws:invoke>
                          <bpws:invoke name="LogUpdateMailBoxConfigCompensation19" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [ UpdateMailBoxConfigCompensation]" wpc:id="2717">
                            <wpc:script>
                              <wpc:javaCode><![CDATA[
SdpLoggerHelper.logMessage("Received the following GBO from SubFlow : UpdateMailBoxConfigCompensation  ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("TrasationDetail_Port : ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(TrasationDetail_Port,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

]]></wpc:javaCode>
                            </wpc:script>
                          </bpws:invoke>
                          <bpws:invoke name="MergeRollBackedMailboxesintoProc11" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Merge RollBacked Mailboxes into Proc" wpc:id="2802">
                            <wpc:script>
                              <wpc:javaCode><![CDATA[DataObject tmpMailbox = null;
List lstAccountMailboxes = null;
Iterator itrAccountMailboxes = null;
List lstMailboxes = null;

SdpLoggerHelper.logMessage("Merging the RolledBack mailboxes into the response SdpOrder",
	PROCESS_NAME,processID,SdpLoggerHelper.DEBUG);

try {
	lstAccountMailboxes = 
		SDP_ORDER_Port.getList(SdpHelper.VOIP_ACCOUNTMAILBOXES_PATH.replace('.','/'));
	itrAccountMailboxes = lstAccountMailboxes.iterator();
	
	lstMailboxes = MailboxConfig_Proc.getList(SdpHelper.VOIP_ACCOUNTMAILBOXES_PATH.replace('.','/'));
	
	while(itrAccountMailboxes.hasNext())
	{		
		tmpMailbox = SDO.copy((DataObject) itrAccountMailboxes.next());
		lstMailboxes.add(tmpMailbox);
	}
}
catch(Exception ex)
{
	SdpLoggerHelper.logMessage("Failed during Merge the RolledBack mailboxes into response SdpOrder",
		PROCESS_NAME,processID,SdpLoggerHelper.DEBUG);
	SdpLoggerHelper.logMessage("Exception : " + ex,
		PROCESS_NAME,processID,SdpLoggerHelper.DEBUG);
}]]></wpc:javaCode>
                            </wpc:script>
                          </bpws:invoke>
                          <bpws:assign name="MergerProctoTrig13" wpc:displayName="Merger Proc to Trig" wpc:id="2718">
                            <bpws:copy>
                              <bpws:from variable="MailboxConfig_Proc"/>
                              <bpws:to variable="MailboxConfigRequest_Trig"/>
                            </bpws:copy>
                            <bpws:copy>
                              <bpws:from variable="sdpProcessContext"/>
                              <bpws:to variable="MailboxConfigRequest_Trig">
                                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/ProcessContext]]></bpws:query>
                              </bpws:to>
                            </bpws:copy>
                          </bpws:assign>
                          <bpws:invoke name="LogEndProcess4" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [End Process]" wpc:id="2720">
                            <wpc:script>
                              <wpc:javaCode><![CDATA[
SdpLoggerHelper.logMessage("Returning the following GBO To MAM ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("Provisioned [MailboxConfigRequest_Trig ]: ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(MailboxConfigRequest_Trig,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("End - UpdateMailBoxConfig",PROCESS_NAME,processID,SdpLoggerHelper.INFO);]]></wpc:javaCode>
                            </wpc:script>
                          </bpws:invoke>
                          <bpws:reply name="ReplyMPSError5" operation="UpdateMailboxConfig" partnerLink="FromMam_FeaturePermissionMailboxUpdate_Interface" portType="ns3:FromMam_FeaturePermissionMailboxUpdate_Interface" wpc:displayName="Reply MPS Error" wpc:id="2721">
                            <wpc:input>
                              <wpc:parameter name="mailboxConfigResponse" variable="MailboxConfigRequest_Trig"/>
                            </wpc:input>
                          </bpws:reply>
                          <bpws:terminate name="Terminate17" wpc:displayName="Terminate" wpc:id="2722"/>
                        </bpws:sequence>
                      </bpws:catch>
                    </bpws:invoke>
                    <bpws:invoke name="LogMPSUpdateComponentrSuccess1" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [MPS.UpdateComponentr -Success ]" wpc:id="2725">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage("MPS.UpdateComponent :-"+SdpLoggerHelper.SUCCESS_STR,PROCESS_NAME,processID
														,SdpLoggerHelper.INFO);
SdpLoggerHelper.logMessage("Response BO [TrasationDetail]",PROCESS_NAME,processID,SdpLoggerHelper.INFO);
SdpLoggerHelper.logMessage("TrasationDetail_Port:",PROCESS_NAME,processID,SdpLoggerHelper.INFO);														
SdpLoggerHelper.logBO(TrasationDetail_Port,PROCESS_NAME,processID,SdpLoggerHelper.INFO);
																		]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                    <bpws:invoke name="AddLineforRollback" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Add Line for Rollback" wpc:id="2928">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[Order orderBO = new Order(TnChangeUpdateState);

orderBO.getProductList(Product.CVOIPLINE).add(lineSubComponent);]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                  </bpws:sequence>
                </bpws:case>
              </bpws:switch>
              <bpws:invoke name="IntCounter1" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="intCounter++" wpc:id="2728">
                <wpc:script>
                  <wpc:javaCode><![CDATA[intCounter = new Integer (intCounter.intValue() +1);]]></wpc:javaCode>
                </wpc:script>
              </bpws:invoke>
            </bpws:sequence>
          </bpws:while>
          <bpws:invoke name="SetpublishSubfromprovBOifUserCompAssociationexists" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Set publishSub from provBO if UserCompAssociation exists" wpc:id="2939">
            <wpc:script>
              <wpc:javaCode><![CDATA[//Added this snippet for the defect 94192
//To retain the value of featurepermissionpublishsubscribeind from provisiondBO if the sub-account has an existing associated mailbox in the MPS usercomponent associations
List lstProvMemProfile = null;
Iterator iterProvMemProfile = null;
List lstReqMemProfile = null;
Iterator iterReqMemProfile = null;
DataObject reqMailBoxDO = null;
DataObject provMemProfileDO = null;
DataObject reqMemProfileDO = null;
String provMemberID = null;
String reqMemberId = null;
String strProvMBInvariantID = null;
String strPublishSubInd = null;
String strPrimaryMemInd = null;

//MPS order memberProfile list
lstProvMemProfile = new Order(MailboxConfig_Prov).getMemberProfileList();

//checking 
if(lstProvMemProfile != null && lstProvMemProfile.size() > 0) {
	iterProvMemProfile = lstProvMemProfile.iterator();			
	//memberProfile loop
	while(iterProvMemProfile.hasNext()) {
	    			
		provMemProfileDO = (DataObject)iterProvMemProfile.next();
		strProvMBInvariantID = provMemProfileDO.getString(SdpHelper.MEMBERPROFILE_MAILBOXINVARIANTID);
		provMemberID = provMemProfileDO.getString(SdpHelper.MEMBERPROFILE_MEMBERID);
		strPublishSubInd = provMemProfileDO.getString(SdpHelper.MEMBERPROFILE_FEATUREPERMISSIONPUBLISHSUBSCRIBEIND);
		strPrimaryMemInd = provMemProfileDO.getString(SdpHelper.MEMBERPROFILE_PRIMARYMEMBERIND);
		reqMailBoxDO = SdpHelper.getMailBox(MailboxConfig_Proc,provMemberID,SdpHelper.SEARCH_TYPE_MEMBER);
		if (strProvMBInvariantID != null && strProvMBInvariantID.trim().length() > 0 && reqMailBoxDO != null && (!"Y".equals(strPrimaryMemInd))){
		
			lstReqMemProfile = new Order(MailboxConfig_Proc).getMemberProfileList();
	
			if(lstReqMemProfile != null && lstReqMemProfile.size() > 0) {
				iterReqMemProfile = lstReqMemProfile.iterator();
				while(iterReqMemProfile.hasNext()){	
				 reqMemProfileDO = (DataObject)iterReqMemProfile.next();
				 reqMemberId = reqMemProfileDO.getString(SdpHelper.MEMBERPROFILE_MEMBERID);
				 if(provMemberID != null && provMemberID.equalsIgnoreCase(reqMemberId))
					{	
						reqMemProfileDO.setString(SdpHelper.MEMBERPROFILE_FEATUREPERMISSIONPUBLISHSUBSCRIBEIND,strPublishSubInd);
					}
				}
			}
		}
		
	}
	
}


SdpLoggerHelper.logMessage("MailboxConfig_Proc after setting PublishSubInd :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);														
SdpLoggerHelper.logBO(MailboxConfig_Proc,PROCESS_NAME,processID,SdpLoggerHelper.INFO);
			
			]]></wpc:javaCode>
            </wpc:script>
          </bpws:invoke>
          <bpws:assign name="InitializeCounters1" wpc:displayName="Initialize Counters" wpc:id="1327">
            <bpws:copy>
              <bpws:from>0</bpws:from>
              <bpws:to variable="intProvCounter"/>
            </bpws:copy>
            <bpws:copy>
              <bpws:from>0</bpws:from>
              <bpws:to variable="intReqCounter"/>
            </bpws:copy>
          </bpws:assign>
          <bpws:while name="LoopthroughforeachUserInMPS" wpc:displayName="Loop through for each User In MPS" wpc:id="1292">
            <bpws:condition><![CDATA[return SDP_Order_Prov_Updated.getList(SdpHelper.MEMBERPROFILE_LIST_PATH.replace('.','/')) != null 
	&& intProvCounter.intValue() < SDP_Order_Prov_Updated.getList(SdpHelper.MEMBERPROFILE_LIST_PATH.replace('.','/')).size();]]></bpws:condition>
            <bpws:sequence name="HiddenSequence20" wpc:id="1293">
              <bpws:invoke name="GettheSubcriberinMPSandReIntializeUpdateSubFlag" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Get the Subcriber in MPS and Re -Intialize Update Sub. Flag" wpc:id="1295">
                <wpc:script>
                  <wpc:javaCode><![CDATA[intReqCounter = new Integer(0);

blnUpdateSubscriber = new Boolean(false);

List lstMemberProfile = new Order(SDP_Order_Prov_Updated).getMemberProfileList();

tmpMemProf = (DataObject)lstMemberProfile.get(intProvCounter.intValue());]]></wpc:javaCode>
                </wpc:script>
              </bpws:invoke>
              <bpws:assign name="PreInvokeAssigns11" wpc:displayName="Pre-Invoke Assigns" wpc:id="1305">
                <bpws:copy>
                  <bpws:from variable="emptyTransactionDetail"/>
                  <bpws:to variable="TrasationDetail_Port"/>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from>MPS.UpdateUser.request</bpws:from>
                  <bpws:to variable="TrasationDetail_Port">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/State]]></bpws:query>
                  </bpws:to>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from>MPS</bpws:from>
                  <bpws:to variable="TrasationDetail_Port">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/TargetSystem]]></bpws:query>
                  </bpws:to>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from>UpdateUser</bpws:from>
                  <bpws:to variable="TrasationDetail_Port">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/currentTargetOperation]]></bpws:query>
                  </bpws:to>
                </bpws:copy>
              </bpws:assign>
              <bpws:invoke name="SetMailboxIndexMailboxComponentID" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Set MailboxIndex &amp; MailboxComponentID" wpc:id="2615">
                <wpc:script>
                  <wpc:javaCode><![CDATA[DataObject tmpAccountMailbox =null; 
String strMemberId = null;
String strMboxComponentID = null;

strMemberId = tmpMemProf.getString(SdpHelper.MEMBERPROFILE_MEMBERID);

SdpLoggerHelper.logMessage("Checking to Set a MailboxIndex Filter for MemberProfile["
	+strMemberId+"]", PROCESS_NAME, processID,SdpLoggerHelper.DEBUG);

tmpAccountMailbox = SdpHelper.getMailBox(MailboxConfig_Proc,strMemberId,SdpHelper.SEARCH_TYPE_MEMBER);

if (tmpAccountMailbox != null)
{
	if (tmpAccountMailbox.isSet(SdpHelper.CVOIP_MAILBOX_INDEX))
	{
		mailboxIndex = new Integer(tmpAccountMailbox.getInt(SdpHelper.CVOIP_MAILBOX_INDEX));
	
		SdpLoggerHelper.logMessage("Getting MailboxIndex : " + mailboxIndex.toString(),
			PROCESS_NAME,processID,SdpLoggerHelper.DEBUG);

		tmpMemProf.setString(SdpHelper.MEMBERPROFILE_MAILBOXINDEX,mailboxIndex.toString());
		SdpLoggerHelper.logMessage("MailboxIndex["+mailboxIndex.toString()+"] is set for MemberProfile["
			+strMemberId+"]", PROCESS_NAME, processID,SdpLoggerHelper.DEBUG);
	}
	else
	{
		tmpMemProf.setString(SdpHelper.MEMBERPROFILE_MAILBOXINDEX, null);
	}

	strMboxComponentID = tmpAccountMailbox.getString(SdpHelper.CVOIP_MAILBOX_COMPONENTID);
	if(strMboxComponentID != null && strMboxComponentID.trim().length() > 0)
	{
		tmpMemProf.setString(SdpHelper.MEMBERPROFILE_MAILBOXCOMPONENTID,strMboxComponentID);
	}
}
else
{
	tmpMemProf.setString(SdpHelper.MEMBERPROFILE_MAILBOXCOMPONENTID,null);
}]]></wpc:javaCode>
                </wpc:script>
              </bpws:invoke>
              <bpws:assign name="SetmailboxCfn" wpc:displayName="Set mailboxCfn" wpc:id="2617">
                <bpws:copy>
                  <bpws:from variable="MailboxConfig_Prov">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/order/ReqService/product/cvoipProduct/cfn]]></bpws:query>
                  </bpws:from>
                  <bpws:to variable="tmpMemProf">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/mailboxCfn]]></bpws:query>
                  </bpws:to>
                </bpws:copy>
              </bpws:assign>
              <bpws:invoke name="SetFeaturePermissionPublishSubscriberIndCR16774" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Set FeaturePermissionPublishSubscriberInd - CR#16774" wpc:id="2825">
                <wpc:script>
                  <wpc:javaCode><![CDATA[DataObject memberProfile = null;
String memberID = null;
String publishSubInd = null;

if (tmpMemProf != null)
{
	memberID = tmpMemProf.getString(SdpHelper.MEMBERPROFILE_MEMBERID);
	memberProfile = SdpHelper.getMemberProfile(MailboxConfig_Proc,memberID,SdpHelper.MEMBER_FILTER);
	
	if (memberProfile != null)
	{
		publishSubInd = memberProfile.getString(SdpHelper.MEMBERPROFILE_FEATUREPERMISSIONPUBLISHSUBSCRIBEIND);
		if (publishSubInd != null && publishSubInd.trim().length() > 0)
		{
			tmpMemProf.setString(SdpHelper.MEMBERPROFILE_FEATUREPERMISSIONPUBLISHSUBSCRIBEIND,publishSubInd);
		}
	}
}]]></wpc:javaCode>
                </wpc:script>
              </bpws:invoke>
              <bpws:invoke name="CreateinputobjforupdateSubscriber" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Create input obj for updateSubscriber" wpc:id="2571">
                <wpc:script>
                  <wpc:javaCode><![CDATA[List lstMemberProfList = null;
List lstMemberTNs = null;

com.ibm.websphere.bo.BOFactory factory = null;
commonj.sdo.DataObject memberTN = null;

String memberTNs_NameSpace = "http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_MemberTNS";
String memberTNs_Name = "SDP_MemberTNS"; 
String BOFactory = "com/ibm/websphere/bo/BOFactory"; 

UpdateSubscriberInput = SDO.copy(SDP_Order_Prov_Updated);
lstMemberProfList = UpdateSubscriberInput.getList(SdpHelper.MEMBERPROFILE_LIST_PATH.replace('.', '/'));

if(tmpMemProf != null)
{
	lstMemberProfList.clear();
	
	//Commented the code, since the memberTNs and memberProfile level is not used in R7.
	/*lstMemberTNs = tmpMemProf.getList(SdpHelper.MEMBERPROFILE_MEMBER_TNS);
	
	if(lstMemberTNs.size() == 0)
	{
		factory = (com.ibm.websphere.bo.BOFactory) 
			new com.ibm.websphere.sca.ServiceManager().locateService(BOFactory);
				
		memberTN = factory.create(memberTNs_NameSpace, memberTNs_Name);
		memberTN.setString("tn","");
		lstMemberTNs.add(memberTN);
	}*/
	
	lstMemberProfList.add(SDO.copy(tmpMemProf));
}]]></wpc:javaCode>
                </wpc:script>
              </bpws:invoke>
              <bpws:invoke name="SetupMPSValuesnotused1" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Setup MPS Values- not used" wpc:id="1307">
                <wpc:script>
                  <wpc:javaCode><![CDATA[/*
SdpLoggerHelper.logMessage("Setting up the Values for MPS.updateUser", PROCESS_NAME, processID,
	SdpLoggerHelper.DEBUG);
// R7 Filter Setting not required
//Create WESM Content Filter 
ContentFilterCreator filterCreator = new ContentFilterCreator();

//Create WESM Select Filter
if(tmpMemProf.getString(SdpHelper.MEMBERPROFILE_PRIMARYMEMBERIND).equalsIgnoreCase(SdpHelper.YES))
	filterCreator.addSelectFilter(SdpHelper.ACCT_OBJID, SdpHelper.ACCT_OBJID_PATH);
else
	filterCreator.addSelectFilter(SdpHelper.MEMBERPROFILE_MEMBERID, SdpHelper.MEMBERPROFILE_MEMBERID_PATH);
	
//Set the Filter for the MailBoxInvarintID
filterCreator.addUpdateFilter(SdpHelper.MEMBERPROFILE_MAILBOXINVARIANTID, SdpHelper.MEMBERPROFILE_MAILBOXINVARIANTID_PATH);
filterCreator.addUpdateFilter(SdpHelper.MEMBERPROFILE_MAINMAILBOXIND, SdpHelper.MEMBERPROFILE_MAINMAILBOXIND_PATH);
filterCreator.addUpdateFilter(SdpHelper.MEMBERPROFILE_MAILBOXCFN, SdpHelper.MEMBERPROFILE_MAILBOXCFN_PATH);
filterCreator.addUpdateFilter(SdpHelper.MEMBERPROFILE_MAILBOXINDEX, SdpHelper.MEMBERPROFILE_MAILBOXINDEX_PATH);

//Set the Content filter to the transaction detail object. 
UpdateSubscriberInput.getDataObject("transactionDetail").setDataObject( "contentFilter", filterCreator.createFilters() );

//Create WESM Update Filter for MemberTNs
SdpHelper.setUpMemberTNs(UpdateSubscriberInput.getDataObject("transactionDetail"),
	tmpMemProf.getList(SdpHelper.MEMBERPROFILE_MAILBOX_TNS).size(),SdpHelper.MEMBER_TN_TYPE);
	*/
	]]></wpc:javaCode>
                </wpc:script>
              </bpws:invoke>
              <bpws:invoke name="LogMPSupdateUser" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [MPS.updateUser ]" wpc:id="2874">
                <wpc:script>
                  <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage(SdpLoggerHelper.INVOKE_STR +" : MPS.updateUser",PROCESS_NAME,processID
														,SdpLoggerHelper.INFO);
														
SdpLoggerHelper.logMessage("Request BO:[SDP_ORDER]",PROCESS_NAME,processID
														,SdpLoggerHelper.INFO);
SdpLoggerHelper.logMessage("UpdateSubscriberInput:",PROCESS_NAME,processID
														,SdpLoggerHelper.INFO);

														
SdpLoggerHelper.logBO(UpdateSubscriberInput,PROCESS_NAME,processID,SdpLoggerHelper.INFO);
]]></wpc:javaCode>
                </wpc:script>
              </bpws:invoke>
              <bpws:invoke name="MPSUpdateUser" operation="updateUser" partnerLink="MPSCompensableService2_InterfacePartner" portType="ns35:MPSCompensableService2_Interface" wpc:displayName="MPS Update User" wpc:id="2877">
                <wpc:input>
                  <wpc:parameter name="order" variable="UpdateSubscriberInput"/>
                </wpc:input>
                <wpc:output/>
                <bpws:catch faultName="ns35:serviceCallFault" faultVariable="scFault" wpc:faultType="java:ServiceCallFault" wpc:id="3029" wpc:variableId="2878">
                  <bpws:sequence name="HiddenSequence16" wpc:id="2879">
                    <bpws:assign name="SetErrorDetails11" wpc:displayName="Set Error Details" wpc:id="2880">
                      <bpws:copy>
                        <bpws:from><![CDATA[11016]]></bpws:from>
                        <bpws:to variable="TrasationDetail_Port">
                          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/Message/MessageCode]]></bpws:query>
                        </bpws:to>
                      </bpws:copy>
                      <bpws:copy>
                        <bpws:from><![CDATA[SDP_Downstream_System_Error]]></bpws:from>
                        <bpws:to variable="TrasationDetail_Port">
                          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/Message/MessageText]]></bpws:query>
                        </bpws:to>
                      </bpws:copy>
                      <bpws:copy>
                        <bpws:from>FATAL</bpws:from>
                        <bpws:to variable="TrasationDetail_Port">
                          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/Severity]]></bpws:query>
                        </bpws:to>
                      </bpws:copy>
                      <bpws:copy>
                        <bpws:from variable="scFault">
                          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[messageDetail]]></bpws:query>
                        </bpws:from>
                        <bpws:to variable="TrasationDetail_Port">
                          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[errorDetails/Error/Message/MessageDetail]]></bpws:query>
                        </bpws:to>
                      </bpws:copy>
                    </bpws:assign>
                    <bpws:invoke name="HandleRuntimefailure8" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Handle Run time failure" wpc:id="2882">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[TrasationDetail_Port.setBoolean("errorIndicator", true);
SdpLoggerHelper.logMessage(SdpLoggerHelper.RUNTIME_FAILURE+" MPS.updateUser",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);
SdpLoggerHelper.logBO(scFault,PROCESS_NAME,processID,SdpLoggerHelper.FATAL);

/*
SdpErrorHelper.setErrDetInTransDet(TrasationDetail_Port,scFault,SdpErrorHelper.SEVERITY_FATAL);

SdpLoggerHelper.logMessage(SdpLoggerHelper.RUNTIME_FAILURE+"  MPS.UpdateUser",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);

DataObject responseMessage = (DataObject)TrasationDetail_Port.getDataObject("errorDetails/Error/Message");
responseMessage.setString(SdpHelper.ERRORDETAILS_MESSAGE_CODE,SdpErrorHelper.SDP_INTERNAL_SYSTEM_ERROR);
*/]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                    <bpws:invoke name="LogUpdateMailBoxConfigCompensation20" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UpdateMailBoxConfigCompensation ]" wpc:id="2884">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[
SdpLoggerHelper.logMessage(SdpLoggerHelper.INVOKE_STR +" SubFlow : UpdateMailBoxConfigCompensation",PROCESS_NAME,processID,SdpLoggerHelper.INFO);
SdpLoggerHelper.logMessage("Request BOs : ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("CreateRequestState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(CreateRequestState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("CreateProvState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(CreateProvstate,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("DeleteRequestState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(DeleteRequestState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("DeleteProvState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(DeleteProvState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("UpdateRequestState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(UpdateRequestState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("UpdateProvState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(UpdateProvState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("TransactionDetailPort :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(TrasationDetail_Port,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("SDP_ORDER_GrpMBoxInfoPort :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(SDP_ORDER_GrpMBoxInfoPort,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("IndexChangeUpdateState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(IndexChangeUpdateState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("SetSubscriberSettingsBySub :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(SetSubscriberSettingsBySub,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("PinChangeUpdateState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(PinChangeUpdateState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("TnChangeUpdateState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(TnChangeUpdateState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("AddServiceState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(AddServiceState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("RemoveServiceState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(RemoveServiceState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

CreateRequestState.setString(SdpHelper.TEMPSTRING2_PATH.replace('.','/'),processID);
]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                    <bpws:assign name="MergeMPSerrortoProcobject6" wpc:displayName="Merge MPS error to Proc object" wpc:id="2885">
                      <bpws:copy>
                        <bpws:from variable="TrasationDetail_Port"/>
                        <bpws:to variable="MailboxConfig_Proc">
                          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail]]></bpws:query>
                        </bpws:to>
                      </bpws:copy>
                    </bpws:assign>
                    <bpws:invoke name="CallUpdateMailBoxConfigCompensate10" operation="compensateUpdateMailBoxConfig" partnerLink="UpdateMailBoxConfig_Compensation_Interface" portType="ns31:UpdateMailBoxConfig_Compensation_Interface" wpc:displayName="call UpdateMailBoxConfig Compensate" wpc:id="2886">
                      <wpc:input>
                        <wpc:parameter name="CreateProvState" variable="CreateProvstate"/>
                        <wpc:parameter name="CreateRequestState" variable="CreateRequestState"/>
                        <wpc:parameter name="UpdateProvState" variable="UpdateProvState"/>
                        <wpc:parameter name="TransactionDetailPort" variable="TrasationDetail_Port"/>
                        <wpc:parameter name="DeleteProvState" variable="DeleteProvState"/>
                        <wpc:parameter name="DeleteRequestState" variable="DeleteRequestState"/>
                        <wpc:parameter name="UpdateRequestState" variable="UpdateRequestState"/>
                        <wpc:parameter name="SDP_ORDER_GrpMBoxInfoPort" variable="SDP_ORDER_GrpMBoxInfoPort"/>
                        <wpc:parameter name="IndexChangeUpdateState" variable="IndexChangeUpdateState"/>
                        <wpc:parameter name="SetSubscriberSettingsBySub" variable="SetSubscriberSettingsBySub"/>
                        <wpc:parameter name="PinChangeUpdateState" variable="PinChangeUpdateState"/>
                        <wpc:parameter name="TnChangeUpdateState" variable="TnChangeUpdateState"/>
                        <wpc:parameter name="AddServiceState" variable="AddServiceState"/>
                        <wpc:parameter name="RemoveServiceState" variable="RemoveServiceState"/>
                      </wpc:input>
                      <wpc:output>
                        <wpc:parameter name="TransactionDetailPort" variable="TrasationDetail_Port"/>
                        <wpc:parameter name="SdpOrderPort" variable="SDP_ORDER_Port"/>
                      </wpc:output>
                    </bpws:invoke>
                    <bpws:invoke name="LogUpdateMailBoxConfigCompensation21" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [ UpdateMailBoxConfigCompensation]" wpc:id="2888">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[
SdpLoggerHelper.logMessage("Received the following GBO from SubFlow : UpdateMailBoxConfigCompensation  ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("TrasationDetail_Port : ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(TrasationDetail_Port,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                    <bpws:invoke name="MergeRollBackedMailboxesintoProc12" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Merge RollBacked Mailboxes into Proc" wpc:id="2890">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[DataObject tmpMailbox = null;
List lstAccountMailboxes = null;
Iterator itrAccountMailboxes = null;
List lstMailboxes = null;

SdpLoggerHelper.logMessage("Merging the RolledBack mailboxes into the response SdpOrder",
	PROCESS_NAME,processID,SdpLoggerHelper.DEBUG);

try {
	lstAccountMailboxes = 
		SDP_ORDER_Port.getList(SdpHelper.VOIP_ACCOUNTMAILBOXES_PATH.replace('.','/'));
	itrAccountMailboxes = lstAccountMailboxes.iterator();
	
	lstMailboxes = MailboxConfig_Proc.getList(SdpHelper.VOIP_ACCOUNTMAILBOXES_PATH.replace('.','/'));
	
	while(itrAccountMailboxes.hasNext())
	{		
		tmpMailbox = SDO.copy((DataObject) itrAccountMailboxes.next());
		lstMailboxes.add(tmpMailbox);
	}
}
catch(Exception ex)
{
	SdpLoggerHelper.logMessage("Failed during Merge the RolledBack mailboxes into response SdpOrder",
		PROCESS_NAME,processID,SdpLoggerHelper.DEBUG);
	SdpLoggerHelper.logMessage("Exception : " + ex,
		PROCESS_NAME,processID,SdpLoggerHelper.DEBUG);
}]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                    <bpws:assign name="MergerProctoTrig14" wpc:displayName="Merger Proc to Trig" wpc:id="2891">
                      <bpws:copy>
                        <bpws:from variable="MailboxConfig_Proc"/>
                        <bpws:to variable="MailboxConfigRequest_Trig"/>
                      </bpws:copy>
                      <bpws:copy>
                        <bpws:from variable="sdpProcessContext"/>
                        <bpws:to variable="MailboxConfigRequest_Trig">
                          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/ProcessContext]]></bpws:query>
                        </bpws:to>
                      </bpws:copy>
                    </bpws:assign>
                    <bpws:invoke name="LogEndProcess3" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [End Process]" wpc:id="2893">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[
SdpLoggerHelper.logMessage("Returning the following GBO To MAM ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("Provisioned [MailboxConfigRequest_Trig ]: ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(MailboxConfigRequest_Trig,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("End - UpdateMailBoxConfig",PROCESS_NAME,processID,SdpLoggerHelper.INFO);]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                    <bpws:reply name="ReplyMPSError6" operation="UpdateMailboxConfig" partnerLink="FromMam_FeaturePermissionMailboxUpdate_Interface" portType="ns3:FromMam_FeaturePermissionMailboxUpdate_Interface" wpc:displayName="Reply MPS Error" wpc:id="2894">
                      <wpc:input>
                        <wpc:parameter name="mailboxConfigResponse" variable="MailboxConfigRequest_Trig"/>
                      </wpc:input>
                    </bpws:reply>
                    <bpws:terminate name="Terminate12" wpc:displayName="Terminate" wpc:id="2895"/>
                  </bpws:sequence>
                </bpws:catch>
              </bpws:invoke>
              <bpws:invoke name="LogMPSUpdateUserSuccess" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [MPS.UpdateUser -Success]" wpc:id="2876">
                <wpc:script>
                  <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage("MPS.updateUser :-"+SdpLoggerHelper.SUCCESS_STR,PROCESS_NAME,processID
														,SdpLoggerHelper.INFO);
SdpLoggerHelper.logMessage("Response BO [TrasationDetail]",PROCESS_NAME,processID,SdpLoggerHelper.INFO);
SdpLoggerHelper.logMessage("TrasationDetail_Port:",PROCESS_NAME,processID,SdpLoggerHelper.INFO);														
SdpLoggerHelper.logBO(TrasationDetail_Port,PROCESS_NAME,processID,SdpLoggerHelper.INFO);
																		]]></wpc:javaCode>
                </wpc:script>
              </bpws:invoke>
              <bpws:invoke name="AddmemberProfileforRollBack" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Add memberProfile for RollBack" wpc:id="2930">
                <wpc:script>
                  <wpc:javaCode><![CDATA[Order orderBO = new Order(TnChangeUpdateState);
orderBO.getMemberProfileList().add(SDO.copy(tmpMemProf));
]]></wpc:javaCode>
                </wpc:script>
              </bpws:invoke>
              <bpws:invoke name="LogMPSassociateUserMailbox" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [MPS.associateUserMailbox ]" wpc:id="2330">
                <wpc:script>
                  <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage(SdpLoggerHelper.INVOKE_STR +" : MPS.associateUserMailbox",PROCESS_NAME,processID
														,SdpLoggerHelper.INFO);
														
//SdpLoggerHelper.logMessage("Request BO:[SDP_ORDER]",PROCESS_NAME,processID
//														,SdpLoggerHelper.INFO);
//SdpLoggerHelper.logMessage("UpdateSubscriberInput:",PROCESS_NAME,processID
//														,SdpLoggerHelper.INFO);

														
//SdpLoggerHelper.logBO(UpdateSubscriberInput,PROCESS_NAME,processID,SdpLoggerHelper.INFO);
]]></wpc:javaCode>
                </wpc:script>
              </bpws:invoke>
              <bpws:invoke name="MPSAssociateUsertoMailbox" operation="associateUserMailbox" partnerLink="MPSCompensableService2_InterfacePartner" portType="ns35:MPSCompensableService2_Interface" wpc:displayName="MPS Associate User to Mailbox" wpc:id="1308">
                <wpc:input>
                  <wpc:parameter name="order" variable="UpdateSubscriberInput"/>
                </wpc:input>
                <wpc:output/>
                <bpws:catch faultName="ns35:serviceCallFault" faultVariable="scFault" wpc:faultType="java:ServiceCallFault" wpc:id="3028" wpc:variableId="1309">
                  <bpws:sequence name="HiddenSequence16" wpc:id="1073744647">
                    <bpws:assign name="SetErrorDetails11" wpc:displayName="Set Error Details" wpc:id="2872">
                      <bpws:copy>
                        <bpws:from><![CDATA[11016]]></bpws:from>
                        <bpws:to variable="TrasationDetail_Port">
                          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/Message/MessageCode]]></bpws:query>
                        </bpws:to>
                      </bpws:copy>
                      <bpws:copy>
                        <bpws:from><![CDATA[SDP_Downstream_System_Error]]></bpws:from>
                        <bpws:to variable="TrasationDetail_Port">
                          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/Message/MessageText]]></bpws:query>
                        </bpws:to>
                      </bpws:copy>
                      <bpws:copy>
                        <bpws:from>FATAL</bpws:from>
                        <bpws:to variable="TrasationDetail_Port">
                          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/Severity]]></bpws:query>
                        </bpws:to>
                      </bpws:copy>
                      <bpws:copy>
                        <bpws:from variable="scFault">
                          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[messageDetail]]></bpws:query>
                        </bpws:from>
                        <bpws:to variable="TrasationDetail_Port">
                          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[errorDetails/Error/Message/MessageDetail]]></bpws:query>
                        </bpws:to>
                      </bpws:copy>
                    </bpws:assign>
                    <bpws:invoke name="HandleRuntimefailure8" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Handle Run time failure" wpc:id="1416">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[TrasationDetail_Port.setBoolean("errorIndicator", true);
SdpLoggerHelper.logMessage(SdpLoggerHelper.RUNTIME_FAILURE+" MPS.associateUserMailbox",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);
SdpLoggerHelper.logBO(scFault,PROCESS_NAME,processID,SdpLoggerHelper.FATAL);

/*
SdpErrorHelper.setErrDetInTransDet(TrasationDetail_Port,scFault,SdpErrorHelper.SEVERITY_FATAL);

SdpLoggerHelper.logMessage(SdpLoggerHelper.RUNTIME_FAILURE+"  MPS.UpdateUser",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);

DataObject responseMessage = (DataObject)TrasationDetail_Port.getDataObject("errorDetails/Error/Message");
responseMessage.setString(SdpHelper.ERRORDETAILS_MESSAGE_CODE,SdpErrorHelper.SDP_INTERNAL_SYSTEM_ERROR);
*/]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                    <bpws:invoke name="LogUpdateMailBoxConfigCompensation20" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UpdateMailBoxConfigCompensation ]" wpc:id="2334">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[
SdpLoggerHelper.logMessage(SdpLoggerHelper.INVOKE_STR +" SubFlow : UpdateMailBoxConfigCompensation",PROCESS_NAME,processID,SdpLoggerHelper.INFO);
SdpLoggerHelper.logMessage("Request BOs : ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("CreateRequestState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(CreateRequestState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("CreateProvState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(CreateProvstate,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("DeleteRequestState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(DeleteRequestState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("DeleteProvState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(DeleteProvState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("UpdateRequestState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(UpdateRequestState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("UpdateProvState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(UpdateProvState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("TransactionDetailPort :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(TrasationDetail_Port,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("SDP_ORDER_GrpMBoxInfoPort :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(SDP_ORDER_GrpMBoxInfoPort,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("IndexChangeUpdateState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(IndexChangeUpdateState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("SetSubscriberSettingsBySub :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(SetSubscriberSettingsBySub,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("PinChangeUpdateState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(PinChangeUpdateState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("TnChangeUpdateState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(TnChangeUpdateState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("AddServiceState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(AddServiceState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("RemoveServiceState :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(RemoveServiceState,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

CreateRequestState.setString(SdpHelper.TEMPSTRING2_PATH.replace('.','/'),processID);
]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                    <bpws:assign name="MergeMPSerrortoProcobject6" wpc:displayName="Merge MPS error to Proc object" wpc:id="2497">
                      <bpws:copy>
                        <bpws:from variable="TrasationDetail_Port"/>
                        <bpws:to variable="MailboxConfig_Proc">
                          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail]]></bpws:query>
                        </bpws:to>
                      </bpws:copy>
                    </bpws:assign>
                    <bpws:invoke name="CallUpdateMailBoxConfigCompensate10" operation="compensateUpdateMailBoxConfig" partnerLink="UpdateMailBoxConfig_Compensation_Interface" portType="ns31:UpdateMailBoxConfig_Compensation_Interface" wpc:displayName="call UpdateMailBoxConfig Compensate" wpc:id="2181">
                      <wpc:input>
                        <wpc:parameter name="CreateProvState" variable="CreateProvstate"/>
                        <wpc:parameter name="CreateRequestState" variable="CreateRequestState"/>
                        <wpc:parameter name="UpdateProvState" variable="UpdateProvState"/>
                        <wpc:parameter name="TransactionDetailPort" variable="TrasationDetail_Port"/>
                        <wpc:parameter name="DeleteProvState" variable="DeleteProvState"/>
                        <wpc:parameter name="DeleteRequestState" variable="DeleteRequestState"/>
                        <wpc:parameter name="UpdateRequestState" variable="UpdateRequestState"/>
                        <wpc:parameter name="SDP_ORDER_GrpMBoxInfoPort" variable="SDP_ORDER_GrpMBoxInfoPort"/>
                        <wpc:parameter name="IndexChangeUpdateState" variable="IndexChangeUpdateState"/>
                        <wpc:parameter name="SetSubscriberSettingsBySub" variable="SetSubscriberSettingsBySub"/>
                        <wpc:parameter name="PinChangeUpdateState" variable="PinChangeUpdateState"/>
                        <wpc:parameter name="TnChangeUpdateState" variable="TnChangeUpdateState"/>
                        <wpc:parameter name="AddServiceState" variable="AddServiceState"/>
                        <wpc:parameter name="RemoveServiceState" variable="RemoveServiceState"/>
                      </wpc:input>
                      <wpc:output>
                        <wpc:parameter name="TransactionDetailPort" variable="TrasationDetail_Port"/>
                        <wpc:parameter name="SdpOrderPort" variable="SDP_ORDER_Port"/>
                      </wpc:output>
                    </bpws:invoke>
                    <bpws:invoke name="LogUpdateMailBoxConfigCompensation21" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [ UpdateMailBoxConfigCompensation]" wpc:id="2336">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[
SdpLoggerHelper.logMessage("Received the following GBO from SubFlow : UpdateMailBoxConfigCompensation  ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("TrasationDetail_Port : ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(TrasationDetail_Port,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                    <bpws:invoke name="MergeRollBackedMailboxesintoProc12" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Merge RollBacked Mailboxes into Proc" wpc:id="2804">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[DataObject tmpMailbox = null;
List lstAccountMailboxes = null;
Iterator itrAccountMailboxes = null;
List lstMailboxes = null;

SdpLoggerHelper.logMessage("Merging the RolledBack mailboxes into the response SdpOrder",
	PROCESS_NAME,processID,SdpLoggerHelper.DEBUG);

try {
	lstAccountMailboxes = 
		SDP_ORDER_Port.getList(SdpHelper.VOIP_ACCOUNTMAILBOXES_PATH.replace('.','/'));
	itrAccountMailboxes = lstAccountMailboxes.iterator();
	
	lstMailboxes = MailboxConfig_Proc.getList(SdpHelper.VOIP_ACCOUNTMAILBOXES_PATH.replace('.','/'));
	
	while(itrAccountMailboxes.hasNext())
	{		
		tmpMailbox = SDO.copy((DataObject) itrAccountMailboxes.next());
		lstMailboxes.add(tmpMailbox);
	}
}
catch(Exception ex)
{
	SdpLoggerHelper.logMessage("Failed during Merge the RolledBack mailboxes into response SdpOrder",
		PROCESS_NAME,processID,SdpLoggerHelper.DEBUG);
	SdpLoggerHelper.logMessage("Exception : " + ex,
		PROCESS_NAME,processID,SdpLoggerHelper.DEBUG);
}]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                    <bpws:assign name="MergerProctoTrig14" wpc:displayName="Merger Proc to Trig" wpc:id="2469">
                      <bpws:copy>
                        <bpws:from variable="MailboxConfig_Proc"/>
                        <bpws:to variable="MailboxConfigRequest_Trig"/>
                      </bpws:copy>
                      <bpws:copy>
                        <bpws:from variable="sdpProcessContext"/>
                        <bpws:to variable="MailboxConfigRequest_Trig">
                          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/ProcessContext]]></bpws:query>
                        </bpws:to>
                      </bpws:copy>
                    </bpws:assign>
                    <bpws:invoke name="LogEndProcess3" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [End Process]" wpc:id="2419">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[
SdpLoggerHelper.logMessage("Returning the following GBO To MAM ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("Provisioned [MailboxConfigRequest_Trig ]: ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(MailboxConfigRequest_Trig,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("End - UpdateMailBoxConfig",PROCESS_NAME,processID,SdpLoggerHelper.INFO);]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                    <bpws:reply name="ReplyMPSError6" operation="UpdateMailboxConfig" partnerLink="FromMam_FeaturePermissionMailboxUpdate_Interface" portType="ns3:FromMam_FeaturePermissionMailboxUpdate_Interface" wpc:displayName="Reply MPS Error" wpc:id="1322">
                      <wpc:input>
                        <wpc:parameter name="mailboxConfigResponse" variable="MailboxConfigRequest_Trig"/>
                      </wpc:input>
                    </bpws:reply>
                    <bpws:terminate name="Terminate12" wpc:displayName="Terminate" wpc:id="1822"/>
                  </bpws:sequence>
                </bpws:catch>
              </bpws:invoke>
              <bpws:invoke name="LogMPSassociateUserMailboxSuccess" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [MPS.associateUserMailbox -Success]" wpc:id="2402">
                <wpc:script>
                  <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage("MPS.associateUserMailbox :-"+SdpLoggerHelper.SUCCESS_STR,PROCESS_NAME,processID
														,SdpLoggerHelper.INFO);
SdpLoggerHelper.logMessage("Response BO [TrasationDetail]",PROCESS_NAME,processID,SdpLoggerHelper.INFO);
SdpLoggerHelper.logMessage("TrasationDetail_Port:",PROCESS_NAME,processID,SdpLoggerHelper.INFO);														
SdpLoggerHelper.logBO(TrasationDetail_Port,PROCESS_NAME,processID,SdpLoggerHelper.INFO);
																		]]></wpc:javaCode>
                </wpc:script>
              </bpws:invoke>
              <bpws:invoke name="IncrementProvandReInitializeReqCounter" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Increment Prov and Re Initialize Req Counter" wpc:id="1326">
                <wpc:script>
                  <wpc:javaCode><![CDATA[intProvCounter= new Integer(intProvCounter.intValue() + 1);
]]></wpc:javaCode>
                </wpc:script>
              </bpws:invoke>
            </bpws:sequence>
          </bpws:while>
        </bpws:sequence>
      </bpws:onMessage>
    </bpws:pick>
    <bpws:invoke name="SetMailboxInvariantIdtoProc" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Set MailboxInvariantId to Proc" wpc:id="2585">
      <wpc:script>
        <wpc:javaCode><![CDATA[DataObject tmpReqMBox = null;
DataObject tmpMailBox = null;

Iterator itrReqMbox = null;

List lstMBoxUpdated = null;
List lstMBoxRequest = null;

String strInvariantId = null;

lstMBoxRequest = MailboxConfig_Proc.getList(SdpHelper.VOIP_ACCOUNTMAILBOXES_PATH.replace('.', '/'));

if(SDP_Order_Prov_Updated != null)
{	
	lstMBoxUpdated = SDP_Order_Prov_Updated.getList(SdpHelper.VOIP_ACCOUNTMAILBOXES_PATH.replace('.', '/'));

	int lstMBoxUpdatedSize = lstMBoxUpdated.size(); 
	
	SdpLoggerHelper.logMessage("Before Assigning MailboxInvariantId ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);
	
	SdpLoggerHelper.logMessage("SDP_Order_Prov_Updated: ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

	SdpLoggerHelper.logBO(SDP_Order_Prov_Updated,PROCESS_NAME,processID,SdpLoggerHelper.INFO);
	
	SdpLoggerHelper.logMessage("MailboxConfig_Proc: ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

	SdpLoggerHelper.logBO(MailboxConfig_Proc,PROCESS_NAME,processID,SdpLoggerHelper.INFO);
	
	
	if(lstMBoxUpdated != null && lstMBoxUpdated.size() > 0 && 
		lstMBoxRequest != null && lstMBoxRequest.size() > 0)
	{			
		itrReqMbox = lstMBoxRequest.iterator();
		
		while (itrReqMbox.hasNext())
		{
			tmpReqMBox = (DataObject) itrReqMbox.next();
		
			SdpLoggerHelper.logMessage("Comparing the request Mailboxes with UpdatedMailboxes",
				PROCESS_NAME,processID,SdpLoggerHelper.INFO);
			
			if (tmpReqMBox != null && 
				tmpReqMBox.getString(SdpHelper.CVOIP_MAILBOX_MAILBOXINVARIANTID).trim().length() > 0)
			{
				strInvariantId = tmpReqMBox.getString(SdpHelper.CVOIP_MAILBOX_MAILBOXINVARIANTID).trim();
				
				SdpLoggerHelper.logMessage("Comparing the Mailbox[" + strInvariantId + 
					"] with UpdatedMailboxes",PROCESS_NAME,processID,SdpLoggerHelper.INFO);
				
				tmpMailBox = SdpHelper.getMailBox(SDP_Order_Prov_Updated, strInvariantId);
				
				if (tmpMailBox == null)
				{
					SdpLoggerHelper.logMessage("Mailbox[" + strInvariantId + 
						"] not found in UpdatedMailboxes so the same is added to updatedMailboxList",
						PROCESS_NAME,processID,SdpLoggerHelper.INFO);
				
					lstMBoxUpdated.add(SDO.copy(tmpReqMBox));					
				}
			}
		}
		
		if (lstMBoxUpdatedSize < lstMBoxUpdated.size())
		{
			MailboxConfig_Proc.setList(SdpHelper.VOIP_ACCOUNTMAILBOXES_PATH.replace('.', '/'),lstMBoxUpdated);
		}
	}
}]]></wpc:javaCode>
      </wpc:script>
    </bpws:invoke>
    <bpws:assign name="AssignSucessStatusandMergePorttoProc" wpc:displayName="Assign Sucess Status and Merge Port to Proc" wpc:id="1202">
      <bpws:copy>
        <bpws:from>0</bpws:from>
        <bpws:to variable="MailboxConfig_Proc">
          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/errorDetails/Error/Message/MessageCode]]></bpws:query>
        </bpws:to>
      </bpws:copy>
      <bpws:copy>
        <bpws:from>Success</bpws:from>
        <bpws:to variable="MailboxConfig_Proc">
          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/errorDetails/Error/Message/MessageText]]></bpws:query>
        </bpws:to>
      </bpws:copy>
      <bpws:copy>
        <bpws:from variable="MailboxConfig_Proc"/>
        <bpws:to variable="MailboxConfigRequest_Trig"/>
      </bpws:copy>
      <bpws:copy>
        <bpws:from variable="sdpProcessContext"/>
        <bpws:to variable="MailboxConfigRequest_Trig">
          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/ProcessContext]]></bpws:query>
        </bpws:to>
      </bpws:copy>
    </bpws:assign>
    <bpws:invoke name="LogEndProcess" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log -[End Process]" wpc:id="2357">
      <wpc:script>
        <wpc:javaCode><![CDATA[
SdpLoggerHelper.logMessage("Returning the following GBO To MAM ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("Provisioned [MailboxConfigRequest_Trig ]: ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(MailboxConfigRequest_Trig,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("End - UpdateMailBoxConfig",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

]]></wpc:javaCode>
      </wpc:script>
    </bpws:invoke>
    <bpws:reply name="Reply" operation="UpdateMailboxConfig" partnerLink="FromMam_FeaturePermissionMailboxUpdate_Interface" portType="ns3:FromMam_FeaturePermissionMailboxUpdate_Interface" wpc:displayName="Reply" wpc:id="7">
      <wpc:input>
        <wpc:parameter name="mailboxConfigResponse" variable="MailboxConfigRequest_Trig"/>
      </wpc:input>
    </bpws:reply>
  </bpws:sequence>
</bpws:process>