<?xml version="1.0" encoding="UTF-8"?><bpws:process xmlns:bpws="http://schemas.xmlsoap.org/ws/2004/03/business-process/" xmlns:java="http://SdpCommonLibrary" xmlns:ns="http://MamMemberServicesProcessModule/com/att/sdp/bprocess/CreateNewMailBoxArtifacts" xmlns:ns0="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_Order" xmlns:ns1="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_TransactionDetail" xmlns:ns10="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_ErrorObject_Message" xmlns:ns11="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_ServiceCvoipSettings" xmlns:ns12="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_AccountMailBoxes" xmlns:ns13="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_MemberTNS" xmlns:ns14="http://SdpCommonLibrary/com/att/sdp/intf/FromSdp_ErrorLogger_Interface" xmlns:ns15="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_Account" xmlns:ns16="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_CVoipTNInfo" xmlns:ns17="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_MailBoxMembers" xmlns:ns18="http://MamMemberServicesProcessModule/com/att/sdp/intf/FromMam_DeleteMailBox_Interface" xmlns:ns19="http://SdpCommonLibrary/com/att/sdp/intf/FromMam_FeaturePermissionMailboxUpdate_Interface" xmlns:ns2="http://MamMemberServicesProcessModule/com/att/sdp/intf/FromMam_CreateNewMailBox_Interface" xmlns:ns20="http://MamMemberServicesProcessModule/com/att/sdp/intf/DeleteMailBox_Compensation_Interface" xmlns:ns21="http://SdpCommonLibrary/com/att/sdp/intf/FromSdp_CommonErrorLogger_Interface" xmlns:ns22="http://SdpCommonLibrary/com/att/sdp/intf/UcdclOutputServiceWrapper_Interface" xmlns:ns23="http://SdpCommonLibrary/com/att/sdp/intf/MPSCompensableService2_Interface" xmlns:ns24="http://MamMemberServicesProcessModule/com/att/sdp/bprocess/DeleteMailBoxCompensation" xmlns:ns25="http://SdpCommonLibrary/com/att/sdp/intf/UCDCLCompensableService_Interface" xmlns:ns3="http://SdpCommonLibrary/com/att/sdp/intf/ToUCDCL_ProvisioningService_Interface" xmlns:ns4="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_Person" xmlns:ns5="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_TelephoneNumber" xmlns:ns6="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_PersonName" xmlns:ns7="http://SdpCommonLibrary/com/att/sdp/intf/ToUCDCL_SubscriberService_Interface" xmlns:ns8="http://SdpCommonLibrary/com/att/sdp/intf/To_WESM" xmlns:ns9="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_Error" xmlns:wpc="http://www.ibm.com/xmlns/prod/websphere/business-process/6.0.0/" xmlns:xsd="http://www.w3.org/2001/XMLSchema" expressionLanguage="http://www.ibm.com/xmlns/prod/websphere/business-process/expression-lang/java/6.0.0/" name="DeleteMailBox_Compensation" suppressJoinFailure="yes" targetNamespace="http://MamMemberServicesProcessModule/com/att/sdp/bprocess" wpc:displayName="DeleteMailBox_Compensation" wpc:executionMode="microflow" wpc:id="1" wpc:version="IBM_8.5.0">
  <wpc:javaGlobals>
    <wpc:import packages="sbc.lightspeed.sdp.wps.SdpErrorHelper"/>
    <wpc:import packages="sbc.lightspeed.sdp.wps.SdpHelper"/>
    <wpc:import packages="sbc.lightspeed.sdp.wps.SdpLoggerHelper"/>
    <wpc:import packages="commonj.sdo.DataObject"/>
    <wpc:import packages="java.util.List"/>
    <wpc:import packages="com.att.sdp.utils.MamMemberServiceHelper"/>
    <wpc:import packages="java.util.Iterator"/>
    <wpc:import packages="att.lightspeed.sdp.helper.Product"/>
    <wpc:import packages="att.lightspeed.sdp.helper.Order"/>
    <wpc:import packages="att.lightspeed.sdp.helper.CvoipConfig"/>
    <wpc:import packages="att.lightspeed.sdp.helper.PropertyReadException"/>
    <wpc:import packages="com.att.sdp.util.StringUtil"/>
  </wpc:javaGlobals>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../../../../../MamMemberServicesProcessModuleBackUp/com/att/sdp/intf/FromMam_CreateNewMailBox_Interface.wsdl" namespace="http://MamMemberServicesProcessModule/com/att/sdp/intf/FromMam_CreateNewMailBox_Interface"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../SDP_Order.xsd" namespace="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_Order"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="DeleteMailBox_CompensationArtifacts.wsdl" namespace="http://MamMemberServicesProcessModule/com/att/sdp/bprocess/DeleteMailBoxCompensation"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../SDP_TransactionDetail.xsd" namespace="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_TransactionDetail"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../intf/SDP_Order_to_UCDCL_ProvisioningService.wsdl" namespace="http://SdpCommonLibrary/com/att/sdp/intf/ToUCDCL_ProvisioningService_Interface"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../SDP_TelephoneNumber.xsd" namespace="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_TelephoneNumber"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../SDP_Person.xsd" namespace="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_Person"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../SDP_PersonName.xsd" namespace="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_PersonName"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../intf/SDP_Order_to_UCDCL_SubscriberService.wsdl" namespace="http://SdpCommonLibrary/com/att/sdp/intf/ToUCDCL_SubscriberService_Interface"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../intf/To_WESM.wsdl" namespace="http://SdpCommonLibrary/com/att/sdp/intf/To_WESM"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../BPCStandardFaultType.xsd" namespace="http://www.ibm.com/xmlns/prod/websphere/business-process/6.0.0/"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../SDP_Error.xsd" namespace="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_Error"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../SDP_ErrorObject_Message.xsd" namespace="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_ErrorObject_Message"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../SDP_ServiceCvoipSettings.xsd" namespace="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_ServiceCvoipSettings"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../SDP_AccountMailBoxes.xsd" namespace="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_AccountMailBoxes"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../SDP_MemberTNS.xsd" namespace="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_MemberTNS"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../intf/FromSdp_ErrorLogger_Interface.wsdl" namespace="http://SdpCommonLibrary/com/att/sdp/intf/FromSdp_ErrorLogger_Interface"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../SDP_Account.xsd" namespace="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_Account"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../SDP_CVoipTNInfo.xsd" namespace="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_CVoipTNInfo"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../SDP_MailBoxMembers.xsd" namespace="http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_MailBoxMembers"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../../../../../MamMemberServicesProcessModuleBackUp/com/att/sdp/intf/FromMam_DeleteMailBox_Interface.wsdl" namespace="http://MamMemberServicesProcessModule/com/att/sdp/intf/FromMam_DeleteMailBox_Interface"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../intf/FromMam_FeaturePermissionMailboxUpdate_Interface.wsdl" namespace="http://SdpCommonLibrary/com/att/sdp/intf/FromMam_FeaturePermissionMailboxUpdate_Interface"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../../../../../MamMemberServicesProcessModuleBackUp/com/att/sdp/bprocess/CreateNewMailBoxArtifacts.wsdl" namespace="http://MamMemberServicesProcessModule/com/att/sdp/bprocess/CreateNewMailBoxArtifacts"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../../../../../MamMemberServicesProcessModulebackup/com/att/sdp/intf/FromMam_CreateNewMailBox_Interface.wsdl" namespace="http://MamMemberServicesProcessModule/com/att/sdp/intf/FromMam_CreateNewMailBox_Interface"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../../../../../MamMemberServicesProcessModulebackup/com/att/sdp/bprocess/CreateNewMailBoxArtifacts.wsdl" namespace="http://MamMemberServicesProcessModule/com/att/sdp/bprocess/CreateNewMailBoxArtifacts"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../../../../../MamMemberServicesProcessModulebackup/com/att/sdp/intf/FromMam_DeleteMailBox_Interface.wsdl" namespace="http://MamMemberServicesProcessModule/com/att/sdp/intf/FromMam_DeleteMailBox_Interface"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="CreateNewMailBoxArtifacts.wsdl" namespace="http://MamMemberServicesProcessModule/com/att/sdp/bprocess/CreateNewMailBoxArtifacts"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../../../../../MamMemberServicesProcessModule_Old/com/att/sdp/intf/FromMam_DeleteMailBox_Interface.wsdl" namespace="http://MamMemberServicesProcessModule/com/att/sdp/intf/FromMam_DeleteMailBox_Interface"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../../../../../MamMemberServicesProcessModule_Old/com/att/sdp/intf/FromMam_CreateNewMailBox_Interface.wsdl" namespace="http://MamMemberServicesProcessModule/com/att/sdp/intf/FromMam_CreateNewMailBox_Interface"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../../../../../MamMemberServicesProcessModule_Old/com/att/sdp/intf/DeleteMailBox_Compensation_Interface.wsdl" namespace="http://MamMemberServicesProcessModule/com/att/sdp/intf/DeleteMailBox_Compensation_Interface"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../../../../FromSdp_CommonErrorLogger_Interface.wsdl" namespace="http://SdpCommonLibrary/com/att/sdp/intf/FromSdp_CommonErrorLogger_Interface"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../../../../../MamMemberServicesProcessModule_Old/com/att/sdp/intf/DeleteMailBox_Compensation_Interface.wsdl" namespace="http://MamMemberServicesProcessModule/com/att/sdp/intf/DeleteMailBox_Compensation_Interface"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../../../../../MamMemberServicesProcessModule_Old/com/att/sdp/intf/DeleteMailBox_Compensation_Interface.wsdl" namespace="http://MamMemberServicesProcessModule/com/att/sdp/intf/DeleteMailBox_Compensation_Interface"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../intf/DeleteMailBox_Compensation_Interface.wsdl" namespace="http://MamMemberServicesProcessModule/com/att/sdp/intf/DeleteMailBox_Compensation_Interface"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../intf/UcdclOutputServiceWrapper_Interface.wsdl" namespace="http://SdpCommonLibrary/com/att/sdp/intf/UcdclOutputServiceWrapper_Interface"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="/resource/SdpCommonLibrary/com/att/sdp/intf/MPSCompensableService2_Interface.wsdl" namespace="http://SdpCommonLibrary/com/att/sdp/intf/MPSCompensableService2_Interface"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../intf/MPSCompensableService2_Interface.wsdl" namespace="http://SdpCommonLibrary/com/att/sdp/intf/MPSCompensableService2_Interface"/>
  <bpws:import importType="http://www.w3.org/2001/XMLSchema" location="../../../../ServiceCallFault.xsd" namespace="http://SdpCommonLibrary"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="/resource/SdpCommonLibrary/com/att/sdp/intf/UcdclOutputServiceWrapper_Interface.wsdl" namespace="http://SdpCommonLibrary/com/att/sdp/intf/UcdclOutputServiceWrapper_Interface"/>
  <bpws:import importType="http://schemas.xmlsoap.org/wsdl/" location="../intf/UCDCLCompensableService_Interface.wsdl" namespace="http://SdpCommonLibrary/com/att/sdp/intf/UCDCLCompensableService_Interface"/>
  <bpws:partnerLinks>
    <bpws:partnerLink myRole="myRole" name="DeleteMailBox_Compensation_Interface" partnerLinkType="ns24:PartnerPLT" wpc:id="1841"/>
    <bpws:partnerLink name="FromSdp_CommonErrorLogger_Interface" partnerLinkType="ns24:PartnerPLT1" partnerRole="partnerRole" wpc:id="1842"/>
    <bpws:partnerLink name="MPSCompensableService2_InterfacePartner" partnerLinkType="ns:MPSCompensableService2_InterfacePLT" partnerRole="MPSCompensableService2_InterfaceRole" wpc:id="1843"/>
    <bpws:partnerLink name="UcdclCompensableServicePartner_Interface" partnerLinkType="ns24:PartnerPLT2" partnerRole="partnerRole" wpc:id="1844"/>
  </bpws:partnerLinks>
  <bpws:variables>
    <bpws:variable name="EmptyTransaction_Detail" type="ns1:SDP_TransactionDetail" wpc:id="4"/>
    <bpws:variable name="ucdclEmailOrPhone" type="xsd:string" wpc:id="9"/>
    <bpws:variable name="ucdclTelePhoneNumber" type="ns16:SDP_CVoipTNInfo" wpc:id="11"/>
    <bpws:variable name="ucdclDeviceNumber" type="xsd:string" wpc:id="21"/>
    <bpws:variable name="ucdclDeviceType" type="xsd:string" wpc:id="22"/>
    <bpws:variable name="ucdclDeviceCFN" type="xsd:string" wpc:id="23"/>
    <bpws:variable name="ucdclAuthentication" type="xsd:string" wpc:id="24"/>
    <bpws:variable name="ucdclTransportMWI" type="xsd:string" wpc:id="25"/>
    <bpws:variable name="EmptyErrorObject" type="ns9:SDP_Error" wpc:id="113"/>
    <bpws:variable name="currentMBox" type="ns12:SDP_AccountMailBoxes" wpc:id="125"/>
    <bpws:variable name="intListCounter" type="xsd:int" wpc:id="126"/>
    <bpws:variable name="intTNListCounter" type="xsd:int" wpc:id="136"/>
    <bpws:variable name="sdpOrderTrig" type="ns0:SDP_Order" wpc:id="200"/>
    <bpws:variable name="sdpOrderProc" type="ns0:SDP_Order" wpc:id="201"/>
    <bpws:variable name="provSdpOrderTrig" type="ns0:SDP_Order" wpc:id="202"/>
    <bpws:variable name="provSdpOrderProc" type="ns0:SDP_Order" wpc:id="203"/>
    <bpws:variable name="sdpOrderPort" type="ns0:SDP_Order" wpc:id="205"/>
    <bpws:variable name="sdpAccount" type="ns15:SDP_Account" wpc:id="209"/>
    <bpws:variable name="mainMailBox" type="ns12:SDP_AccountMailBoxes" wpc:id="224"/>
    <bpws:variable name="sdpOrderForUpdate" type="ns0:SDP_Order" wpc:id="308"/>
    <bpws:variable name="currentTN" type="ns13:SDP_MemberTNS" wpc:id="324"/>
    <bpws:variable name="firstmailboxTN" type="ns13:SDP_MemberTNS" wpc:id="343"/>
    <bpws:variable name="SDP_ORDER_RequestPort" type="ns0:SDP_Order" wpc:id="464"/>
    <bpws:variable name="SDP_ORDER_ProvPort" type="ns0:SDP_Order" wpc:id="465"/>
    <bpws:variable name="RollBackState" type="xsd:int" wpc:id="532"/>
    <bpws:variable name="SDP_ERROR_OBJECT_MESSAGE" type="ns10:SDP_ErrorObject_Message" wpc:id="538"/>
    <bpws:variable name="MANUAL_INTERVENTION_FLAG" type="xsd:boolean" wpc:id="539"/>
    <bpws:variable name="PARENT_PROCESS_NAME" type="xsd:string" wpc:id="540"/>
    <bpws:variable name="TARGET_OPERATION_NAME" type="xsd:string" wpc:id="541"/>
    <bpws:variable name="TARGET_SYSTEM_NAME" type="xsd:string" wpc:id="542"/>
    <bpws:variable name="SEVERITY" type="xsd:string" wpc:id="543"/>
    <bpws:variable name="STATE" type="xsd:string" wpc:id="544"/>
    <bpws:variable name="TransactionDetail_Error" type="ns1:SDP_TransactionDetail" wpc:id="547"/>
    <bpws:variable name="TransactionDetailPort" type="ns1:SDP_TransactionDetail" wpc:id="561"/>
    <bpws:variable name="PROCESS_NAME" type="xsd:string" wpc:id="642"/>
    <bpws:variable name="processID" type="xsd:string" wpc:id="643"/>
    <bpws:variable name="SDP_AccountMailBoxes_Port" type="ns12:SDP_AccountMailBoxes" wpc:id="656"/>
    <bpws:variable name="errorLevel" type="xsd:int" wpc:id="659"/>
    <bpws:variable name="loginId" type="xsd:string" wpc:id="968"/>
    <bpws:variable name="invariantId" type="xsd:string" wpc:id="1023"/>
    <bpws:variable name="intCounter" type="xsd:int" wpc:id="1155"/>
    <bpws:variable name="isSecondaryMailboxCreated" type="xsd:boolean" wpc:id="1156"/>
    <bpws:variable name="sdpOrderForIndex" type="ns0:SDP_Order" wpc:id="1641"/>
    <bpws:variable name="UMSessionID" type="xsd:string" wpc:id="1651"/>
    <bpws:variable name="mailboxComponentId" type="xsd:string" wpc:id="1791"/>
    <bpws:variable name="emptyOrder" type="ns0:SDP_Order" wpc:id="1823"/>
    <bpws:variable name="processBO" type="ns0:SDP_Order" wpc:id="1824"/>
    <bpws:variable name="processTransDetail" type="ns1:SDP_TransactionDetail" wpc:id="1825"/>
    <bpws:variable name="umMessageCenterIP" type="xsd:string" wpc:id="1838"/>
    <bpws:variable name="umJSessionId" type="xsd:string" wpc:id="1839"/>
  </bpws:variables>
  <bpws:faultHandlers>
    <bpws:catchAll wpc:id="1840">
      <bpws:invoke name="LogErrortoFile" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log Error to File" wpc:id="537">
        <wpc:script>
          <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage("Unknown Failure Occured in MAM.UpdateMailBoxConfig",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);
														
											
														
														
														]]></wpc:javaCode>
        </wpc:script>
      </bpws:invoke>
    </bpws:catchAll>
  </bpws:faultHandlers>
  <bpws:sequence name="HiddenSequence3" wpc:id="1073743586">
    <bpws:receive createInstance="yes" name="Receive" operation="compensateDeleteMailBox" partnerLink="DeleteMailBox_Compensation_Interface" portType="ns20:DeleteMailBox_Compensation_Interface" wpc:displayName="Receive" wpc:id="594">
      <wpc:output>
        <wpc:parameter name="SDP_ORDER_Prov" variable="provSdpOrderTrig"/>
        <wpc:parameter name="SDP_ORDER_Request" variable="sdpOrderTrig"/>
      </wpc:output>
    </bpws:receive>
    <bpws:invoke name="LogBeginProcess" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [Begin Process]" wpc:id="607">
      <wpc:script>
        <wpc:javaCode><![CDATA[processID = sdpOrderTrig.getString(SdpHelper.TEMPSTRING2_PATH.replace('.','/'));
PROCESS_NAME ="DELETE_MAILBOX_COMPENSATION";


SdpLoggerHelper.logMessage("Begin SubFlow : DeleteMailBoxCompensation",PROCESS_NAME,processID,SdpLoggerHelper.INFO);
SdpLoggerHelper.logMessage("Received the following GBO From MAM ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("sdpOrderTrig :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(sdpOrderTrig,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("provSdpOrderTrig :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(provSdpOrderTrig,PROCESS_NAME,processID,SdpLoggerHelper.INFO);]]></wpc:javaCode>
      </wpc:script>
    </bpws:invoke>
    <bpws:assign name="CopyTrigtoProc" wpc:displayName="Copy Trig to Proc" wpc:id="206">
      <bpws:copy>
        <bpws:from variable="sdpOrderTrig"/>
        <bpws:to variable="sdpOrderProc"/>
      </bpws:copy>
      <bpws:copy>
        <bpws:from variable="provSdpOrderTrig"/>
        <bpws:to variable="provSdpOrderProc"/>
      </bpws:copy>
      <bpws:copy>
        <bpws:from>UpdateMailBoxConfig</bpws:from>
        <bpws:to variable="PARENT_PROCESS_NAME"/>
      </bpws:copy>
      <bpws:copy>
        <bpws:from>false</bpws:from>
        <bpws:to variable="MANUAL_INTERVENTION_FLAG"/>
      </bpws:copy>
    </bpws:assign>
    <bpws:invoke name="GettheMainMailbox1" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Get the MainMailbox" wpc:id="660">
      <wpc:script>
        <wpc:javaCode><![CDATA[mainMailBox = SdpHelper.getPrimaryMailBox(provSdpOrderProc);]]></wpc:javaCode>
      </wpc:script>
    </bpws:invoke>
    <bpws:invoke name="SetSdpOrderForIndex" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Set SdpOrderForIndex" wpc:id="1643">
      <wpc:script>
        <wpc:javaCode><![CDATA[sdpOrderForIndex = null;

sdpOrderForIndex = SdpHelper.copySpecificBO(provSdpOrderProc);
sdpOrderForIndex.getList(SdpHelper.VOIP_ACCOUNTMAILBOXES_PATH.replace('.','/')).clear();]]></wpc:javaCode>
      </wpc:script>
    </bpws:invoke>
    <bpws:invoke name="SaveRollbackstate" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="save Rollback state" wpc:id="531">
      <wpc:script>
        <wpc:javaCode><![CDATA[int __result__1 = sdpOrderProc.getDataObject("transactionDetail").getDataObject("tempStoreNonArray").getInt("temp11");
RollBackState = new java.lang.Integer(__result__1);

//@generated:com.ibm.wbit.activity.ui
//<?xml version="1.0" encoding="UTF-8"?>
//<com.ibm.wbit.activity:CompositeActivity xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:com.ibm.wbit.activity="http:///com/ibm/wbit/activity.ecore" name="ActivityMethod">
//  <exceptions>
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="com.ibm.bpe.api.ProcessException"/>
//  </exceptions>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="sdpOrderProc.transactionDetail.tempStoreNonArray.temp11" field="true">
//    <dataOutputs target="//@executableElements.1"/>
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="int" namespace="http://www.w3.org/2001/XMLSchema" nillable="false"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" dataInputs="//@executableElements.0/@dataOutputs.0" value="RollBackState" variable="true">
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="int" namespace="http://www.w3.org/2001/XMLSchema"/>
//  </executableElements>
//  <executableGroups executableElements="//@executableElements.0 //@executableElements.1"/>
//</com.ibm.wbit.activity:CompositeActivity>
//@generated:end
//!SMAP!*S WBIACTDBG
//!SMAP!*L
//!SMAP!1:1,1
//!SMAP!2:2,1
//!SMAP!1000000:25,1]]></wpc:javaCode>
      </wpc:script>
    </bpws:invoke>
    <bpws:assign name="InitializeVariables" wpc:displayName="Initialize Variables" wpc:id="112">
      <bpws:copy>
        <bpws:from>
          <bpws:expression expressionLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[bo:create('http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_Error','SDP_Error')]]></bpws:expression>
        </bpws:from>
        <bpws:to variable="EmptyErrorObject"/>
      </bpws:copy>
      <bpws:copy>
        <bpws:from>Landline</bpws:from>
        <bpws:to variable="ucdclDeviceType"/>
      </bpws:copy>
      <bpws:copy>
        <bpws:from>SIP</bpws:from>
        <bpws:to variable="ucdclTransportMWI"/>
      </bpws:copy>
      <bpws:copy>
        <bpws:from variable="provSdpOrderProc"/>
        <bpws:to variable="sdpOrderForUpdate"/>
      </bpws:copy>
      <bpws:copy>
        <bpws:from>
          <bpws:expression expressionLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[bo:create('http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_TransactionDetail', 'SDP_TransactionDetail')]]></bpws:expression>
        </bpws:from>
        <bpws:to variable="EmptyTransaction_Detail"/>
      </bpws:copy>
      <bpws:copy>
        <bpws:from>false</bpws:from>
        <bpws:to variable="EmptyTransaction_Detail">
          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorIndicator]]></bpws:query>
        </bpws:to>
      </bpws:copy>
      <bpws:copy>
        <bpws:from>null</bpws:from>
        <bpws:to variable="EmptyTransaction_Detail">
          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/Message/SdpCode]]></bpws:query>
        </bpws:to>
      </bpws:copy>
      <bpws:copy>
        <bpws:from variable="EmptyTransaction_Detail"/>
        <bpws:to variable="TransactionDetailPort"/>
      </bpws:copy>
      <bpws:copy>
        <bpws:from variable="EmptyTransaction_Detail"/>
        <bpws:to variable="sdpOrderForUpdate">
          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail]]></bpws:query>
        </bpws:to>
      </bpws:copy>
      <bpws:copy>
        <bpws:from variable="sdpOrderProc">
          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/tempStoreNonArray/temp11]]></bpws:query>
        </bpws:from>
        <bpws:to variable="errorLevel"/>
      </bpws:copy>
      <bpws:copy>
        <bpws:from>false</bpws:from>
        <bpws:to variable="isSecondaryMailboxCreated"/>
      </bpws:copy>
      <bpws:copy>
        <bpws:from>
          <bpws:expression expressionLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[bo:create('http://www.ibm.com/websphere/crossworlds/2002/BOSchema/SDP_Order', 'SDP_Order')]]></bpws:expression>
        </bpws:from>
        <bpws:to variable="emptyOrder"/>
      </bpws:copy>
      <bpws:copy>
        <bpws:from variable="EmptyTransaction_Detail"/>
        <bpws:to variable="processBO">
          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[transactionDetail]]></bpws:query>
        </bpws:to>
      </bpws:copy>
      <bpws:copy>
        <bpws:from><![CDATA[null]]></bpws:from>
        <bpws:to variable="umMessageCenterIP"/>
      </bpws:copy>
    </bpws:assign>
    <bpws:invoke name="InitializeintListCounter" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Initialize intListCounter" wpc:id="696">
      <wpc:script>
        <wpc:javaCode><![CDATA[intListCounter = new Integer(0);]]></wpc:javaCode>
      </wpc:script>
    </bpws:invoke>
    <bpws:while name="ForeachMailboxinRequest" wpc:displayName="For each Mailbox in Request" wpc:id="692">
      <bpws:condition><![CDATA[return intListCounter.intValue() < sdpOrderProc.getList(SdpHelper.VOIP_ACCOUNTMAILBOXES_PATH.replace('.','/')).size();
]]></bpws:condition>
      <bpws:sequence name="HiddenSequence" wpc:id="1073743587">
        <bpws:invoke name="GetCurrentMailBoxSetinvariantIdnull" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Get Current MailBox / Set invariantId = null" wpc:id="731">
          <wpc:script>
            <wpc:javaCode><![CDATA[DataObject tmpMailbox = null;

List lstAccountMailboxes = sdpOrderProc.getList(SdpHelper.VOIP_ACCOUNTMAILBOXES_PATH.replace('.','/'));
tmpMailbox = (DataObject) lstAccountMailboxes.get(intListCounter.intValue());
currentMBox = SdpHelper.copySpecificBO(tmpMailbox); 

SdpLoggerHelper.logMessage("Current RollBack Mailbox",PROCESS_NAME,
	processID,SdpLoggerHelper.DEBUG);
														
SdpLoggerHelper.logBO(currentMBox,PROCESS_NAME,processID,SdpLoggerHelper.DEBUG);

invariantId = null;]]></wpc:javaCode>
          </wpc:script>
        </bpws:invoke>
        <bpws:switch name="RollBackMPSassociateMailboxTNs" wpc:displayName="RollBack MPS.associateMailboxTNs" wpc:id="657">
          <bpws:case wpc:id="658">
            <bpws:condition><![CDATA[DataObject tmpMailbox = null;;
String strInvariantId = null;

strInvariantId = sdpOrderProc.getString("transactionDetail/tempStoreNonArray/temp5");

tmpMailbox = SdpHelper.getMailBox(provSdpOrderProc,strInvariantId);

return errorLevel.intValue() > 4 && strInvariantId != null && tmpMailbox != null;]]></bpws:condition>
            <bpws:sequence name="HiddenSequence7" wpc:id="1073743588">
              <bpws:invoke name="SetsdpOrderForUpdate" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Set sdpOrderForUpdate" wpc:id="661">
                <wpc:script>
                  <wpc:javaCode><![CDATA[DataObject tmpMailbox = null;
String strInvariantId = null;

strInvariantId = sdpOrderProc.getString("transactionDetail/tempStoreNonArray/temp5");

List lstAccountMailboxes = sdpOrderForUpdate.getList(SdpHelper.VOIP_ACCOUNTMAILBOXES_PATH.replace('.','/'));
lstAccountMailboxes.clear();

tmpMailbox = SdpHelper.getMailBox(provSdpOrderProc,strInvariantId);

lstAccountMailboxes.add(tmpMailbox);]]></wpc:javaCode>
                </wpc:script>
              </bpws:invoke>
              <bpws:assign name="PreInvokeAssigns4" wpc:displayName="Pre-Invoke Assigns" wpc:id="662">
                <bpws:copy>
                  <bpws:from variable="EmptyTransaction_Detail"/>
                  <bpws:to variable="TransactionDetailPort"/>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from>MPS.UpdateComponent.Request</bpws:from>
                  <bpws:to variable="TransactionDetailPort">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/State]]></bpws:query>
                  </bpws:to>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from>MPS</bpws:from>
                  <bpws:to variable="TransactionDetailPort">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/TargetSystem]]></bpws:query>
                  </bpws:to>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from>UpdateComponent</bpws:from>
                  <bpws:to variable="TransactionDetailPort">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/currentTargetOperation]]></bpws:query>
                  </bpws:to>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from>MAILBOX</bpws:from>
                  <bpws:to variable="TransactionDetailPort">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/currentProduct]]></bpws:query>
                  </bpws:to>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from variable="TransactionDetailPort"/>
                  <bpws:to variable="sdpOrderForUpdate">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail]]></bpws:query>
                  </bpws:to>
                </bpws:copy>
              </bpws:assign>
              <bpws:invoke name="SetMPSValues" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Set MPS Values" wpc:id="691">
                <wpc:script>
                  <wpc:javaCode><![CDATA[/*
SdpLoggerHelper.logMessage("Setting up the Values for MPS.updateComponent[MailBox]", PROCESS_NAME, processID,
	SdpLoggerHelper.DEBUG);
// R7 Filter Setting not required
//Create WESM Content Filter 
ContentFilterCreator filterCreator = new ContentFilterCreator();

filterCreator.addSelectFilter(SdpHelper.PRODUCTTYPE, SdpHelper.CURRENT_PRODUCT_PATH);

//Create WESM Select Filter
filterCreator.addSelectFilter(SdpHelper.ACCT_OBJID, SdpHelper.ACCT_OBJID_PATH);

//Set the Filter for the MailBoxInvarintID
filterCreator.addSelectFilter(SdpHelper.CVOIP_MAILBOX_MAILBOXINVARIANTID, 
	SdpHelper.CVOIP_MAILBOX_MAILBOXINVARIANTID_PATH);
		
//Set the Content filter to the transaction detail object. 
sdpOrderForUpdate.getDataObject("transactionDetail").setDataObject( "contentFilter", filterCreator.createFilters() );

//Create WESM Update Filter for MemberTNs
SdpHelper.setUpMemberTNs(sdpOrderForUpdate.getDataObject("transactionDetail"),
	mainMailBox.getList(SdpHelper.VOIP_MAILBOXTNS).size(),SdpHelper.MAILBOX_TN_TYPE);
	*/
]]></wpc:javaCode>
                </wpc:script>
              </bpws:invoke>
              <bpws:invoke name="LogMPScompensateAssociateMailboxTNs" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [MPS.compensateAssociateMailboxTNs ]" wpc:id="667">
                <wpc:script>
                  <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage(SdpLoggerHelper.INVOKE_STR +" : MPS.compensateAssociateMailboxTNs",PROCESS_NAME,
	processID,SdpLoggerHelper.INFO);
														
SdpLoggerHelper.logMessage("Request BO [sdpOrderForUpdate:]",PROCESS_NAME,
	processID,SdpLoggerHelper.INFO);
														
SdpLoggerHelper.logBO(sdpOrderForUpdate,PROCESS_NAME,processID,SdpLoggerHelper.INFO);
																		]]></wpc:javaCode>
                </wpc:script>
              </bpws:invoke>
              <bpws:invoke name="InvokeMPScompensateAssociateMailboxTNsMainMailBox" operation="compensateAssociateMailboxTNs" partnerLink="MPSCompensableService2_InterfacePartner" portType="ns23:MPSCompensableService2_Interface" wpc:displayName="Invoke [MPS.compensateAssociateMailboxTNs - MainMailBox]" wpc:id="668">
                <wpc:input>
                  <wpc:parameter name="order" variable="sdpOrderForUpdate"/>
                </wpc:input>
              </bpws:invoke>
              <bpws:invoke name="LogMPScompensateAssociateMailboxTNsSuccess" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [MPS.compensateAssociateMailboxTNs -Success]" wpc:id="689">
                <wpc:script>
                  <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage("WESM.UpdateOrder :-"+SdpLoggerHelper.SUCCESS_STR,PROCESS_NAME,
	processID,SdpLoggerHelper.INFO);
	
																		]]></wpc:javaCode>
                </wpc:script>
              </bpws:invoke>
            </bpws:sequence>
          </bpws:case>
        </bpws:switch>
        <bpws:assign name="PreInvokeAssigns3" wpc:displayName="Pre-Invoke Assigns" wpc:id="821">
          <bpws:copy>
            <bpws:from variable="EmptyTransaction_Detail"/>
            <bpws:to variable="TransactionDetailPort"/>
          </bpws:copy>
          <bpws:copy>
            <bpws:from>UCDCL</bpws:from>
            <bpws:to variable="TransactionDetailPort">
              <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/TargetSystem]]></bpws:query>
            </bpws:to>
          </bpws:copy>
          <bpws:copy>
            <bpws:from>UCDCL.Login.Request</bpws:from>
            <bpws:to variable="TransactionDetailPort">
              <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/State]]></bpws:query>
            </bpws:to>
          </bpws:copy>
          <bpws:copy>
            <bpws:from>Login</bpws:from>
            <bpws:to variable="TransactionDetailPort">
              <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/currentTargetOperation]]></bpws:query>
            </bpws:to>
          </bpws:copy>
        </bpws:assign>
        <bpws:invoke name="LogUCDCLLogin" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UCDCL.Login]" wpc:id="823">
          <wpc:script>
            <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage(SdpLoggerHelper.INVOKE_STR +" : UCDCL.Login",PROCESS_NAME,processID,SdpLoggerHelper.INFO);]]></wpc:javaCode>
          </wpc:script>
        </bpws:invoke>
        <bpws:invoke name="InvokeUCDCLLogin" operation="provisioningServiceLogin" partnerLink="UcdclCompensableServicePartner_Interface" portType="ns25:UCDCLCompensableService_Interface" wpc:displayName="Invoke - [UCDCL.Login]" wpc:id="825">
          <wpc:input>
            <wpc:parameter name="transactionDetail" variable="processTransDetail"/>
          </wpc:input>
          <wpc:output>
            <wpc:parameter name="transactionDetail" variable="processTransDetail"/>
          </wpc:output>
          <bpws:catch faultName="wpc:runtimeFailure" faultVariable="bpcFault" wpc:faultType="wpc:BPCStandardFaultType" wpc:id="1869" wpc:variableId="828">
            <bpws:invoke name="HandleruntimeFailure1" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Handle runtime Failure" wpc:id="826">
              <wpc:script>
                <wpc:javaCode><![CDATA[SdpErrorHelper.setErrDetInTransDet(TransactionDetailPort,bpcFault,SdpErrorHelper.SEVERITY_FATAL);

SdpLoggerHelper.logMessage(SdpLoggerHelper.RUNTIME_FAILURE+" UCDCL.Login",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);
]]></wpc:javaCode>
              </wpc:script>
            </bpws:invoke>
          </bpws:catch>
          <bpws:catch faultName="ns25:serviceCallFault" faultVariable="scFault" wpc:faultType="java:ServiceCallFault" wpc:id="1870" wpc:variableId="829">
            <bpws:invoke name="SetErrorDetails4" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Set Error Details" wpc:id="827">
              <wpc:script>
                <wpc:javaCode><![CDATA[TransactionDetailPort.setBoolean(SdpHelper.ERRORINDICATOR,true);

new att.lightspeed.sdp.helper.TransactionDetail(TransactionDetailPort).setSDPErrorMessage(scFault);

TransactionDetailPort.getDataObject("errorDetails").getDataObject("Error").setString("Severity",SdpErrorHelper.SEVERITY_FATAL);

SdpLoggerHelper.logMessage(SdpLoggerHelper.FAULT_FAILURE +"  UCDCL.Login",PROCESS_NAME,processID,SdpLoggerHelper.FATAL); 
]]></wpc:javaCode>
              </wpc:script>
            </bpws:invoke>
          </bpws:catch>
          <bpws:catchAll wpc:id="1868">
            <bpws:invoke name="HandleotherFailures2" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Handle other Failures" wpc:id="834">
              <wpc:script>
                <wpc:javaCode><![CDATA[SdpErrorHelper.setErrDetInTransDet(TransactionDetailPort,null,SdpErrorHelper.SEVERITY_FATAL);
SdpLoggerHelper.logMessage(SdpLoggerHelper.UNKNOWN_FAILURE +"  UCDCL.Login",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);]]></wpc:javaCode>
              </wpc:script>
            </bpws:invoke>
          </bpws:catchAll>
        </bpws:invoke>
        <bpws:switch name="ErrorinUCDCLLogin" wpc:displayName="Error in UCDCL.Login?" wpc:id="819">
          <bpws:case wpc:id="820">
            <bpws:condition><![CDATA[return TransactionDetailPort.getBoolean(SdpHelper.ERRORINDICATOR);]]></bpws:condition>
            <bpws:sequence name="HiddenSequence1" wpc:id="1073743589">
              <bpws:invoke name="LogUCDCLLoginError1" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UCDCL.Login - Error]" wpc:id="837">
                <wpc:script>
                  <wpc:javaCode><![CDATA[String strSeverity =TransactionDetailPort.getString("errorDetails/Error/Severity");
int logLevel = SdpHelper.getLogLevel(strSeverity);

SdpLoggerHelper.logMessage("UCDCL.Login :- "+SdpLoggerHelper.ERROR_STR+"["+strSeverity+"]",PROCESS_NAME,processID,logLevel);
SdpLoggerHelper.logMessage("Response BO [TransactionDetailPort:]",PROCESS_NAME,processID,logLevel);														
SdpLoggerHelper.logBO(TransactionDetailPort,PROCESS_NAME,processID,logLevel);
																		]]></wpc:javaCode>
                </wpc:script>
              </bpws:invoke>
              <bpws:assign name="PrepareGBOforLogging1" wpc:displayName="Prepare GBO for Logging" wpc:id="839">
                <bpws:copy>
                  <bpws:from variable="TransactionDetailPort">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/State]]></bpws:query>
                  </bpws:from>
                  <bpws:to variable="STATE"/>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from variable="TransactionDetailPort">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/Severity]]></bpws:query>
                  </bpws:from>
                  <bpws:to variable="SEVERITY"/>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from variable="TransactionDetailPort">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/Message]]></bpws:query>
                  </bpws:from>
                  <bpws:to variable="SDP_ERROR_OBJECT_MESSAGE"/>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from>true</bpws:from>
                  <bpws:to variable="MANUAL_INTERVENTION_FLAG"/>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from variable="TransactionDetailPort">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/TargetSystem]]></bpws:query>
                  </bpws:from>
                  <bpws:to variable="TARGET_SYSTEM_NAME"/>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from variable="TransactionDetailPort">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/currentTargetOperation]]></bpws:query>
                  </bpws:from>
                  <bpws:to variable="TARGET_OPERATION_NAME"/>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from variable="TransactionDetailPort">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/Message]]></bpws:query>
                  </bpws:from>
                  <bpws:to variable="sdpOrderProc">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/errorDetails/Error/Message]]></bpws:query>
                  </bpws:to>
                </bpws:copy>
              </bpws:assign>
              <bpws:invoke name="LogCommonErrorLogger8" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [CommonErrorLogger ]" wpc:id="842">
                <wpc:script>
                  <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage("Invoking CommonErrorLogger:",PROCESS_NAME,processID,SdpLoggerHelper.INFO);
												
sdpOrderProc.setString(SdpHelper.TEMPSTRING1_PATH.replace('.','/'),processID);																				]]></wpc:javaCode>
                </wpc:script>
              </bpws:invoke>
              <bpws:invoke name="InvokeLogError4" operation="logErrorDetails" partnerLink="FromSdp_CommonErrorLogger_Interface" portType="ns21:FromSdp_CommonErrorLogger_Interface" wpc:displayName="Invoke LogError" wpc:id="844">
                <wpc:input>
                  <wpc:parameter name="transactionState" variable="STATE"/>
                  <wpc:parameter name="targetOperation" variable="TARGET_OPERATION_NAME"/>
                  <wpc:parameter name="parentProcessName" variable="PARENT_PROCESS_NAME"/>
                  <wpc:parameter name="sdpOrder" variable="sdpOrderProc"/>
                  <wpc:parameter name="manualInterventionInd" variable="MANUAL_INTERVENTION_FLAG"/>
                  <wpc:parameter name="severity" variable="SEVERITY"/>
                  <wpc:parameter name="targetSystem" variable="TARGET_SYSTEM_NAME"/>
                  <wpc:parameter name="sdpErrorObjectMessage" variable="SDP_ERROR_OBJECT_MESSAGE"/>
                </wpc:input>
                <wpc:output>
                  <wpc:parameter name="response" variable="TransactionDetail_Error"/>
                </wpc:output>
              </bpws:invoke>
              <bpws:invoke name="LogCommonErrorLogger9" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [ CommonErrorLogger]" wpc:id="847">
                <wpc:script>
                  <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage(" CommonErrorLogger",PROCESS_NAME,processID,SdpLoggerHelper.INFO);]]></wpc:javaCode>
                </wpc:script>
              </bpws:invoke>
              <bpws:assign name="Copyproctotrig3" wpc:displayName="Copy proc to trig" wpc:id="849">
                <bpws:copy>
                  <bpws:from variable="sdpOrderProc"/>
                  <bpws:to variable="sdpOrderTrig"/>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from variable="provSdpOrderProc"/>
                  <bpws:to variable="provSdpOrderTrig"/>
                </bpws:copy>
              </bpws:assign>
              <bpws:reply name="Reply5" operation="compensateDeleteMailBox" partnerLink="DeleteMailBox_Compensation_Interface" portType="ns20:DeleteMailBox_Compensation_Interface" wpc:displayName="Reply" wpc:id="851">
                <wpc:input>
                  <wpc:parameter name="SDP_ORDER_ProvPort" variable="provSdpOrderTrig"/>
                  <wpc:parameter name="Transaction_Detail" variable="TransactionDetailPort"/>
                  <wpc:parameter name="SDP_ORDER_RequestPort" variable="sdpOrderTrig"/>
                </wpc:input>
              </bpws:reply>
              <bpws:terminate name="Terminate1" wpc:displayName="Terminate" wpc:id="853"/>
            </bpws:sequence>
          </bpws:case>
          <bpws:otherwise wpc:id="1872">
            <bpws:sequence name="HiddenSequence25" wpc:id="1073743650">
              <bpws:invoke name="LogUCDCLLoginSuccess" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UCDCL.Login - Success]" wpc:id="854">
                <wpc:script>
                  <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage("UCDCL.Login -"+SdpLoggerHelper.SUCCESS_STR,PROCESS_NAME,
	processID,SdpLoggerHelper.INFO);]]></wpc:javaCode>
                </wpc:script>
              </bpws:invoke>
              <bpws:invoke name="SetUMSessionIDUMMessageCenterIP" operation="null" partnerLink="null" portType="wpc:null" wpc:continueOnError="inherit" wpc:displayName="Set UMSessionID &amp; UMMessageCenterIP" wpc:id="1827">
                <wpc:script>
                  <wpc:javaCode><![CDATA[att.lightspeed.sdp.helper.WpsLogger logger = att.lightspeed.sdp.helper.WpsLogger.getLogger(processInstance());
String UMSessionID = null;
String UMMessageCenterIP = null;

UMSessionID = processTransDetail.getString(SdpHelper.TRANSDETAIL_UMSESSIONID);
UMMessageCenterIP = processTransDetail.getString(SdpHelper.TRANSDETAIL_UMMESSAGECENTERIP);

logger.debug("UMSessionID from the Login Response: " + UMSessionID);
logger.debug("UMMessageCenterIP from the Login Response: " + UMMessageCenterIP);

processBO.setString(SdpHelper.xPathify(SdpHelper.TRANSDETAIL_UMSESSIONID_PATH),UMSessionID);

processBO.setString(SdpHelper.xPathify(SdpHelper.TRANSDETAIL_UMMESSAGECENTERIP_PATH),UMMessageCenterIP);]]></wpc:javaCode>
                </wpc:script>
              </bpws:invoke>
            </bpws:sequence>
          </bpws:otherwise>
        </bpws:switch>
        <bpws:switch name="RollBackUCDCLaddDeviceCall" wpc:displayName="RollBack UCDCL.addDevice Call?" wpc:id="732">
          <bpws:case wpc:id="733">
            <bpws:condition><![CDATA[String strInvariantId = null;
strInvariantId = sdpOrderProc.getString("transactionDetail/tempStoreNonArray/temp5");
return errorLevel.intValue() > 2 && strInvariantId != null && strInvariantId.trim().length() > 0;]]></bpws:condition>
            <bpws:sequence name="HiddenSequence24" wpc:id="1073743590">
              <bpws:invoke name="InitializeintListCounter1" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Initialize intListCounter" wpc:id="777">
                <wpc:script>
                  <wpc:javaCode><![CDATA[intTNListCounter = new Integer(0);]]></wpc:javaCode>
                </wpc:script>
              </bpws:invoke>
              <bpws:while name="ForeachTNincurrentMailBox" wpc:displayName="For each TN in currentMailBox" wpc:id="734">
                <bpws:condition><![CDATA[return intTNListCounter.intValue() 
	< currentMBox.getList(SdpHelper.VOIP_MAILBOXTNS.replace('.','/')).size();]]></bpws:condition>
                <bpws:sequence name="HiddenSequence11" wpc:id="1073743591">
                  <bpws:invoke name="GetthecurrentTNfromcurrentMailBox" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Get the currentTN from currentMailBox" wpc:id="737">
                    <wpc:script>
                      <wpc:javaCode><![CDATA[DataObject tmpMailbox = SdpHelper.copySpecificBO(currentMBox);
List lstMailboxTNs = tmpMailbox.getList(SdpHelper.VOIP_MAILBOXTNS);
currentTN = (DataObject) lstMailboxTNs.get(intTNListCounter.intValue()); ]]></wpc:javaCode>
                    </wpc:script>
                  </bpws:invoke>
                  <bpws:switch name="NotaPTL" wpc:displayName="Not a PTL?" wpc:id="1165">
                    <bpws:case wpc:id="1166">
                      <bpws:condition><![CDATA[String strTN = null;
String primaryTNInd = null;
String strInvariantId = null;
String isNLT = null;
boolean blnPTL = false;

DataObject lineSubComponent = null;

if (currentTN != null)
{
	strTN = currentTN.getString(SdpHelper.CVOIP_MAILBOX_TN);
	
	SdpLoggerHelper.logMessage("Current TN [ " + strTN + "]", PROCESS_NAME, processID, 
		SdpLoggerHelper.DEBUG);
	
	lineSubComponent = SdpHelper.getTN(provSdpOrderProc,strTN);
	
	if (lineSubComponent != null)
	{
		primaryTNInd = lineSubComponent.getString(SdpHelper.CVOIP_TN_PRIMARYIND_PATH.replace('.' , '/'));
		isNLT = lineSubComponent.getString(SdpHelper.ISNLT);
		
		SdpLoggerHelper.logMessage("Primary TN Ind[ " + primaryTNInd + "]", PROCESS_NAME, processID, 
			SdpLoggerHelper.DEBUG);
		
		SdpLoggerHelper.logMessage("NLT Ind " + isNLT + "]", PROCESS_NAME, processID, 
			SdpLoggerHelper.DEBUG);
		//Changing the logic for UBV 2 orders.	
		if ((!StringUtil.isEmpty(isNLT) && isNLT.equalsIgnoreCase(SdpHelper.YES)) || primaryTNInd.equalsIgnoreCase(SdpHelper.YES))
		/*if (primaryTNInd.equalsIgnoreCase(SdpHelper.YES))*/
		{
			blnPTL = true;
		}
	}
}

return !blnPTL;]]></bpws:condition>
                      <bpws:sequence name="HiddenSequence26" wpc:id="1073743592">
                        <bpws:invoke name="SetucdclEmailOrPhone" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Set ucdclEmailOrPhone" wpc:id="1650">
                          <wpc:script>
                            <wpc:javaCode><![CDATA[ucdclEmailOrPhone = sdpOrderProc.getString("transactionDetail/tempStoreNonArray/temp5");
sdpOrderProc.setString("transactionDetail/tempStoreNonArray/temp5",null);]]></wpc:javaCode>
                          </wpc:script>
                        </bpws:invoke>
                        <bpws:assign name="PreInvokeAssigns1" wpc:displayName="Pre-Invoke Assigns" wpc:id="738">
                          <bpws:copy>
                            <bpws:from variable="currentTN">
                              <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/tn]]></bpws:query>
                            </bpws:from>
                            <bpws:to variable="ucdclDeviceNumber"/>
                          </bpws:copy>
                          <bpws:copy>
                            <bpws:from variable="EmptyTransaction_Detail"/>
                            <bpws:to variable="TransactionDetailPort"/>
                          </bpws:copy>
                          <bpws:copy>
                            <bpws:from>UCDCL</bpws:from>
                            <bpws:to variable="TransactionDetailPort">
                              <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/TargetSystem]]></bpws:query>
                            </bpws:to>
                          </bpws:copy>
                          <bpws:copy>
                            <bpws:from>UCDCL.DeleteDevice.Request</bpws:from>
                            <bpws:to variable="TransactionDetailPort">
                              <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/State]]></bpws:query>
                            </bpws:to>
                          </bpws:copy>
                          <bpws:copy>
                            <bpws:from>DeleteDevice</bpws:from>
                            <bpws:to variable="TransactionDetailPort">
                              <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/currentTargetOperation]]></bpws:query>
                            </bpws:to>
                          </bpws:copy>
                          <bpws:copy>
                            <bpws:from variable="currentTN">
                              <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[tn]]></bpws:query>
                            </bpws:from>
                            <bpws:to variable="processBO">
                              <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[order/ReqService/product/cvoipProduct/cvoipLineSubComponent[1]/tnInfo/tn]]></bpws:query>
                            </bpws:to>
                          </bpws:copy>
                          <bpws:copy>
                            <bpws:from variable="ucdclEmailOrPhone"/>
                            <bpws:to variable="processBO">
                              <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[order/ReqService/product/cvoipProduct/accountMailBoxes[1]/mailBoxInvariantId]]></bpws:query>
                            </bpws:to>
                          </bpws:copy>
                        </bpws:assign>
                        <bpws:invoke name="LogUCDCLDeleteDevice" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UCDCL.DeleteDevice ]" wpc:id="743">
                          <wpc:script>
                            <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage(SdpLoggerHelper.INVOKE_STR +" : UCDCL.DeleteDevice",PROCESS_NAME,processID,SdpLoggerHelper.INFO);
SdpLoggerHelper.logMessage("ucdclEmailOrPhone :"+ucdclEmailOrPhone,PROCESS_NAME,processID,SdpLoggerHelper.INFO);
SdpLoggerHelper.logMessage("ucdclDeviceNumber :"+ucdclDeviceNumber,PROCESS_NAME,processID,SdpLoggerHelper.INFO);
SdpLoggerHelper.logMessage("ucdclAuthentication :"+ucdclAuthentication,PROCESS_NAME,processID,SdpLoggerHelper.INFO);]]></wpc:javaCode>
                          </wpc:script>
                        </bpws:invoke>
                        <bpws:invoke name="UCDCLDeleteDevice" operation="deleteDevice" partnerLink="UcdclCompensableServicePartner_Interface" portType="ns25:UCDCLCompensableService_Interface" wpc:displayName="UCDCL Delete Device" wpc:id="744">
                          <wpc:input>
                            <wpc:parameter name="order" variable="processBO"/>
                          </wpc:input>
                          <wpc:output>
                            <wpc:parameter name="transactionDetail" variable="processTransDetail"/>
                          </wpc:output>
                          <bpws:catch faultName="wpc:runtimeFailure" faultVariable="bpcFault" wpc:faultType="wpc:BPCStandardFaultType" wpc:id="1874" wpc:variableId="745">
                            <bpws:invoke name="Handleruntimefailure" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="handle runtime failure" wpc:id="747">
                              <wpc:script>
                                <wpc:javaCode><![CDATA[SdpErrorHelper.setErrDetInTransDet(TransactionDetailPort,bpcFault,SdpErrorHelper.SEVERITY_FATAL);
SdpLoggerHelper.logMessage(SdpLoggerHelper.RUNTIME_FAILURE+"  UCDCL.DeleteDevice",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);]]></wpc:javaCode>
                              </wpc:script>
                            </bpws:invoke>
                          </bpws:catch>
                          <bpws:catch faultName="ns25:serviceCallFault" faultVariable="scFault" wpc:faultType="java:ServiceCallFault" wpc:id="1875" wpc:variableId="748">
                            <bpws:invoke name="SetErrorDetails2" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Set Error Details" wpc:id="750">
                              <wpc:script>
                                <wpc:javaCode><![CDATA[TransactionDetailPort.setBoolean(SdpHelper.ERRORINDICATOR,true);

new att.lightspeed.sdp.helper.TransactionDetail(TransactionDetailPort).setSDPErrorMessage(scFault);

TransactionDetailPort.getDataObject("errorDetails").getDataObject("Error").setString("Severity",SdpErrorHelper.SEVERITY_FATAL);

 
SdpLoggerHelper.logMessage(SdpLoggerHelper.FAULT_FAILURE +"  UCDCL.DeleteDevice",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);
 ]]></wpc:javaCode>
                              </wpc:script>
                            </bpws:invoke>
                          </bpws:catch>
                          <bpws:catchAll wpc:id="1873">
                            <bpws:invoke name="Handleotherfailures" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="handle other failures" wpc:id="755">
                              <wpc:script>
                                <wpc:javaCode><![CDATA[SdpErrorHelper.setErrDetInTransDet(TransactionDetailPort,null,SdpErrorHelper.SEVERITY_FATAL);
SdpLoggerHelper.logMessage(SdpLoggerHelper.UNKNOWN_FAILURE+"  UCDCL.DeleteDevice",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);]]></wpc:javaCode>
                              </wpc:script>
                            </bpws:invoke>
                          </bpws:catchAll>
                        </bpws:invoke>
                        <bpws:switch name="CheckUCDCLError" wpc:displayName="Check UCDCL Error" wpc:id="756">
                          <bpws:case wpc:id="757">
                            <bpws:condition><![CDATA[boolean __result__1 = com.ibm.wbiservers.brules.core.codegen.NillableUtility.getBoolean(TransactionDetailPort, "errorIndicator", "TransactionDetailPort");
return __result__1;

//@generated:com.ibm.wbit.activity.ui
//<?xml version="1.0" encoding="UTF-8"?>
//<com.ibm.wbit.activity:CompositeActivity xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:com.ibm.wbit.activity="http:///com/ibm/wbit/activity.ecore" name="ActivityMethod">
//  <result name="Result">
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="boolean"/>
//  </result>
//  <exceptions>
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="com.ibm.bpe.api.ProcessException"/>
//  </exceptions>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="TransactionDetailPort.errorIndicator" field="true">
//    <dataOutputs target="//@executableElements.1"/>
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="boolean" namespace="http://www.w3.org/2001/XMLSchema" nillable="false"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:ReturnElement" dataInputs="//@executableElements.0/@dataOutputs.0"/>
//  <executableGroups executableElements="//@executableElements.0 //@executableElements.1"/>
//</com.ibm.wbit.activity:CompositeActivity>
//@generated:end
//!SMAP!*S WBIACTDBG
//!SMAP!*L
//!SMAP!1:1,1
//!SMAP!2:2,1
//!SMAP!1000000:26,1]]></bpws:condition>
                            <bpws:sequence name="HiddenSequence27" wpc:id="1073743593">
                              <bpws:invoke name="LogUCDCLDeleteDeviceError" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [ UCDCL.DeleteDevice  - Error]" wpc:id="760">
                                <wpc:script>
                                  <wpc:javaCode><![CDATA[String strSeverity =TransactionDetailPort.getString("errorDetails/Error/Severity");
int logLevel = SdpHelper.getLogLevel(strSeverity);
SdpLoggerHelper.logMessage(" UCDCL.DeleteDevice - "+SdpLoggerHelper.ERROR_STR+"["+strSeverity+"]",PROCESS_NAME,processID,logLevel);]]></wpc:javaCode>
                                </wpc:script>
                              </bpws:invoke>
                              <bpws:assign name="PrepareGBOforLogging3" wpc:displayName="prepare GBO for Logging" wpc:id="761">
                                <bpws:copy>
                                  <bpws:from variable="TransactionDetailPort">
                                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/State]]></bpws:query>
                                  </bpws:from>
                                  <bpws:to variable="STATE"/>
                                </bpws:copy>
                                <bpws:copy>
                                  <bpws:from variable="TransactionDetailPort">
                                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/Severity]]></bpws:query>
                                  </bpws:from>
                                  <bpws:to variable="SEVERITY"/>
                                </bpws:copy>
                                <bpws:copy>
                                  <bpws:from variable="TransactionDetailPort">
                                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/Message]]></bpws:query>
                                  </bpws:from>
                                  <bpws:to variable="SDP_ERROR_OBJECT_MESSAGE"/>
                                </bpws:copy>
                                <bpws:copy>
                                  <bpws:from>true</bpws:from>
                                  <bpws:to variable="MANUAL_INTERVENTION_FLAG"/>
                                </bpws:copy>
                                <bpws:copy>
                                  <bpws:from variable="TransactionDetailPort">
                                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/TargetSystem]]></bpws:query>
                                  </bpws:from>
                                  <bpws:to variable="TARGET_SYSTEM_NAME"/>
                                </bpws:copy>
                                <bpws:copy>
                                  <bpws:from variable="TransactionDetailPort">
                                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/currentTargetOperation]]></bpws:query>
                                  </bpws:from>
                                  <bpws:to variable="TARGET_OPERATION_NAME"/>
                                </bpws:copy>
                                <bpws:copy>
                                  <bpws:from variable="TransactionDetailPort">
                                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/Message]]></bpws:query>
                                  </bpws:from>
                                  <bpws:to variable="sdpOrderProc">
                                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/errorDetails/Error/Message]]></bpws:query>
                                  </bpws:to>
                                </bpws:copy>
                              </bpws:assign>
                              <bpws:invoke name="LogCommonErrorLogger6" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [CommonErrorLogger ]" wpc:id="763">
                                <wpc:script>
                                  <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage("Invoking CommonErrorLogger:",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

sdpOrderProc.setString(SdpHelper.TEMPSTRING1_PATH.replace('.','/'),processID);		
																		]]></wpc:javaCode>
                                </wpc:script>
                              </bpws:invoke>
                              <bpws:invoke name="InvokeLogError3" operation="logErrorDetails" partnerLink="FromSdp_CommonErrorLogger_Interface" portType="ns21:FromSdp_CommonErrorLogger_Interface" wpc:displayName="Invoke Log Error" wpc:id="764">
                                <wpc:input>
                                  <wpc:parameter name="transactionState" variable="STATE"/>
                                  <wpc:parameter name="targetOperation" variable="TARGET_OPERATION_NAME"/>
                                  <wpc:parameter name="parentProcessName" variable="PARENT_PROCESS_NAME"/>
                                  <wpc:parameter name="sdpOrder" variable="sdpOrderProc"/>
                                  <wpc:parameter name="manualInterventionInd" variable="MANUAL_INTERVENTION_FLAG"/>
                                  <wpc:parameter name="severity" variable="SEVERITY"/>
                                  <wpc:parameter name="targetSystem" variable="TARGET_SYSTEM_NAME"/>
                                  <wpc:parameter name="sdpErrorObjectMessage" variable="SDP_ERROR_OBJECT_MESSAGE"/>
                                </wpc:input>
                                <wpc:output>
                                  <wpc:parameter name="response" variable="TransactionDetail_Error"/>
                                </wpc:output>
                              </bpws:invoke>
                              <bpws:invoke name="LogCommonErrorLogger7" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [ CommonErrorLogger]" wpc:id="766">
                                <wpc:script>
                                  <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage(" CommonErrorLogger",PROCESS_NAME,processID,SdpLoggerHelper.INFO);]]></wpc:javaCode>
                                </wpc:script>
                              </bpws:invoke>
                              <bpws:assign name="Copyproctotrigg6" wpc:displayName="copy proc to trigg" wpc:id="767">
                                <bpws:copy>
                                  <bpws:from variable="sdpOrderProc"/>
                                  <bpws:to variable="sdpOrderTrig"/>
                                </bpws:copy>
                                <bpws:copy>
                                  <bpws:from variable="provSdpOrderProc"/>
                                  <bpws:to variable="provSdpOrderTrig"/>
                                </bpws:copy>
                              </bpws:assign>
                              <bpws:reply name="Reply2" operation="compensateDeleteMailBox" partnerLink="DeleteMailBox_Compensation_Interface" portType="ns20:DeleteMailBox_Compensation_Interface" wpc:displayName="Reply" wpc:id="768">
                                <wpc:input>
                                  <wpc:parameter name="SDP_ORDER_ProvPort" variable="provSdpOrderTrig"/>
                                  <wpc:parameter name="Transaction_Detail" variable="TransactionDetailPort"/>
                                  <wpc:parameter name="SDP_ORDER_RequestPort" variable="sdpOrderTrig"/>
                                </wpc:input>
                              </bpws:reply>
                              <bpws:terminate name="Terminate3" wpc:displayName="Terminate" wpc:id="769"/>
                            </bpws:sequence>
                          </bpws:case>
                          <bpws:otherwise wpc:id="1876">
                            <bpws:sequence name="HiddenSequence38" wpc:id="1073743652">
                              <bpws:invoke name="LogUCDCLDeleteDeviceSuccess" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UCDCL.DeleteDevice-Success ]" wpc:id="771">
                                <wpc:script>
                                  <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage(" UCDCL.DeleteDevice -"+SdpLoggerHelper.SUCCESS_STR,PROCESS_NAME,processID,SdpLoggerHelper.INFO);]]></wpc:javaCode>
                                </wpc:script>
                              </bpws:invoke>
                              <bpws:invoke name="SetUMSessionIDUMMessageCenterIP1" operation="null" partnerLink="null" portType="wpc:null" wpc:continueOnError="inherit" wpc:displayName="Set UMSessionID &amp; UMMessageCenterIP" wpc:id="1829">
                                <wpc:script>
                                  <wpc:javaCode><![CDATA[att.lightspeed.sdp.helper.WpsLogger logger = att.lightspeed.sdp.helper.WpsLogger.getLogger(processInstance());
String UMSessionID = null;
String UMMessageCenterIP = null;

UMSessionID = processTransDetail.getString(SdpHelper.TRANSDETAIL_UMSESSIONID);
UMMessageCenterIP = processTransDetail.getString(SdpHelper.TRANSDETAIL_UMMESSAGECENTERIP);

logger.debug("UMSessionID from the DeleteDevice Response: " + UMSessionID);
logger.debug("UMMessageCenterIP from the DeleteDevice Response: " + UMMessageCenterIP);

processBO.setString(SdpHelper.xPathify(SdpHelper.TRANSDETAIL_UMSESSIONID_PATH),UMSessionID);

processBO.setString(SdpHelper.xPathify(SdpHelper.TRANSDETAIL_UMMESSAGECENTERIP_PATH),UMMessageCenterIP);]]></wpc:javaCode>
                                </wpc:script>
                              </bpws:invoke>
                            </bpws:sequence>
                          </bpws:otherwise>
                        </bpws:switch>
                      </bpws:sequence>
                    </bpws:case>
                  </bpws:switch>
                  <bpws:invoke name="IntTNListCounter1" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="intTNListCounter++" wpc:id="775">
                    <wpc:script>
                      <wpc:javaCode><![CDATA[intTNListCounter = new Integer(intTNListCounter.intValue() +1);
]]></wpc:javaCode>
                    </wpc:script>
                  </bpws:invoke>
                </bpws:sequence>
              </bpws:while>
            </bpws:sequence>
          </bpws:case>
        </bpws:switch>
        <bpws:switch name="RollBackUCDCLdeleteMailbox" wpc:displayName="RollBack UCDCL.deleteMailbox?" wpc:id="779">
          <bpws:case wpc:id="780">
            <bpws:condition><![CDATA[return errorLevel.intValue() > 1 ;]]></bpws:condition>
            <bpws:sequence name="HiddenSequence18" wpc:id="1073743594">
              <bpws:invoke name="GetfirsttnfromCurrentMBox2" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Get first tn from Current MBox" wpc:id="782">
                <wpc:script>
                  <wpc:javaCode><![CDATA[DataObject tmpMailbox = null;
tmpMailbox = SdpHelper.copySpecificBO(currentMBox);
firstmailboxTN = (DataObject)tmpMailbox.getList(SdpHelper.VOIP_MAILBOXTNS).get(0);]]></wpc:javaCode>
                </wpc:script>
              </bpws:invoke>
              <bpws:assign name="PreInvokeAssigns" wpc:displayName="Pre-Invoke Assigns" wpc:id="783">
                <bpws:copy>
                  <bpws:from variable="EmptyTransaction_Detail"/>
                  <bpws:to variable="TransactionDetailPort"/>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from>UCDCL.CreateSecondaryMailBox</bpws:from>
                  <bpws:to variable="TransactionDetailPort">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/State]]></bpws:query>
                  </bpws:to>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from>UCDCL</bpws:from>
                  <bpws:to variable="TransactionDetailPort">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/TargetSystem]]></bpws:query>
                  </bpws:to>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from>CreateSecondaryMailBox</bpws:from>
                  <bpws:to variable="TransactionDetailPort">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/currentTargetOperation]]></bpws:query>
                  </bpws:to>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from variable="mainMailBox">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/mailBoxInvariantId]]></bpws:query>
                  </bpws:from>
                  <bpws:to variable="ucdclEmailOrPhone"/>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from>null</bpws:from>
                  <bpws:to variable="SDP_AccountMailBoxes_Port">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/Status/Message/SdpCode]]></bpws:query>
                  </bpws:to>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from variable="firstmailboxTN">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/tn]]></bpws:query>
                  </bpws:from>
                  <bpws:to variable="ucdclTelePhoneNumber">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/tn]]></bpws:query>
                  </bpws:to>
                </bpws:copy>
              </bpws:assign>
              <bpws:invoke name="PreparingucdclTelePhoneNumberAddingRandomNumberintoTN" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Preparing ucdclTelePhoneNumber[Adding Random Number into TN]" wpc:id="1210">
                <wpc:script>
                  <wpc:javaCode><![CDATA[String tmpTN = null;
String newTNWithRandomNo = null;

tmpTN = ucdclTelePhoneNumber.getString("tn");

SdpLoggerHelper.logMessage("Before adding the Random No. TN in ucdclTelePhoneNumber: " + tmpTN,
	PROCESS_NAME,processID,SdpLoggerHelper.INFO);

newTNWithRandomNo = MamMemberServiceHelper.getEmailAddress(tmpTN);

ucdclTelePhoneNumber.setString("tn",newTNWithRandomNo);

tmpTN = ucdclTelePhoneNumber.getString("tn");

SdpLoggerHelper.logMessage("After adding the Random No. TN in ucdclTelePhoneNumber: " + tmpTN,
	PROCESS_NAME,processID,SdpLoggerHelper.INFO);]]></wpc:javaCode>
                </wpc:script>
              </bpws:invoke>
              <bpws:invoke name="SetsdpAccount" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Set sdpAccount" wpc:id="1024">
                <wpc:script>
                  <wpc:javaCode><![CDATA[DataObject sdpAccountTmp = null;
DataObject memberProfile = null;

List lstMailboxMembers = null;
String strMemberId = null;

lstMailboxMembers = currentMBox.getList(SdpHelper.VOIP_MAILBOX_MEMBERS);

SdpLoggerHelper.logMessage("Setting sdpAccount for CreateSecondaryMailbox call",
	PROCESS_NAME,processID,SdpLoggerHelper.INFO);

if (lstMailboxMembers.size() > 0)
{
	strMemberId = ((DataObject)lstMailboxMembers.get(0)).getString(SdpHelper.CVOIP_MAILBOX_MEMBERID);
	
	SdpLoggerHelper.logMessage("MemberId["+strMemberId+"]",PROCESS_NAME,
		processID,SdpLoggerHelper.INFO);
	
	memberProfile = SdpHelper.getMemberProfile(provSdpOrderProc, strMemberId, SdpHelper.MEMBER_FILTER);
	
	if (memberProfile != null)
	{
		sdpAccountTmp = (DataObject)provSdpOrderProc.getDataObject("order/ReqService/Account");
		
		sdpAccount = SdpHelper.copySpecificBO(sdpAccountTmp);
		
		sdpAccount.getList("Customer/Person/memberProfile").clear();
		
		sdpAccount.getList("Customer/Person/memberProfile").add(memberProfile);
		
		SdpLoggerHelper.logMessage("MemberProfile for MemberId["+strMemberId+
			"] found and added to sdpAccount",PROCESS_NAME,processID,SdpLoggerHelper.INFO);
	}
}]]></wpc:javaCode>
                </wpc:script>
              </bpws:invoke>
              <bpws:assign name="PreInvokeAssigns10" wpc:displayName="Pre-Invoke Assigns" wpc:id="1157">
                <bpws:copy>
                  <bpws:from>0</bpws:from>
                  <bpws:to variable="intCounter"/>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from>false</bpws:from>
                  <bpws:to variable="isSecondaryMailboxCreated"/>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from variable="sdpAccount"/>
                  <bpws:to variable="processBO">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[order/ReqService/Account]]></bpws:query>
                  </bpws:to>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from variable="ucdclEmailOrPhone"/>
                  <bpws:to variable="processBO">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[order/ReqService/product/cvoipProduct/accountMailBoxes[1]/mailBoxInvariantId]]></bpws:query>
                  </bpws:to>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from variable="ucdclTelePhoneNumber"/>
                  <bpws:to variable="processBO">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[order/ReqService/product/cvoipProduct/cvoipLineSubComponent[1]/tnInfo]]></bpws:query>
                  </bpws:to>
                </bpws:copy>
              </bpws:assign>
              <bpws:while name="RetryLoop" wpc:displayName="Retry Loop" wpc:id="1153">
                <bpws:condition><![CDATA[return !isSecondaryMailboxCreated.booleanValue() && intCounter.intValue() < 4;
]]></bpws:condition>
                <bpws:sequence name="HiddenSequence12" wpc:id="1073743595">
                  <bpws:invoke name="Waitfor15Sec" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Wait for 15 Sec" wpc:id="1152">
                    <wpc:script>
                      <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage("Waiting to Call UCDCL.CreateSecondaryMailbox",
	PROCESS_NAME,processID,SdpLoggerHelper.DEBUG);



long milliSeconds = MamMemberServiceHelper.getTimeDelayMilliSeconds();

try
{
	Thread.sleep(milliSeconds);
}
catch (Exception ex)
{
	SdpLoggerHelper.logMessage("While waiting to call CreateSecondaryMailbox",
		PROCESS_NAME,processID,SdpLoggerHelper.DEBUG);
		
	SdpLoggerHelper.logMessage("Exception: " +ex,PROCESS_NAME,processID,SdpLoggerHelper.INFO);
}

SdpLoggerHelper.logMessage("Ready to Call UCDCL.CreateSecondaryMailbox",
	PROCESS_NAME,processID,SdpLoggerHelper.DEBUG);]]></wpc:javaCode>
                    </wpc:script>
                  </bpws:invoke>
                  <bpws:invoke name="LogUCDCLCreateSecondaryMailBox" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [ UCDCL.CreateSecondaryMailBox]" wpc:id="789">
                    <wpc:script>
                      <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage(SdpLoggerHelper.INVOKE_STR +" : UCDCL.CreateSecondaryMailBox",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("ucdclEmailOrPhone :"+ucdclEmailOrPhone,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("sdpAccount :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(sdpAccount,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("ucdclTelePhoneNumber :",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(ucdclTelePhoneNumber,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

														]]></wpc:javaCode>
                    </wpc:script>
                  </bpws:invoke>
                  <bpws:invoke name="UCDCLCreateSecondaryMailBox" operation="createSecondaryMailbox" partnerLink="UcdclCompensableServicePartner_Interface" portType="ns25:UCDCLCompensableService_Interface" wpc:displayName="UCDCL Create Secondary MailBox" wpc:id="790">
                    <wpc:input>
                      <wpc:parameter name="order" variable="processBO"/>
                    </wpc:input>
                    <wpc:output>
                      <wpc:parameter name="returnOrder" variable="processBO"/>
                    </wpc:output>
                    <bpws:catch faultName="wpc:runtimeFailure" faultVariable="bpcFault" wpc:faultType="wpc:BPCStandardFaultType" wpc:id="1894" wpc:variableId="791">
                      <bpws:invoke name="Handleruntimefailure2" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="handle runtime failure" wpc:id="793">
                        <wpc:script>
                          <wpc:javaCode><![CDATA[SdpErrorHelper.setErrDetInTransDet(TransactionDetailPort,bpcFault,SdpErrorHelper.SEVERITY_FATAL);
SdpLoggerHelper.logMessage(SdpLoggerHelper.RUNTIME_FAILURE+" UCDCL.CreateSecondaryMailBox",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);]]></wpc:javaCode>
                        </wpc:script>
                      </bpws:invoke>
                    </bpws:catch>
                    <bpws:catch faultName="ns25:serviceCallFault" faultVariable="scFault" wpc:faultType="java:ServiceCallFault" wpc:id="1895" wpc:variableId="794">
                      <bpws:invoke name="SetErrorDetails" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Set Error Details" wpc:id="796">
                        <wpc:script>
                          <wpc:javaCode><![CDATA[TransactionDetailPort.setBoolean(SdpHelper.ERRORINDICATOR,true);

new att.lightspeed.sdp.helper.TransactionDetail(TransactionDetailPort).setSDPErrorMessage(scFault);

TransactionDetailPort.getDataObject("errorDetails").getDataObject("Error").setString("Severity",SdpErrorHelper.SEVERITY_FATAL);

 
SdpLoggerHelper.logMessage(SdpLoggerHelper.FAULT_FAILURE +" UCDCL.CreateSecondaryMailBox",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);]]></wpc:javaCode>
                        </wpc:script>
                      </bpws:invoke>
                    </bpws:catch>
                    <bpws:catchAll wpc:id="1893">
                      <bpws:invoke name="Handleotherfailures1" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="handle other failures" wpc:id="801">
                        <wpc:script>
                          <wpc:javaCode><![CDATA[SdpErrorHelper.setErrDetInTransDet(TransactionDetailPort,null,SdpErrorHelper.SEVERITY_FATAL);
SdpLoggerHelper.logMessage(SdpLoggerHelper.UNKNOWN_FAILURE+" UCDCL.CreateSecondaryMailBox",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);]]></wpc:javaCode>
                        </wpc:script>
                      </bpws:invoke>
                    </bpws:catchAll>
                  </bpws:invoke>
                  <bpws:switch name="CheckUCDCLError1" wpc:displayName="Check UCDCL Error" wpc:id="802">
                    <bpws:case wpc:id="1162">
                      <bpws:condition><![CDATA[return intCounter.intValue() < 3 && TransactionDetailPort.getBoolean(SdpHelper.ERRORINDICATOR);]]></bpws:condition>
                      <bpws:sequence name="HiddenSequence15" wpc:id="1073743596">
                        <bpws:empty name="Continue" wpc:displayName="Continue" wpc:id="1164"/>
                      </bpws:sequence>
                    </bpws:case>
                    <bpws:case wpc:id="803">
                      <bpws:condition><![CDATA[boolean __result__1 = com.ibm.wbiservers.brules.core.codegen.NillableUtility.getBoolean(TransactionDetailPort, "errorIndicator", "TransactionDetailPort");
return __result__1;

//@generated:com.ibm.wbit.activity.ui
//<?xml version="1.0" encoding="UTF-8"?>
//<com.ibm.wbit.activity:CompositeActivity xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:com.ibm.wbit.activity="http:///com/ibm/wbit/activity.ecore" name="ActivityMethod">
//  <result name="Result">
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="boolean"/>
//  </result>
//  <exceptions>
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="com.ibm.bpe.api.ProcessException"/>
//  </exceptions>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="TransactionDetailPort.errorIndicator" field="true">
//    <dataOutputs target="//@executableElements.1"/>
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="boolean" namespace="http://www.w3.org/2001/XMLSchema" nillable="false"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:ReturnElement" dataInputs="//@executableElements.0/@dataOutputs.0"/>
//  <executableGroups executableElements="//@executableElements.0 //@executableElements.1"/>
//</com.ibm.wbit.activity:CompositeActivity>
//@generated:end
//!SMAP!*S WBIACTDBG
//!SMAP!*L
//!SMAP!1:1,1
//!SMAP!2:2,1
//!SMAP!1000000:26,1]]></bpws:condition>
                      <bpws:sequence name="HiddenSequence16" wpc:id="1073743598">
                        <bpws:invoke name="LogUCDCLCreateSecondaryMailBoxError" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UCDCL.CreateSecondaryMailBox  - Error]" wpc:id="806">
                          <wpc:script>
                            <wpc:javaCode><![CDATA[String strSeverity =TransactionDetailPort.getString("errorDetails/Error/Severity");
int logLevel = SdpHelper.getLogLevel(strSeverity);
SdpLoggerHelper.logMessage(" UCDCL.CreateSecondaryMailBox - "+SdpLoggerHelper.ERROR_STR+"["+strSeverity+"]",PROCESS_NAME,processID,logLevel);]]></wpc:javaCode>
                          </wpc:script>
                        </bpws:invoke>
                        <bpws:assign name="PrepareGBOforLogging2" wpc:displayName="Prepare GBO for Logging" wpc:id="807">
                          <bpws:copy>
                            <bpws:from variable="TransactionDetailPort">
                              <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/State]]></bpws:query>
                            </bpws:from>
                            <bpws:to variable="STATE"/>
                          </bpws:copy>
                          <bpws:copy>
                            <bpws:from variable="TransactionDetailPort">
                              <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/Severity]]></bpws:query>
                            </bpws:from>
                            <bpws:to variable="SEVERITY"/>
                          </bpws:copy>
                          <bpws:copy>
                            <bpws:from variable="TransactionDetailPort">
                              <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/Message]]></bpws:query>
                            </bpws:from>
                            <bpws:to variable="SDP_ERROR_OBJECT_MESSAGE"/>
                          </bpws:copy>
                          <bpws:copy>
                            <bpws:from>true</bpws:from>
                            <bpws:to variable="MANUAL_INTERVENTION_FLAG"/>
                          </bpws:copy>
                          <bpws:copy>
                            <bpws:from variable="TransactionDetailPort">
                              <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/TargetSystem]]></bpws:query>
                            </bpws:from>
                            <bpws:to variable="TARGET_SYSTEM_NAME"/>
                          </bpws:copy>
                          <bpws:copy>
                            <bpws:from variable="TransactionDetailPort">
                              <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/currentTargetOperation]]></bpws:query>
                            </bpws:from>
                            <bpws:to variable="TARGET_OPERATION_NAME"/>
                          </bpws:copy>
                          <bpws:copy>
                            <bpws:from variable="TransactionDetailPort">
                              <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/Message]]></bpws:query>
                            </bpws:from>
                            <bpws:to variable="sdpOrderProc">
                              <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/errorDetails/Error/Message]]></bpws:query>
                            </bpws:to>
                          </bpws:copy>
                        </bpws:assign>
                        <bpws:invoke name="LogCommonErrorLogger4" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [ CommonErrorLogger]" wpc:id="809">
                          <wpc:script>
                            <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage("Invoking CommonErrorLogger:",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

sdpOrderProc.setString(SdpHelper.TEMPSTRING1_PATH.replace('.','/'),processID);		]]></wpc:javaCode>
                          </wpc:script>
                        </bpws:invoke>
                        <bpws:invoke name="InvokeLogError2" operation="logErrorDetails" partnerLink="FromSdp_CommonErrorLogger_Interface" portType="ns21:FromSdp_CommonErrorLogger_Interface" wpc:displayName="Invoke Log Error" wpc:id="810">
                          <wpc:input>
                            <wpc:parameter name="transactionState" variable="STATE"/>
                            <wpc:parameter name="targetOperation" variable="TARGET_OPERATION_NAME"/>
                            <wpc:parameter name="parentProcessName" variable="PARENT_PROCESS_NAME"/>
                            <wpc:parameter name="sdpOrder" variable="sdpOrderProc"/>
                            <wpc:parameter name="manualInterventionInd" variable="MANUAL_INTERVENTION_FLAG"/>
                            <wpc:parameter name="severity" variable="SEVERITY"/>
                            <wpc:parameter name="targetSystem" variable="TARGET_SYSTEM_NAME"/>
                            <wpc:parameter name="sdpErrorObjectMessage" variable="SDP_ERROR_OBJECT_MESSAGE"/>
                          </wpc:input>
                          <wpc:output>
                            <wpc:parameter name="response" variable="TransactionDetail_Error"/>
                          </wpc:output>
                        </bpws:invoke>
                        <bpws:invoke name="LogCommonErrorLogger5" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [CommonErrorLogger ]" wpc:id="812">
                          <wpc:script>
                            <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage(" CommonErrorLogger",PROCESS_NAME,processID,SdpLoggerHelper.INFO);]]></wpc:javaCode>
                          </wpc:script>
                        </bpws:invoke>
                        <bpws:assign name="Copyproctotrig5" wpc:displayName="Copy proc to trig" wpc:id="813">
                          <bpws:copy>
                            <bpws:from variable="sdpOrderProc"/>
                            <bpws:to variable="sdpOrderTrig"/>
                          </bpws:copy>
                          <bpws:copy>
                            <bpws:from variable="provSdpOrderProc"/>
                            <bpws:to variable="provSdpOrderTrig"/>
                          </bpws:copy>
                        </bpws:assign>
                        <bpws:reply name="Reply1" operation="compensateDeleteMailBox" partnerLink="DeleteMailBox_Compensation_Interface" portType="ns20:DeleteMailBox_Compensation_Interface" wpc:displayName="Reply" wpc:id="814">
                          <wpc:input>
                            <wpc:parameter name="SDP_ORDER_ProvPort" variable="provSdpOrderTrig"/>
                            <wpc:parameter name="Transaction_Detail" variable="TransactionDetailPort"/>
                            <wpc:parameter name="SDP_ORDER_RequestPort" variable="sdpOrderTrig"/>
                          </wpc:input>
                        </bpws:reply>
                        <bpws:terminate name="Terminate2" wpc:displayName="Terminate" wpc:id="815"/>
                      </bpws:sequence>
                    </bpws:case>
                    <bpws:otherwise wpc:id="1896">
                      <bpws:sequence name="HiddenSequence17" wpc:id="1073743597">
                        <bpws:invoke name="LogUCDCLCreateSecondaryMailBoxSuccess" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UCDCL.CreateSecondaryMailBox-Success ]" wpc:id="817">
                          <wpc:script>
                            <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage(" UCDCL.CreateSecondaryMailBox -"+SdpLoggerHelper.SUCCESS_STR,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("CreatedMailbox:[SDP_AccountMailBoxes_Port]",PROCESS_NAME,
	processID,SdpLoggerHelper.INFO);
														
SdpLoggerHelper.logBO(SDP_AccountMailBoxes_Port,PROCESS_NAME,processID,SdpLoggerHelper.INFO);]]></wpc:javaCode>
                          </wpc:script>
                        </bpws:invoke>
                        <bpws:assign name="IsSecondaryMailboxCreatedtrue" wpc:displayName="isSecondaryMailboxCreated = true" wpc:id="1159">
                          <bpws:copy>
                            <bpws:from>true</bpws:from>
                            <bpws:to variable="isSecondaryMailboxCreated"/>
                          </bpws:copy>
                        </bpws:assign>
                      </bpws:sequence>
                    </bpws:otherwise>
                  </bpws:switch>
                  <bpws:invoke name="IntCounter1" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="intCounter++" wpc:id="1161">
                    <wpc:script>
                      <wpc:javaCode><![CDATA[intCounter = new Integer(intCounter.intValue()+1);]]></wpc:javaCode>
                    </wpc:script>
                  </bpws:invoke>
                </bpws:sequence>
              </bpws:while>
              <bpws:assign name="PreInvokeAssigns5" wpc:displayName="Pre-Invoke Assigns" wpc:id="858">
                <bpws:copy>
                  <bpws:from variable="EmptyTransaction_Detail"/>
                  <bpws:to variable="TransactionDetailPort"/>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from>UCDCL</bpws:from>
                  <bpws:to variable="TransactionDetailPort">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/TargetSystem]]></bpws:query>
                  </bpws:to>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from>UCDCL.Logout.Request</bpws:from>
                  <bpws:to variable="TransactionDetailPort">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/State]]></bpws:query>
                  </bpws:to>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from>Logout</bpws:from>
                  <bpws:to variable="TransactionDetailPort">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/currentTargetOperation]]></bpws:query>
                  </bpws:to>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from variable="processBO">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[transactionDetail/UMSessionID]]></bpws:query>
                  </bpws:from>
                  <bpws:to variable="processTransDetail">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[UMSessionID]]></bpws:query>
                  </bpws:to>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from variable="processBO">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[transactionDetail/UMMessageCenterIP]]></bpws:query>
                  </bpws:from>
                  <bpws:to variable="processTransDetail">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[UMMessageCenterIP]]></bpws:query>
                  </bpws:to>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from variable="processBO">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[transactionDetail/UMMessageCenterIP]]></bpws:query>
                  </bpws:from>
                  <bpws:to variable="umMessageCenterIP"/>
                </bpws:copy>
              </bpws:assign>
              <bpws:invoke name="LogUCDCLLogout" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UCDCL.Logout]" wpc:id="861">
                <wpc:script>
                  <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage(SdpLoggerHelper.INVOKE_STR +" : UCDCL.Logout",PROCESS_NAME,processID,SdpLoggerHelper.INFO);]]></wpc:javaCode>
                </wpc:script>
              </bpws:invoke>
              <bpws:invoke name="InvokeUCDCLLogout" operation="provisioningServiceLogout" partnerLink="UcdclCompensableServicePartner_Interface" portType="ns25:UCDCLCompensableService_Interface" wpc:displayName="Invoke - [UCDCL.Logout]" wpc:id="870">
                <wpc:input>
                  <wpc:parameter name="transactionDetail" variable="processTransDetail"/>
                </wpc:input>
                <wpc:output/>
                <bpws:catch faultName="wpc:runtimeFailure" faultVariable="bpcFault" wpc:faultType="wpc:BPCStandardFaultType" wpc:id="1884" wpc:variableId="871">
                  <bpws:invoke name="HandleruntimeFailure1" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Handle runtime Failure" wpc:id="873">
                    <wpc:script>
                      <wpc:javaCode><![CDATA[SdpErrorHelper.setErrDetInTransDet(TransactionDetailPort,bpcFault,SdpErrorHelper.SEVERITY_FATAL);

SdpLoggerHelper.logMessage(SdpLoggerHelper.RUNTIME_FAILURE+" UCDCL.Logout",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);
]]></wpc:javaCode>
                    </wpc:script>
                  </bpws:invoke>
                </bpws:catch>
                <bpws:catch faultName="ns25:serviceCallFault" faultVariable="scFault" wpc:faultType="java:ServiceCallFault" wpc:id="1885" wpc:variableId="874">
                  <bpws:invoke name="SetErrorDetails4" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Set Error Details" wpc:id="876">
                    <wpc:script>
                      <wpc:javaCode><![CDATA[TransactionDetailPort.setBoolean(SdpHelper.ERRORINDICATOR,true);

new att.lightspeed.sdp.helper.TransactionDetail(TransactionDetailPort).setSDPErrorMessage(scFault);

TransactionDetailPort.getDataObject("errorDetails").getDataObject("Error").setString("Severity",SdpErrorHelper.SEVERITY_FATAL);

SdpLoggerHelper.logMessage(SdpLoggerHelper.FAULT_FAILURE +"  UCDCL.Logout",PROCESS_NAME,processID,SdpLoggerHelper.FATAL); 
]]></wpc:javaCode>
                    </wpc:script>
                  </bpws:invoke>
                </bpws:catch>
                <bpws:catchAll wpc:id="1883">
                  <bpws:invoke name="HandleotherFailures2" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Handle other Failures" wpc:id="881">
                    <wpc:script>
                      <wpc:javaCode><![CDATA[SdpErrorHelper.setErrDetInTransDet(TransactionDetailPort,null,SdpErrorHelper.SEVERITY_FATAL);
SdpLoggerHelper.logMessage(SdpLoggerHelper.UNKNOWN_FAILURE +"  UCDCL.Logout",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);]]></wpc:javaCode>
                    </wpc:script>
                  </bpws:invoke>
                </bpws:catchAll>
              </bpws:invoke>
              <bpws:switch name="ErrorinUCDCLLogout" wpc:displayName="Error in UCDCL.Logout?" wpc:id="894">
                <bpws:case wpc:id="895">
                  <bpws:condition><![CDATA[return TransactionDetailPort.getBoolean(SdpHelper.ERRORINDICATOR);]]></bpws:condition>
                  <bpws:sequence name="HiddenSequence5" wpc:id="1073743599">
                    <bpws:invoke name="LogUCDCLLogoutError" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UCDCL.Logout - Error]" wpc:id="898">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[String strSeverity =TransactionDetailPort.getString("errorDetails/Error/Severity");
int logLevel = SdpHelper.getLogLevel(strSeverity);

SdpLoggerHelper.logMessage("UCDCL.Logout :- "+SdpLoggerHelper.ERROR_STR+"["+strSeverity+"]",PROCESS_NAME,processID,logLevel);
SdpLoggerHelper.logMessage("Response BO [TransactionDetailPort:]",PROCESS_NAME,processID,logLevel);														
SdpLoggerHelper.logBO(TransactionDetailPort,PROCESS_NAME,processID,logLevel);
																		]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                  </bpws:sequence>
                </bpws:case>
                <bpws:otherwise wpc:id="1892">
                  <bpws:invoke name="LogUCDCLLogoutSuccess" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UCDCL.Logout - Success]" wpc:id="909">
                    <wpc:script>
                      <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage("UCDCL.Logout -"+SdpLoggerHelper.SUCCESS_STR,PROCESS_NAME,
	processID,SdpLoggerHelper.INFO);]]></wpc:javaCode>
                    </wpc:script>
                  </bpws:invoke>
                </bpws:otherwise>
              </bpws:switch>
              <bpws:invoke name="CreateloginId" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Create loginId" wpc:id="967">
                <wpc:script>
                  <wpc:javaCode><![CDATA[String tn = null;

if(ucdclTelePhoneNumber != null )
{
	tn = ucdclTelePhoneNumber.getString("tn");
	try {
		loginId = tn + "@" + CvoipConfig.instance().getEmailAddressDomain();
	}catch (PropertyReadException prEX) 
	{
		SdpLoggerHelper.logMessage("Exception occured while Constructing LoginId: " + prEX.getMessage(), 
			PROCESS_NAME, processID, SdpLoggerHelper.ERROR);
	}
	SdpLoggerHelper.logMessage("Constructed LoginId : " + loginId, PROCESS_NAME, processID, SdpLoggerHelper.INFO);
}
else
{
	SdpLoggerHelper.logMessage("Failed While Creating LoginId ", PROCESS_NAME, processID, SdpLoggerHelper.INFO);
}
]]></wpc:javaCode>
                </wpc:script>
              </bpws:invoke>
              <bpws:assign name="PreInvokeAssigns8" wpc:displayName="Pre-Invoke Assigns" wpc:id="913">
                <bpws:copy>
                  <bpws:from variable="EmptyTransaction_Detail"/>
                  <bpws:to variable="TransactionDetailPort"/>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from>UCDCL</bpws:from>
                  <bpws:to variable="TransactionDetailPort">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/TargetSystem]]></bpws:query>
                  </bpws:to>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from>UCDCL.DelegatedLogin.Request</bpws:from>
                  <bpws:to variable="TransactionDetailPort">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/State]]></bpws:query>
                  </bpws:to>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from>DelegatedLogin</bpws:from>
                  <bpws:to variable="TransactionDetailPort">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/currentTargetOperation]]></bpws:query>
                  </bpws:to>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from variable="EmptyTransaction_Detail"/>
                  <bpws:to variable="processTransDetail"/>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from variable="emptyOrder"/>
                  <bpws:to variable="processBO"/>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from variable="loginId"/>
                  <bpws:to variable="processBO">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[order/ReqService/product/cvoipProduct/accountMailBoxes[1]/mailBoxInvariantId]]></bpws:query>
                  </bpws:to>
                </bpws:copy>
              </bpws:assign>
              <bpws:invoke name="LogUCDCLDelegatedLogin" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UCDCL.DelegatedLogin]" wpc:id="916">
                <wpc:script>
                  <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage(SdpLoggerHelper.INVOKE_STR +" : UCDCL.DelegatedLogin",PROCESS_NAME,processID,SdpLoggerHelper.INFO);]]></wpc:javaCode>
                </wpc:script>
              </bpws:invoke>
              <bpws:invoke name="InvokeUCDCLDelegatedLogin" operation="delegatedLogin" partnerLink="UcdclCompensableServicePartner_Interface" portType="ns25:UCDCLCompensableService_Interface" wpc:displayName="Invoke - [UCDCL.DelegatedLogin]" wpc:id="925">
                <wpc:input>
                  <wpc:parameter name="order" variable="processBO"/>
                </wpc:input>
                <wpc:output>
                  <wpc:parameter name="transactionDetail" variable="processTransDetail"/>
                </wpc:output>
                <bpws:catch faultName="wpc:runtimeFailure" faultVariable="bpcFault" wpc:faultType="wpc:BPCStandardFaultType" wpc:id="1878" wpc:variableId="926">
                  <bpws:invoke name="HandleruntimeFailure1" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Handle runtime Failure" wpc:id="928">
                    <wpc:script>
                      <wpc:javaCode><![CDATA[SdpErrorHelper.setErrDetInTransDet(TransactionDetailPort,bpcFault,SdpErrorHelper.SEVERITY_FATAL);

SdpLoggerHelper.logMessage(SdpLoggerHelper.RUNTIME_FAILURE+" UCDCL.DelegatedLogin",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);
]]></wpc:javaCode>
                    </wpc:script>
                  </bpws:invoke>
                </bpws:catch>
                <bpws:catch faultName="ns25:serviceCallFault" faultVariable="scFault" wpc:faultType="java:ServiceCallFault" wpc:id="1879" wpc:variableId="929">
                  <bpws:invoke name="SetErrorDetails4" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Set Error Details" wpc:id="931">
                    <wpc:script>
                      <wpc:javaCode><![CDATA[TransactionDetailPort.setBoolean(SdpHelper.ERRORINDICATOR,true);

new att.lightspeed.sdp.helper.TransactionDetail(TransactionDetailPort).setSDPErrorMessage(scFault);

TransactionDetailPort.getDataObject("errorDetails").getDataObject("Error").setString("Severity",SdpErrorHelper.SEVERITY_FATAL);

SdpLoggerHelper.logMessage(SdpLoggerHelper.FAULT_FAILURE +"  UCDCL.DelegatedLogin",PROCESS_NAME,processID,SdpLoggerHelper.FATAL); 
]]></wpc:javaCode>
                    </wpc:script>
                  </bpws:invoke>
                </bpws:catch>
                <bpws:catchAll wpc:id="1877">
                  <bpws:invoke name="HandleotherFailures2" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Handle other Failures" wpc:id="936">
                    <wpc:script>
                      <wpc:javaCode><![CDATA[SdpErrorHelper.setErrDetInTransDet(TransactionDetailPort,null,SdpErrorHelper.SEVERITY_FATAL);
SdpLoggerHelper.logMessage(SdpLoggerHelper.UNKNOWN_FAILURE +"  UCDCL.DelegatedLogin",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);]]></wpc:javaCode>
                    </wpc:script>
                  </bpws:invoke>
                </bpws:catchAll>
              </bpws:invoke>
              <bpws:switch name="ErrorinUCDCLDelegatedLogin" wpc:displayName="Error in UCDCL.DelegatedLogin?" wpc:id="949">
                <bpws:case wpc:id="950">
                  <bpws:condition><![CDATA[return TransactionDetailPort.getBoolean(SdpHelper.ERRORINDICATOR);]]></bpws:condition>
                  <bpws:sequence name="HiddenSequence28" wpc:id="1073743600">
                    <bpws:invoke name="LogUCDCLDelegatedLoginError" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UCDCL.DelegatedLogin - Error]" wpc:id="953">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[String strSeverity =TransactionDetailPort.getString("errorDetails/Error/Severity");
int logLevel = SdpHelper.getLogLevel(strSeverity);

SdpLoggerHelper.logMessage("UCDCL.DelegatedLogin :- "+SdpLoggerHelper.ERROR_STR+"["+strSeverity+"]",PROCESS_NAME,processID,logLevel);
SdpLoggerHelper.logMessage("Response BO [TransactionDetailPort:]",PROCESS_NAME,processID,logLevel);														
SdpLoggerHelper.logBO(TransactionDetailPort,PROCESS_NAME,processID,logLevel);
																		]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                    <bpws:assign name="PrepareGBOforLogging1" wpc:displayName="Prepare GBO for Logging" wpc:id="954">
                      <bpws:copy>
                        <bpws:from variable="TransactionDetailPort">
                          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/State]]></bpws:query>
                        </bpws:from>
                        <bpws:to variable="STATE"/>
                      </bpws:copy>
                      <bpws:copy>
                        <bpws:from variable="TransactionDetailPort">
                          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/Severity]]></bpws:query>
                        </bpws:from>
                        <bpws:to variable="SEVERITY"/>
                      </bpws:copy>
                      <bpws:copy>
                        <bpws:from variable="TransactionDetailPort">
                          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/Message]]></bpws:query>
                        </bpws:from>
                        <bpws:to variable="SDP_ERROR_OBJECT_MESSAGE"/>
                      </bpws:copy>
                      <bpws:copy>
                        <bpws:from>true</bpws:from>
                        <bpws:to variable="MANUAL_INTERVENTION_FLAG"/>
                      </bpws:copy>
                      <bpws:copy>
                        <bpws:from variable="TransactionDetailPort">
                          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/TargetSystem]]></bpws:query>
                        </bpws:from>
                        <bpws:to variable="TARGET_SYSTEM_NAME"/>
                      </bpws:copy>
                      <bpws:copy>
                        <bpws:from variable="TransactionDetailPort">
                          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/currentTargetOperation]]></bpws:query>
                        </bpws:from>
                        <bpws:to variable="TARGET_OPERATION_NAME"/>
                      </bpws:copy>
                      <bpws:copy>
                        <bpws:from variable="TransactionDetailPort">
                          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/Message]]></bpws:query>
                        </bpws:from>
                        <bpws:to variable="sdpOrderProc">
                          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/errorDetails/Error/Message]]></bpws:query>
                        </bpws:to>
                      </bpws:copy>
                    </bpws:assign>
                    <bpws:invoke name="LogCommonErrorLogger8" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [CommonErrorLogger ]" wpc:id="956">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage("Invoking CommonErrorLogger:",PROCESS_NAME,processID,SdpLoggerHelper.INFO);
												
sdpOrderProc.setString(SdpHelper.TEMPSTRING1_PATH.replace('.','/'),processID);																				]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                    <bpws:invoke name="InvokeLogError4" operation="logErrorDetails" partnerLink="FromSdp_CommonErrorLogger_Interface" portType="ns21:FromSdp_CommonErrorLogger_Interface" wpc:displayName="Invoke LogError" wpc:id="957">
                      <wpc:input>
                        <wpc:parameter name="transactionState" variable="STATE"/>
                        <wpc:parameter name="targetOperation" variable="TARGET_OPERATION_NAME"/>
                        <wpc:parameter name="parentProcessName" variable="PARENT_PROCESS_NAME"/>
                        <wpc:parameter name="sdpOrder" variable="sdpOrderProc"/>
                        <wpc:parameter name="manualInterventionInd" variable="MANUAL_INTERVENTION_FLAG"/>
                        <wpc:parameter name="severity" variable="SEVERITY"/>
                        <wpc:parameter name="targetSystem" variable="TARGET_SYSTEM_NAME"/>
                        <wpc:parameter name="sdpErrorObjectMessage" variable="SDP_ERROR_OBJECT_MESSAGE"/>
                      </wpc:input>
                      <wpc:output>
                        <wpc:parameter name="response" variable="TransactionDetail_Error"/>
                      </wpc:output>
                    </bpws:invoke>
                    <bpws:invoke name="LogCommonErrorLogger9" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [ CommonErrorLogger]" wpc:id="959">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage(" CommonErrorLogger",PROCESS_NAME,processID,SdpLoggerHelper.INFO);]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                    <bpws:assign name="Copyproctotrig3" wpc:displayName="Copy proc to trig" wpc:id="960">
                      <bpws:copy>
                        <bpws:from variable="sdpOrderProc"/>
                        <bpws:to variable="sdpOrderTrig"/>
                      </bpws:copy>
                      <bpws:copy>
                        <bpws:from variable="provSdpOrderProc"/>
                        <bpws:to variable="provSdpOrderTrig"/>
                      </bpws:copy>
                    </bpws:assign>
                    <bpws:reply name="Reply5" operation="compensateDeleteMailBox" partnerLink="DeleteMailBox_Compensation_Interface" portType="ns20:DeleteMailBox_Compensation_Interface" wpc:displayName="Reply" wpc:id="961">
                      <wpc:input>
                        <wpc:parameter name="SDP_ORDER_ProvPort" variable="provSdpOrderTrig"/>
                        <wpc:parameter name="Transaction_Detail" variable="TransactionDetailPort"/>
                        <wpc:parameter name="SDP_ORDER_RequestPort" variable="sdpOrderTrig"/>
                      </wpc:input>
                    </bpws:reply>
                    <bpws:terminate name="Terminate1" wpc:displayName="Terminate" wpc:id="962"/>
                  </bpws:sequence>
                </bpws:case>
                <bpws:otherwise wpc:id="1886">
                  <bpws:sequence name="HiddenSequence29" wpc:id="1073743601">
                    <bpws:invoke name="LogUCDCLDelegatedLoginSuccess" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UCDCL.DelegatedLogin - Success]" wpc:id="964">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage("UCDCL.DelegatedLogin -"+SdpLoggerHelper.SUCCESS_STR,PROCESS_NAME,
	processID,SdpLoggerHelper.INFO);]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                    <bpws:invoke name="SetUMSessionIDUMMessageCenterIP2" operation="null" partnerLink="null" portType="wpc:null" wpc:continueOnError="inherit" wpc:displayName="Set UMSessionID &amp; UMMessageCenterIP" wpc:id="1830">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[att.lightspeed.sdp.helper.WpsLogger logger = att.lightspeed.sdp.helper.WpsLogger.getLogger(processInstance());
String UMSessionID = null;
String UMMessageCenterIP = null;
umJSessionId = null;

UMSessionID = processTransDetail.getString(SdpHelper.TRANSDETAIL_UMSESSIONID);
umJSessionId = processTransDetail.getString(SdpHelper.TRANSDETAIL_UMSESSIONID);
UMMessageCenterIP = processTransDetail.getString(SdpHelper.TRANSDETAIL_UMMESSAGECENTERIP);

logger.debug("UMSessionID from the DelegatedLogin Response: " + UMSessionID);
logger.debug("UMMessageCenterIP from the DelegatedLogin Response: " + UMMessageCenterIP);

processBO.setString(SdpHelper.xPathify(SdpHelper.TRANSDETAIL_UMSESSIONID_PATH),UMSessionID);

processBO.setString(SdpHelper.xPathify(SdpHelper.TRANSDETAIL_UMMESSAGECENTERIP_PATH),UMMessageCenterIP);
]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                    <bpws:assign name="PreInvokeAssigns9" wpc:displayName="Pre-Invoke Assigns" wpc:id="970">
                      <bpws:copy>
                        <bpws:from variable="EmptyTransaction_Detail"/>
                        <bpws:to variable="TransactionDetailPort"/>
                      </bpws:copy>
                      <bpws:copy>
                        <bpws:from>UCDCL</bpws:from>
                        <bpws:to variable="TransactionDetailPort">
                          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/TargetSystem]]></bpws:query>
                        </bpws:to>
                      </bpws:copy>
                      <bpws:copy>
                        <bpws:from>UCDCL.CreateInvariantId.Request</bpws:from>
                        <bpws:to variable="TransactionDetailPort">
                          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/State]]></bpws:query>
                        </bpws:to>
                      </bpws:copy>
                      <bpws:copy>
                        <bpws:from>CreateInvariantId</bpws:from>
                        <bpws:to variable="TransactionDetailPort">
                          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/currentTargetOperation]]></bpws:query>
                        </bpws:to>
                      </bpws:copy>
                    </bpws:assign>
                    <bpws:invoke name="LogUCDCLcreateInvariantId" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UCDCL.createInvariantId]" wpc:id="973">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage(SdpLoggerHelper.INVOKE_STR +" : UCDCL.createInvariantId",PROCESS_NAME,processID,SdpLoggerHelper.INFO);]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                    <bpws:invoke name="InvokeUCDCLcreateInvariantId" operation="createInvariantID" partnerLink="UcdclCompensableServicePartner_Interface" portType="ns25:UCDCLCompensableService_Interface" wpc:displayName="Invoke - [UCDCL.createInvariantId]" wpc:id="982">
                      <wpc:input>
                        <wpc:parameter name="order" variable="processBO"/>
                      </wpc:input>
                      <wpc:output>
                        <wpc:parameter name="returnOrder" variable="processBO"/>
                      </wpc:output>
                      <bpws:catch faultName="wpc:runtimeFailure" faultVariable="bpcFault" wpc:faultType="wpc:BPCStandardFaultType" wpc:id="1888" wpc:variableId="983">
                        <bpws:invoke name="HandleruntimeFailure1" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Handle runtime Failure" wpc:id="985">
                          <wpc:script>
                            <wpc:javaCode><![CDATA[SdpErrorHelper.setErrDetInTransDet(TransactionDetailPort,bpcFault,SdpErrorHelper.SEVERITY_FATAL);

SdpLoggerHelper.logMessage(SdpLoggerHelper.RUNTIME_FAILURE+" UCDCL.CreateInvariantId",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);
]]></wpc:javaCode>
                          </wpc:script>
                        </bpws:invoke>
                      </bpws:catch>
                      <bpws:catch faultName="ns25:serviceCallFault" faultVariable="scFault" wpc:faultType="java:ServiceCallFault" wpc:id="1889" wpc:variableId="986">
                        <bpws:invoke name="SetErrorDetails4" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Set Error Details" wpc:id="988">
                          <wpc:script>
                            <wpc:javaCode><![CDATA[TransactionDetailPort.setBoolean(SdpHelper.ERRORINDICATOR,true);

new att.lightspeed.sdp.helper.TransactionDetail(TransactionDetailPort).setSDPErrorMessage(scFault);

TransactionDetailPort.getDataObject("errorDetails").getDataObject("Error").setString("Severity",SdpErrorHelper.SEVERITY_FATAL);

SdpLoggerHelper.logMessage(SdpLoggerHelper.FAULT_FAILURE +"  UCDCL.CreateInvariantId",PROCESS_NAME,processID,SdpLoggerHelper.FATAL); 
]]></wpc:javaCode>
                          </wpc:script>
                        </bpws:invoke>
                      </bpws:catch>
                      <bpws:catchAll wpc:id="1887">
                        <bpws:invoke name="HandleotherFailures2" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Handle other Failures" wpc:id="993">
                          <wpc:script>
                            <wpc:javaCode><![CDATA[SdpErrorHelper.setErrDetInTransDet(TransactionDetailPort,null,SdpErrorHelper.SEVERITY_FATAL);
SdpLoggerHelper.logMessage(SdpLoggerHelper.UNKNOWN_FAILURE +"  UCDCL.CreateInvariantId",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);]]></wpc:javaCode>
                          </wpc:script>
                        </bpws:invoke>
                      </bpws:catchAll>
                    </bpws:invoke>
                    <bpws:switch name="ErrorinUCDCLcreateInvariantId" wpc:displayName="Error in UCDCL.createInvariantId?" wpc:id="1006">
                      <bpws:case wpc:id="1007">
                        <bpws:condition><![CDATA[return TransactionDetailPort.getBoolean(SdpHelper.ERRORINDICATOR);]]></bpws:condition>
                        <bpws:sequence name="HiddenSequence10" wpc:id="1073743602">
                          <bpws:invoke name="LogUCDCLcreateInvariantIdError" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UCDCL.createInvariantId - Error]" wpc:id="1010">
                            <wpc:script>
                              <wpc:javaCode><![CDATA[String strSeverity =TransactionDetailPort.getString("errorDetails/Error/Severity");
int logLevel = SdpHelper.getLogLevel(strSeverity);

SdpLoggerHelper.logMessage("UCDCL.createInvariantId :- "+SdpLoggerHelper.ERROR_STR+"["+strSeverity+"]",PROCESS_NAME,processID,logLevel);
SdpLoggerHelper.logMessage("Response BO [TransactionDetailPort:]",PROCESS_NAME,processID,logLevel);														
SdpLoggerHelper.logBO(TransactionDetailPort,PROCESS_NAME,processID,logLevel);
																		]]></wpc:javaCode>
                            </wpc:script>
                          </bpws:invoke>
                          <bpws:assign name="PrepareGBOforLogging1" wpc:displayName="Prepare GBO for Logging" wpc:id="1011">
                            <bpws:copy>
                              <bpws:from variable="TransactionDetailPort">
                                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/State]]></bpws:query>
                              </bpws:from>
                              <bpws:to variable="STATE"/>
                            </bpws:copy>
                            <bpws:copy>
                              <bpws:from variable="TransactionDetailPort">
                                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/Severity]]></bpws:query>
                              </bpws:from>
                              <bpws:to variable="SEVERITY"/>
                            </bpws:copy>
                            <bpws:copy>
                              <bpws:from variable="TransactionDetailPort">
                                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/Message]]></bpws:query>
                              </bpws:from>
                              <bpws:to variable="SDP_ERROR_OBJECT_MESSAGE"/>
                            </bpws:copy>
                            <bpws:copy>
                              <bpws:from>true</bpws:from>
                              <bpws:to variable="MANUAL_INTERVENTION_FLAG"/>
                            </bpws:copy>
                            <bpws:copy>
                              <bpws:from variable="TransactionDetailPort">
                                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/TargetSystem]]></bpws:query>
                              </bpws:from>
                              <bpws:to variable="TARGET_SYSTEM_NAME"/>
                            </bpws:copy>
                            <bpws:copy>
                              <bpws:from variable="TransactionDetailPort">
                                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/currentTargetOperation]]></bpws:query>
                              </bpws:from>
                              <bpws:to variable="TARGET_OPERATION_NAME"/>
                            </bpws:copy>
                            <bpws:copy>
                              <bpws:from variable="TransactionDetailPort">
                                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/Message]]></bpws:query>
                              </bpws:from>
                              <bpws:to variable="sdpOrderProc">
                                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/errorDetails/Error/Message]]></bpws:query>
                              </bpws:to>
                            </bpws:copy>
                          </bpws:assign>
                          <bpws:invoke name="LogCommonErrorLogger8" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [CommonErrorLogger ]" wpc:id="1013">
                            <wpc:script>
                              <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage("Invoking CommonErrorLogger:",PROCESS_NAME,processID,SdpLoggerHelper.INFO);
												
sdpOrderProc.setString(SdpHelper.TEMPSTRING1_PATH.replace('.','/'),processID);																				]]></wpc:javaCode>
                            </wpc:script>
                          </bpws:invoke>
                          <bpws:invoke name="InvokeLogError4" operation="logErrorDetails" partnerLink="FromSdp_CommonErrorLogger_Interface" portType="ns21:FromSdp_CommonErrorLogger_Interface" wpc:displayName="Invoke LogError" wpc:id="1014">
                            <wpc:input>
                              <wpc:parameter name="transactionState" variable="STATE"/>
                              <wpc:parameter name="targetOperation" variable="TARGET_OPERATION_NAME"/>
                              <wpc:parameter name="parentProcessName" variable="PARENT_PROCESS_NAME"/>
                              <wpc:parameter name="sdpOrder" variable="sdpOrderProc"/>
                              <wpc:parameter name="manualInterventionInd" variable="MANUAL_INTERVENTION_FLAG"/>
                              <wpc:parameter name="severity" variable="SEVERITY"/>
                              <wpc:parameter name="targetSystem" variable="TARGET_SYSTEM_NAME"/>
                              <wpc:parameter name="sdpErrorObjectMessage" variable="SDP_ERROR_OBJECT_MESSAGE"/>
                            </wpc:input>
                            <wpc:output>
                              <wpc:parameter name="response" variable="TransactionDetail_Error"/>
                            </wpc:output>
                          </bpws:invoke>
                          <bpws:invoke name="LogCommonErrorLogger9" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [ CommonErrorLogger]" wpc:id="1016">
                            <wpc:script>
                              <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage(" CommonErrorLogger",PROCESS_NAME,processID,SdpLoggerHelper.INFO);]]></wpc:javaCode>
                            </wpc:script>
                          </bpws:invoke>
                          <bpws:assign name="Copyproctotrig3" wpc:displayName="Copy proc to trig" wpc:id="1017">
                            <bpws:copy>
                              <bpws:from variable="sdpOrderProc"/>
                              <bpws:to variable="sdpOrderTrig"/>
                            </bpws:copy>
                            <bpws:copy>
                              <bpws:from variable="provSdpOrderProc"/>
                              <bpws:to variable="provSdpOrderTrig"/>
                            </bpws:copy>
                          </bpws:assign>
                          <bpws:reply name="Reply5" operation="compensateDeleteMailBox" partnerLink="DeleteMailBox_Compensation_Interface" portType="ns20:DeleteMailBox_Compensation_Interface" wpc:displayName="Reply" wpc:id="1018">
                            <wpc:input>
                              <wpc:parameter name="SDP_ORDER_ProvPort" variable="provSdpOrderTrig"/>
                              <wpc:parameter name="Transaction_Detail" variable="TransactionDetailPort"/>
                              <wpc:parameter name="SDP_ORDER_RequestPort" variable="sdpOrderTrig"/>
                            </wpc:input>
                          </bpws:reply>
                          <bpws:terminate name="Terminate1" wpc:displayName="Terminate" wpc:id="1019"/>
                        </bpws:sequence>
                      </bpws:case>
                      <bpws:otherwise wpc:id="1890">
                        <bpws:sequence name="HiddenSequence30" wpc:id="1073743603">
                          <bpws:invoke name="LogUCDCLcreateInvariantIdSuccess" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UCDCL.createInvariantId - Success]" wpc:id="1021">
                            <wpc:script>
                              <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage("UCDCL.createInvariantId -"+SdpLoggerHelper.SUCCESS_STR,PROCESS_NAME,
	processID,SdpLoggerHelper.INFO);
	
SdpLoggerHelper.logMessage("Created InvariantId : " + invariantId,PROCESS_NAME,
	processID,SdpLoggerHelper.INFO);
]]></wpc:javaCode>
                            </wpc:script>
                          </bpws:invoke>
                          <bpws:assign name="CopyinvariantIdtocurrentMailbox" wpc:displayName="Copy invariantId to currentMailbox" wpc:id="1026">
                            <bpws:copy>
                              <bpws:from variable="processBO">
                                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[order/ReqService/product/cvoipProduct/accountMailBoxes[1]/mailBoxInvariantId]]></bpws:query>
                              </bpws:from>
                              <bpws:to variable="currentMBox">
                                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/mailBoxInvariantId]]></bpws:query>
                              </bpws:to>
                            </bpws:copy>
                          </bpws:assign>
                        </bpws:sequence>
                      </bpws:otherwise>
                    </bpws:switch>
                  </bpws:sequence>
                </bpws:otherwise>
              </bpws:switch>
              <bpws:assign name="PreInvokeAssigns2" wpc:displayName="Pre-Invoke Assigns" wpc:id="1030">
                <bpws:copy>
                  <bpws:from variable="EmptyTransaction_Detail"/>
                  <bpws:to variable="TransactionDetailPort"/>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from>UCDCL</bpws:from>
                  <bpws:to variable="TransactionDetailPort">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/TargetSystem]]></bpws:query>
                  </bpws:to>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from>UCDCL.Login.Request</bpws:from>
                  <bpws:to variable="TransactionDetailPort">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/State]]></bpws:query>
                  </bpws:to>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from>Login</bpws:from>
                  <bpws:to variable="TransactionDetailPort">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/currentTargetOperation]]></bpws:query>
                  </bpws:to>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from variable="emptyOrder"/>
                  <bpws:to variable="processBO"/>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from variable="EmptyTransaction_Detail"/>
                  <bpws:to variable="processTransDetail"/>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from variable="umMessageCenterIP"/>
                  <bpws:to variable="processTransDetail">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[UMMessageCenterIP]]></bpws:query>
                  </bpws:to>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from variable="umJSessionId"/>
                  <bpws:to variable="processTransDetail">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[UMSessionID]]></bpws:query>
                  </bpws:to>
                </bpws:copy>
              </bpws:assign>
              <bpws:invoke name="LogUCDCLLogin1" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UCDCL.Login]" wpc:id="1033">
                <wpc:script>
                  <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage(SdpLoggerHelper.INVOKE_STR +" : UCDCL.Login",PROCESS_NAME,processID,SdpLoggerHelper.INFO);]]></wpc:javaCode>
                </wpc:script>
              </bpws:invoke>
              <bpws:invoke name="InvokeUCDCLLogin1" operation="provisioningServiceLogin" partnerLink="UcdclCompensableServicePartner_Interface" portType="ns25:UCDCLCompensableService_Interface" wpc:displayName="Invoke - [UCDCL.Login]" wpc:id="1042">
                <wpc:input>
                  <wpc:parameter name="transactionDetail" variable="processTransDetail"/>
                </wpc:input>
                <wpc:output>
                  <wpc:parameter name="transactionDetail" variable="processTransDetail"/>
                </wpc:output>
                <bpws:catch faultName="wpc:runtimeFailure" faultVariable="bpcFault" wpc:faultType="wpc:BPCStandardFaultType" wpc:id="1881" wpc:variableId="1043">
                  <bpws:invoke name="HandleruntimeFailure1" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Handle runtime Failure" wpc:id="1045">
                    <wpc:script>
                      <wpc:javaCode><![CDATA[SdpErrorHelper.setErrDetInTransDet(TransactionDetailPort,bpcFault,SdpErrorHelper.SEVERITY_FATAL);

SdpLoggerHelper.logMessage(SdpLoggerHelper.RUNTIME_FAILURE+" UCDCL.Login",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);
]]></wpc:javaCode>
                    </wpc:script>
                  </bpws:invoke>
                </bpws:catch>
                <bpws:catch faultName="ns25:serviceCallFault" faultVariable="scFault" wpc:faultType="java:ServiceCallFault" wpc:id="1882" wpc:variableId="1046">
                  <bpws:invoke name="SetErrorDetails4" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Set Error Details" wpc:id="1048">
                    <wpc:script>
                      <wpc:javaCode><![CDATA[TransactionDetailPort.setBoolean(SdpHelper.ERRORINDICATOR,true);

new att.lightspeed.sdp.helper.TransactionDetail(TransactionDetailPort).setSDPErrorMessage(scFault);

TransactionDetailPort.getDataObject("errorDetails").getDataObject("Error").setString("Severity",SdpErrorHelper.SEVERITY_FATAL);

SdpLoggerHelper.logMessage(SdpLoggerHelper.FAULT_FAILURE +"  UCDCL.Login",PROCESS_NAME,processID,SdpLoggerHelper.FATAL); 
]]></wpc:javaCode>
                    </wpc:script>
                  </bpws:invoke>
                </bpws:catch>
                <bpws:catchAll wpc:id="1880">
                  <bpws:invoke name="HandleotherFailures2" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Handle other Failures" wpc:id="1053">
                    <wpc:script>
                      <wpc:javaCode><![CDATA[SdpErrorHelper.setErrDetInTransDet(TransactionDetailPort,null,SdpErrorHelper.SEVERITY_FATAL);
SdpLoggerHelper.logMessage(SdpLoggerHelper.UNKNOWN_FAILURE +"  UCDCL.Login",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);]]></wpc:javaCode>
                    </wpc:script>
                  </bpws:invoke>
                </bpws:catchAll>
              </bpws:invoke>
              <bpws:switch name="ErrorinUCDCLLogin1" wpc:displayName="Error in UCDCL.Login?" wpc:id="1066">
                <bpws:case wpc:id="1067">
                  <bpws:condition><![CDATA[return TransactionDetailPort.getBoolean(SdpHelper.ERRORINDICATOR);]]></bpws:condition>
                  <bpws:sequence name="HiddenSequence9" wpc:id="1073743604">
                    <bpws:invoke name="LogUCDCLLoginError1" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UCDCL.Login - Error]" wpc:id="1070">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[String strSeverity =TransactionDetailPort.getString("errorDetails/Error/Severity");
int logLevel = SdpHelper.getLogLevel(strSeverity);

SdpLoggerHelper.logMessage("UCDCL.Login :- "+SdpLoggerHelper.ERROR_STR+"["+strSeverity+"]",PROCESS_NAME,processID,logLevel);
SdpLoggerHelper.logMessage("Response BO [TransactionDetailPort:]",PROCESS_NAME,processID,logLevel);														
SdpLoggerHelper.logBO(TransactionDetailPort,PROCESS_NAME,processID,logLevel);
																		]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                    <bpws:assign name="PrepareGBOforLogging1" wpc:displayName="Prepare GBO for Logging" wpc:id="1071">
                      <bpws:copy>
                        <bpws:from variable="TransactionDetailPort">
                          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/State]]></bpws:query>
                        </bpws:from>
                        <bpws:to variable="STATE"/>
                      </bpws:copy>
                      <bpws:copy>
                        <bpws:from variable="TransactionDetailPort">
                          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/Severity]]></bpws:query>
                        </bpws:from>
                        <bpws:to variable="SEVERITY"/>
                      </bpws:copy>
                      <bpws:copy>
                        <bpws:from variable="TransactionDetailPort">
                          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/Message]]></bpws:query>
                        </bpws:from>
                        <bpws:to variable="SDP_ERROR_OBJECT_MESSAGE"/>
                      </bpws:copy>
                      <bpws:copy>
                        <bpws:from>true</bpws:from>
                        <bpws:to variable="MANUAL_INTERVENTION_FLAG"/>
                      </bpws:copy>
                      <bpws:copy>
                        <bpws:from variable="TransactionDetailPort">
                          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/TargetSystem]]></bpws:query>
                        </bpws:from>
                        <bpws:to variable="TARGET_SYSTEM_NAME"/>
                      </bpws:copy>
                      <bpws:copy>
                        <bpws:from variable="TransactionDetailPort">
                          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/currentTargetOperation]]></bpws:query>
                        </bpws:from>
                        <bpws:to variable="TARGET_OPERATION_NAME"/>
                      </bpws:copy>
                      <bpws:copy>
                        <bpws:from variable="TransactionDetailPort">
                          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/Message]]></bpws:query>
                        </bpws:from>
                        <bpws:to variable="sdpOrderProc">
                          <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/errorDetails/Error/Message]]></bpws:query>
                        </bpws:to>
                      </bpws:copy>
                    </bpws:assign>
                    <bpws:invoke name="LogCommonErrorLogger8" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [CommonErrorLogger ]" wpc:id="1073">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage("Invoking CommonErrorLogger:",PROCESS_NAME,processID,SdpLoggerHelper.INFO);
												
sdpOrderProc.setString(SdpHelper.TEMPSTRING1_PATH.replace('.','/'),processID);																				]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                    <bpws:invoke name="InvokeLogError4" operation="logErrorDetails" partnerLink="FromSdp_CommonErrorLogger_Interface" portType="ns21:FromSdp_CommonErrorLogger_Interface" wpc:displayName="Invoke LogError" wpc:id="1074">
                      <wpc:input>
                        <wpc:parameter name="transactionState" variable="STATE"/>
                        <wpc:parameter name="targetOperation" variable="TARGET_OPERATION_NAME"/>
                        <wpc:parameter name="parentProcessName" variable="PARENT_PROCESS_NAME"/>
                        <wpc:parameter name="sdpOrder" variable="sdpOrderProc"/>
                        <wpc:parameter name="manualInterventionInd" variable="MANUAL_INTERVENTION_FLAG"/>
                        <wpc:parameter name="severity" variable="SEVERITY"/>
                        <wpc:parameter name="targetSystem" variable="TARGET_SYSTEM_NAME"/>
                        <wpc:parameter name="sdpErrorObjectMessage" variable="SDP_ERROR_OBJECT_MESSAGE"/>
                      </wpc:input>
                      <wpc:output>
                        <wpc:parameter name="response" variable="TransactionDetail_Error"/>
                      </wpc:output>
                    </bpws:invoke>
                    <bpws:invoke name="LogCommonErrorLogger9" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [ CommonErrorLogger]" wpc:id="1076">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage(" CommonErrorLogger",PROCESS_NAME,processID,SdpLoggerHelper.INFO);]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                    <bpws:assign name="Copyproctotrig3" wpc:displayName="Copy proc to trig" wpc:id="1077">
                      <bpws:copy>
                        <bpws:from variable="sdpOrderProc"/>
                        <bpws:to variable="sdpOrderTrig"/>
                      </bpws:copy>
                      <bpws:copy>
                        <bpws:from variable="provSdpOrderProc"/>
                        <bpws:to variable="provSdpOrderTrig"/>
                      </bpws:copy>
                    </bpws:assign>
                    <bpws:reply name="Reply5" operation="compensateDeleteMailBox" partnerLink="DeleteMailBox_Compensation_Interface" portType="ns20:DeleteMailBox_Compensation_Interface" wpc:displayName="Reply" wpc:id="1078">
                      <wpc:input>
                        <wpc:parameter name="SDP_ORDER_ProvPort" variable="provSdpOrderTrig"/>
                        <wpc:parameter name="Transaction_Detail" variable="TransactionDetailPort"/>
                        <wpc:parameter name="SDP_ORDER_RequestPort" variable="sdpOrderTrig"/>
                      </wpc:input>
                    </bpws:reply>
                    <bpws:terminate name="Terminate1" wpc:displayName="Terminate" wpc:id="1079"/>
                  </bpws:sequence>
                </bpws:case>
                <bpws:otherwise wpc:id="1891">
                  <bpws:sequence name="HiddenSequence39" wpc:id="1073743655">
                    <bpws:invoke name="LogUCDCLLoginSuccess" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UCDCL.Login - Success]" wpc:id="1081">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage("UCDCL.Login -"+SdpLoggerHelper.SUCCESS_STR,PROCESS_NAME,
	processID,SdpLoggerHelper.INFO);]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                    <bpws:invoke name="SetUMSessionIDUMMessageCenterIP3" operation="null" partnerLink="null" portType="wpc:null" wpc:continueOnError="inherit" wpc:displayName="Set UMSessionID &amp; UMMessageCenterIP" wpc:id="1832">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[att.lightspeed.sdp.helper.WpsLogger logger = att.lightspeed.sdp.helper.WpsLogger.getLogger(processInstance());
String UMSessionID = null;
String UMMessageCenterIP = null;

UMSessionID = processTransDetail.getString(SdpHelper.TRANSDETAIL_UMSESSIONID);
UMMessageCenterIP = processTransDetail.getString(SdpHelper.TRANSDETAIL_UMMESSAGECENTERIP);

logger.debug("UMSessionID from the Login Response: " + UMSessionID);
logger.debug("UMMessageCenterIP from the Login Response: " + UMMessageCenterIP);

processBO.setString(SdpHelper.xPathify(SdpHelper.TRANSDETAIL_UMSESSIONID_PATH),UMSessionID);

processBO.setString(SdpHelper.xPathify(SdpHelper.TRANSDETAIL_UMMESSAGECENTERIP_PATH),UMMessageCenterIP);]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                  </bpws:sequence>
                </bpws:otherwise>
              </bpws:switch>
            </bpws:sequence>
          </bpws:case>
        </bpws:switch>
        <bpws:switch name="RollBackUCDCLDeleteDeviceCall" wpc:displayName="RollBack UCDCL.DeleteDevice Call?" wpc:id="1082">
          <bpws:case wpc:id="1083">
            <bpws:condition><![CDATA[return errorLevel.intValue() > 0;]]></bpws:condition>
            <bpws:sequence name="HiddenSequence31" wpc:id="1073743605">
              <bpws:invoke name="InitializeintListCounter2" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Initialize intListCounter" wpc:id="1086">
                <wpc:script>
                  <wpc:javaCode><![CDATA[intTNListCounter = new Integer(0);]]></wpc:javaCode>
                </wpc:script>
              </bpws:invoke>
              <bpws:while name="ForeachTNincurrentMailBox1" wpc:displayName="For each TN in currentMailBox" wpc:id="1113">
                <bpws:condition><![CDATA[return intTNListCounter.intValue() 
	< currentMBox.getList(SdpHelper.VOIP_MAILBOXTNS.replace('.','/')).size();]]></bpws:condition>
                <bpws:sequence name="HiddenSequence14" wpc:id="1073743606">
                  <bpws:invoke name="GetthecurrentTNfromcurrentMailBox" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Get the currentTN from currentMailBox" wpc:id="1116">
                    <wpc:script>
                      <wpc:javaCode><![CDATA[DataObject tmpMailbox = null;
tmpMailbox = SdpHelper.copySpecificBO(currentMBox);

List lstMailboxTNs = tmpMailbox.getList(SdpHelper.VOIP_MAILBOXTNS);
currentTN = (DataObject) lstMailboxTNs.get(intTNListCounter.intValue()); ]]></wpc:javaCode>
                    </wpc:script>
                  </bpws:invoke>
                  <bpws:switch name="NotaPTL1" wpc:displayName="Not a PTL?" wpc:id="1168">
                    <bpws:case wpc:id="1169">
                      <bpws:condition><![CDATA[String strTN = null;
String primaryTNInd = null;
String isNLT = null;
boolean blnPTL = false;

DataObject lineSubComponent = null;

if (currentTN != null)
{
	strTN = currentTN.getString(SdpHelper.CVOIP_MAILBOX_TN);
	
	SdpLoggerHelper.logMessage("Current TN [ " + strTN + "]", PROCESS_NAME, processID, 
		SdpLoggerHelper.DEBUG);
	
	lineSubComponent = SdpHelper.getTN(provSdpOrderProc,strTN);
	
	if (lineSubComponent != null)
	{
		primaryTNInd = lineSubComponent.getString(SdpHelper.CVOIP_TN_PRIMARYIND_PATH.replace('.' , '/'));
		isNLT = lineSubComponent.getString(SdpHelper.ISNLT);
		
		SdpLoggerHelper.logMessage("Primary TN Ind[ " + primaryTNInd + "]", PROCESS_NAME, processID, 
			SdpLoggerHelper.DEBUG);
		
		SdpLoggerHelper.logMessage("NLT Ind " + isNLT + "]", PROCESS_NAME, processID, 
			SdpLoggerHelper.DEBUG);
		//Changing the logic for UBV 2 orders.	
		if ((!StringUtil.isEmpty(isNLT) && isNLT.equalsIgnoreCase(SdpHelper.YES)) || primaryTNInd.equalsIgnoreCase(SdpHelper.YES))
		/*if (primaryTNInd.equalsIgnoreCase(SdpHelper.YES))*/
		{
			blnPTL = true;
		}
	}
}

return !blnPTL;]]></bpws:condition>
                      <bpws:sequence name="HiddenSequence13" wpc:id="1073743607">
                        <bpws:assign name="PreInvokeAssigns7" wpc:displayName="Pre-Invoke Assigns" wpc:id="1117">
                          <bpws:copy>
                            <bpws:from variable="currentMBox">
                              <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/mailBoxInvariantId]]></bpws:query>
                            </bpws:from>
                            <bpws:to variable="ucdclEmailOrPhone"/>
                          </bpws:copy>
                          <bpws:copy>
                            <bpws:from variable="EmptyTransaction_Detail"/>
                            <bpws:to variable="TransactionDetailPort"/>
                          </bpws:copy>
                          <bpws:copy>
                            <bpws:from>UCDCL</bpws:from>
                            <bpws:to variable="TransactionDetailPort">
                              <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/TargetSystem]]></bpws:query>
                            </bpws:to>
                          </bpws:copy>
                          <bpws:copy>
                            <bpws:from>UCDCL.AddDevice.Request</bpws:from>
                            <bpws:to variable="TransactionDetailPort">
                              <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/State]]></bpws:query>
                            </bpws:to>
                          </bpws:copy>
                          <bpws:copy>
                            <bpws:from>AddDevice</bpws:from>
                            <bpws:to variable="TransactionDetailPort">
                              <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/currentTargetOperation]]></bpws:query>
                            </bpws:to>
                          </bpws:copy>
                          <bpws:copy>
                            <bpws:from variable="currentTN">
                              <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/tn]]></bpws:query>
                            </bpws:from>
                            <bpws:to variable="ucdclDeviceNumber"/>
                          </bpws:copy>
                          <bpws:copy>
                            <bpws:from>Landline</bpws:from>
                            <bpws:to variable="ucdclDeviceType"/>
                          </bpws:copy>
                          <bpws:copy>
                            <bpws:from variable="provSdpOrderProc">
                              <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/order/ReqService/product/cvoipProduct/cfn]]></bpws:query>
                            </bpws:from>
                            <bpws:to variable="ucdclDeviceCFN"/>
                          </bpws:copy>
                          <bpws:copy>
                            <bpws:from>0000</bpws:from>
                            <bpws:to variable="ucdclAuthentication"/>
                          </bpws:copy>
                          <bpws:copy>
                            <bpws:from>SIP</bpws:from>
                            <bpws:to variable="ucdclTransportMWI"/>
                          </bpws:copy>
                          <bpws:copy>
                            <bpws:from variable="currentMBox">
                              <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[mailBoxInvariantId]]></bpws:query>
                            </bpws:from>
                            <bpws:to variable="processBO">
                              <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[order/ReqService/product/cvoipProduct/accountMailBoxes[1]/mailBoxInvariantId]]></bpws:query>
                            </bpws:to>
                          </bpws:copy>
                          <bpws:copy>
                            <bpws:from variable="currentTN">
                              <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[tn]]></bpws:query>
                            </bpws:from>
                            <bpws:to variable="processBO">
                              <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[order/ReqService/product/cvoipProduct/cvoipLineSubComponent[1]/tnInfo/tn]]></bpws:query>
                            </bpws:to>
                          </bpws:copy>
                          <bpws:copy>
                            <bpws:from variable="provSdpOrderProc">
                              <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[order/ReqService/product/cvoipProduct/cfn]]></bpws:query>
                            </bpws:from>
                            <bpws:to variable="processBO">
                              <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[order/ReqService/product/cvoipProduct/cfn]]></bpws:query>
                            </bpws:to>
                          </bpws:copy>
                        </bpws:assign>
                        <bpws:invoke name="LogUCDCLAddDevice1" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UCDCL.AddDevice]" wpc:id="1119">
                          <wpc:script>
                            <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage(SdpLoggerHelper.INVOKE_STR +" : UCDCL.AddDevice",PROCESS_NAME,processID,SdpLoggerHelper.INFO);												

SdpLoggerHelper.logMessage("ucdclEmailOrPhone :"+ucdclEmailOrPhone,PROCESS_NAME,processID,SdpLoggerHelper.INFO);
SdpLoggerHelper.logMessage("ucdclDeviceNumber :"+ucdclDeviceNumber,PROCESS_NAME,processID,SdpLoggerHelper.INFO);
SdpLoggerHelper.logMessage("ucdclDeviceType :"+ucdclDeviceType,PROCESS_NAME,processID,SdpLoggerHelper.INFO);
SdpLoggerHelper.logMessage("ucdclDeviceCFN :"+ucdclDeviceCFN,PROCESS_NAME,processID,SdpLoggerHelper.INFO);
SdpLoggerHelper.logMessage("ucdclAuthentication :"+ucdclAuthentication,PROCESS_NAME,processID,SdpLoggerHelper.INFO);
SdpLoggerHelper.logMessage("ucdclTransportMWI :"+ucdclTransportMWI,PROCESS_NAME,processID,SdpLoggerHelper.INFO);
														]]></wpc:javaCode>
                          </wpc:script>
                        </bpws:invoke>
                        <bpws:invoke name="InvokeUCDCLaddDevice" operation="addDevice" partnerLink="UcdclCompensableServicePartner_Interface" portType="ns25:UCDCLCompensableService_Interface" wpc:displayName="Invoke - [UCDCL.addDevice]" wpc:id="1120">
                          <wpc:input>
                            <wpc:parameter name="order" variable="processBO"/>
                          </wpc:input>
                          <wpc:output>
                            <wpc:parameter name="transactionDetail" variable="processTransDetail"/>
                          </wpc:output>
                          <bpws:catch faultName="wpc:runtimeFailure" faultVariable="bpcFault" wpc:faultType="wpc:BPCStandardFaultType" wpc:id="1898" wpc:variableId="1121">
                            <bpws:invoke name="Handleruntimefailure" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="handle runtime failure" wpc:id="1123">
                              <wpc:script>
                                <wpc:javaCode><![CDATA[SdpErrorHelper.setErrDetInTransDet(TransactionDetailPort,bpcFault,SdpErrorHelper.SEVERITY_FATAL);
SdpLoggerHelper.logMessage(SdpLoggerHelper.RUNTIME_FAILURE+"  UCDCL.AddDevice",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);]]></wpc:javaCode>
                              </wpc:script>
                            </bpws:invoke>
                          </bpws:catch>
                          <bpws:catch faultName="ns25:serviceCallFault" faultVariable="scFault" wpc:faultType="java:ServiceCallFault" wpc:id="1899" wpc:variableId="1124">
                            <bpws:invoke name="SetErrorDetails2" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Set Error Details" wpc:id="1126">
                              <wpc:script>
                                <wpc:javaCode><![CDATA[TransactionDetailPort.setBoolean(SdpHelper.ERRORINDICATOR,true);

new att.lightspeed.sdp.helper.TransactionDetail(TransactionDetailPort).setSDPErrorMessage(scFault);

TransactionDetailPort.getDataObject("errorDetails").getDataObject("Error").setString("Severity",SdpErrorHelper.SEVERITY_FATAL);

 
SdpLoggerHelper.logMessage(SdpLoggerHelper.FAULT_FAILURE +"  UCDCL.AddDevice",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);
 ]]></wpc:javaCode>
                              </wpc:script>
                            </bpws:invoke>
                          </bpws:catch>
                          <bpws:catchAll wpc:id="1897">
                            <bpws:invoke name="Handleotherfailures" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="handle other failures" wpc:id="1131">
                              <wpc:script>
                                <wpc:javaCode><![CDATA[SdpErrorHelper.setErrDetInTransDet(TransactionDetailPort,null,SdpErrorHelper.SEVERITY_FATAL);
SdpLoggerHelper.logMessage(SdpLoggerHelper.UNKNOWN_FAILURE+"  UCDCL.AddDevice",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);]]></wpc:javaCode>
                              </wpc:script>
                            </bpws:invoke>
                          </bpws:catchAll>
                        </bpws:invoke>
                        <bpws:switch name="CheckUCDCLError" wpc:displayName="Check UCDCL Error" wpc:id="1132">
                          <bpws:case wpc:id="1133">
                            <bpws:condition><![CDATA[boolean __result__1 = com.ibm.wbiservers.brules.core.codegen.NillableUtility.getBoolean(TransactionDetailPort, "errorIndicator", "TransactionDetailPort");
return __result__1;

//@generated:com.ibm.wbit.activity.ui
//<?xml version="1.0" encoding="UTF-8"?>
//<com.ibm.wbit.activity:CompositeActivity xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:com.ibm.wbit.activity="http:///com/ibm/wbit/activity.ecore" name="ActivityMethod">
//  <result name="Result">
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="boolean"/>
//  </result>
//  <exceptions>
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="com.ibm.bpe.api.ProcessException"/>
//  </exceptions>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="TransactionDetailPort.errorIndicator" field="true">
//    <dataOutputs target="//@executableElements.1"/>
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="boolean" namespace="http://www.w3.org/2001/XMLSchema" nillable="false"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:ReturnElement" dataInputs="//@executableElements.0/@dataOutputs.0"/>
//  <executableGroups executableElements="//@executableElements.0 //@executableElements.1"/>
//</com.ibm.wbit.activity:CompositeActivity>
//@generated:end
//!SMAP!*S WBIACTDBG
//!SMAP!*L
//!SMAP!1:1,1
//!SMAP!2:2,1
//!SMAP!1000000:26,1]]></bpws:condition>
                            <bpws:sequence name="HiddenSequence19" wpc:id="1073743608">
                              <bpws:invoke name="LogUCDCLAddDeviceError" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [ UCDCL.AddDevice  - Error]" wpc:id="1136">
                                <wpc:script>
                                  <wpc:javaCode><![CDATA[String strSeverity =TransactionDetailPort.getString("errorDetails/Error/Severity");
int logLevel = SdpHelper.getLogLevel(strSeverity);
SdpLoggerHelper.logMessage(" UCDCL.AddDevice - "+SdpLoggerHelper.ERROR_STR+"["+strSeverity+"]",PROCESS_NAME,processID,logLevel);]]></wpc:javaCode>
                                </wpc:script>
                              </bpws:invoke>
                              <bpws:assign name="PrepareGBOforLogging3" wpc:displayName="prepare GBO for Logging" wpc:id="1137">
                                <bpws:copy>
                                  <bpws:from variable="TransactionDetailPort">
                                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/State]]></bpws:query>
                                  </bpws:from>
                                  <bpws:to variable="STATE"/>
                                </bpws:copy>
                                <bpws:copy>
                                  <bpws:from variable="TransactionDetailPort">
                                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/Severity]]></bpws:query>
                                  </bpws:from>
                                  <bpws:to variable="SEVERITY"/>
                                </bpws:copy>
                                <bpws:copy>
                                  <bpws:from variable="TransactionDetailPort">
                                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/Message]]></bpws:query>
                                  </bpws:from>
                                  <bpws:to variable="SDP_ERROR_OBJECT_MESSAGE"/>
                                </bpws:copy>
                                <bpws:copy>
                                  <bpws:from>true</bpws:from>
                                  <bpws:to variable="MANUAL_INTERVENTION_FLAG"/>
                                </bpws:copy>
                                <bpws:copy>
                                  <bpws:from variable="TransactionDetailPort">
                                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/TargetSystem]]></bpws:query>
                                  </bpws:from>
                                  <bpws:to variable="TARGET_SYSTEM_NAME"/>
                                </bpws:copy>
                                <bpws:copy>
                                  <bpws:from variable="TransactionDetailPort">
                                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/currentTargetOperation]]></bpws:query>
                                  </bpws:from>
                                  <bpws:to variable="TARGET_OPERATION_NAME"/>
                                </bpws:copy>
                                <bpws:copy>
                                  <bpws:from variable="TransactionDetailPort">
                                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/Message]]></bpws:query>
                                  </bpws:from>
                                  <bpws:to variable="sdpOrderProc">
                                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/errorDetails/Error/Message]]></bpws:query>
                                  </bpws:to>
                                </bpws:copy>
                              </bpws:assign>
                              <bpws:invoke name="LogCommonErrorLogger6" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [CommonErrorLogger ]" wpc:id="1139">
                                <wpc:script>
                                  <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage("Invoking CommonErrorLogger:",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

sdpOrderProc.setString(SdpHelper.TEMPSTRING1_PATH.replace('.','/'),processID);		
																		]]></wpc:javaCode>
                                </wpc:script>
                              </bpws:invoke>
                              <bpws:invoke name="InvokeLogError3" operation="logErrorDetails" partnerLink="FromSdp_CommonErrorLogger_Interface" portType="ns21:FromSdp_CommonErrorLogger_Interface" wpc:displayName="Invoke Log Error" wpc:id="1140">
                                <wpc:input>
                                  <wpc:parameter name="transactionState" variable="STATE"/>
                                  <wpc:parameter name="targetOperation" variable="TARGET_OPERATION_NAME"/>
                                  <wpc:parameter name="parentProcessName" variable="PARENT_PROCESS_NAME"/>
                                  <wpc:parameter name="sdpOrder" variable="sdpOrderProc"/>
                                  <wpc:parameter name="manualInterventionInd" variable="MANUAL_INTERVENTION_FLAG"/>
                                  <wpc:parameter name="severity" variable="SEVERITY"/>
                                  <wpc:parameter name="targetSystem" variable="TARGET_SYSTEM_NAME"/>
                                  <wpc:parameter name="sdpErrorObjectMessage" variable="SDP_ERROR_OBJECT_MESSAGE"/>
                                </wpc:input>
                                <wpc:output>
                                  <wpc:parameter name="response" variable="TransactionDetail_Error"/>
                                </wpc:output>
                              </bpws:invoke>
                              <bpws:invoke name="LogCommonErrorLogger7" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [ CommonErrorLogger]" wpc:id="1142">
                                <wpc:script>
                                  <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage(" CommonErrorLogger",PROCESS_NAME,processID,SdpLoggerHelper.INFO);]]></wpc:javaCode>
                                </wpc:script>
                              </bpws:invoke>
                              <bpws:assign name="Copyproctotrig4" wpc:displayName="Copy proc to trig" wpc:id="1143">
                                <bpws:copy>
                                  <bpws:from variable="sdpOrderProc"/>
                                  <bpws:to variable="sdpOrderTrig"/>
                                </bpws:copy>
                                <bpws:copy>
                                  <bpws:from variable="provSdpOrderProc"/>
                                  <bpws:to variable="provSdpOrderTrig"/>
                                </bpws:copy>
                              </bpws:assign>
                              <bpws:reply name="Reply6" operation="compensateDeleteMailBox" partnerLink="DeleteMailBox_Compensation_Interface" portType="ns20:DeleteMailBox_Compensation_Interface" wpc:displayName="Reply" wpc:id="1144">
                                <wpc:input>
                                  <wpc:parameter name="SDP_ORDER_ProvPort" variable="provSdpOrderTrig"/>
                                  <wpc:parameter name="Transaction_Detail" variable="TransactionDetailPort"/>
                                  <wpc:parameter name="SDP_ORDER_RequestPort" variable="sdpOrderTrig"/>
                                </wpc:input>
                              </bpws:reply>
                              <bpws:terminate name="Terminate5" wpc:displayName="Terminate" wpc:id="1145"/>
                            </bpws:sequence>
                          </bpws:case>
                          <bpws:otherwise wpc:id="1900">
                            <bpws:sequence name="HiddenSequence40" wpc:id="1073743657">
                              <bpws:invoke name="LogUCDCLAddDeviceSuccess" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UCDCL.AddDevice-Success ]" wpc:id="1147">
                                <wpc:script>
                                  <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage("UCDCL.AddDevice -"+SdpLoggerHelper.SUCCESS_STR,PROCESS_NAME,processID,SdpLoggerHelper.INFO);]]></wpc:javaCode>
                                </wpc:script>
                              </bpws:invoke>
                              <bpws:invoke name="SetUMSessionIDUMMessageCenterIP4" operation="null" partnerLink="null" portType="wpc:null" wpc:continueOnError="inherit" wpc:displayName="Set UMSessionID &amp; UMMessageCenterIP" wpc:id="1834">
                                <wpc:script>
                                  <wpc:javaCode><![CDATA[att.lightspeed.sdp.helper.WpsLogger logger = att.lightspeed.sdp.helper.WpsLogger.getLogger(processInstance());
String UMSessionID = null;
String UMMessageCenterIP = null;

UMSessionID = processTransDetail.getString(SdpHelper.TRANSDETAIL_UMSESSIONID);
UMMessageCenterIP = processTransDetail.getString(SdpHelper.TRANSDETAIL_UMMESSAGECENTERIP);

logger.debug("UMSessionID from the AddDevice Response: " + UMSessionID);
logger.debug("UMMessageCenterIP from the AddDevice Response: " + UMMessageCenterIP);

processBO.setString(SdpHelper.xPathify(SdpHelper.TRANSDETAIL_UMSESSIONID_PATH),UMSessionID);

processBO.setString(SdpHelper.xPathify(SdpHelper.TRANSDETAIL_UMMESSAGECENTERIP_PATH),UMMessageCenterIP);]]></wpc:javaCode>
                                </wpc:script>
                              </bpws:invoke>
                            </bpws:sequence>
                          </bpws:otherwise>
                        </bpws:switch>
                      </bpws:sequence>
                    </bpws:case>
                  </bpws:switch>
                  <bpws:invoke name="IntTNListCounter1" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="intTNListCounter++" wpc:id="1149">
                    <wpc:script>
                      <wpc:javaCode><![CDATA[intTNListCounter = new Integer(intTNListCounter.intValue() +1);
]]></wpc:javaCode>
                    </wpc:script>
                  </bpws:invoke>
                </bpws:sequence>
              </bpws:while>
            </bpws:sequence>
          </bpws:case>
        </bpws:switch>
        <bpws:switch name="RollBackDeleteComponent" wpc:displayName="RollBack DeleteComponent?" wpc:id="1213">
          <bpws:case wpc:id="1214">
            <bpws:condition><![CDATA[return isSecondaryMailboxCreated.booleanValue() && invariantId != null;]]></bpws:condition>
            <bpws:sequence name="HiddenSequence4" wpc:id="1073743609">
              <bpws:switch name="NeedDeleteComponentmailbox" wpc:displayName="Need DeleteComponent (mailbox)?" wpc:id="1814">
                <bpws:case wpc:id="1815">
                  <bpws:condition expressionLanguage="http://www.ibm.com/xmlns/prod/websphere/business-process/expression-lang/java/6.0.0/"><![CDATA[return errorLevel.intValue() < 4; ]]></bpws:condition>
                  <bpws:sequence name="HiddenSequence37" wpc:id="1073743640">
                    <bpws:invoke name="SetsdpOrderForUpdate3" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Set sdpOrderForUpdate" wpc:id="1807">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[DataObject tmpMailbox = null;

List lstAccountMailboxes = sdpOrderForUpdate.getList(SdpHelper.VOIP_ACCOUNTMAILBOXES_PATH.replace('.','/'));
lstAccountMailboxes.clear();
tmpMailbox = SdpHelper.copySpecificBO(currentMBox);
lstAccountMailboxes.add(tmpMailbox);

//R7 code
Order pOrder = new Order(sdpOrderForUpdate);
pOrder.getTransactionDetail().setCurrentProduct(Product.CVOIPMAILBOX);
pOrder.getTransactionDetail().setIteratorStep(0);]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                    <bpws:invoke name="LogMPSDeleteComponent" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [ MPS.DeleteComponent]" wpc:id="1809">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage(SdpLoggerHelper.INVOKE_STR +" : MPS.DeleteComponent",
	PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("Request BO:[sdpOrder]",
	PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("sdpOrderForUpdate:",
	PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(sdpOrderForUpdate,PROCESS_NAME,processID,SdpLoggerHelper.INFO);]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                    <bpws:invoke name="InvokeMPSdeleteComponentMailBox" operation="deleteComponent" partnerLink="MPSCompensableService2_InterfacePartner" portType="ns23:MPSCompensableService2_Interface" wpc:displayName="Invoke - [MPS.deleteComponent - MailBox]" wpc:id="1810">
                      <wpc:input>
                        <wpc:parameter name="order" variable="sdpOrderForUpdate"/>
                      </wpc:input>
                      <wpc:output/>
                    </bpws:invoke>
                    <bpws:invoke name="LogMPSDeleteComponentSuccess" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [MPS.DeleteComponent - Success]" wpc:id="1813">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage("MPS.DeleteComponent :-"+SdpLoggerHelper.SUCCESS_STR,
	PROCESS_NAME,processID,SdpLoggerHelper.INFO);
																	]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                  </bpws:sequence>
                </bpws:case>
              </bpws:switch>
              <bpws:assign name="PreInvokeAssigns6" wpc:displayName="Pre-Invoke Assigns" wpc:id="1218">
                <bpws:copy>
                  <bpws:from variable="EmptyTransaction_Detail"/>
                  <bpws:to variable="TransactionDetailPort"/>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from>MPS.CreateComponent.Request</bpws:from>
                  <bpws:to variable="TransactionDetailPort">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/State]]></bpws:query>
                  </bpws:to>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from>MPS</bpws:from>
                  <bpws:to variable="TransactionDetailPort">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/TargetSystem]]></bpws:query>
                  </bpws:to>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from>CreateComponent</bpws:from>
                  <bpws:to variable="TransactionDetailPort">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/currentTargetOperation]]></bpws:query>
                  </bpws:to>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from>MAILBOX</bpws:from>
                  <bpws:to variable="TransactionDetailPort">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/currentProduct]]></bpws:query>
                  </bpws:to>
                </bpws:copy>
                <bpws:copy>
                  <bpws:from variable="TransactionDetailPort"/>
                  <bpws:to variable="sdpOrderForUpdate">
                    <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail]]></bpws:query>
                  </bpws:to>
                </bpws:copy>
              </bpws:assign>
              <bpws:invoke name="SetsdpOrderForUpdate2" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Set sdpOrderForUpdate" wpc:id="1217">
                <wpc:script>
                  <wpc:javaCode><![CDATA[DataObject tmpMailbox = null;

List lstAccountMailboxes = sdpOrderForUpdate.getList(SdpHelper.VOIP_ACCOUNTMAILBOXES_PATH.replace('.','/'));
lstAccountMailboxes.clear();
tmpMailbox = SdpHelper.copySpecificBO(currentMBox);
lstAccountMailboxes.add(tmpMailbox);

//R7 code
Order pOrder = new Order(sdpOrderForUpdate);
pOrder.getTransactionDetail().setCurrentProduct(Product.CVOIPMAILBOX);
pOrder.getTransactionDetail().setIteratorStep(0);]]></wpc:javaCode>
                </wpc:script>
              </bpws:invoke>
              <bpws:invoke name="LogMPScompensateDeleteComponent" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [ MPS.compensateDeleteComponent]" wpc:id="1220">
                <wpc:script>
                  <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage(SdpLoggerHelper.INVOKE_STR +" : MPS.compensateDeleteComponent",PROCESS_NAME,processID
														,SdpLoggerHelper.INFO);
														
SdpLoggerHelper.logMessage("Request BO:[sdpOrder]",PROCESS_NAME,processID
														,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("sdpOrderForUpdate:",PROCESS_NAME,processID
														,SdpLoggerHelper.INFO);
														
SdpLoggerHelper.logBO(sdpOrderForUpdate,PROCESS_NAME,processID,SdpLoggerHelper.INFO);
																		]]></wpc:javaCode>
                </wpc:script>
              </bpws:invoke>
              <bpws:invoke name="InvokeMPScompensateDeleteComponentMailBox" operation="compensateDeleteComponent" partnerLink="MPSCompensableService2_InterfacePartner" portType="ns23:MPSCompensableService2_Interface" wpc:displayName="Invoke - [MPS.compensateDeleteComponent - MailBox]" wpc:id="1221">
                <wpc:input>
                  <wpc:parameter name="order" variable="sdpOrderForUpdate"/>
                </wpc:input>
              </bpws:invoke>
              <bpws:invoke name="InvokeMPScompensateAssociateMailboxTNs" operation="compensateAssociateMailboxTNs" partnerLink="MPSCompensableService2_InterfacePartner" portType="ns23:MPSCompensableService2_Interface" wpc:displayName="Invoke - [MPS.compensateAssociateMailboxTNs]" wpc:id="1761">
                <wpc:input>
                  <wpc:parameter name="order" variable="sdpOrderForUpdate"/>
                </wpc:input>
              </bpws:invoke>
              <bpws:invoke name="LogMPScompensateDeleteComponentSuccess" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [MPS.compensateDeleteComponent-Success ]" wpc:id="1243">
                <wpc:script>
                  <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage("MPS.compensateDeleteComponent :-"+SdpLoggerHelper.SUCCESS_STR,
	PROCESS_NAME,processID,SdpLoggerHelper.INFO);
																	]]></wpc:javaCode>
                </wpc:script>
              </bpws:invoke>
              <bpws:assign name="IntCounter0" wpc:displayName="intCounter = 0" wpc:id="1246">
                <bpws:copy>
                  <bpws:from>0</bpws:from>
                  <bpws:to variable="intCounter"/>
                </bpws:copy>
              </bpws:assign>
              <bpws:while name="LoopeachmailboxMember" wpc:displayName="Loop each mailboxMember" wpc:id="1245">
                <bpws:condition><![CDATA[List lstMailboxMember = null;
lstMailboxMember = currentMBox.getList(SdpHelper.VOIP_MAILBOX_MEMBERS);
return intCounter.intValue() < lstMailboxMember.size();]]></bpws:condition>
                <bpws:sequence name="HiddenSequence6" wpc:id="1073743610">
                  <bpws:invoke name="SetsdpOrderForUpdate1" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Set sdpOrderForUpdate" wpc:id="1249">
                    <wpc:script>
                      <wpc:javaCode><![CDATA[DataObject tmpMailbox = null;
DataObject memberProfile = null;
DataObject mailboxMember = null;

List lstMemberProfile = null;
List lstMailboxMember = null;

String strMemberId = null;
String strInvariantId = null;
String strMboxComponentID = null;

lstMemberProfile = sdpOrderForUpdate.getList(SdpHelper.MEMBERPROFILE_LIST_PATH.replace('.','/'));
lstMemberProfile.clear();

lstMailboxMember = currentMBox.getList(SdpHelper.VOIP_MAILBOX_MEMBERS);
mailboxMember = (DataObject)lstMailboxMember.get(intCounter.intValue());
strMemberId = mailboxMember.getString(SdpHelper.CVOIP_MAILBOX_MEMBERID);
strInvariantId = currentMBox.getString(SdpHelper.CVOIP_MAILBOX_MAILBOXINVARIANTID);
strMboxComponentID = currentMBox.getString(SdpHelper.CVOIP_MAILBOX_COMPONENTID);

memberProfile = SdpHelper.getMemberProfile(provSdpOrderProc,strMemberId,SdpHelper.MEMBER_FILTER);
memberProfile.setString(SdpHelper.MEMBERPROFILE_MAILBOXINVARIANTID,strInvariantId);
memberProfile.setString(SdpHelper.MEMBERPROFILE_MAILBOXCOMPONENTID,strMboxComponentID);
lstMemberProfile.add(memberProfile);]]></wpc:javaCode>
                    </wpc:script>
                  </bpws:invoke>
                  <bpws:assign name="PreInvokeAssigns12" wpc:displayName="Pre-Invoke Assigns" wpc:id="1251">
                    <bpws:copy>
                      <bpws:from variable="EmptyTransaction_Detail"/>
                      <bpws:to variable="TransactionDetailPort"/>
                    </bpws:copy>
                    <bpws:copy>
                      <bpws:from>MPS.UpdateUser.Request</bpws:from>
                      <bpws:to variable="TransactionDetailPort">
                        <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/State]]></bpws:query>
                      </bpws:to>
                    </bpws:copy>
                    <bpws:copy>
                      <bpws:from>MPS</bpws:from>
                      <bpws:to variable="TransactionDetailPort">
                        <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/TargetSystem]]></bpws:query>
                      </bpws:to>
                    </bpws:copy>
                    <bpws:copy>
                      <bpws:from>UpdateUser</bpws:from>
                      <bpws:to variable="TransactionDetailPort">
                        <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/currentTargetOperation]]></bpws:query>
                      </bpws:to>
                    </bpws:copy>
                    <bpws:copy>
                      <bpws:from>MAILBOX</bpws:from>
                      <bpws:to variable="TransactionDetailPort">
                        <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/currentProduct]]></bpws:query>
                      </bpws:to>
                    </bpws:copy>
                    <bpws:copy>
                      <bpws:from variable="TransactionDetailPort"/>
                      <bpws:to variable="sdpOrderForUpdate">
                        <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail]]></bpws:query>
                      </bpws:to>
                    </bpws:copy>
                  </bpws:assign>
                  <bpws:invoke name="SetMPSFilters" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Set MPS Filters" wpc:id="1295">
                    <wpc:script>
                      <wpc:javaCode><![CDATA[DataObject tmpMemProf = null;
List lstMemberProfile = null;

lstMemberProfile = sdpOrderForUpdate.getList(SdpHelper.MEMBERPROFILE_LIST_PATH.replace('.','/'));
tmpMemProf = (DataObject)lstMemberProfile.get(0);

/*
SdpLoggerHelper.logMessage("Setting up the Filters for WESM.updateSubscriber", PROCESS_NAME, processID,
	SdpLoggerHelper.DEBUG);
// R7 Filter setting not required
//Create WESM Content Filter 
ContentFilterCreator filterCreator = new ContentFilterCreator();

//Create WESM Select Filter
if(tmpMemProf.getString(SdpHelper.MEMBERPROFILE_PRIMARYMEMBERIND).equalsIgnoreCase(SdpHelper.YES))
	filterCreator.addSelectFilter(SdpHelper.ACCT_OBJID, SdpHelper.ACCT_OBJID_PATH);
else
	filterCreator.addSelectFilter(SdpHelper.MEMBERPROFILE_MEMBERID, SdpHelper.MEMBERPROFILE_MEMBERID_PATH);
	
//Set the Filter for the MailBoxInvarintID
filterCreator.addUpdateFilter(SdpHelper.MEMBERPROFILE_MAILBOXINVARIANTID, SdpHelper.MEMBERPROFILE_MAILBOXINVARIANTID_PATH);

//Set the Content filter to the transaction detail object. 
sdpOrderForUpdate.getDataObject("transactionDetail").setDataObject( "contentFilter", filterCreator.createFilters() );
*/
]]></wpc:javaCode>
                    </wpc:script>
                  </bpws:invoke>
                  <bpws:invoke name="LogMPScompensateAssociateUserMailbox" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [ MPS.compensateAssociateUserMailbox]" wpc:id="1254">
                    <wpc:script>
                      <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage(SdpLoggerHelper.INVOKE_STR +" : MPS.compensateAssociateUserMailbox",
	PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("Request BO:[sdpOrderForUpdate]",
	PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(sdpOrderForUpdate,PROCESS_NAME,processID,SdpLoggerHelper.INFO);]]></wpc:javaCode>
                    </wpc:script>
                  </bpws:invoke>
                  <bpws:invoke name="InvokeMPScompensateAssociateUserMailbox" operation="compensateAssociateUserMailbox" partnerLink="MPSCompensableService2_InterfacePartner" portType="ns23:MPSCompensableService2_Interface" wpc:displayName="Invoke - [MPS.compensateAssociateUserMailbox]" wpc:id="1259">
                    <wpc:input>
                      <wpc:parameter name="order" variable="sdpOrderForUpdate"/>
                    </wpc:input>
                  </bpws:invoke>
                  <bpws:invoke name="LogMPScompensateAssociateUserMailboxSuccess" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [MPS.compensateAssociateUserMailbox -Success]" wpc:id="1292">
                    <wpc:script>
                      <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage("MPS.compensateAssociateUserMailbox :-"+SdpLoggerHelper.SUCCESS_STR,PROCESS_NAME,
	processID,SdpLoggerHelper.INFO);
	
																		]]></wpc:javaCode>
                    </wpc:script>
                  </bpws:invoke>
                  <bpws:invoke name="IntCounter2" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="intCounter++" wpc:id="1297">
                    <wpc:script>
                      <wpc:javaCode><![CDATA[intCounter = new Integer (intCounter.intValue() + 1);]]></wpc:javaCode>
                    </wpc:script>
                  </bpws:invoke>
                </bpws:sequence>
              </bpws:while>
            </bpws:sequence>
          </bpws:case>
        </bpws:switch>
        <bpws:assign name="PreInvokeAssigns11" wpc:displayName="Pre-Invoke Assigns" wpc:id="1174">
          <bpws:copy>
            <bpws:from variable="EmptyTransaction_Detail"/>
            <bpws:to variable="TransactionDetailPort"/>
          </bpws:copy>
          <bpws:copy>
            <bpws:from>UCDCL</bpws:from>
            <bpws:to variable="TransactionDetailPort">
              <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/TargetSystem]]></bpws:query>
            </bpws:to>
          </bpws:copy>
          <bpws:copy>
            <bpws:from>UCDCL.Logout.Request</bpws:from>
            <bpws:to variable="TransactionDetailPort">
              <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/State]]></bpws:query>
            </bpws:to>
          </bpws:copy>
          <bpws:copy>
            <bpws:from>Logout</bpws:from>
            <bpws:to variable="TransactionDetailPort">
              <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/currentTargetOperation]]></bpws:query>
            </bpws:to>
          </bpws:copy>
        </bpws:assign>
        <bpws:invoke name="LogUCDCLLogout1" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UCDCL.Logout]" wpc:id="1177">
          <wpc:script>
            <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage(SdpLoggerHelper.INVOKE_STR +" : UCDCL.Logout",PROCESS_NAME,processID,SdpLoggerHelper.INFO);]]></wpc:javaCode>
          </wpc:script>
        </bpws:invoke>
        <bpws:invoke name="InvokeUCDCLLogout1" operation="provisioningServiceLogout" partnerLink="UcdclCompensableServicePartner_Interface" portType="ns25:UCDCLCompensableService_Interface" wpc:displayName="Invoke - [UCDCL.Logout]" wpc:id="1186">
          <wpc:input>
            <wpc:parameter name="transactionDetail" variable="processTransDetail"/>
          </wpc:input>
          <wpc:output/>
          <bpws:catch faultName="wpc:runtimeFailure" faultVariable="bpcFault" wpc:faultType="wpc:BPCStandardFaultType" wpc:id="1866" wpc:variableId="1187">
            <bpws:invoke name="HandleruntimeFailure1" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Handle runtime Failure" wpc:id="1189">
              <wpc:script>
                <wpc:javaCode><![CDATA[SdpErrorHelper.setErrDetInTransDet(TransactionDetailPort,bpcFault,SdpErrorHelper.SEVERITY_FATAL);

SdpLoggerHelper.logMessage(SdpLoggerHelper.RUNTIME_FAILURE+" UCDCL.Logout",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);
]]></wpc:javaCode>
              </wpc:script>
            </bpws:invoke>
          </bpws:catch>
          <bpws:catch faultName="ns25:serviceCallFault" faultVariable="scFault" wpc:faultType="java:ServiceCallFault" wpc:id="1867" wpc:variableId="1190">
            <bpws:invoke name="SetErrorDetails4" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Set Error Details" wpc:id="1192">
              <wpc:script>
                <wpc:javaCode><![CDATA[TransactionDetailPort.setBoolean(SdpHelper.ERRORINDICATOR,true);

new att.lightspeed.sdp.helper.TransactionDetail(TransactionDetailPort).setSDPErrorMessage(scFault);

TransactionDetailPort.getDataObject("errorDetails").getDataObject("Error").setString("Severity",SdpErrorHelper.SEVERITY_FATAL);

SdpLoggerHelper.logMessage(SdpLoggerHelper.FAULT_FAILURE +"  UCDCL.Logout",PROCESS_NAME,processID,SdpLoggerHelper.FATAL); 
]]></wpc:javaCode>
              </wpc:script>
            </bpws:invoke>
          </bpws:catch>
          <bpws:catchAll wpc:id="1865">
            <bpws:invoke name="HandleotherFailures2" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Handle other Failures" wpc:id="1197">
              <wpc:script>
                <wpc:javaCode><![CDATA[SdpErrorHelper.setErrDetInTransDet(TransactionDetailPort,null,SdpErrorHelper.SEVERITY_FATAL);
SdpLoggerHelper.logMessage(SdpLoggerHelper.UNKNOWN_FAILURE +"  UCDCL.Logout",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);]]></wpc:javaCode>
              </wpc:script>
            </bpws:invoke>
          </bpws:catchAll>
        </bpws:invoke>
        <bpws:switch name="ErrorinUCDCLLogout1" wpc:displayName="Error in UCDCL.Logout?" wpc:id="1203">
          <bpws:case wpc:id="1204">
            <bpws:condition><![CDATA[return TransactionDetailPort.getBoolean(SdpHelper.ERRORINDICATOR);]]></bpws:condition>
            <bpws:sequence name="HiddenSequence21" wpc:id="1073743616">
              <bpws:invoke name="LogUCDCLLogoutError" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UCDCL.Logout - Error]" wpc:id="1207">
                <wpc:script>
                  <wpc:javaCode><![CDATA[String strSeverity =TransactionDetailPort.getString("errorDetails/Error/Severity");
int logLevel = SdpHelper.getLogLevel(strSeverity);

SdpLoggerHelper.logMessage("UCDCL.Logout :- "+SdpLoggerHelper.ERROR_STR+"["+strSeverity+"]",PROCESS_NAME,processID,logLevel);
SdpLoggerHelper.logMessage("Response BO [TransactionDetailPort:]",PROCESS_NAME,processID,logLevel);														
SdpLoggerHelper.logBO(TransactionDetailPort,PROCESS_NAME,processID,logLevel);
																		]]></wpc:javaCode>
                </wpc:script>
              </bpws:invoke>
            </bpws:sequence>
          </bpws:case>
          <bpws:otherwise wpc:id="1871">
            <bpws:invoke name="LogUCDCLLogoutSuccess" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UCDCL.Logout - Success]" wpc:id="1209">
              <wpc:script>
                <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage("UCDCL.Logout -"+SdpLoggerHelper.SUCCESS_STR,PROCESS_NAME,
	processID,SdpLoggerHelper.INFO);]]></wpc:javaCode>
              </wpc:script>
            </bpws:invoke>
          </bpws:otherwise>
        </bpws:switch>
        <bpws:invoke name="IntListCounter1" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="intListCounter++" wpc:id="698">
          <wpc:script>
            <wpc:javaCode><![CDATA[intListCounter = new Integer (intListCounter.intValue()+1);]]></wpc:javaCode>
          </wpc:script>
        </bpws:invoke>
      </bpws:sequence>
    </bpws:while>
    <bpws:switch name="NeedstocallsetGroupMailboxInfo" wpc:displayName="Needs to call setGroupMailboxInfo?" wpc:id="1426">
      <bpws:case wpc:id="1427">
        <bpws:condition><![CDATA[return isSecondaryMailboxCreated.booleanValue() && invariantId != null;]]></bpws:condition>
        <bpws:sequence name="HiddenSequence23" wpc:id="1073743617">
          <bpws:assign name="PreInvokeAssigns13" wpc:displayName="Pre-Invoke Assigns" wpc:id="1428">
            <bpws:copy>
              <bpws:from variable="EmptyTransaction_Detail"/>
              <bpws:to variable="TransactionDetailPort"/>
            </bpws:copy>
            <bpws:copy>
              <bpws:from>UCDCL</bpws:from>
              <bpws:to variable="TransactionDetailPort">
                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/TargetSystem]]></bpws:query>
              </bpws:to>
            </bpws:copy>
            <bpws:copy>
              <bpws:from>UCDCL.DelegatedLogin.Request</bpws:from>
              <bpws:to variable="TransactionDetailPort">
                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/State]]></bpws:query>
              </bpws:to>
            </bpws:copy>
            <bpws:copy>
              <bpws:from>DelegatedLogin</bpws:from>
              <bpws:to variable="TransactionDetailPort">
                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/currentTargetOperation]]></bpws:query>
              </bpws:to>
            </bpws:copy>
            <bpws:copy>
              <bpws:from variable="emptyOrder"/>
              <bpws:to variable="processBO"/>
            </bpws:copy>
            <bpws:copy>
              <bpws:from variable="EmptyTransaction_Detail"/>
              <bpws:to variable="processTransDetail"/>
            </bpws:copy>
          </bpws:assign>
          <bpws:invoke name="CreateloginId1" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Create loginId" wpc:id="1591">
            <wpc:script>
              <wpc:javaCode><![CDATA[String tn = null;
try
{       
		loginId = null;
		DataObject primaryMBox = SdpHelper.getPrimaryMailBox(provSdpOrderProc);
		tn = ((DataObject)primaryMBox.getList("mailBoxTNs").get(0)).getString("tn");
		loginId = tn;
		SdpLoggerHelper.logMessage("LoginId : " + loginId, PROCESS_NAME, processID, SdpLoggerHelper.INFO);
	
}
catch(Exception ex)
{
	SdpLoggerHelper.logMessage("Exception Occured: " + ex, PROCESS_NAME, processID, SdpLoggerHelper.DEBUG);
}]]></wpc:javaCode>
            </wpc:script>
          </bpws:invoke>
          <bpws:assign name="BuildGBO" wpc:displayName="Build GBO" wpc:id="1835">
            <bpws:copy>
              <bpws:from variable="loginId"/>
              <bpws:to variable="processBO">
                <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[order/ReqService/product/cvoipProduct/accountMailBoxes[1]/mailBoxInvariantId]]></bpws:query>
              </bpws:to>
            </bpws:copy>
          </bpws:assign>
          <bpws:invoke name="LogUCDCLDelegatedLogin1" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UCDCL.DelegatedLogin]" wpc:id="1430">
            <wpc:script>
              <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage(SdpLoggerHelper.INVOKE_STR +" : UCDCL.DelegatedLogin",PROCESS_NAME,processID,SdpLoggerHelper.INFO);]]></wpc:javaCode>
            </wpc:script>
          </bpws:invoke>
          <bpws:invoke name="InvokeUCDCLDelegatedLogin1" operation="delegatedLogin" partnerLink="UcdclCompensableServicePartner_Interface" portType="ns25:UCDCLCompensableService_Interface" wpc:displayName="Invoke - [UCDCL.DelegatedLogin]" wpc:id="1431">
            <wpc:input>
              <wpc:parameter name="order" variable="processBO"/>
            </wpc:input>
            <wpc:output>
              <wpc:parameter name="transactionDetail" variable="processTransDetail"/>
            </wpc:output>
            <bpws:catch faultName="wpc:runtimeFailure" faultVariable="bpcFault" wpc:faultType="wpc:BPCStandardFaultType" wpc:id="1846" wpc:variableId="1432">
              <bpws:invoke name="HandleruntimeFailure1" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Handle runtime Failure" wpc:id="1434">
                <wpc:script>
                  <wpc:javaCode><![CDATA[SdpErrorHelper.setErrDetInTransDet(TransactionDetailPort,bpcFault,SdpErrorHelper.SEVERITY_FATAL);

SdpLoggerHelper.logMessage(SdpLoggerHelper.RUNTIME_FAILURE+" UCDCL.DelegatedLogin",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);
]]></wpc:javaCode>
                </wpc:script>
              </bpws:invoke>
            </bpws:catch>
            <bpws:catch faultName="ns25:serviceCallFault" faultVariable="scFault" wpc:faultType="java:ServiceCallFault" wpc:id="1847" wpc:variableId="1435">
              <bpws:invoke name="SetErrorDetails4" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Set Error Details" wpc:id="1437">
                <wpc:script>
                  <wpc:javaCode><![CDATA[TransactionDetailPort.setBoolean(SdpHelper.ERRORINDICATOR,true);

new att.lightspeed.sdp.helper.TransactionDetail(TransactionDetailPort).setSDPErrorMessage(scFault);

TransactionDetailPort.getDataObject("errorDetails").getDataObject("Error").setString("Severity",SdpErrorHelper.SEVERITY_FATAL);

SdpLoggerHelper.logMessage(SdpLoggerHelper.FAULT_FAILURE +"  UCDCL.DelegatedLogin",PROCESS_NAME,processID,SdpLoggerHelper.FATAL); 
]]></wpc:javaCode>
                </wpc:script>
              </bpws:invoke>
            </bpws:catch>
            <bpws:catchAll wpc:id="1845">
              <bpws:invoke name="HandleotherFailures2" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Handle other Failures" wpc:id="1442">
                <wpc:script>
                  <wpc:javaCode><![CDATA[SdpErrorHelper.setErrDetInTransDet(TransactionDetailPort,null,SdpErrorHelper.SEVERITY_FATAL);
SdpLoggerHelper.logMessage(SdpLoggerHelper.UNKNOWN_FAILURE +"  UCDCL.DelegatedLogin",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);]]></wpc:javaCode>
                </wpc:script>
              </bpws:invoke>
            </bpws:catchAll>
          </bpws:invoke>
          <bpws:switch name="ErrorinUCDCLDelegatedLogin1" wpc:displayName="Error in UCDCL.DelegatedLogin?" wpc:id="1443">
            <bpws:case wpc:id="1444">
              <bpws:condition><![CDATA[return TransactionDetailPort.getBoolean(SdpHelper.ERRORINDICATOR);]]></bpws:condition>
              <bpws:sequence name="HiddenSequence32" wpc:id="1073743618">
                <bpws:invoke name="LogUCDCLDelegatedLoginError" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UCDCL.DelegatedLogin - Error]" wpc:id="1447">
                  <wpc:script>
                    <wpc:javaCode><![CDATA[String strSeverity =TransactionDetailPort.getString("errorDetails/Error/Severity");
int logLevel = SdpHelper.getLogLevel(strSeverity);

SdpLoggerHelper.logMessage("UCDCL.DelegatedLogin :- "+SdpLoggerHelper.ERROR_STR+"["+strSeverity+"]",PROCESS_NAME,processID,logLevel);
SdpLoggerHelper.logMessage("Response BO [TransactionDetailPort:]",PROCESS_NAME,processID,logLevel);														
SdpLoggerHelper.logBO(TransactionDetailPort,PROCESS_NAME,processID,logLevel);
																		]]></wpc:javaCode>
                  </wpc:script>
                </bpws:invoke>
                <bpws:assign name="PrepareGBOforLogging1" wpc:displayName="Prepare GBO for Logging" wpc:id="1448">
                  <bpws:copy>
                    <bpws:from variable="TransactionDetailPort">
                      <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/State]]></bpws:query>
                    </bpws:from>
                    <bpws:to variable="STATE"/>
                  </bpws:copy>
                  <bpws:copy>
                    <bpws:from variable="TransactionDetailPort">
                      <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/Severity]]></bpws:query>
                    </bpws:from>
                    <bpws:to variable="SEVERITY"/>
                  </bpws:copy>
                  <bpws:copy>
                    <bpws:from variable="TransactionDetailPort">
                      <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/Message]]></bpws:query>
                    </bpws:from>
                    <bpws:to variable="SDP_ERROR_OBJECT_MESSAGE"/>
                  </bpws:copy>
                  <bpws:copy>
                    <bpws:from>true</bpws:from>
                    <bpws:to variable="MANUAL_INTERVENTION_FLAG"/>
                  </bpws:copy>
                  <bpws:copy>
                    <bpws:from variable="TransactionDetailPort">
                      <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/TargetSystem]]></bpws:query>
                    </bpws:from>
                    <bpws:to variable="TARGET_SYSTEM_NAME"/>
                  </bpws:copy>
                  <bpws:copy>
                    <bpws:from variable="TransactionDetailPort">
                      <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/currentTargetOperation]]></bpws:query>
                    </bpws:from>
                    <bpws:to variable="TARGET_OPERATION_NAME"/>
                  </bpws:copy>
                  <bpws:copy>
                    <bpws:from variable="TransactionDetailPort">
                      <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/Message]]></bpws:query>
                    </bpws:from>
                    <bpws:to variable="sdpOrderProc">
                      <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/errorDetails/Error/Message]]></bpws:query>
                    </bpws:to>
                  </bpws:copy>
                </bpws:assign>
                <bpws:invoke name="LogCommonErrorLogger8" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [CommonErrorLogger ]" wpc:id="1450">
                  <wpc:script>
                    <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage("Invoking CommonErrorLogger:",PROCESS_NAME,processID,SdpLoggerHelper.INFO);
												
sdpOrderProc.setString(SdpHelper.TEMPSTRING1_PATH.replace('.','/'),processID);																				]]></wpc:javaCode>
                  </wpc:script>
                </bpws:invoke>
                <bpws:invoke name="InvokeLogError4" operation="logErrorDetails" partnerLink="FromSdp_CommonErrorLogger_Interface" portType="ns21:FromSdp_CommonErrorLogger_Interface" wpc:displayName="Invoke LogError" wpc:id="1451">
                  <wpc:input>
                    <wpc:parameter name="transactionState" variable="STATE"/>
                    <wpc:parameter name="targetOperation" variable="TARGET_OPERATION_NAME"/>
                    <wpc:parameter name="parentProcessName" variable="PARENT_PROCESS_NAME"/>
                    <wpc:parameter name="sdpOrder" variable="sdpOrderProc"/>
                    <wpc:parameter name="manualInterventionInd" variable="MANUAL_INTERVENTION_FLAG"/>
                    <wpc:parameter name="severity" variable="SEVERITY"/>
                    <wpc:parameter name="targetSystem" variable="TARGET_SYSTEM_NAME"/>
                    <wpc:parameter name="sdpErrorObjectMessage" variable="SDP_ERROR_OBJECT_MESSAGE"/>
                  </wpc:input>
                  <wpc:output>
                    <wpc:parameter name="response" variable="TransactionDetail_Error"/>
                  </wpc:output>
                </bpws:invoke>
                <bpws:invoke name="LogCommonErrorLogger9" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [ CommonErrorLogger]" wpc:id="1453">
                  <wpc:script>
                    <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage(" CommonErrorLogger",PROCESS_NAME,processID,SdpLoggerHelper.INFO);]]></wpc:javaCode>
                  </wpc:script>
                </bpws:invoke>
                <bpws:assign name="Copyproctotrig3" wpc:displayName="Copy proc to trig" wpc:id="1454">
                  <bpws:copy>
                    <bpws:from variable="sdpOrderProc"/>
                    <bpws:to variable="sdpOrderTrig"/>
                  </bpws:copy>
                  <bpws:copy>
                    <bpws:from variable="provSdpOrderProc"/>
                    <bpws:to variable="provSdpOrderTrig"/>
                  </bpws:copy>
                </bpws:assign>
                <bpws:reply name="Reply5" operation="compensateDeleteMailBox" partnerLink="DeleteMailBox_Compensation_Interface" portType="ns20:DeleteMailBox_Compensation_Interface" wpc:displayName="Reply" wpc:id="1455">
                  <wpc:input>
                    <wpc:parameter name="SDP_ORDER_ProvPort" variable="provSdpOrderTrig"/>
                    <wpc:parameter name="Transaction_Detail" variable="TransactionDetailPort"/>
                    <wpc:parameter name="SDP_ORDER_RequestPort" variable="sdpOrderTrig"/>
                  </wpc:input>
                </bpws:reply>
                <bpws:terminate name="Terminate1" wpc:displayName="Terminate" wpc:id="1456"/>
              </bpws:sequence>
            </bpws:case>
            <bpws:otherwise wpc:id="1848">
              <bpws:sequence name="HiddenSequence33" wpc:id="1073743619">
                <bpws:invoke name="LogUCDCLDelegatedLoginSuccess" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UCDCL.DelegatedLogin - Success]" wpc:id="1459">
                  <wpc:script>
                    <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage("UCDCL.DelegatedLogin -"+SdpLoggerHelper.SUCCESS_STR,PROCESS_NAME,
	processID,SdpLoggerHelper.INFO);]]></wpc:javaCode>
                  </wpc:script>
                </bpws:invoke>
                <bpws:invoke name="SetUMSessionIDUMMessageCenterIP5" operation="null" partnerLink="null" portType="wpc:null" wpc:continueOnError="inherit" wpc:displayName="Set UMSessionID &amp; UMMessageCenterIP" wpc:id="1836">
                  <wpc:script>
                    <wpc:javaCode><![CDATA[att.lightspeed.sdp.helper.WpsLogger logger = att.lightspeed.sdp.helper.WpsLogger.getLogger(processInstance());
String UMSessionID = null;
String UMMessageCenterIP = null;

UMSessionID = processTransDetail.getString(SdpHelper.TRANSDETAIL_UMSESSIONID);
UMMessageCenterIP = processTransDetail.getString(SdpHelper.TRANSDETAIL_UMMESSAGECENTERIP);

logger.debug("UMSessionID from the DelegatedLogin Response: " + UMSessionID);
logger.debug("UMMessageCenterIP from the DelegatedLogin Response: " + UMMessageCenterIP);

processBO.setString(SdpHelper.xPathify(SdpHelper.TRANSDETAIL_UMSESSIONID_PATH),UMSessionID);

processBO.setString(SdpHelper.xPathify(SdpHelper.TRANSDETAIL_UMMESSAGECENTERIP_PATH),UMMessageCenterIP);]]></wpc:javaCode>
                  </wpc:script>
                </bpws:invoke>
                <bpws:assign name="PreInvokeAssigns14" wpc:displayName="Pre-Invoke Assigns" wpc:id="1460">
                  <bpws:copy>
                    <bpws:from variable="EmptyTransaction_Detail"/>
                    <bpws:to variable="TransactionDetailPort"/>
                  </bpws:copy>
                  <bpws:copy>
                    <bpws:from>UCDCL.getGroupMailboxInfo.Request</bpws:from>
                    <bpws:to variable="TransactionDetailPort">
                      <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/State]]></bpws:query>
                    </bpws:to>
                  </bpws:copy>
                  <bpws:copy>
                    <bpws:from>UCDCL</bpws:from>
                    <bpws:to variable="TransactionDetailPort">
                      <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/TargetSystem]]></bpws:query>
                    </bpws:to>
                  </bpws:copy>
                  <bpws:copy>
                    <bpws:from>getGroupMailboxInfo</bpws:from>
                    <bpws:to variable="TransactionDetailPort">
                      <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/currentTargetOperation]]></bpws:query>
                    </bpws:to>
                  </bpws:copy>
                </bpws:assign>
                <bpws:invoke name="LogUCDCLgetGroupMailboxInfo" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UCDCL.getGroupMailboxInfo]" wpc:id="1462">
                  <wpc:script>
                    <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage(SdpLoggerHelper.INVOKE_STR +" : UCDCL.getGroupMailboxInfo",
	PROCESS_NAME,processID,SdpLoggerHelper.INFO);]]></wpc:javaCode>
                  </wpc:script>
                </bpws:invoke>
                <bpws:invoke name="InvokeUCDCLgetGroupMailboxInfo" operation="getGroupMailboxInfo" partnerLink="UcdclCompensableServicePartner_Interface" portType="ns25:UCDCLCompensableService_Interface" wpc:displayName="Invoke - [UCDCL.getGroupMailboxInfo]" wpc:id="1463">
                  <wpc:input>
                    <wpc:parameter name="order" variable="processBO"/>
                  </wpc:input>
                  <wpc:output>
                    <wpc:parameter name="order" variable="sdpOrderPort"/>
                  </wpc:output>
                  <bpws:catch faultName="wpc:runtimeFailure" faultVariable="bpcFault" wpc:faultType="wpc:BPCStandardFaultType" wpc:id="1850" wpc:variableId="1464">
                    <bpws:invoke name="Handlesruntimefailures" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="handles runtime failures" wpc:id="1466">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[SdpErrorHelper.setErrDetInTransDet(sdpOrderPort.getDataObject(SdpHelper.TRANSACTION_DETAIL),bpcFault,SdpErrorHelper.SEVERITY_FATAL);
SdpLoggerHelper.logMessage(SdpLoggerHelper.RUNTIME_FAILURE+" UCDCL.getGroupMailboxInfo",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);

DataObject responseMessage = (DataObject)sdpOrderPort.getDataObject("transactionDetail/errorDetails/Error/Message");
responseMessage.setString(SdpHelper.ERRORDETAILS_MESSAGE_CODE,SdpErrorHelper.SDP_INTERNAL_SYSTEM_ERROR);]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                  </bpws:catch>
                  <bpws:catch faultName="ns25:serviceCallFault" faultVariable="scFault" wpc:faultType="java:ServiceCallFault" wpc:id="1851" wpc:variableId="1817">
                    <bpws:invoke name="SetErrorDetails1" operation="null" partnerLink="null" portType="wpc:null" wpc:continueOnError="inherit" wpc:displayName="Set Error Details" wpc:id="1818">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[TransactionDetailPort.setBoolean(SdpHelper.ERRORINDICATOR,true);

new att.lightspeed.sdp.helper.TransactionDetail(TransactionDetailPort).setSDPErrorMessage(scFault);

TransactionDetailPort.getDataObject("errorDetails").getDataObject("Error").setString("Severity",SdpErrorHelper.SEVERITY_FATAL);

SdpLoggerHelper.logMessage(SdpLoggerHelper.FAULT_FAILURE +"  UCDCL.DelegatedLogin",PROCESS_NAME,processID,SdpLoggerHelper.FATAL); ]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                  </bpws:catch>
                  <bpws:catchAll wpc:id="1849">
                    <bpws:invoke name="Handlesotherfailures" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="handles other failures" wpc:id="1468">
                      <wpc:script>
                        <wpc:javaCode><![CDATA[SdpErrorHelper.setErrDetInTransDet(sdpOrderPort.getDataObject(SdpHelper.TRANSACTION_DETAIL),null,SdpErrorHelper.SEVERITY_FATAL);
SdpLoggerHelper.logMessage(SdpLoggerHelper.UNKNOWN_FAILURE+" UCDCL.getGroupMailboxInfo",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);

DataObject responseMessage = (DataObject)sdpOrderPort.getDataObject("transactionDetail/errorDetails/Error/Message");
responseMessage.setString(SdpHelper.ERRORDETAILS_MESSAGE_CODE,SdpErrorHelper.SDP_INTERNAL_SYSTEM_ERROR);]]></wpc:javaCode>
                      </wpc:script>
                    </bpws:invoke>
                  </bpws:catchAll>
                </bpws:invoke>
                <bpws:switch name="CheckUCDCLError2" wpc:displayName="Check UCDCL Error?" wpc:id="1470">
                  <bpws:case wpc:id="1471">
                    <bpws:condition><![CDATA[boolean __result__1 = com.ibm.wbiservers.brules.core.codegen.NillableUtility.getBoolean(TransactionDetailPort, "errorIndicator", "TransactionDetailPort");
return __result__1;

//@generated:com.ibm.wbit.activity.ui
//<?xml version="1.0" encoding="UTF-8"?>
//<com.ibm.wbit.activity:CompositeActivity xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:com.ibm.wbit.activity="http:///com/ibm/wbit/activity.ecore" name="ActivityMethod">
//  <result name="Result">
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="boolean"/>
//  </result>
//  <exceptions>
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="com.ibm.bpe.api.ProcessException"/>
//  </exceptions>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="TransactionDetailPort.errorIndicator" field="true">
//    <dataOutputs target="//@executableElements.1"/>
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="boolean" namespace="http://www.w3.org/2001/XMLSchema" nillable="false"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:ReturnElement" dataInputs="//@executableElements.0/@dataOutputs.0"/>
//  <executableGroups executableElements="//@executableElements.0 //@executableElements.1"/>
//</com.ibm.wbit.activity:CompositeActivity>
//@generated:end
//!SMAP!*S WBIACTDBG
//!SMAP!*L
//!SMAP!1:1,1
//!SMAP!2:2,1
//!SMAP!1000000:26,1]]></bpws:condition>
                    <bpws:sequence name="HiddenSequence22" wpc:id="1073743620">
                      <bpws:invoke name="LogUCDCLgetGroupMailboxInfoError" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UCDCL.getGroupMailboxInfo - Error]" wpc:id="1474">
                        <wpc:script>
                          <wpc:javaCode><![CDATA[String strSeverity =TransactionDetailPort.getString("errorDetails/Error/Severity");
int logLevel = SdpHelper.getLogLevel(strSeverity);
SdpLoggerHelper.logMessage("UCDCL.getGroupMailboxInfo :- "+SdpLoggerHelper.ERROR_STR+"["+strSeverity+"]",PROCESS_NAME,processID,logLevel);
SdpLoggerHelper.logMessage("Response BO [sdpOrderPort]",PROCESS_NAME,processID,logLevel);													
SdpLoggerHelper.logBO(sdpOrderPort,PROCESS_NAME,processID,logLevel);
																		]]></wpc:javaCode>
                        </wpc:script>
                      </bpws:invoke>
                      <bpws:assign name="PrepareGBOforLogging4" wpc:displayName="Prepare GBO for Logging" wpc:id="1475">
                        <bpws:copy>
                          <bpws:from variable="TransactionDetailPort">
                            <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/State]]></bpws:query>
                          </bpws:from>
                          <bpws:to variable="STATE"/>
                        </bpws:copy>
                        <bpws:copy>
                          <bpws:from variable="TransactionDetailPort">
                            <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/Severity]]></bpws:query>
                          </bpws:from>
                          <bpws:to variable="SEVERITY"/>
                        </bpws:copy>
                        <bpws:copy>
                          <bpws:from variable="TransactionDetailPort">
                            <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/Message]]></bpws:query>
                          </bpws:from>
                          <bpws:to variable="SDP_ERROR_OBJECT_MESSAGE"/>
                        </bpws:copy>
                        <bpws:copy>
                          <bpws:from>true</bpws:from>
                          <bpws:to variable="MANUAL_INTERVENTION_FLAG"/>
                        </bpws:copy>
                        <bpws:copy>
                          <bpws:from variable="TransactionDetailPort">
                            <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/TargetSystem]]></bpws:query>
                          </bpws:from>
                          <bpws:to variable="TARGET_SYSTEM_NAME"/>
                        </bpws:copy>
                        <bpws:copy>
                          <bpws:from variable="TransactionDetailPort">
                            <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/currentTargetOperation]]></bpws:query>
                          </bpws:from>
                          <bpws:to variable="TARGET_OPERATION_NAME"/>
                        </bpws:copy>
                        <bpws:copy>
                          <bpws:from variable="TransactionDetailPort">
                            <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/Message]]></bpws:query>
                          </bpws:from>
                          <bpws:to variable="sdpOrderProc">
                            <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/errorDetails/Error/Message]]></bpws:query>
                          </bpws:to>
                        </bpws:copy>
                      </bpws:assign>
                      <bpws:invoke name="LogCommonErrorLogger2" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [CommonErrorLogger ]" wpc:id="1477">
                        <wpc:script>
                          <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage("Invoking CommonErrorLogger:",PROCESS_NAME,processID,SdpLoggerHelper.INFO);
												
sdpOrderProc.setString(SdpHelper.TEMPSTRING1_PATH.replace('.','/'),processID);																				]]></wpc:javaCode>
                        </wpc:script>
                      </bpws:invoke>
                      <bpws:invoke name="InvokeLogError1" operation="logErrorDetails" partnerLink="FromSdp_CommonErrorLogger_Interface" portType="ns21:FromSdp_CommonErrorLogger_Interface" wpc:displayName="Invoke LogError" wpc:id="1478">
                        <wpc:input>
                          <wpc:parameter name="transactionState" variable="STATE"/>
                          <wpc:parameter name="targetOperation" variable="TARGET_OPERATION_NAME"/>
                          <wpc:parameter name="parentProcessName" variable="PARENT_PROCESS_NAME"/>
                          <wpc:parameter name="sdpOrder" variable="sdpOrderProc"/>
                          <wpc:parameter name="manualInterventionInd" variable="MANUAL_INTERVENTION_FLAG"/>
                          <wpc:parameter name="severity" variable="SEVERITY"/>
                          <wpc:parameter name="targetSystem" variable="TARGET_SYSTEM_NAME"/>
                          <wpc:parameter name="sdpErrorObjectMessage" variable="SDP_ERROR_OBJECT_MESSAGE"/>
                        </wpc:input>
                        <wpc:output>
                          <wpc:parameter name="response" variable="TransactionDetail_Error"/>
                        </wpc:output>
                      </bpws:invoke>
                      <bpws:invoke name="LogCommonErrorLogger3" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [ CommonErrorLogger]" wpc:id="1480">
                        <wpc:script>
                          <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage(" CommonErrorLogger",PROCESS_NAME,processID,SdpLoggerHelper.INFO);]]></wpc:javaCode>
                        </wpc:script>
                      </bpws:invoke>
                      <bpws:assign name="Copyproctotrig1" wpc:displayName="Copy proc to trig" wpc:id="1481">
                        <bpws:copy>
                          <bpws:from variable="sdpOrderProc"/>
                          <bpws:to variable="sdpOrderTrig"/>
                        </bpws:copy>
                        <bpws:copy>
                          <bpws:from variable="provSdpOrderProc"/>
                          <bpws:to variable="provSdpOrderTrig"/>
                        </bpws:copy>
                      </bpws:assign>
                      <bpws:reply name="Reply" operation="compensateDeleteMailBox" partnerLink="DeleteMailBox_Compensation_Interface" portType="ns20:DeleteMailBox_Compensation_Interface" wpc:displayName="Reply" wpc:id="1482">
                        <wpc:input>
                          <wpc:parameter name="SDP_ORDER_ProvPort" variable="provSdpOrderTrig"/>
                          <wpc:parameter name="Transaction_Detail" variable="TransactionDetailPort"/>
                          <wpc:parameter name="SDP_ORDER_RequestPort" variable="sdpOrderTrig"/>
                        </wpc:input>
                      </bpws:reply>
                      <bpws:terminate name="Terminate4" wpc:displayName="Terminate" wpc:id="1483"/>
                    </bpws:sequence>
                  </bpws:case>
                  <bpws:otherwise wpc:id="1852">
                    <bpws:sequence name="HiddenSequence34" wpc:id="1073743621">
                      <bpws:invoke name="LogUCDCLgetGroupMailboxInfoSuccess" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UCDCL.getGroupMailboxInfo - Success]" wpc:id="1485">
                        <wpc:script>
                          <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage("UCDCL.getGroupMailboxInfo :-"+SdpLoggerHelper.SUCCESS_STR,
	PROCESS_NAME,processID,SdpLoggerHelper.INFO);
SdpLoggerHelper.logMessage("Response BO : [sdpOrderPort]",PROCESS_NAME,processID,SdpLoggerHelper.INFO);													
SdpLoggerHelper.logBO(sdpOrderPort,PROCESS_NAME,processID,SdpLoggerHelper.INFO);]]></wpc:javaCode>
                        </wpc:script>
                      </bpws:invoke>
                      <bpws:invoke name="Setindexas1fornewMailboxes" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Set index as &quot;-1&quot; for new Mailboxes" wpc:id="1489">
                        <wpc:script>
                          <wpc:javaCode><![CDATA[List lstTempStore = null;
Iterator itrTempStore = null;

DataObject tempStore = null;
DataObject tmpSdp_Order = null;
DataObject tmpAccountMailbox = null;

String strInvariantId = null;
StringBuffer logMsg=new StringBuffer();
tmpSdp_Order = SdpHelper.copySpecificBO(sdpOrderForIndex);

lstTempStore = sdpOrderPort.getList(SdpHelper.TEMP_STORE_LIST.replace('.','/'));
itrTempStore = lstTempStore.iterator();

SdpLoggerHelper.logMessage("setting index as -1 for New Mailboxes",
	PROCESS_NAME,processID,SdpLoggerHelper.INFO);

while (itrTempStore.hasNext())
{
	tempStore = (DataObject)itrTempStore.next();
	if (tempStore != null)
	{
		strInvariantId = tempStore.getString(SdpHelper.TEMP1);
		SdpLoggerHelper.logMessage("Comparing the index of getGroupMailbox with New Mailboxes",
			PROCESS_NAME,processID,SdpLoggerHelper.INFO);
		tmpAccountMailbox = SdpHelper.getMailBox(tmpSdp_Order,strInvariantId);
		if(tempStore.getInt("temp10") == 0 || tmpAccountMailbox != null)
		{	
			tempStore.setInt("temp10",-1);
			
			logMsg.append("Mailbox [");
			logMsg.append(strInvariantId);
			logMsg.append("]");
			logMsg.append("is available in New Mailboxes and set as -1 for setGroupMailboxInfo call");
			SdpLoggerHelper.logMessage(logMsg.toString(),PROCESS_NAME,processID,SdpLoggerHelper.INFO);
			logMsg.delete(0, logMsg.length());
		}
	}
} 

// Setting index as "-1" to PrimaryMailbox
try {

	sdpOrderPort.setInt(SdpHelper.TEMPINT2_PATH.replace('.','/'),-1);
}
catch (Exception ex)
{
	SdpLoggerHelper.logMessage("Not able to set index as -1 for Primary Mailbox",
		PROCESS_NAME,processID,SdpLoggerHelper.INFO);	
}]]></wpc:javaCode>
                        </wpc:script>
                      </bpws:invoke>
                      <bpws:assign name="PreInvokeAssigns15" wpc:displayName="Pre-Invoke Assigns" wpc:id="1491">
                        <bpws:copy>
                          <bpws:from variable="EmptyTransaction_Detail"/>
                          <bpws:to variable="TransactionDetailPort"/>
                        </bpws:copy>
                        <bpws:copy>
                          <bpws:from>UCDCL.setGroupMailboxInfo.Request</bpws:from>
                          <bpws:to variable="TransactionDetailPort">
                            <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/State]]></bpws:query>
                          </bpws:to>
                        </bpws:copy>
                        <bpws:copy>
                          <bpws:from>UCDCL</bpws:from>
                          <bpws:to variable="TransactionDetailPort">
                            <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/TargetSystem]]></bpws:query>
                          </bpws:to>
                        </bpws:copy>
                        <bpws:copy>
                          <bpws:from>setGroupMailboxInfo</bpws:from>
                          <bpws:to variable="TransactionDetailPort">
                            <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/currentTargetOperation]]></bpws:query>
                          </bpws:to>
                        </bpws:copy>
                      </bpws:assign>
                      <bpws:invoke name="LogUCDCLsetGroupMailboxInfo" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UCDCL.setGroupMailboxInfo]" wpc:id="1494">
                        <wpc:script>
                          <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage(SdpLoggerHelper.INVOKE_STR +" : UCDCL.setGroupMailboxInfo",
	PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("Request BO : [sdpOrderPort]",PROCESS_NAME,processID,SdpLoggerHelper.INFO);													

SdpLoggerHelper.logBO(sdpOrderPort,PROCESS_NAME,processID,SdpLoggerHelper.INFO);
]]></wpc:javaCode>
                        </wpc:script>
                      </bpws:invoke>
                      <bpws:invoke name="InvokeUCDCLsetGroupMailboxInfo" operation="setGroupMailboxInfo" partnerLink="UcdclCompensableServicePartner_Interface" portType="ns25:UCDCLCompensableService_Interface" wpc:displayName="Invoke - [UCDCL.setGroupMailboxInfo]" wpc:id="1499">
                        <wpc:input>
                          <wpc:parameter name="order" variable="sdpOrderPort"/>
                        </wpc:input>
                        <wpc:output>
                          <wpc:parameter name="transactionDetail" variable="processTransDetail"/>
                        </wpc:output>
                        <bpws:catch faultName="wpc:runtimeFailure" faultVariable="bpcFault" wpc:faultType="wpc:BPCStandardFaultType" wpc:id="1854" wpc:variableId="1500">
                          <bpws:invoke name="Handlesruntimefailures" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="handles runtime failures" wpc:id="1502">
                            <wpc:script>
                              <wpc:javaCode><![CDATA[SdpErrorHelper.setErrDetInTransDet(sdpOrderPort.getDataObject(SdpHelper.TRANSACTION_DETAIL),bpcFault,SdpErrorHelper.SEVERITY_FATAL);
SdpLoggerHelper.logMessage(SdpLoggerHelper.RUNTIME_FAILURE+" UCDCL.setGroupMailboxInfo",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);

DataObject responseMessage = (DataObject)TransactionDetailPort.getDataObject("errorDetails/Error/Message");
responseMessage.setString(SdpHelper.ERRORDETAILS_MESSAGE_CODE,SdpErrorHelper.SDP_INTERNAL_SYSTEM_ERROR);]]></wpc:javaCode>
                            </wpc:script>
                          </bpws:invoke>
                        </bpws:catch>
                        <bpws:catch faultName="ns25:serviceCallFault" faultVariable="scFault" wpc:faultType="java:ServiceCallFault" wpc:id="1855" wpc:variableId="1819">
                          <bpws:invoke name="SetErrorDetails3" operation="null" partnerLink="null" portType="wpc:null" wpc:continueOnError="inherit" wpc:displayName="Set Error Details" wpc:id="1820">
                            <wpc:script>
                              <wpc:javaCode><![CDATA[TransactionDetailPort.setBoolean(SdpHelper.ERRORINDICATOR,true);

new att.lightspeed.sdp.helper.TransactionDetail(TransactionDetailPort).setSDPErrorMessage(scFault);

TransactionDetailPort.getDataObject("errorDetails").getDataObject("Error").setString("Severity",SdpErrorHelper.SEVERITY_FATAL);

SdpLoggerHelper.logMessage(SdpLoggerHelper.FAULT_FAILURE +"  UCDCL.DelegatedLogin",PROCESS_NAME,processID,SdpLoggerHelper.FATAL); ]]></wpc:javaCode>
                            </wpc:script>
                          </bpws:invoke>
                        </bpws:catch>
                        <bpws:catchAll wpc:id="1853">
                          <bpws:invoke name="Handlesotherfailures" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="handles other failures" wpc:id="1504">
                            <wpc:script>
                              <wpc:javaCode><![CDATA[SdpErrorHelper.setErrDetInTransDet(sdpOrderPort.getDataObject(SdpHelper.TRANSACTION_DETAIL),null,SdpErrorHelper.SEVERITY_FATAL);
SdpLoggerHelper.logMessage(SdpLoggerHelper.UNKNOWN_FAILURE+" UCDCL.setGroupMailboxInfo",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);

DataObject responseMessage = (DataObject)TransactionDetailPort.getDataObject("errorDetails/Error/Message");
responseMessage.setString(SdpHelper.ERRORDETAILS_MESSAGE_CODE,SdpErrorHelper.SDP_INTERNAL_SYSTEM_ERROR);]]></wpc:javaCode>
                            </wpc:script>
                          </bpws:invoke>
                        </bpws:catchAll>
                      </bpws:invoke>
                      <bpws:switch name="CheckUCDCLError3" wpc:displayName="Check UCDCL Error?" wpc:id="1525">
                        <bpws:case wpc:id="1526">
                          <bpws:condition><![CDATA[boolean __result__1 = com.ibm.wbiservers.brules.core.codegen.NillableUtility.getBoolean(TransactionDetailPort, "errorIndicator", "TransactionDetailPort");
return __result__1;

//@generated:com.ibm.wbit.activity.ui
//<?xml version="1.0" encoding="UTF-8"?>
//<com.ibm.wbit.activity:CompositeActivity xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:com.ibm.wbit.activity="http:///com/ibm/wbit/activity.ecore" name="ActivityMethod">
//  <result name="Result">
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="boolean"/>
//  </result>
//  <exceptions>
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="com.ibm.bpe.api.ProcessException"/>
//  </exceptions>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="TransactionDetailPort.errorIndicator" field="true">
//    <dataOutputs target="//@executableElements.1"/>
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="boolean" namespace="http://www.w3.org/2001/XMLSchema" nillable="false"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:ReturnElement" dataInputs="//@executableElements.0/@dataOutputs.0"/>
//  <executableGroups executableElements="//@executableElements.0 //@executableElements.1"/>
//</com.ibm.wbit.activity:CompositeActivity>
//@generated:end
//!SMAP!*S WBIACTDBG
//!SMAP!*L
//!SMAP!1:1,1
//!SMAP!2:2,1
//!SMAP!1000000:26,1]]></bpws:condition>
                          <bpws:sequence name="HiddenSequence35" wpc:id="1073743622">
                            <bpws:invoke name="LogUCDCLsetGroupMailboxInfoError" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UCDCL.setGroupMailboxInfo - Error]" wpc:id="1529">
                              <wpc:script>
                                <wpc:javaCode><![CDATA[String strSeverity =TransactionDetailPort.getString("errorDetails/Error/Severity");
int logLevel = SdpHelper.getLogLevel(strSeverity);
SdpLoggerHelper.logMessage("UCDCL.setGroupMailboxInfo :- "+SdpLoggerHelper.ERROR_STR+"["+strSeverity+"]",PROCESS_NAME,processID,logLevel);
SdpLoggerHelper.logMessage("Response BO [TransactionDetailPort]",PROCESS_NAME,processID,logLevel);													
SdpLoggerHelper.logBO(TransactionDetailPort,PROCESS_NAME,processID,logLevel);
																		]]></wpc:javaCode>
                              </wpc:script>
                            </bpws:invoke>
                            <bpws:assign name="PrepareGBOforLogging4" wpc:displayName="Prepare GBO for Logging" wpc:id="1530">
                              <bpws:copy>
                                <bpws:from variable="TransactionDetailPort">
                                  <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/State]]></bpws:query>
                                </bpws:from>
                                <bpws:to variable="STATE"/>
                              </bpws:copy>
                              <bpws:copy>
                                <bpws:from variable="TransactionDetailPort">
                                  <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/Severity]]></bpws:query>
                                </bpws:from>
                                <bpws:to variable="SEVERITY"/>
                              </bpws:copy>
                              <bpws:copy>
                                <bpws:from variable="TransactionDetailPort">
                                  <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/Message]]></bpws:query>
                                </bpws:from>
                                <bpws:to variable="SDP_ERROR_OBJECT_MESSAGE"/>
                              </bpws:copy>
                              <bpws:copy>
                                <bpws:from>true</bpws:from>
                                <bpws:to variable="MANUAL_INTERVENTION_FLAG"/>
                              </bpws:copy>
                              <bpws:copy>
                                <bpws:from variable="TransactionDetailPort">
                                  <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/TargetSystem]]></bpws:query>
                                </bpws:from>
                                <bpws:to variable="TARGET_SYSTEM_NAME"/>
                              </bpws:copy>
                              <bpws:copy>
                                <bpws:from variable="TransactionDetailPort">
                                  <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/currentTargetOperation]]></bpws:query>
                                </bpws:from>
                                <bpws:to variable="TARGET_OPERATION_NAME"/>
                              </bpws:copy>
                              <bpws:copy>
                                <bpws:from variable="TransactionDetailPort">
                                  <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/Message]]></bpws:query>
                                </bpws:from>
                                <bpws:to variable="sdpOrderProc">
                                  <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/errorDetails/Error/Message]]></bpws:query>
                                </bpws:to>
                              </bpws:copy>
                            </bpws:assign>
                            <bpws:invoke name="LogCommonErrorLogger2" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [CommonErrorLogger ]" wpc:id="1532">
                              <wpc:script>
                                <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage("Invoking CommonErrorLogger:",PROCESS_NAME,processID,SdpLoggerHelper.INFO);
												
sdpOrderProc.setString(SdpHelper.TEMPSTRING1_PATH.replace('.','/'),processID);																				]]></wpc:javaCode>
                              </wpc:script>
                            </bpws:invoke>
                            <bpws:invoke name="InvokeLogError1" operation="logErrorDetails" partnerLink="FromSdp_CommonErrorLogger_Interface" portType="ns21:FromSdp_CommonErrorLogger_Interface" wpc:displayName="Invoke LogError" wpc:id="1533">
                              <wpc:input>
                                <wpc:parameter name="transactionState" variable="STATE"/>
                                <wpc:parameter name="targetOperation" variable="TARGET_OPERATION_NAME"/>
                                <wpc:parameter name="parentProcessName" variable="PARENT_PROCESS_NAME"/>
                                <wpc:parameter name="sdpOrder" variable="sdpOrderProc"/>
                                <wpc:parameter name="manualInterventionInd" variable="MANUAL_INTERVENTION_FLAG"/>
                                <wpc:parameter name="severity" variable="SEVERITY"/>
                                <wpc:parameter name="targetSystem" variable="TARGET_SYSTEM_NAME"/>
                                <wpc:parameter name="sdpErrorObjectMessage" variable="SDP_ERROR_OBJECT_MESSAGE"/>
                              </wpc:input>
                              <wpc:output>
                                <wpc:parameter name="response" variable="TransactionDetail_Error"/>
                              </wpc:output>
                            </bpws:invoke>
                            <bpws:invoke name="LogCommonErrorLogger3" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [ CommonErrorLogger]" wpc:id="1535">
                              <wpc:script>
                                <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage(" CommonErrorLogger",PROCESS_NAME,processID,SdpLoggerHelper.INFO);]]></wpc:javaCode>
                              </wpc:script>
                            </bpws:invoke>
                            <bpws:assign name="Copyproctotrig1" wpc:displayName="Copy proc to trig" wpc:id="1536">
                              <bpws:copy>
                                <bpws:from variable="sdpOrderProc"/>
                                <bpws:to variable="sdpOrderTrig"/>
                              </bpws:copy>
                              <bpws:copy>
                                <bpws:from variable="provSdpOrderProc"/>
                                <bpws:to variable="provSdpOrderTrig"/>
                              </bpws:copy>
                            </bpws:assign>
                            <bpws:reply name="Reply" operation="compensateDeleteMailBox" partnerLink="DeleteMailBox_Compensation_Interface" portType="ns20:DeleteMailBox_Compensation_Interface" wpc:displayName="Reply" wpc:id="1537">
                              <wpc:input>
                                <wpc:parameter name="SDP_ORDER_ProvPort" variable="provSdpOrderTrig"/>
                                <wpc:parameter name="Transaction_Detail" variable="TransactionDetailPort"/>
                                <wpc:parameter name="SDP_ORDER_RequestPort" variable="sdpOrderTrig"/>
                              </wpc:input>
                            </bpws:reply>
                            <bpws:terminate name="Terminate4" wpc:displayName="Terminate" wpc:id="1538"/>
                          </bpws:sequence>
                        </bpws:case>
                        <bpws:otherwise wpc:id="1856">
                          <bpws:sequence name="HiddenSequence36" wpc:id="1073743623">
                            <bpws:invoke name="LogUCDCLsetGroupMailboxInfoSuccess" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UCDCL.setGroupMailboxInfo - Success]" wpc:id="1541">
                              <wpc:script>
                                <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage("UCDCL.setGroupMailboxInfo :-"+SdpLoggerHelper.SUCCESS_STR,
	PROCESS_NAME,processID,SdpLoggerHelper.INFO);
SdpLoggerHelper.logMessage("Response BO : [TransactionDetailPort]",PROCESS_NAME,processID,SdpLoggerHelper.INFO);													
SdpLoggerHelper.logBO(TransactionDetailPort,PROCESS_NAME,processID,SdpLoggerHelper.INFO);
																		]]></wpc:javaCode>
                              </wpc:script>
                            </bpws:invoke>
                            <bpws:invoke name="SetUMSessionIDUMMessageCenterIP6" operation="null" partnerLink="null" portType="wpc:null" wpc:continueOnError="inherit" wpc:displayName="Set UMSessionID &amp; UMMessageCenterIP" wpc:id="1837">
                              <wpc:script>
                                <wpc:javaCode><![CDATA[att.lightspeed.sdp.helper.WpsLogger logger = att.lightspeed.sdp.helper.WpsLogger.getLogger(processInstance());
String UMSessionID = null;
String UMMessageCenterIP = null;

UMSessionID = processTransDetail.getString(SdpHelper.TRANSDETAIL_UMSESSIONID);
UMMessageCenterIP = processTransDetail.getString(SdpHelper.TRANSDETAIL_UMMESSAGECENTERIP);

logger.debug("UMSessionID from the setGroupMailboxInfo Response: " + UMSessionID);
logger.debug("UMMessageCenterIP from the setGroupMailboxInfo Response: " + UMMessageCenterIP);

sdpOrderPort.setString(SdpHelper.xPathify(SdpHelper.TRANSDETAIL_UMSESSIONID_PATH),UMSessionID);

sdpOrderPort.setString(SdpHelper.xPathify(SdpHelper.TRANSDETAIL_UMMESSAGECENTERIP_PATH),UMMessageCenterIP);]]></wpc:javaCode>
                              </wpc:script>
                            </bpws:invoke>
                            <bpws:invoke name="SetindexforMailboxes" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Set index for Mailboxes" wpc:id="1543">
                              <wpc:script>
                                <wpc:javaCode><![CDATA[List lstTempStore = null;
Iterator itrTempStore = null;

DataObject tempStore = null;
DataObject tmpSdp_Order = null;
DataObject tmpAccountMailbox = null;

String strInvariantId = null;
int index = 0;
boolean enabled = false;
StringBuffer logMsg=new StringBuffer();
tmpSdp_Order = SdpHelper.copySpecificBO(sdpOrderForIndex);

lstTempStore = sdpOrderPort.getList(SdpHelper.TEMP_STORE_LIST.replace('.','/'));
itrTempStore = lstTempStore.iterator();

SdpLoggerHelper.logMessage("setting Indexes for New Mailboxes",
	PROCESS_NAME,processID,SdpLoggerHelper.INFO);

while (itrTempStore.hasNext())
{
	tempStore = (DataObject)itrTempStore.next();
	if (tempStore != null)
	{
		strInvariantId = tempStore.getString(SdpHelper.TEMP1);
		SdpLoggerHelper.logMessage("Comparing the index of getGroupMailbox with New Mailboxes",
			PROCESS_NAME,processID,SdpLoggerHelper.INFO);
		tmpAccountMailbox = SdpHelper.getMailBox(tmpSdp_Order,strInvariantId);
		if(tmpAccountMailbox != null)
		{	
			try {
				index = tmpAccountMailbox.getInt(SdpHelper.CVOIP_MAILBOX_INDEX);
				if (index == 0 || index == -1)
				{
					index = -1;
				}
				else
				{
					enabled = true;
				} 
			}
			catch(Exception ex)
			{
				index = -1;
			}
			tempStore.setInt("temp10",index);
			
			logMsg.append("Index for Mailbox [");
			logMsg.append(strInvariantId);
			logMsg.append("]is set as [");
			logMsg.append(index);
			logMsg.append("] for setGroupMailboxInfo call");
			SdpLoggerHelper.logMessage(logMsg.toString(),PROCESS_NAME,processID,SdpLoggerHelper.INFO);
			logMsg.delete(0, logMsg.length());
		}
	}
} 

// Setting index for PrimaryMailbox
try {
	int mainMailboxIndex = mainMailBox.getInt(SdpHelper.CVOIP_MAILBOX_INDEX);
	
	if (mainMailboxIndex == 0 || mainMailboxIndex == -1)
	{
		sdpOrderPort.setInt(SdpHelper.TEMPINT2_PATH.replace('.','/'),-1);
	}
	else
	{
		sdpOrderPort.setInt(SdpHelper.TEMPINT2_PATH.replace('.','/'),mainMailboxIndex);
	}
}
catch (Exception ex)
{
	SdpLoggerHelper.logMessage("Not able to set index for Primary Mailbox",
		PROCESS_NAME,processID,SdpLoggerHelper.INFO);	
}

// Setting enabled for PrimaryMailbox

if (enabled)
{
	sdpOrderPort.setBoolean(SdpHelper.TEMPBOOL1_PATH.replace('.','/'), true);
	SdpLoggerHelper.logMessage("PrimaryMailbox Enabled is set as TRUE",
		PROCESS_NAME,processID,SdpLoggerHelper.INFO);
}
else
{
	sdpOrderPort.setBoolean(SdpHelper.TEMPBOOL1_PATH.replace('.','/'), false);
	SdpLoggerHelper.logMessage("PrimaryMailbox Enabled is set as FALSE",
		PROCESS_NAME,processID,SdpLoggerHelper.INFO);
}]]></wpc:javaCode>
                              </wpc:script>
                            </bpws:invoke>
                            <bpws:assign name="PreInvokeAssigns15" wpc:displayName="Pre-Invoke Assigns" wpc:id="1544">
                              <bpws:copy>
                                <bpws:from variable="EmptyTransaction_Detail"/>
                                <bpws:to variable="TransactionDetailPort"/>
                              </bpws:copy>
                              <bpws:copy>
                                <bpws:from>UCDCL.setGroupMailboxInfo.Request</bpws:from>
                                <bpws:to variable="TransactionDetailPort">
                                  <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/State]]></bpws:query>
                                </bpws:to>
                              </bpws:copy>
                              <bpws:copy>
                                <bpws:from>UCDCL</bpws:from>
                                <bpws:to variable="TransactionDetailPort">
                                  <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/TargetSystem]]></bpws:query>
                                </bpws:to>
                              </bpws:copy>
                              <bpws:copy>
                                <bpws:from>setGroupMailboxInfo</bpws:from>
                                <bpws:to variable="TransactionDetailPort">
                                  <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/currentTargetOperation]]></bpws:query>
                                </bpws:to>
                              </bpws:copy>
                            </bpws:assign>
                            <bpws:invoke name="LogUCDCLsetGroupMailboxInfo" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UCDCL.setGroupMailboxInfo]" wpc:id="1546">
                              <wpc:script>
                                <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage(SdpLoggerHelper.INVOKE_STR +" : UCDCL.setGroupMailboxInfo",
	PROCESS_NAME,processID,SdpLoggerHelper.INFO);
	
SdpLoggerHelper.logMessage("Request BO : [sdpOrderPort]",PROCESS_NAME,processID,SdpLoggerHelper.INFO);													

SdpLoggerHelper.logBO(sdpOrderPort,PROCESS_NAME,processID,SdpLoggerHelper.INFO);]]></wpc:javaCode>
                              </wpc:script>
                            </bpws:invoke>
                            <bpws:invoke name="InvokeUCDCLsetGroupMailboxInfo" operation="setGroupMailboxInfo" partnerLink="UcdclCompensableServicePartner_Interface" portType="ns25:UCDCLCompensableService_Interface" wpc:displayName="Invoke - [UCDCL.setGroupMailboxInfo]" wpc:id="1547">
                              <wpc:input>
                                <wpc:parameter name="order" variable="sdpOrderPort"/>
                              </wpc:input>
                              <wpc:output>
                                <wpc:parameter name="transactionDetail" variable="processTransDetail"/>
                              </wpc:output>
                              <bpws:catch faultName="wpc:runtimeFailure" faultVariable="bpcFault" wpc:faultType="wpc:BPCStandardFaultType" wpc:id="1858" wpc:variableId="1548">
                                <bpws:invoke name="Handlesruntimefailures" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="handles runtime failures" wpc:id="1550">
                                  <wpc:script>
                                    <wpc:javaCode><![CDATA[SdpErrorHelper.setErrDetInTransDet(sdpOrderPort.getDataObject(SdpHelper.TRANSACTION_DETAIL),bpcFault,SdpErrorHelper.SEVERITY_FATAL);
SdpLoggerHelper.logMessage(SdpLoggerHelper.RUNTIME_FAILURE+" UCDCL.setGroupMailboxInfo",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);

DataObject responseMessage = (DataObject)TransactionDetailPort.getDataObject("errorDetails/Error/Message");
responseMessage.setString(SdpHelper.ERRORDETAILS_MESSAGE_CODE,SdpErrorHelper.SDP_INTERNAL_SYSTEM_ERROR);]]></wpc:javaCode>
                                  </wpc:script>
                                </bpws:invoke>
                              </bpws:catch>
                              <bpws:catch faultName="ns25:serviceCallFault" faultVariable="scFault" wpc:faultType="java:ServiceCallFault" wpc:id="1859" wpc:variableId="1821">
                                <bpws:invoke name="SetErrorDetails5" operation="null" partnerLink="null" portType="wpc:null" wpc:continueOnError="inherit" wpc:displayName="Set Error Details" wpc:id="1822">
                                  <wpc:script>
                                    <wpc:javaCode><![CDATA[TransactionDetailPort.setBoolean(SdpHelper.ERRORINDICATOR,true);

new att.lightspeed.sdp.helper.TransactionDetail(TransactionDetailPort).setSDPErrorMessage(scFault);

TransactionDetailPort.getDataObject("errorDetails").getDataObject("Error").setString("Severity",SdpErrorHelper.SEVERITY_FATAL);

SdpLoggerHelper.logMessage(SdpLoggerHelper.FAULT_FAILURE +"  UCDCL.DelegatedLogin",PROCESS_NAME,processID,SdpLoggerHelper.FATAL); ]]></wpc:javaCode>
                                  </wpc:script>
                                </bpws:invoke>
                              </bpws:catch>
                              <bpws:catchAll wpc:id="1857">
                                <bpws:invoke name="Handlesotherfailures" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="handles other failures" wpc:id="1552">
                                  <wpc:script>
                                    <wpc:javaCode><![CDATA[SdpErrorHelper.setErrDetInTransDet(sdpOrderPort.getDataObject(SdpHelper.TRANSACTION_DETAIL),null,SdpErrorHelper.SEVERITY_FATAL);
SdpLoggerHelper.logMessage(SdpLoggerHelper.UNKNOWN_FAILURE+" UCDCL.setGroupMailboxInfo",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);

DataObject responseMessage = (DataObject)TransactionDetailPort.getDataObject("errorDetails/Error/Message");
responseMessage.setString(SdpHelper.ERRORDETAILS_MESSAGE_CODE,SdpErrorHelper.SDP_INTERNAL_SYSTEM_ERROR);]]></wpc:javaCode>
                                  </wpc:script>
                                </bpws:invoke>
                              </bpws:catchAll>
                            </bpws:invoke>
                            <bpws:switch name="CheckUCDCLError4" wpc:displayName="Check UCDCL Error?" wpc:id="1573">
                              <bpws:case wpc:id="1574">
                                <bpws:condition><![CDATA[boolean __result__1 = com.ibm.wbiservers.brules.core.codegen.NillableUtility.getBoolean(TransactionDetailPort, "errorIndicator", "TransactionDetailPort");
return __result__1;

//@generated:com.ibm.wbit.activity.ui
//<?xml version="1.0" encoding="UTF-8"?>
//<com.ibm.wbit.activity:CompositeActivity xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:com.ibm.wbit.activity="http:///com/ibm/wbit/activity.ecore" name="ActivityMethod">
//  <result name="Result">
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="boolean"/>
//  </result>
//  <exceptions>
//    <type xsi:type="com.ibm.wbit.activity:JavaElementType" name="com.ibm.bpe.api.ProcessException"/>
//  </exceptions>
//  <executableElements xsi:type="com.ibm.wbit.activity:Expression" value="TransactionDetailPort.errorIndicator" field="true">
//    <dataOutputs target="//@executableElements.1"/>
//    <type xsi:type="com.ibm.wbit.activity:XSDElementType" name="boolean" namespace="http://www.w3.org/2001/XMLSchema" nillable="false"/>
//  </executableElements>
//  <executableElements xsi:type="com.ibm.wbit.activity:ReturnElement" dataInputs="//@executableElements.0/@dataOutputs.0"/>
//  <executableGroups executableElements="//@executableElements.0 //@executableElements.1"/>
//</com.ibm.wbit.activity:CompositeActivity>
//@generated:end
//!SMAP!*S WBIACTDBG
//!SMAP!*L
//!SMAP!1:1,1
//!SMAP!2:2,1
//!SMAP!1000000:26,1]]></bpws:condition>
                                <bpws:sequence name="HiddenSequence20" wpc:id="1073743624">
                                  <bpws:invoke name="LogUCDCLsetGroupMailboxInfoError" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UCDCL.setGroupMailboxInfo - Error]" wpc:id="1577">
                                    <wpc:script>
                                      <wpc:javaCode><![CDATA[String strSeverity =TransactionDetailPort.getString("errorDetails/Error/Severity");
int logLevel = SdpHelper.getLogLevel(strSeverity);
SdpLoggerHelper.logMessage("UCDCL.setGroupMailboxInfo :- "+SdpLoggerHelper.ERROR_STR+"["+strSeverity+"]",PROCESS_NAME,processID,logLevel);
SdpLoggerHelper.logMessage("Response BO [TransactionDetailPort]",PROCESS_NAME,processID,logLevel);													
SdpLoggerHelper.logBO(TransactionDetailPort,PROCESS_NAME,processID,logLevel);
																		]]></wpc:javaCode>
                                    </wpc:script>
                                  </bpws:invoke>
                                  <bpws:assign name="PrepareGBOforLogging4" wpc:displayName="Prepare GBO for Logging" wpc:id="1578">
                                    <bpws:copy>
                                      <bpws:from variable="TransactionDetailPort">
                                        <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/State]]></bpws:query>
                                      </bpws:from>
                                      <bpws:to variable="STATE"/>
                                    </bpws:copy>
                                    <bpws:copy>
                                      <bpws:from variable="TransactionDetailPort">
                                        <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/Severity]]></bpws:query>
                                      </bpws:from>
                                      <bpws:to variable="SEVERITY"/>
                                    </bpws:copy>
                                    <bpws:copy>
                                      <bpws:from variable="TransactionDetailPort">
                                        <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/Message]]></bpws:query>
                                      </bpws:from>
                                      <bpws:to variable="SDP_ERROR_OBJECT_MESSAGE"/>
                                    </bpws:copy>
                                    <bpws:copy>
                                      <bpws:from>true</bpws:from>
                                      <bpws:to variable="MANUAL_INTERVENTION_FLAG"/>
                                    </bpws:copy>
                                    <bpws:copy>
                                      <bpws:from variable="TransactionDetailPort">
                                        <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/TargetSystem]]></bpws:query>
                                      </bpws:from>
                                      <bpws:to variable="TARGET_SYSTEM_NAME"/>
                                    </bpws:copy>
                                    <bpws:copy>
                                      <bpws:from variable="TransactionDetailPort">
                                        <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/currentTargetOperation]]></bpws:query>
                                      </bpws:from>
                                      <bpws:to variable="TARGET_OPERATION_NAME"/>
                                    </bpws:copy>
                                    <bpws:copy>
                                      <bpws:from variable="TransactionDetailPort">
                                        <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/errorDetails/Error/Message]]></bpws:query>
                                      </bpws:from>
                                      <bpws:to variable="sdpOrderProc">
                                        <bpws:query queryLanguage="http://www.w3.org/TR/1999/REC-xpath-19991116"><![CDATA[/transactionDetail/errorDetails/Error/Message]]></bpws:query>
                                      </bpws:to>
                                    </bpws:copy>
                                  </bpws:assign>
                                  <bpws:invoke name="LogCommonErrorLogger2" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [CommonErrorLogger ]" wpc:id="1580">
                                    <wpc:script>
                                      <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage("Invoking CommonErrorLogger:",PROCESS_NAME,processID,SdpLoggerHelper.INFO);
												
sdpOrderProc.setString(SdpHelper.TEMPSTRING1_PATH.replace('.','/'),processID);																				]]></wpc:javaCode>
                                    </wpc:script>
                                  </bpws:invoke>
                                  <bpws:invoke name="InvokeLogError1" operation="logErrorDetails" partnerLink="FromSdp_CommonErrorLogger_Interface" portType="ns21:FromSdp_CommonErrorLogger_Interface" wpc:displayName="Invoke LogError" wpc:id="1581">
                                    <wpc:input>
                                      <wpc:parameter name="transactionState" variable="STATE"/>
                                      <wpc:parameter name="targetOperation" variable="TARGET_OPERATION_NAME"/>
                                      <wpc:parameter name="parentProcessName" variable="PARENT_PROCESS_NAME"/>
                                      <wpc:parameter name="sdpOrder" variable="sdpOrderProc"/>
                                      <wpc:parameter name="manualInterventionInd" variable="MANUAL_INTERVENTION_FLAG"/>
                                      <wpc:parameter name="severity" variable="SEVERITY"/>
                                      <wpc:parameter name="targetSystem" variable="TARGET_SYSTEM_NAME"/>
                                      <wpc:parameter name="sdpErrorObjectMessage" variable="SDP_ERROR_OBJECT_MESSAGE"/>
                                    </wpc:input>
                                    <wpc:output>
                                      <wpc:parameter name="response" variable="TransactionDetail_Error"/>
                                    </wpc:output>
                                  </bpws:invoke>
                                  <bpws:invoke name="LogCommonErrorLogger3" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [ CommonErrorLogger]" wpc:id="1583">
                                    <wpc:script>
                                      <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage(" CommonErrorLogger",PROCESS_NAME,processID,SdpLoggerHelper.INFO);]]></wpc:javaCode>
                                    </wpc:script>
                                  </bpws:invoke>
                                  <bpws:assign name="Copyproctotrig1" wpc:displayName="Copy proc to trig" wpc:id="1584">
                                    <bpws:copy>
                                      <bpws:from variable="sdpOrderProc"/>
                                      <bpws:to variable="sdpOrderTrig"/>
                                    </bpws:copy>
                                    <bpws:copy>
                                      <bpws:from variable="provSdpOrderProc"/>
                                      <bpws:to variable="provSdpOrderTrig"/>
                                    </bpws:copy>
                                  </bpws:assign>
                                  <bpws:reply name="Reply" operation="compensateDeleteMailBox" partnerLink="DeleteMailBox_Compensation_Interface" portType="ns20:DeleteMailBox_Compensation_Interface" wpc:displayName="Reply" wpc:id="1585">
                                    <wpc:input>
                                      <wpc:parameter name="SDP_ORDER_ProvPort" variable="provSdpOrderTrig"/>
                                      <wpc:parameter name="Transaction_Detail" variable="TransactionDetailPort"/>
                                      <wpc:parameter name="SDP_ORDER_RequestPort" variable="sdpOrderTrig"/>
                                    </wpc:input>
                                  </bpws:reply>
                                  <bpws:terminate name="Terminate4" wpc:displayName="Terminate" wpc:id="1586"/>
                                </bpws:sequence>
                              </bpws:case>
                              <bpws:otherwise wpc:id="1860">
                                <bpws:sequence name="HiddenSequence8" wpc:id="1073743626">
                                  <bpws:invoke name="LogUCDCLsetGroupMailboxInfoSuccess" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UCDCL.setGroupMailboxInfo - Success]" wpc:id="1589">
                                    <wpc:script>
                                      <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage("UCDCL.setGroupMailboxInfo :-"+SdpLoggerHelper.SUCCESS_STR,
	PROCESS_NAME,processID,SdpLoggerHelper.INFO);
SdpLoggerHelper.logMessage("Response BO : [TransactionDetailPort]",PROCESS_NAME,processID,SdpLoggerHelper.INFO);													
SdpLoggerHelper.logBO(TransactionDetailPort,PROCESS_NAME,processID,SdpLoggerHelper.INFO);
																		]]></wpc:javaCode>
                                    </wpc:script>
                                  </bpws:invoke>
                                  <bpws:invoke name="LogUCDCLLogout2" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UCDCL.Logout]" wpc:id="1739">
                                    <wpc:script>
                                      <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage(SdpLoggerHelper.INVOKE_STR +" : UCDCL.Logout",PROCESS_NAME,processID,SdpLoggerHelper.INFO);]]></wpc:javaCode>
                                    </wpc:script>
                                  </bpws:invoke>
                                  <bpws:invoke name="InvokeUCDCLLogout2" operation="subscriberServiceLogout" partnerLink="UcdclCompensableServicePartner_Interface" portType="ns25:UCDCLCompensableService_Interface" wpc:displayName="Invoke - [UCDCL.Logout]" wpc:id="1740">
                                    <wpc:input>
                                      <wpc:parameter name="transactionDetail" variable="processTransDetail"/>
                                    </wpc:input>
                                    <wpc:output/>
                                    <bpws:catch faultName="wpc:runtimeFailure" faultVariable="bpcFault" wpc:faultType="wpc:BPCStandardFaultType" wpc:id="1862" wpc:variableId="1741">
                                      <bpws:invoke name="HandleruntimeFailure1" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Handle runtime Failure" wpc:id="1743">
                                        <wpc:script>
                                          <wpc:javaCode><![CDATA[SdpErrorHelper.setErrDetInTransDet(TransactionDetailPort,bpcFault,SdpErrorHelper.SEVERITY_FATAL);

SdpLoggerHelper.logMessage(SdpLoggerHelper.RUNTIME_FAILURE+" UCDCL.Logout",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);
]]></wpc:javaCode>
                                        </wpc:script>
                                      </bpws:invoke>
                                    </bpws:catch>
                                    <bpws:catch faultName="ns25:serviceCallFault" faultVariable="scFault" wpc:faultType="java:ServiceCallFault" wpc:id="1863" wpc:variableId="1744">
                                      <bpws:invoke name="SetErrorDetails4" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Set Error Details" wpc:id="1746">
                                        <wpc:script>
                                          <wpc:javaCode><![CDATA[TransactionDetailPort.setBoolean(SdpHelper.ERRORINDICATOR,true);

new att.lightspeed.sdp.helper.TransactionDetail(TransactionDetailPort).setSDPErrorMessage(scFault);

TransactionDetailPort.getDataObject("errorDetails").getDataObject("Error").setString("Severity",SdpErrorHelper.SEVERITY_FATAL);

SdpLoggerHelper.logMessage(SdpLoggerHelper.FAULT_FAILURE +"  UCDCL.Logout",PROCESS_NAME,processID,SdpLoggerHelper.FATAL); 
]]></wpc:javaCode>
                                        </wpc:script>
                                      </bpws:invoke>
                                    </bpws:catch>
                                    <bpws:catchAll wpc:id="1861">
                                      <bpws:invoke name="HandleotherFailures2" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Handle other Failures" wpc:id="1751">
                                        <wpc:script>
                                          <wpc:javaCode><![CDATA[SdpErrorHelper.setErrDetInTransDet(TransactionDetailPort,null,SdpErrorHelper.SEVERITY_FATAL);
SdpLoggerHelper.logMessage(SdpLoggerHelper.UNKNOWN_FAILURE +"  UCDCL.Logout",PROCESS_NAME,processID,SdpLoggerHelper.FATAL);]]></wpc:javaCode>
                                        </wpc:script>
                                      </bpws:invoke>
                                    </bpws:catchAll>
                                  </bpws:invoke>
                                  <bpws:switch name="ErrorinUCDCLLogout2" wpc:displayName="Error in UCDCL.Logout?" wpc:id="1752">
                                    <bpws:case wpc:id="1753">
                                      <bpws:condition><![CDATA[return TransactionDetailPort.getBoolean(SdpHelper.ERRORINDICATOR);]]></bpws:condition>
                                      <bpws:sequence name="HiddenSequence2" wpc:id="1073743625">
                                        <bpws:invoke name="LogUCDCLLogoutError" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UCDCL.Logout - Error]" wpc:id="1756">
                                          <wpc:script>
                                            <wpc:javaCode><![CDATA[String strSeverity =TransactionDetailPort.getString("errorDetails/Error/Severity");
int logLevel = SdpHelper.getLogLevel(strSeverity);

SdpLoggerHelper.logMessage("UCDCL.Logout :- "+SdpLoggerHelper.ERROR_STR+"["+strSeverity+"]",PROCESS_NAME,processID,logLevel);
SdpLoggerHelper.logMessage("Response BO [TransactionDetailPort:]",PROCESS_NAME,processID,logLevel);														
SdpLoggerHelper.logBO(TransactionDetailPort,PROCESS_NAME,processID,logLevel);
																		]]></wpc:javaCode>
                                          </wpc:script>
                                        </bpws:invoke>
                                      </bpws:sequence>
                                    </bpws:case>
                                    <bpws:otherwise wpc:id="1864">
                                      <bpws:invoke name="LogUCDCLLogoutSuccess" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [UCDCL.Logout - Success]" wpc:id="1758">
                                        <wpc:script>
                                          <wpc:javaCode><![CDATA[SdpLoggerHelper.logMessage("UCDCL.Logout -"+SdpLoggerHelper.SUCCESS_STR,PROCESS_NAME,
	processID,SdpLoggerHelper.INFO);]]></wpc:javaCode>
                                        </wpc:script>
                                      </bpws:invoke>
                                    </bpws:otherwise>
                                  </bpws:switch>
                                </bpws:sequence>
                              </bpws:otherwise>
                            </bpws:switch>
                          </bpws:sequence>
                        </bpws:otherwise>
                      </bpws:switch>
                    </bpws:sequence>
                  </bpws:otherwise>
                </bpws:switch>
              </bpws:sequence>
            </bpws:otherwise>
          </bpws:switch>
        </bpws:sequence>
      </bpws:case>
    </bpws:switch>
    <bpws:invoke name="SetresponsesdpOrderProc" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Set response sdpOrderProc" wpc:id="1648">
      <wpc:script>
        <wpc:javaCode><![CDATA[sdpOrderProc = SdpHelper.copySpecificBO(sdpOrderForIndex);
]]></wpc:javaCode>
      </wpc:script>
    </bpws:invoke>
    <bpws:assign name="Copyproctotrig2" wpc:displayName="Copy proc to trig" wpc:id="356">
      <bpws:copy>
        <bpws:from variable="sdpOrderProc"/>
        <bpws:to variable="sdpOrderTrig"/>
      </bpws:copy>
      <bpws:copy>
        <bpws:from variable="provSdpOrderProc"/>
        <bpws:to variable="provSdpOrderTrig"/>
      </bpws:copy>
    </bpws:assign>
    <bpws:invoke name="LogEndProcess" operation="null" partnerLink="null" portType="wpc:null" wpc:displayName="Log - [ End Process] " wpc:id="641">
      <wpc:script>
        <wpc:javaCode><![CDATA[
SdpLoggerHelper.logMessage("Returning the following GBO To MAM ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("TransactionDetailPort : ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(TransactionDetailPort,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("sdpOrderTrig : ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(sdpOrderTrig,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("provSdpOrderTrig : ",PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logBO(provSdpOrderTrig,PROCESS_NAME,processID,SdpLoggerHelper.INFO);

SdpLoggerHelper.logMessage("End SubFlow: DeleteMailBoxCompensation",PROCESS_NAME,processID,SdpLoggerHelper.INFO);]]></wpc:javaCode>
      </wpc:script>
    </bpws:invoke>
    <bpws:reply name="Reply3" operation="compensateDeleteMailBox" partnerLink="DeleteMailBox_Compensation_Interface" portType="ns20:DeleteMailBox_Compensation_Interface" wpc:displayName="Reply" wpc:id="603">
      <wpc:input>
        <wpc:parameter name="SDP_ORDER_ProvPort" variable="provSdpOrderTrig"/>
        <wpc:parameter name="Transaction_Detail" variable="TransactionDetailPort"/>
        <wpc:parameter name="SDP_ORDER_RequestPort" variable="sdpOrderTrig"/>
      </wpc:input>
    </bpws:reply>
  </bpws:sequence>
</bpws:process>